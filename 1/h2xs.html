<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>H2XS(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">H2XS(1)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">H2XS(1)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">h2xs - convert .h C header files to Perl extensions</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>h2xs</b> [<b>OPTIONS</b> ...] [headerfile ...
    [extra_libraries]]</p>
<p class="Pp"><b>h2xs</b> <b>-h</b>|<b>-?</b>|<b>--help</b></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><i>h2xs</i> builds a Perl extension from C header files. The
    extension will include functions which can be used to retrieve the value of
    any #define statement which was in the C header files.</p>
<p class="Pp">The <i>module_name</i> will be used for the name of the extension.
    If module_name is not supplied then the name of the first header file will
    be used, with the first character capitalized.</p>
<p class="Pp">If the extension might need extra libraries, they should be
    included here. The extension Makefile.PL will take care of checking whether
    the libraries actually exist and how they should be loaded. The extra
    libraries should be specified in the form -lm -lposix, etc, just as on the
    cc command line. By default, the Makefile.PL will search through the library
    path determined by Configure. That path can be augmented by including
    arguments of the form <b>-L/another/library/path</b> in the extra-libraries
    argument.</p>
<p class="Pp">In spite of its name, <i>h2xs</i> may also be used to create a
    skeleton pure Perl module. See the <b>-X</b> option.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="A"><a class="permalink" href="#A"><b>-A</b>,
    <b>--omit-autoload</b></a></dt>
  <dd>Omit all autoload facilities. This is the same as <b>-c</b> but also
      removes the <span class="Li">&quot;use&#x00A0;AutoLoader&quot;</span>
      statement from the .pm file.</dd>
  <dt id="B"><a class="permalink" href="#B"><b>-B</b>,
    <b>--beta-version</b></a></dt>
  <dd>Use an alpha/beta style version number. Causes version number to be
      &quot;0.00_01&quot; unless <b>-v</b> is specified.</dd>
  <dt id="C"><a class="permalink" href="#C"><b>-C</b>,
    <b>--omit-changes</b></a></dt>
  <dd>Omits creation of the <i>Changes</i> file, and adds a HISTORY section to
      the POD template.</dd>
  <dt id="F"><a class="permalink" href="#F"><b>-F</b>,
    <b>--cpp-flags</b>=<i>addflags</i></a></dt>
  <dd>Additional flags to specify to C preprocessor when scanning header for
      function declarations. Writes these options in the generated
      <i>Makefile.PL</i> too.</dd>
  <dt id="M"><a class="permalink" href="#M"><b>-M</b>,
    <b>--func-mask</b>=<i>regular expression</i></a></dt>
  <dd>selects functions/macros to process.</dd>
  <dt id="O"><a class="permalink" href="#O"><b>-O</b>,
    <b>--overwrite-ok</b></a></dt>
  <dd>Allows a pre-existing extension directory to be overwritten.</dd>
  <dt id="P"><a class="permalink" href="#P"><b>-P</b>,
    <b>--omit-pod</b></a></dt>
  <dd>Omit the autogenerated stub POD section.</dd>
  <dt id="X"><a class="permalink" href="#X"><b>-X</b>, <b>--omit-XS</b></a></dt>
  <dd>Omit the XS portion. Used to generate a skeleton pure Perl module.
      <span class="Li">&quot;-c&quot;</span> and
      <span class="Li">&quot;-f&quot;</span> are implicitly enabled.</dd>
  <dt id="a"><a class="permalink" href="#a"><b>-a</b>,
    <b>--gen-accessors</b></a></dt>
  <dd>Generate an accessor method for each element of structs and unions. The
      generated methods are named after the element name; will return the
      current value of the element if called without additional arguments; and
      will set the element to the supplied value (and return the new value) if
      called with an additional argument. Embedded structures and unions are
      returned as a pointer rather than the complete structure, to facilitate
      chained calls.
    <p class="Pp">These methods all apply to the Ptr type for the structure;
        additionally two methods are constructed for the structure type itself,
        <span class="Li">&quot;_to_ptr&quot;</span> which returns a Ptr type
        pointing to the same structure, and a
        <span class="Li">&quot;new&quot;</span> method to construct and return a
        new structure, initialised to zeroes.</p>
  </dd>
  <dt id="b"><a class="permalink" href="#b"><b>-b</b>,
    <b>--compat-version</b>=<i>version</i></a></dt>
  <dd>Generates a .pm file which is backwards compatible with the specified perl
      version.
    <p class="Pp">For versions &lt; 5.6.0, the changes are.
      <br/>
       - no use of 'our' (uses 'use vars' instead)
      <br/>
       - no 'use warnings'</p>
    <p class="Pp">Specifying a compatibility version higher than the version of
        perl you are using to run h2xs will have no effect. If unspecified h2xs
        will default to compatibility with the version of perl you are using to
        run h2xs.</p>
  </dd>
  <dt id="c"><a class="permalink" href="#c"><b>-c</b>,
    <b>--omit-constant</b></a></dt>
  <dd>Omit <span class="Li">&quot;constant()&quot;</span> from the .xs file and
      corresponding specialised <span class="Li">&quot;AUTOLOAD&quot;</span>
      from the .pm file.</dd>
  <dt id="d"><a class="permalink" href="#d"><b>-d</b>,
    <b>--debugging</b></a></dt>
  <dd>Turn on debugging messages.</dd>
  <dt id="e"><a class="permalink" href="#e"><b>-e</b>,
    <b>--omit-enums</b>=[<i>regular expression</i>]</a></dt>
  <dd>If <i>regular expression</i> is not given, skip all constants that are
      defined in a C enumeration. Otherwise skip only those constants that are
      defined in an enum whose name matches <i>regular expression</i>.
    <p class="Pp">Since <i>regular expression</i> is optional, make sure that
        this switch is followed by at least one other switch if you omit
        <i>regular expression</i> and have some pending arguments such as
        header-file names. This is ok:</p>
    <p class="Pp"></p>
    <pre>    h2xs -e -n Module::Foo foo.h
    </pre>
    <p class="Pp">This is not ok:</p>
    <p class="Pp"></p>
    <pre>    h2xs -n Module::Foo -e foo.h
    </pre>
    <p class="Pp">In the latter, foo.h is taken as <i>regular
      expression</i>.</p>
  </dd>
  <dt id="f"><a class="permalink" href="#f"><b>-f</b>, <b>--force</b></a></dt>
  <dd>Allows an extension to be created for a header even if that header is not
      found in standard include directories.</dd>
  <dt id="g"><a class="permalink" href="#g"><b>-g</b>, <b>--global</b></a></dt>
  <dd>Include code for safely storing static data in the .xs file. Extensions
      that do no make use of static data can ignore this option.</dd>
  <dt id="h"><a class="permalink" href="#h"><b>-h</b>, <b>-?</b>,
    <b>--help</b></a></dt>
  <dd>Print the usage, help and version for this h2xs and exit.</dd>
  <dt id="k"><a class="permalink" href="#k"><b>-k</b>,
    <b>--omit-const-func</b></a></dt>
  <dd>For function arguments declared as
      <span class="Li">&quot;const&quot;</span>, omit the const attribute in the
      generated XS code.</dd>
  <dt id="m"><a class="permalink" href="#m"><b>-m</b>,
    <b>--gen-tied-var</b></a></dt>
  <dd><b>Experimental</b>: for each variable declared in the header file(s),
      declare a perl variable of the same name magically tied to the C
    variable.</dd>
  <dt id="n"><a class="permalink" href="#n"><b>-n</b>,
    <b>--name</b>=<i>module_name</i></a></dt>
  <dd>Specifies a name to be used for the extension, e.g.,
    -n&#x00A0;RPC::DCE</dd>
  <dt id="o"><a class="permalink" href="#o"><b>-o</b>,
    <b>--opaque-re</b>=<i>regular expression</i></a></dt>
  <dd>Use &quot;opaque&quot; data type for the C types matched by the regular
      expression, even if these types are
      <span class="Li">&quot;typedef&quot;</span>-equivalent to types from
      typemaps. Should not be used without <b>-x</b>.
    <p class="Pp">This may be useful since, say, types which are
        <span class="Li">&quot;typedef&quot;</span>-equivalent to integers may
        represent OS-related handles, and one may want to work with these
        handles in OO-way, as in
        <span class="Li">&quot;$handle-&gt;do_something()&quot;</span>. Use
        <span class="Li">&quot;-o .&quot;</span> if you want to handle all the
        <span class="Li">&quot;typedef&quot;</span>ed types as opaque types.</p>
    <p class="Pp">The type-to-match is whitewashed (except for commas, which
        have no whitespace before them, and multiple
        <span class="Li">&quot;*&quot;</span> which have no whitespace between
        them).</p>
  </dd>
  <dt id="p"><a class="permalink" href="#p"><b>-p</b>,
    <b>--remove-prefix</b>=<i>prefix</i></a></dt>
  <dd>Specify a prefix which should be removed from the Perl function names,
      e.g., -p&#x00A0;sec_rgy_ This sets up the XS <b>PREFIX</b> keyword and
      removes the prefix from functions that are autoloaded via the
      <span class="Li">&quot;constant()&quot;</span> mechanism.</dd>
  <dt id="s"><a class="permalink" href="#s"><b>-s</b>,
    <b>--const-subs</b>=<i>sub1,sub2</i></a></dt>
  <dd>Create a perl subroutine for the specified macros rather than autoload
      with the <b>constant()</b> subroutine. These macros are assumed to have a
      return type of <b>char *</b>, e.g.,
      -s&#x00A0;sec_rgy_wildcard_name,sec_rgy_wildcard_sid.</dd>
  <dt id="t"><a class="permalink" href="#t"><b>-t</b>,
    <b>--default-type</b>=<i>type</i></a></dt>
  <dd>Specify the internal type that the <b>constant()</b> mechanism uses for
      macros. The default is IV (signed integer). Currently all macros found
      during the header scanning process will be assumed to have this type.
      Future versions of <span class="Li">&quot;h2xs&quot;</span> may gain the
      ability to make educated guesses.</dd>
  <dt id="use"><a class="permalink" href="#use"><b>--use-new-tests</b></a></dt>
  <dd>When <b>--compat-version</b> (<b>-b</b>) is present the generated tests
      will use <span class="Li">&quot;Test::More&quot;</span> rather than
      <span class="Li">&quot;Test&quot;</span> which is the default for versions
      before 5.6.2. <span class="Li">&quot;Test::More&quot;</span> will be added
      to PREREQ_PM in the generated
      <span class="Li">&quot;Makefile.PL&quot;</span>.</dd>
  <dt id="use~2"><a class="permalink" href="#use~2"><b>--use-old-tests</b></a></dt>
  <dd>Will force the generation of test code that uses the older
      <span class="Li">&quot;Test&quot;</span> module.</dd>
  <dt id="skip"><a class="permalink" href="#skip"><b>--skip-exporter</b></a></dt>
  <dd>Do not use <span class="Li">&quot;Exporter&quot;</span> and/or export any
      symbol.</dd>
  <dt id="skip~2"><a class="permalink" href="#skip~2"><b>--skip-ppport</b></a></dt>
  <dd>Do not use <span class="Li">&quot;Devel::PPPort&quot;</span>: no
      portability to older version.</dd>
  <dt id="skip~3"><a class="permalink" href="#skip~3"><b>--skip-autoloader</b></a></dt>
  <dd>Do not use the module <span class="Li">&quot;AutoLoader&quot;</span>; but
      keep the <b>constant()</b> function and <span class="Li">&quot;sub
      AUTOLOAD&quot;</span> for constants.</dd>
  <dt id="skip~4"><a class="permalink" href="#skip~4"><b>--skip-strict</b></a></dt>
  <dd>Do not use the pragma <span class="Li">&quot;strict&quot;</span>.</dd>
  <dt id="skip~5"><a class="permalink" href="#skip~5"><b>--skip-warnings</b></a></dt>
  <dd>Do not use the pragma <span class="Li">&quot;warnings&quot;</span>.</dd>
  <dt id="v"><a class="permalink" href="#v"><b>-v</b>,
    <b>--version</b>=<i>version</i></a></dt>
  <dd>Specify a version number for this extension. This version number is added
      to the templates. The default is 0.01, or 0.00_01 if
      <span class="Li">&quot;-B&quot;</span> is specified. The version specified
      should be numeric.</dd>
  <dt id="x"><a class="permalink" href="#x"><b>-x</b>,
    <b>--autogen-xsubs</b></a></dt>
  <dd>Automatically generate XSUBs basing on function declarations in the header
      file. The package <span class="Li">&quot;C::Scan&quot;</span> should be
      installed. If this option is specified, the name of the header file may
      look like <span class="Li">&quot;NAME1,NAME2&quot;</span>. In this case
      NAME1 is used instead of the specified string, but XSUBs are emitted only
      for the declarations included from file NAME2.
    <p class="Pp">Note that some types of arguments/return-values for functions
        may result in XSUB-declarations/typemap-entries which need hand-editing.
        Such may be objects which cannot be converted from/to a pointer (like
        <span class="Li">&quot;long long&quot;</span>), pointers to functions,
        or arrays. See also the section on &quot;LIMITATIONS of
      <b>-x</b>&quot;.</p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<pre>    # Default behavior, extension is Rusers
    h2xs rpcsvc/rusers
    # Same, but extension is RUSERS
    h2xs -n RUSERS rpcsvc/rusers
    # Extension is rpcsvc::rusers. Still finds &lt;rpcsvc/rusers.h&gt;
    h2xs rpcsvc::rusers
    # Extension is ONC::RPC.  Still finds &lt;rpcsvc/rusers.h&gt;
    h2xs -n ONC::RPC rpcsvc/rusers
    # Without constant() or AUTOLOAD
    h2xs -c rpcsvc/rusers
    # Creates templates for an extension named RPC
    h2xs -cfn RPC
    # Extension is ONC::RPC.
    h2xs -cfn ONC::RPC
    # Extension is a pure Perl module with no XS code.
    h2xs -X My::Module
    # Extension is Lib::Foo which works at least with Perl5.005_03.
    # Constants are created for all #defines and enums h2xs can find
    # in foo.h.
    h2xs -b 5.5.3 -n Lib::Foo foo.h
    # Extension is Lib::Foo which works at least with Perl5.005_03.
    # Constants are created for all #defines but only for enums
    # whose names do not start with 'bar_'.
    h2xs -b 5.5.3 -e '^bar_' -n Lib::Foo foo.h
    # Makefile.PL will look for library -lrpc in
    # additional directory /opt/net/lib
    h2xs rpcsvc/rusers -L/opt/net/lib -lrpc
    # Extension is DCE::rgynbase
    # prefix &quot;sec_rgy_&quot; is dropped from perl function names
    h2xs -n DCE::rgynbase -p sec_rgy_ dce/rgynbase
    # Extension is DCE::rgynbase
    # prefix &quot;sec_rgy_&quot; is dropped from perl function names
    # subroutines are created for sec_rgy_wildcard_name and
    # sec_rgy_wildcard_sid
    h2xs -n DCE::rgynbase -p sec_rgy_ \
    -s sec_rgy_wildcard_name,sec_rgy_wildcard_sid dce/rgynbase
    # Make XS without defines in perl.h, but with function declarations
    # visible from perl.h. Name of the extension is perl1.
    # When scanning perl.h, define -DEXT=extern -DdEXT= -DINIT(x)=
    # Extra backslashes below because the string is passed to shell.
    # Note that a directory with perl header files would
    #  be added automatically to include path.
    h2xs -xAn perl1 -F &quot;-DEXT=extern -DdEXT= -DINIT\(x\)=&quot; perl.h
    # Same with function declaration in proto.h as visible from perl.h.
    h2xs -xAn perl2 perl.h,proto.h
    # Same but select only functions which match /^av_/
    h2xs -M '^av_' -xAn perl2 perl.h,proto.h
    # Same but treat SV* etc as &quot;opaque&quot; types
    h2xs -o '^[S]V \*$' -M '^av_' -xAn perl2 perl.h,proto.h
</pre>
<section class="Ss">
<h2 class="Ss" id="Extension_based_on_"><a class="permalink" href="#Extension_based_on_">Extension
  based on <i>.h</i> and <i>.c</i> files</a></h2>
<p class="Pp">Suppose that you have some C files implementing some
    functionality, and the corresponding header files. How to create an
    extension which makes this functionality accessible in Perl? The example
    below assumes that the header files are <i>interface_simple.h</i> and
    <i>interface_hairy.h</i>, and you want the perl module be named as
    <span class="Li">&quot;Ext::Ension&quot;</span>. If you need some
    preprocessor directives and/or linking with external libraries, see the
    flags <span class="Li">&quot;-F&quot;</span>,
    <span class="Li">&quot;-L&quot;</span> and
    <span class="Li">&quot;-l&quot;</span> in &quot;OPTIONS&quot;.</p>
<dl class="Bl-tag">
  <dt id="Find"><a class="permalink" href="#Find">Find the directory
    name</a></dt>
  <dd>Start with a dummy run of h2xs:
    <p class="Pp"></p>
    <pre>  h2xs -Afn Ext::Ension
    </pre>
    <p class="Pp">The only purpose of this step is to create the needed
        directories, and let you know the names of these directories. From the
        output you can see that the directory for the extension is
        <i>Ext/Ension</i>.</p>
  </dd>
  <dt id="Copy"><a class="permalink" href="#Copy">Copy C files</a></dt>
  <dd>Copy your header files and C files to this directory
    <i>Ext/Ension</i>.</dd>
  <dt id="Create"><a class="permalink" href="#Create">Create the
    extension</a></dt>
  <dd>Run h2xs, overwriting older autogenerated files:
    <p class="Pp"></p>
    <pre>  h2xs -Oxan Ext::Ension interface_simple.h interface_hairy.h
    </pre>
    <p class="Pp">h2xs looks for header files <i>after</i> changing to the
        extension directory, so it will find your header files OK.</p>
  </dd>
  <dt id="Archive"><a class="permalink" href="#Archive">Archive and
    test</a></dt>
  <dd>As usual, run
    <p class="Pp"></p>
    <pre>  cd Ext/Ension
  perl Makefile.PL
  make dist
  make
  make test
    </pre>
  </dd>
  <dt id="Hints"><a class="permalink" href="#Hints">Hints</a></dt>
  <dd>It is important to do <span class="Li">&quot;make dist&quot;</span> as
      early as possible. This way you can easily <b>merge</b>(1) your changes to
      autogenerated files if you decide to edit your
      <span class="Li">&quot;.h&quot;</span> files and rerun h2xs.
    <p class="Pp">Do not forget to edit the documentation in the generated
        <i>.pm</i> file.</p>
    <p class="Pp">Consider the autogenerated files as skeletons only, you may
        invent better interfaces than what h2xs could guess.</p>
    <p class="Pp">Consider this section as a guideline only, some other options
        of h2xs may better suit your needs.</p>
  </dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<p class="Pp">No environment variables are used.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Larry Wall and others</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">perl, perlxstut, ExtUtils::MakeMaker, and AutoLoader.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DIAGNOSTICS"><a class="permalink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
<p class="Pp">The usual warnings if it cannot read or write the files
  involved.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="LIMITATIONS_of_"><a class="permalink" href="#LIMITATIONS_of_">LIMITATIONS
  of <b>-x</b></a></h1>
<p class="Pp"><i>h2xs</i> would not distinguish whether an argument to a C
    function which is of the form, say, <span class="Li">&quot;int
    *&quot;</span>, is an input, output, or input/output parameter. In
    particular, argument declarations of the form</p>
<p class="Pp"></p>
<pre>    int
    foo(n)
        int *n
</pre>
<p class="Pp">should be better rewritten as</p>
<p class="Pp"></p>
<pre>    int
    foo(n)
        int &amp;n
</pre>
<p class="Pp">if <span class="Li">&quot;n&quot;</span> is an input
  parameter.</p>
<p class="Pp">Additionally, <i>h2xs</i> has no facilities to intuit that a
    function</p>
<p class="Pp"></p>
<pre>   int
   foo(addr,l)
        char *addr
        int   l
</pre>
<p class="Pp">takes a pair of address and length of data at this address, so it
    is better to rewrite this function as</p>
<p class="Pp"></p>
<pre>    int
    foo(sv)
            SV *addr
        PREINIT:
            STRLEN len;
            char *s;
        CODE:
            s = SvPV(sv,len);
            RETVAL = foo(s, len);
        OUTPUT:
            RETVAL
</pre>
<p class="Pp">or alternately</p>
<p class="Pp"></p>
<pre>    static int
    my_foo(SV *sv)
    {
        STRLEN len;
        char *s = SvPV(sv,len);
        return foo(s, len);
    }
    MODULE = foo        PACKAGE = foo   PREFIX = my_
    int
    foo(sv)
        SV *sv
</pre>
<p class="Pp">See perlxs and perlxstut for additional details.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2023-11-12</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
