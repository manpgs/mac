<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>AA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AA(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">AA(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">aa</code> &#x2014; <span class="Nd">Manipulate
    Apple Archives</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">aa <b>command</b> [<b>options</b>]</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">aa creates and manipulates Apple Archives</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMANDS"><a class="permalink" href="#COMMANDS">COMMANDS</a></h1>
<p class="Pp"><b>archive</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Archive
    the contents of the target directory
  <br/>
  <b>append</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Archive
    the contents of the target directory, append to an existing archive file
  <br/>
  <b>extract</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Extract
    the contents of an archive to the target directory
  <br/>
  <b>list</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;List
    the contents of an archive
  <br/>
  <b>convert</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Convert
    an archive into another archive
  <br/>
  <b>manifest</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Alias
    for 'archive -manifest'
  <br/>
  <b>verify</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Compare
    the contents of the target directory with a manifest
  <br/>
  <b>check-and-fix</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Verify and fix the
    contents of the target directory using an error correcting manifest</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="v"><a class="permalink" href="#v"><code class="Fl">-v</code></a></dt>
  <dd>Increase verbosity. Default is silent operation.</dd>
  <dt id="h"><a class="permalink" href="#h"><code class="Fl">-h</code></a></dt>
  <dd>Print usage and exit.</dd>
  <dt id="d"><a class="permalink" href="#d"><code class="Fl">-d</code></a>
    <code class="Fl">-<i>dir</i></code></dt>
  <dd>Target directory for archive/extract. Default is the current
    directory.</dd>
  <dt id="i"><a class="permalink" href="#i"><code class="Fl">-i</code></a>
    <code class="Fl">-<i>input_file</i></code></dt>
  <dd>Input file. Default is <i>stdin</i>.</dd>
  <dt id="o"><a class="permalink" href="#o"><code class="Fl">-o</code></a>
    <code class="Fl">-<i>output_file</i></code></dt>
  <dd>Output file. Default is <i>stdout</i>.</dd>
  <dt id="subdir"><a class="permalink" href="#subdir"><code class="Fl">-subdir</code></a>
    <code class="Fl">-<i>subdir</i></code></dt>
  <dd>Path to archive under <i>dir</i>. <i>subdir</i> will be included in the
      archived paths, and extracted. Default is empty.</dd>
  <dt id="D"><a class="permalink" href="#D"><code class="Fl">-D</code></a>
    <code class="Fl">-<i>dir_and_subdir</i></code></dt>
  <dd>Set both <i>dir</i> to `dirname <i>dir_and_subdir</i>` and <i>subdir</i>
      to `basename <i>dir_and_subdir</i>`.</dd>
  <dt id="x"><a class="permalink" href="#x"><code class="Fl">-x</code></a></dt>
  <dd>Do not cross volume boundaries when archiving.</dd>
  <dt id="p"><a class="permalink" href="#p"><code class="Fl">-p</code></a></dt>
  <dd>Generate destination path automatically based on source path. For example
      'aa archive -d foo -p' becomes 'aa archive -d foo -o foo.aar'.</dd>
  <dt id="a"><a class="permalink" href="#a"><code class="Fl">-a</code></a>
    <code class="Fl">-<i>algorithm</i></code></dt>
  <dd>Compression algorithm used when creating archives. One of <i>lzfse</i>,
      <i>lzma</i>, <i>lz4</i>, <i>zlib</i>, <i>raw</i>. Default is
    <i>lzfse</i>.</dd>
  <dt id="b"><a class="permalink" href="#b"><code class="Fl">-b</code></a>
    <code class="Fl">-<i>block_size</i></code></dt>
  <dd>Block size used when compressing archives, a number with optional
      <i>b</i>, <i>k</i>, <i>m</i>, <i>g</i> suffix (bytes are assumed if no
      suffix is specified). Default is <i>4m</i> for <i>archive</i> and
      <i>1m</i> for the other commands.</dd>
  <dt id="t"><a class="permalink" href="#t"><code class="Fl">-t</code></a>
    <code class="Fl">-<i>worker_threads</i></code></dt>
  <dd>Number of worker threads compressing/decompressing data. Default is the
      number of physical CPU on the running machine.</dd>
  <dt id="wt"><a class="permalink" href="#wt"><code class="Fl">-wt</code></a>
    <code class="Fl">-<i>writer_threads</i></code></dt>
  <dd>Number of writer threads extracting archive content. Default is to match
      <i>worker_threads</i>.</dd>
  <dt id="enable-dedup"><a class="permalink" href="#enable-dedup"><code class="Fl">-enable-dedup</code></a>
    <code class="Fl">-(-no-enable-dedup)</code></dt>
  <dd>If set, and SLC fields (the SLC field identifies a cluster of regular
      files with identical content) are present in the archive, files with same
      data will be extracted as clones.
    <p class="Pp">Note that to create such an archive, you have to manually add
        the SLC field, for example `aa archive -o archive.aa -include-field SLC
        ...`. In this case, aa marks files with identical content as a cluster
        and shows a summary at the end.</p>
    <p class="Pp">There is no way to deduplicate the data in the archive (by
        storing the data only once) from the command line. To achieve this, use
        the API and pass the `AA_FLAG_ARCHIVE_DEDUPLICATE_DAT` flag.</p>
  </dd>
  <dt id="enable-holes"><a class="permalink" href="#enable-holes"><code class="Fl">-enable-holes</code></a>
    <code class="Fl">-(-no-enable-holes)</code></dt>
  <dd>If set, and the filesystem supports it, detect and create holes in files
      to store 0-filled segments</dd>
  <dt id="ignore-eperm"><a class="permalink" href="#ignore-eperm"><code class="Fl">-ignore-eperm</code></a>
    <code class="Fl">-(-no-ignore-eperm)</code></dt>
  <dd>If set, ignore EPERM (operation not permitted) errors when setting files
      attributes</dd>
  <dt id="manifest"><a class="permalink" href="#manifest"><code class="Fl">-manifest</code></a></dt>
  <dd>Alias for the following options:
    <br/>
    <b>-exclude-field</b> <i>dat</i>
    <br/>
    <b>-include-field</b> <i>sh2,siz,idx,idz</i>
    <br/>
    <b>-a</b> <i>lzfse</i> <b>-b</b> <i>1m</i></dd>
  <dt id="imanifest"><a class="permalink" href="#imanifest"><code class="Fl">-imanifest</code></a>
    <code class="Fl">-<i>input_manifest_file</i></code></dt>
  <dd>Manifest matching the input archive. Can be used in conjonction with the
      entry selection options to accelerate processing</dd>
  <dt id="omanifest"><a class="permalink" href="#omanifest"><code class="Fl">-omanifest</code></a>
    <code class="Fl">-<i>output_manifest_file</i></code></dt>
  <dd>Receives a manifest of the output archive</dd>
  <dt id="list-format"><a class="permalink" href="#list-format"><code class="Fl">-list-format</code></a>
    <code class="Fl">-<i>format</i></code></dt>
  <dd>Output format for the <b>list</b> command, one of <i>text</i>,
      <i>json</i>. Default is <i>text</i></dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_SELECTION_OPTIONS"><a class="permalink" href="#ENTRY_SELECTION_OPTIONS">ENTRY
  SELECTION OPTIONS</a></h1>
<p class="Pp"><b>-include-path</b> and <b>-include-path-list</b> options are
    applied first to select an initial set of entries, then
    <b>-exclude-path</b>, <b>-exclude-path-list</b>, <b>-exclude-name</b>,
    <b>-exclude-regex</b> are applied to remove entries from this set.</p>
<p class="Pp">If no <b>-include-path</b> or <b>-include-path-list</b> option is
    given, all entries are included in the initial set. If a directory is
    included/excluded, the entire sub-tree is included/excluded.</p>
<dl class="Bl-tag">
  <dt id="include-path"><a class="permalink" href="#include-path"><code class="Fl">-include-path</code></a>
    <code class="Fl">-<i>path</i></code></dt>
  <dd>Include entry paths having <i>path</i> as a prefix. This option can be
      given multiple times.</dd>
  <dt id="exclude-path"><a class="permalink" href="#exclude-path"><code class="Fl">-exclude-path</code></a>
    <code class="Fl">-<i>path</i></code></dt>
  <dd>Exclude entry paths having <i>path</i> as a prefix. This option can be
      given multiple times.</dd>
  <dt id="include-path-list"><a class="permalink" href="#include-path-list"><code class="Fl">-include-path-list</code></a>
    <code class="Fl">-<i>path_list_file</i></code></dt>
  <dd>File containing a list of paths to include, one entry per line. This
      option can be given multiple times.</dd>
  <dt id="exclude-path-list"><a class="permalink" href="#exclude-path-list"><code class="Fl">-exclude-path-list</code></a>
    <code class="Fl">-<i>path_list_file</i></code></dt>
  <dd>File containing a list of paths to exclude, one entry per line. This
      option can be given multiple times.</dd>
  <dt id="include-regex"><a class="permalink" href="#include-regex"><code class="Fl">-include-regex</code></a>
    <code class="Fl">-<i>expr</i></code></dt>
  <dd>Include entry paths matching regular expression <i>expr</i>, see
      <i>re_format(7)</i>. This option can be given multiple times.</dd>
  <dt id="exclude"><a class="permalink" href="#exclude"><code class="Fl">-exclude-regex</code></a>
    <code class="Fl">-<i>expr</i></code></dt>
  <dd>Exclude entry paths matching regular expression <i>expr</i>, see
      <i>re_format(7)</i>. This option can be given multiple times.</dd>
  <dt id="exclude~2"><a class="permalink" href="#exclude~2"><code class="Fl">-exclude-name</code></a>
    <code class="Fl">-<i>name</i></code></dt>
  <dd>Exclude entry paths where a single component of the path matches exactly
      <i>name</i>. This option can be given multiple times.</dd>
  <dt id="include-type"><a class="permalink" href="#include-type"><code class="Fl">--include-type</code></a>
    <code class="Fl">-<i>&lt;type_spec&gt;</i></code></dt>
  <dd>Include only entries matching the given types. <i>&lt;type_spec&gt;</i> is
      a word containing one or more of the entry type characters listed
    below.</dd>
  <dt id="exclude-type"><a class="permalink" href="#exclude-type"><code class="Fl">-exclude-type</code></a>
    <code class="Fl">-<i>&lt;type_spec&gt;</i></code></dt>
  <dd>Include only entries not matching the given types.
      <i>&lt;type_spec&gt;</i> is a word containing one or more of the entry
      type characters listed below.</dd>
  <dt id="include-field"><a class="permalink" href="#include-field"><code class="Fl">-include-field</code></a>
    <code class="Fl">-<i>&lt;field_spec&gt;</i></code></dt>
  <dd>Add the given fields to the set of field keys. This option can be given
      multiple times. <i>&lt;field_spec&gt;</i> is a comma separated list of
      entry field keys listed below.</dd>
  <dt id="exclude-field"><a class="permalink" href="#exclude-field"><code class="Fl">-exclude-field</code></a>
    <code class="Fl">-<i>&lt;field_spec&gt;</i></code></dt>
  <dd>Remove the given fields from the set of field keys. This option can be
      given multiple times. <i>&lt;field_spec&gt;</i> is a comma separated list
      of entry field keys listed below.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENCRYPTION_OPTIONS"><a class="permalink" href="#ENCRYPTION_OPTIONS">ENCRYPTION
  OPTIONS</a></h1>
<p class="Pp">When archiving, encryption is selected by one of the
    <i>-password...</i>, <i>-key...</i>, or <i>-recipient-pub</i> options.</p>
<p class="Pp">The archive will be signed if a private key is specified with
    <i>-sign-priv</i>.</p>
<p class="Pp">With the currently available profiles, public/private keys are on
    the Elliptic Curve P-256, and symmetric keys are 256-bit long.</p>
<dl class="Bl-tag">
  <dt id="keychain"><a class="permalink" href="#keychain"><code class="Fl">-keychain</code></a></dt>
  <dd>Use Keychain to load/store symmetric keys and passwords</dd>
  <dt id="password"><a class="permalink" href="#password"><code class="Fl">-password</code></a>
    <code class="Fl">-<i>file</i></code></dt>
  <dd>File containing encryption password. When encrypting, and if
      <i>-password-gen</i> is passed, receives the generated password. Can be
      <i>-</i> to print the password to standard output.</dd>
  <dt id="password-value"><a class="permalink" href="#password-value"><code class="Fl">--password-value</code></a>
    <code class="Fl">-<i>password</i></code></dt>
  <dd>Password.</dd>
  <dt id="password-gen"><a class="permalink" href="#password-gen"><code class="Fl">-password-gen</code></a></dt>
  <dd>When encrypting, generate a new random password. It is recommended to
      always use this option, in conjonction with <i>-keychain</i> to store the
      password in the Keychain, or <i>-password</i> to store the password in a
      file or print it.</dd>
  <dt id="key"><a class="permalink" href="#key"><code class="Fl">-key</code></a>
    <code class="Fl">-<i>file</i></code></dt>
  <dd>File containing encryption symmetric key. When encrypting, and if
      <i>-key-gen</i> is passed, receives the generated key.</dd>
  <dt id="key-value"><a class="permalink" href="#key-value"><code class="Fl">-key-value</code></a>
    <code class="Fl">-<i>key</i></code></dt>
  <dd>Symmetric key, either &quot;hex:&lt;64 hex digits&gt;&quot; or
      &quot;base64:&lt;32 bytes encoded using base64&gt;&quot;.</dd>
  <dt id="key-gen"><a class="permalink" href="#key-gen"><code class="Fl">-key-gen</code></a></dt>
  <dd>When encrypting, generate a new random symmetric key.</dd>
  <dt id="recipient-pub"><a class="permalink" href="#recipient-pub"><code class="Fl">-recipient-pub</code></a>
    <code class="Fl">-<i>file</i></code></dt>
  <dd>Recipient public key for encryption. The corresponding private key is
      required to decrypt the archive.</dd>
  <dt id="recipient-priv"><a class="permalink" href="#recipient-priv"><code class="Fl">-recipient-priv</code></a>
    <code class="Fl">-<i>file</i></code></dt>
  <dd>Recipient private key for decryption. The archive must have been encrypted
      against the corresponding public key.</dd>
  <dt id="sign-pub"><a class="permalink" href="#sign-pub"><code class="Fl">-sign-pub</code></a>
    <code class="Fl">-<i>file</i></code></dt>
  <dd>Signing public key for decryption. The archive must have been signed with
      the corresponding private key.</dd>
  <dt id="sign-priv"><a class="permalink" href="#sign-priv"><code class="Fl">-sign-priv</code></a>
    <code class="Fl">-<i>file</i></code></dt>
  <dd>Signing private key for encryption. The corresponding public key is
      required to decrypt and authenticate the archive.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_TYPES"><a class="permalink" href="#ENTRY_TYPES">ENTRY
  TYPES</a></h1>
<p class="Pp"><b>b</b> block special
  <br/>
  <b>c</b> character special
  <br/>
  <b>d</b> directory
  <br/>
  <b>f</b> regular file
  <br/>
  <b>l</b> symbolic link
  <br/>
  <b>m</b> metadata
  <br/>
  <b>p</b> fifo
  <br/>
  <b>s</b> socket</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_FIELDS"><a class="permalink" href="#ENTRY_FIELDS">ENTRY
  FIELDS</a></h1>
<p class="Pp"><b>typ</b> entry type
  <br/>
  <b>pat</b> path
  <br/>
  <b>lnk</b> link path
  <br/>
  <b>dev</b> device id
  <br/>
  <b>uid</b> user id
  <br/>
  <b>gid</b> group id
  <br/>
  <b>mod</b> access permissions
  <br/>
  <b>flg</b> flags
  <br/>
  <b>mtm</b> modification time
  <br/>
  <b>ctm</b> creation time
  <br/>
  <b>btm</b> backup time
  <br/>
  <b>xat</b> extended attributes
  <br/>
  <b>acl</b> access control list
  <br/>
  <b>cks</b> CRC32 checksum
  <br/>
  <b>sh1</b> SHA1 digest
  <br/>
  <b>sh2</b> SHA2-256 digest
  <br/>
  <b>dat</b> file contents
  <br/>
  <b>siz</b> file size
  <br/>
  <b>duz</b> disk usage
  <br/>
  <b>idx</b> entry index in main archive
  <br/>
  <b>yec</b> file data error correcting codes
  <br/>
  <b>yaf</b> Apple Archive fields (in metadata entry)
  <br/>
  <b>all</b> alias for all fields (exclude only)
  <br/>
  <b>attr</b> alias for <i>uid,gid,mod,flg,mtm,btm,ctm</i></p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">Archive the contents of directory <i>foo</i> into archive
    <i>foo.aar</i>, using LZMA compression with 8 MB blocks</p>
<p class="Pp"><cite class="Rs">&#x00A0;aa archive -d foo -o foo.aar -a lzma -b
    8m</cite></p>
<p class="Pp">Extract the contents of <i>foo.aar</i> in directory <i>dst</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa extract -d dst -i foo.aar</cite></p>
<p class="Pp">Create a manifest of the contents of directory <i>foo</i> into
    <i>foo.manifest</i>, using LZFSE compression with 1 MB blocks</p>
<p class="Pp"><cite class="Rs">&#x00A0;aa manifest -d foo -o foo.manifest -a
    lzfse -b 1m</cite></p>
<p class="Pp">Verify the contents of <i>dst</i> match the manifest
    <i>foo.manifest</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa verify -i foo.manifest -d dst
    -v</cite></p>
<p class="Pp">Print all entry paths in <i>foo.manifest</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa list -i foo.manifest</cite></p>
<p class="Pp">Print all entry paths, uid, gid for regular files in
    <i>foo.manifest</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa list -v -i foo.manifest -include-type
    f -exclude-field all -include-field uid,gid,pat</cite></p>
<p class="Pp">Create a manifest of the contents of archive <i>foo.aar</i> in
    <i>foo.manifest</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa convert -manifest -v -i foo.aar -o
    foo.manifest</cite></p>
<p class="Pp">Extract a subset of entries matching prefix
    <i>Applications/Mail.app</i> from archive <i>foo.aar</i> in directory
    <i>dst</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa extract -i foo.aar -include-path
    Applications/Mail.app -d dst</cite></p>
<p class="Pp">Archive and encrypt directory <i>foo</i> to archive
    <i>foo.aea</i>, generating a random password and storing it in the
  Keychain</p>
<p class="Pp"><cite class="Rs">&#x00A0;aa archive -d foo -o foo.aea -keychain
    -password-gen</cite></p>
<p class="Pp">Decrypt and extract archive <i>foo.aea</i> to directory
    <i>dst</i>, obtaining the password from the Keychain (requires local
    authentication)</p>
<p class="Pp"><cite class="Rs">&#x00A0;aa extract -o foo.aea -d dst
    -keychain</cite></p>
<p class="Pp">Archive directory <i>foo</i> to archive <i>foo.aar</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa archive -p -d foo</cite></p>
<p class="Pp">Extract archive <i>foo.aar</i> to directory <i>foo</i></p>
<p class="Pp"><cite class="Rs">&#x00A0;aa extract -p -i foo.aar</cite></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">March 9, 2020</td>
    <td class="foot-os">macOS</td>
  </tr>
</table>
</body>
</html>
