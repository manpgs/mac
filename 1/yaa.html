<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>AA(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">AA(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">AA(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">aa - Manipulate Apple Archives</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>aa <b>command</b> [<b>options</b>]</b></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><b>aa creates and manipulates Apple Archives</b></p>
</section>
<section class="Sh">
<h1 class="Sh" id="COMMANDS"><a class="permalink" href="#COMMANDS">COMMANDS</a></h1>
<p class="Pp"><b>archive</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Archive
    the contents of the target directory</p>
<p class="Pp"><b>append</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Archive
    the contents of the target directory, append to an existing archive file</p>
<p class="Pp"><b>extract</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Extract
    the contents of an archive to the target directory</p>
<p class="Pp"><b>list</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;List
    the contents of an archive</p>
<p class="Pp"><b>convert</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Convert
    an archive into another archive</p>
<p class="Pp"><b>manifest</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Alias
    for 'archive -manifest'</p>
<p class="Pp"><b>verify</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Compare
    the contents of the target directory with a manifest</p>
<p class="Pp"><b>check-and-fix</b>&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Verify
    and fix the contents of the target directory using an error correcting
    manifest</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<dl class="Bl-tag">
  <dt id="v"><a class="permalink" href="#v"><b>-v</b></a></dt>
  <dd>Increase verbosity. Default is silent operation.</dd>
  <dt id="h"><a class="permalink" href="#h"><b>-h</b></a></dt>
  <dd>Print usage and exit.</dd>
  <dt id="d"><a class="permalink" href="#d"><b>-d&#x00A0;<i>dir</i></b></a></dt>
  <dd>Target directory for archive/extract. Default is the current
    directory.</dd>
  <dt id="i"><a class="permalink" href="#i"><b>-i&#x00A0;<i>input_file</i></b></a></dt>
  <dd>Input file. Default is <i>stdin</i>.</dd>
  <dt id="o"><a class="permalink" href="#o"><b>-o&#x00A0;<i>output_file</i></b></a></dt>
  <dd>Output file. Default is <i>stdout</i>.</dd>
  <dt id="subdir"><a class="permalink" href="#subdir"><b>-subdir&#x00A0;<i>subdir</i></b></a></dt>
  <dd>Path to archive under <i>dir</i>. <i>subdir</i> will be included in the
      archived paths, and extracted. Default is empty.</dd>
  <dt id="D"><a class="permalink" href="#D"><b>-D&#x00A0;<i>dir_and_subdir</i></b></a></dt>
  <dd>Set both <i>dir</i> to `dirname <i>dir_and_subdir</i>` and <i>subdir</i>
      to `basename <i>dir_and_subdir</i>`.</dd>
  <dt id="x"><a class="permalink" href="#x"><b>-x</b></a></dt>
  <dd>Do not cross volume boundaries when archiving.</dd>
  <dt id="p"><a class="permalink" href="#p"><b>-p</b></a></dt>
  <dd>Generate destination path automatically based on source path. For example
      'aa archive -d foo -p' becomes 'aa archive -d foo -o foo.aar'.</dd>
  <dt id="a"><a class="permalink" href="#a"><b>-a&#x00A0;<i>algorithm</i></b></a></dt>
  <dd>Compression algorithm used when creating archives. One of <i>lzfse</i>,
      <i>lzma</i>, <i>lz4</i>, <i>zlib</i>, <i>raw</i>. Default is
    <i>lzfse</i>.</dd>
  <dt id="b"><a class="permalink" href="#b"><b>-b&#x00A0;<i>block_size</i></b></a></dt>
  <dd>Block size used when compressing archives, a number with optional
      <i>b</i>, <i>k</i>, <i>m</i>, <i>g</i> suffix (bytes are assumed if no
      suffix is specified). Default is <i>4m</i> for <i>archive</i> and
      <i>1m</i> for the other commands.</dd>
  <dt id="t"><a class="permalink" href="#t"><b>-t&#x00A0;<i>worker_threads</i></b></a></dt>
  <dd>Number of worker threads compressing/decompressing data. Default is the
      number of physical CPU on the running machine.</dd>
  <dt id="wt"><a class="permalink" href="#wt"><b>-wt&#x00A0;<i>writer_threads</i></b></a></dt>
  <dd>Number of writer threads extracting archive content. Default is to match
      <i>worker_threads</i>.</dd>
  <dt id="enable-dedup"><a class="permalink" href="#enable-dedup"><b>-enable-dedup&#x00A0;(-no-enable-dedup)</b></a></dt>
  <dd>If set, and SLC fields are present in the archive, files with same data
      will be extracted as clones</dd>
  <dt id="enable-holes"><a class="permalink" href="#enable-holes"><b>-enable-holes&#x00A0;(-no-enable-holes)</b></a></dt>
  <dd>If set, and the filesystem supports it, detect and create holes in files
      to store 0-filled segments</dd>
  <dt id="ignore-eperm"><a class="permalink" href="#ignore-eperm"><b>-ignore-eperm&#x00A0;(-no-ignore-eperm)</b></a></dt>
  <dd>If set, ignore EPERM (operation not permitted) errors when setting files
      attributes</dd>
  <dt id="manifest"><a class="permalink" href="#manifest"><b>-manifest</b></a></dt>
  <dd>Alias for the following options:
    <br/>
    <b>-exclude-field</b> <i>dat</i>
    <br/>
    <b>-include-field</b> <i>sh2,siz,idx,idz</i>
    <br/>
    <b>-a</b> <i>lzfse</i> <b>-b</b> <i>1m</i></dd>
  <dt id="imanifest"><a class="permalink" href="#imanifest"><b>-imanifest&#x00A0;<i>input_manifest_file</i></b></a></dt>
  <dd>Manifest matching the input archive. Can be used in conjonction with the
      entry selection options to accelerate processing</dd>
  <dt id="omanifest"><a class="permalink" href="#omanifest"><b>-omanifest&#x00A0;<i>output_manifest_file</i></b></a></dt>
  <dd>Receives a manifest of the output archive</dd>
  <dt id="list"><a class="permalink" href="#list"><b>-list-format&#x00A0;<i>format</i></b></a></dt>
  <dd>Output format for the <b>list</b> command, one of <i>text</i>,
      <i>json</i>. Default is <i>text</i>
    <p class="Pp"></p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_SELECTION_OPTIONS"><a class="permalink" href="#ENTRY_SELECTION_OPTIONS">ENTRY
  SELECTION OPTIONS</a></h1>
<p class="Pp"><b>-include-path</b> and <b>-include-path-list</b> options are
    applied first to select an initial set of entries, then
    <b>-exclude-path</b>, <b>-exclude-path-list</b>, <b>-exclude-name</b>,
    <b>-exclude-regex</b> are applied to remove entries from this set. If no
    <b>-include-path</b> or <b>-include-path-list</b> option is given, all
    entries are included in the initial set. If a directory is
    included/excluded, the entire sub-tree is included/excluded.</p>
<dl class="Bl-tag">
  <dt id="include-path"><a class="permalink" href="#include-path"><b>-include-path&#x00A0;<i>path</i></b></a></dt>
  <dd>Include entry paths having <i>path</i> as a prefix. This option can be
      given multiple times.</dd>
  <dt id="exclude-path"><a class="permalink" href="#exclude-path"><b>-exclude-path&#x00A0;<i>path</i></b></a></dt>
  <dd>Exclude entry paths having <i>path</i> as a prefix. This option can be
      given multiple times.</dd>
  <dt id="include-path-list"><a class="permalink" href="#include-path-list"><b>-include-path-list&#x00A0;<i>path_list_file</i></b></a></dt>
  <dd>File containing a list of paths to include, one entry per line. This
      option can be given multiple times.</dd>
  <dt id="exclude-path-list"><a class="permalink" href="#exclude-path-list"><b>-exclude-path-list&#x00A0;<i>path_list_file</i></b></a></dt>
  <dd>File containing a list of paths to exclude, one entry per line. This
      option can be given multiple times.</dd>
  <dt id="include"><a class="permalink" href="#include"><b>-include-regex&#x00A0;<i>expr</i></b></a></dt>
  <dd>Include entry paths matching regular expression <i>expr</i>, see
      <i>re_format(7)</i>. This option can be given multiple times.</dd>
  <dt id="exclude"><a class="permalink" href="#exclude"><b>-exclude-regex&#x00A0;<i>expr</i></b></a></dt>
  <dd>Exclude entry paths matching regular expression <i>expr</i>, see
      <i>re_format(7)</i>. This option can be given multiple times.</dd>
  <dt id="exclude~2"><a class="permalink" href="#exclude~2"><b>-exclude-name&#x00A0;<i>name</i></b></a></dt>
  <dd>Exclude entry paths where a single component of the path matches exactly
      <i>name</i>. This option can be given multiple times.</dd>
  <dt id="include~2"><a class="permalink" href="#include~2"><b>-include-type&#x00A0;<i>&lt;type_spec&gt;</i></b></a></dt>
  <dd>Include only entries matching the given types. <i>&lt;type_spec&gt;</i> is
      a word containing one or more of the entry type characters listed
    below.</dd>
  <dt id="exclude~3"><a class="permalink" href="#exclude~3"><b>-exclude-type&#x00A0;<i>&lt;type_spec&gt;</i></b></a></dt>
  <dd>Include only entries not matching the given types.
      <i>&lt;type_spec&gt;</i> is a word containing one or more of the entry
      type characters listed below.</dd>
  <dt id="include~3"><a class="permalink" href="#include~3"><b>-include-field&#x00A0;<i>&lt;field_spec&gt;</i></b></a></dt>
  <dd>Add the given fields to the set of field keys. This option can be given
      multiple times. <i>&lt;field_spec&gt;</i> is a comma separated list of
      entry field keys listed below.</dd>
  <dt id="exclude~4"><a class="permalink" href="#exclude~4"><b>-exclude-field&#x00A0;<i>&lt;field_spec&gt;</i></b></a></dt>
  <dd>Remove the given fields from the set of field keys. This option can be
      given multiple times. <i>&lt;field_spec&gt;</i> is a comma separated list
      of entry field keys listed below.
    <p class="Pp"></p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENCRYPTION_OPTIONS"><a class="permalink" href="#ENCRYPTION_OPTIONS">ENCRYPTION
  OPTIONS</a></h1>
<p class="Pp">When archiving, encryption is selected by one of the
    <i>-password...</i>, <i>-key...</i>, or <i>-recipient-pub</i> options. The
    archive will be signed if a private key is specified with <i>-sign-priv</i>.
    With the currently available profiles, public/private keys are on the
    Elliptic Curve P-256, and symmetric keys are 256-bit long.</p>
<dl class="Bl-tag">
  <dt id="keychain"><a class="permalink" href="#keychain"><b>-keychain</b></a></dt>
  <dd>Use Keychain to load/store symmetric keys and passwords</dd>
  <dt id="password"><a class="permalink" href="#password"><b>-password&#x00A0;<i>file</i></b></a></dt>
  <dd>File containing encryption password. When encrypting, and if
      <i>-password-gen</i> is passed, receives the generated password. Can be
      <i>-</i> to print the password to standard output.</dd>
  <dt id="password~2"><a class="permalink" href="#password~2"><b>-password-value&#x00A0;<i>password</i></b></a></dt>
  <dd>Password.</dd>
  <dt id="password~3"><a class="permalink" href="#password~3"><b>-password-gen</b></a></dt>
  <dd>When encrypting, generate a new random password. It is recommended to
      always use this option, in conjonction with <i>-keychain</i> to store the
      password in the Keychain, or <i>-password</i> to store the password in a
      file or print it.</dd>
  <dt id="key"><a class="permalink" href="#key"><b>-key&#x00A0;<i>file</i></b></a></dt>
  <dd>File containing encryption symmetric key. When encrypting, and if
      <i>-key-gen</i> is passed, receives the generated key.</dd>
  <dt id="key~2"><a class="permalink" href="#key~2"><b>-key-value&#x00A0;<i>key</i></b></a></dt>
  <dd>Symmetric key, either &quot;hex:&lt;64 hex digits&gt;&quot; or
      &quot;base64:&lt;32 bytes encoded using base64&gt;&quot;.</dd>
  <dt id="key~3"><a class="permalink" href="#key~3"><b>-key-gen</b></a></dt>
  <dd>When encrypting, generate a new random symmetric key.</dd>
  <dt id="recipient"><a class="permalink" href="#recipient"><b>-recipient-pub&#x00A0;<i>file</i></b></a></dt>
  <dd>Recipient public key for encryption. The corresponding private key is
      required to decrypt the archive.</dd>
  <dt id="recipient~2"><a class="permalink" href="#recipient~2"><b>-recipient-priv&#x00A0;<i>file</i></b></a></dt>
  <dd>Recipient private key for decryption. The archive must have been encrypted
      against the corresponding public key.</dd>
  <dt id="sign"><a class="permalink" href="#sign"><b>-sign-pub&#x00A0;<i>file</i></b></a></dt>
  <dd>Signing public key for decryption. The archive must have been signed with
      the corresponding private key.</dd>
  <dt id="sign~2"><a class="permalink" href="#sign~2"><b>-sign-priv&#x00A0;<i>file</i></b></a></dt>
  <dd>Signing private key for encryption. The corresponding public key is
      required to decrypt and authenticate the archive.
    <p class="Pp"></p>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_TYPES"><a class="permalink" href="#ENTRY_TYPES">ENTRY
  TYPES</a></h1>
<p class="Pp"><b>b</b> block special
  <br/>
  <b>c</b> character special
  <br/>
  <b>d</b> directory
  <br/>
  <b>f</b> regular file
  <br/>
  <b>l</b> symbolic link
  <br/>
  <b>m</b> metadata
  <br/>
  <b>p</b> fifo
  <br/>
  <b>s</b> socket</p>
<p class="Pp"></p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENTRY_FIELDS"><a class="permalink" href="#ENTRY_FIELDS">ENTRY
  FIELDS</a></h1>
<p class="Pp"><b>typ</b> entry type
  <br/>
  <b>pat</b> path
  <br/>
  <b>lnk</b> link path
  <br/>
  <b>dev</b> device id
  <br/>
  <b>uid</b> user id
  <br/>
  <b>gid</b> group id
  <br/>
  <b>mod</b> access permissions
  <br/>
  <b>flg</b> flags
  <br/>
  <b>mtm</b> modification time
  <br/>
  <b>ctm</b> creation time
  <br/>
  <b>btm</b> backup time
  <br/>
  <b>xat</b> extended attributes
  <br/>
  <b>acl</b> access control list
  <br/>
  <b>cks</b> CRC32 checksum
  <br/>
  <b>sh1</b> SHA1 digest
  <br/>
  <b>sh2</b> SHA2-256 digest
  <br/>
  <b>dat</b> file contents
  <br/>
  <b>siz</b> file size
  <br/>
  <b>duz</b> disk usage
  <br/>
  <b>idx</b> entry index in main archive
  <br/>
  <b>yec</b> file data error correcting codes
  <br/>
  <b>yaf</b> Apple Archive fields (in metadata entry)
  <br/>
  <b>all</b> alias for all fields (exclude only)
  <br/>
  <b>attr</b> alias for <i>uid,gid,mod,flg,mtm,btm,ctm</i></p>
<p class="Pp"></p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">Archive the contents of directory <i>foo</i> into archive
    <i>foo.aar</i>, using LZMA compression with 8 MB blocks</p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa archive -d foo -o foo.aar -a lzma -b 8m</b></div>
<p class="Pp">Extract the contents of <i>foo.aar</i> in directory <i>dst</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa extract -d dst -i foo.aar</b></div>
<p class="Pp">Create a manifest of the contents of directory <i>foo</i> into
    <i>foo.manifest</i>, using LZFSE compression with 1 MB blocks</p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa manifest -d foo -o foo.manifest -a lzfse -b
  1m</b></div>
<p class="Pp">Verify the contents of <i>dst</i> match the manifest
    <i>foo.manifest</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa verify -i foo.manifest -d dst -v</b></div>
<p class="Pp">Print all entry paths in <i>foo.manifest</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa list -i foo.manifest</b></div>
<p class="Pp">Print all entry paths, uid, gid for regular files in
    <i>foo.manifest</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa list -v -i foo.manifest -include-type f
  -exclude-field all -include-field uid,gid,pat</b></div>
<p class="Pp">Create a manifest of the contents of archive <i>foo.aar</i> in
    <i>foo.manifest</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa convert -manifest -v -i foo.aar -o
  foo.manifest</b></div>
<p class="Pp">Extract a subset of entries matching prefix
    <i>Applications/Mail.app</i> from archive <i>foo.aar</i> in directory
    <i>dst</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa extract -i foo.aar -include-path
  Applications/Mail.app -d dst</b></div>
<p class="Pp">Archive and encrypt directory <i>foo</i> to archive
    <i>foo.aea</i>, generating a random password and storing it in the
  Keychain</p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa archive -d foo -o foo.aea -keychain
  -password-gen</b></div>
<p class="Pp">Decrypt and extract archive <i>foo.aea</i> to directory
    <i>dst</i>, obtaining the password from the Keychain (requires local
    authentication)</p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa extract -o foo.aea -d dst -keychain</b></div>
<p class="Pp">Archive directory <i>foo</i> to archive <i>foo.aar</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa archive -p -d foo</b></div>
<p class="Pp">Extract archive <i>foo.aar</i> to directory <i>foo</i></p>
<p class="Pp"></p>
<div class="Bd-indent"><b>aa extract -p -i foo.aar</b></div>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date"></td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
