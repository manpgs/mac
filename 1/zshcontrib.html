<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>ZSHCONTRIB(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ZSHCONTRIB(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">ZSHCONTRIB(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">zshcontrib - user contributions to zsh</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The Zsh source distribution includes a number of items contributed
    by the user community. These are not inherently a part of the shell, and
    some may not be available in every zsh installation. The most significant of
    these are documented here. For documentation on other contributed items such
    as shell functions, look for comments in the function source files.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="UTILITIES"><a class="permalink" href="#UTILITIES">UTILITIES</a></h1>
<section class="Ss">
<h2 class="Ss" id="Accessing_On"><a class="permalink" href="#Accessing_On">Accessing
  On-Line Help</a></h2>
<p class="Pp">The key sequence <b>ESC h</b> is normally bound by ZLE to execute
    the <b>run-help</b> widget (see <i>zshzle</i>(1)). This invokes the
    <b>run-help</b> command with the command word from the current input line as
    its argument. By default, <b>run-help</b> is an alias for the <b>man</b>
    command, so this often fails when the command word is a shell builtin or a
    user-defined function. By redefining the <b>run-help</b> alias, one can
    improve the on-line help provided by the shell.</p>
<p class="Pp">The <b>helpfiles</b> utility, found in the <b>Util</b> directory
    of the distribution, is a Perl program that can be used to process the zsh
    manual to produce a separate help file for each shell builtin and for many
    other shell features as well. The autoloadable <b>run-help</b> function,
    found in <b>Functions/Misc</b>, searches for these helpfiles and performs
    several other tests to produce the most complete help possible for the
    command.</p>
<p class="Pp">Help files are installed by default to a subdirectory of
    <b>/usr/share/zsh</b> or <b>/usr/local/share/zsh</b>.</p>
<p class="Pp">To create your own help files with <b>helpfiles</b>, choose or
    create a directory where the individual command help files will reside. For
    example, you might choose <b>~/zsh_help</b>. If you unpacked the zsh
    distribution in your home directory, you would use the commands:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>mkdir ~/zsh_help</b>
<b>perl ~/zsh-5.8.1/Util/helpfiles ~/zsh_help</b></pre>
</div>
<p class="Pp">The <b>HELPDIR</b> parameter tells <b>run-help</b> where to look
    for the help files. When unset, it uses the default installation path. To
    use your own set of help files, set this to the appropriate path in one of
    your startup files:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>HELPDIR=~/zsh_help</b></pre>
</div>
<p class="Pp">To use the <b>run-help</b> function, you need to add lines
    something like the following to your <b>.zshrc</b> or equivalent startup
    file:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>unalias run-help</b>
<b>autoload run-help</b></pre>
</div>
<p class="Pp">Note that in order for `<b>autoload run-help</b>' to work, the
    <b>run-help</b> file must be in one of the directories named in your
    <b>fpath</b> array (see <i>zshparam</i>(1)). This should already be the case
    if you have a standard zsh installation; if it is not, copy
    <b>Functions/Misc/run-help</b> to an appropriate directory.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Recompiling_Functions"><a class="permalink" href="#Recompiling_Functions">Recompiling
  Functions</a></h2>
<p class="Pp">If you frequently edit your zsh functions, or periodically update
    your zsh installation to track the latest developments, you may find that
    function digests compiled with the <b>zcompile</b> builtin are frequently
    out of date with respect to the function source files. This is not usually a
    problem, because zsh always looks for the newest file when loading a
    function, but it may cause slower shell startup and function loading. Also,
    if a digest file is explicitly used as an element of <b>fpath</b>, zsh won't
    check whether any of its source files has changed.</p>
<p class="Pp">The <b>zrecompile</b> autoloadable function, found in
    <b>Functions/Misc</b>, can be used to keep function digests up to date.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>zrecompile</b> [ <b>-qt</b> ] [ <i>name</i> ... ]</dt>
  <dd></dd>
  <dt><b>zrecompile</b> [ <b>-qt</b> ] <b>-p</b> <i>arg</i> ... [
    <b>-</b><b>-</b> <i>arg</i> ... ]</dt>
  <dd>This tries to find <b>*.zwc</b> files and automatically re-compile them if
      at least one of the original files is newer than the compiled file. This
      works only if the names stored in the compiled files are full paths or are
      relative to the directory that contains the <b>.zwc</b> file.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">In the first form, each <i>name</i> is the name of a compiled file
    or a directory containing <b>*.zwc</b> files that should be checked. If no
    arguments are given, the directories and <b>*.zwc</b> files in <b>fpath</b>
    are used.</p>
<p class="Pp">When <b>-t</b> is given, no compilation is performed, but a return
    status of zero (true) is set if there are files that need to be re-compiled
    and non-zero (false) otherwise. The <b>-q</b> option quiets the chatty
    output that describes what <b>zrecompile</b> is doing.</p>
<p class="Pp">Without the <b>-t</b> option, the return status is zero if all
    files that needed re-compilation could be compiled and non-zero if
    compilation for at least one of the files failed.</p>
<p class="Pp">If the <b>-p</b> option is given, the <i>arg</i>s are interpreted
    as one or more sets of arguments for <b>zcompile</b>, separated by
    `<b>-</b><b>-</b>'. For example:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zrecompile -p \ </b>
<b>           -R ~/.zshrc -- \ </b>
<b>           -M ~/.zcompdump -- \ </b>
<b>           ~/zsh/comp.zwc ~/zsh/Completion/*/_*</b></pre>
</div>
<p class="Pp">This compiles <b>~/.zshrc</b> into <b>~/.zshrc.zwc</b> if that
    doesn't exist or if it is older than <b>~/.zshrc</b>. The compiled file will
    be marked for reading instead of mapping. The same is done for
    <b>~/.zcompdump</b> and <b>~/.zcompdump.zwc</b>, but this compiled file is
    marked for mapping. The last line re-creates the file <b>~/zsh/comp.zwc</b>
    if any of the files matching the given pattern is newer than it.</p>
<p class="Pp">Without the <b>-p</b> option, <b>zrecompile</b> does not create
    function digests that do not already exist, nor does it add new functions to
    the digest.</p>
</div>
<p class="Pp">The following shell loop is an example of a method for creating
    function digests for all functions in your <b>fpath</b>, assuming that you
    have write permission to the directories:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>for ((i=1; i &lt;= $#fpath; ++i)); do</b>
<b>  dir=$fpath[i]</b>
<b>  zwc=${dir:t}.zwc</b>
<b>  if [[ $dir == (.|..) || $dir == (.|..)/* ]]; then</b>
<b>    continue</b>
<b>  fi</b>
<b>  files=($dir/*(N-.))</b>
<b>  if [[ -w $dir:h &amp;&amp; -n $files ]]; then</b>
<b>    files=(${${(M)files%/*/*}#/})</b>
<b>    if ( cd $dir:h &amp;&amp;</b>
<b>         zrecompile -p -U -z $zwc $files ); then</b>
<b>      fpath[i]=$fpath[i].zwc</b>
<b>    fi</b>
<b>  fi</b>
<b>done</b></pre>
</div>
<p class="Pp">The <b>-U</b> and <b>-z</b> options are appropriate for functions
    in the default zsh installation <b>fpath</b>; you may need to use different
    options for your personal function directories.</p>
<p class="Pp">Once the digests have been created and your <b>fpath</b> modified
    to refer to them, you can keep them up to date by running <b>zrecompile</b>
    with no arguments.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Keyboard_Definition"><a class="permalink" href="#Keyboard_Definition">Keyboard
  Definition</a></h2>
<p class="Pp">The large number of possible combinations of keyboards,
    workstations, terminals, emulators, and window systems makes it impossible
    for zsh to have built-in key bindings for every situation. The <b>zkbd</b>
    utility, found in <b>Functions/Misc</b>, can help you quickly create key
    bindings for your configuration.</p>
<p class="Pp">Run <b>zkbd</b> either as an autoloaded function, or as a shell
    script:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zsh -f ~/zsh-5.8.1/Functions/Misc/zkbd</b></pre>
</div>
<p class="Pp">When you run <b>zkbd</b>, it first asks you to enter your terminal
    type; if the default it offers is correct, just press return. It then asks
    you to press a number of different keys to determine characteristics of your
    keyboard and terminal; <b>zkbd</b> warns you if it finds anything out of the
    ordinary, such as a Delete key that sends neither <b>^H</b> nor
  <b>^?</b>.</p>
<p class="Pp">The keystrokes read by <b>zkbd</b> are recorded as a definition
    for an associative array named <b>key</b>, written to a file in the
    subdirectory <b>.zkbd</b> within either your <b>HOME</b> or <b>ZDOTDIR</b>
    directory. The name of the file is composed from the <b>TERM</b>,
    <b>VENDOR</b> and <b>OSTYPE</b> parameters, joined by hyphens.</p>
<p class="Pp">You may read this file into your <b>.zshrc</b> or another startup
    file with the `<b>source</b>' or `<b>.</b>' commands, then reference the
    <b>key</b> parameter in bindkey commands, like this:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>source ${ZDOTDIR:-$HOME}/.zkbd/$TERM-$VENDOR-$OSTYPE</b>
<b>[[ -n ${key[Left]} ]] &amp;&amp; bindkey &quot;${key[Left]}&quot; backward-char</b>
<b>[[ -n ${key[Right]} ]] &amp;&amp; bindkey &quot;${key[Right]}&quot; forward-char</b>
<b># etc.</b></pre>
</div>
<p class="Pp">Note that in order for `<b>autoload zkbd</b>' to work, the
    <b>zkdb</b> file must be in one of the directories named in your
    <b>fpath</b> array (see <i>zshparam</i>(1)). This should already be the case
    if you have a standard zsh installation; if it is not, copy
    <b>Functions/Misc/zkbd</b> to an appropriate directory.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Dumping_Shell_State"><a class="permalink" href="#Dumping_Shell_State">Dumping
  Shell State</a></h2>
<p class="Pp">Occasionally you may encounter what appears to be a bug in the
    shell, particularly if you are using a beta version of zsh or a development
    release. Usually it is sufficient to send a description of the problem to
    one of the zsh mailing lists (see <i>zsh</i>(1)), but sometimes one of the
    zsh developers will need to recreate your environment in order to track the
    problem down.</p>
<p class="Pp">The script named <b>reporter</b>, found in the <b>Util</b>
    directory of the distribution, is provided for this purpose. (It is also
    possible to <b>autoload reporter</b>, but <b>reporter</b> is not installed
    in <b>fpath</b> by default.) This script outputs a detailed dump of the
    shell state, in the form of another script that can be read with `<b>zsh
    -f</b>' to recreate that state.</p>
<p class="Pp">To use <b>reporter</b>, read the script into your shell with the
    `<b>.</b>' command and redirect the output into a file:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>. ~/zsh-5.8.1/Util/reporter &gt; zsh.report</b></pre>
</div>
<p class="Pp">You should check the <b>zsh.report</b> file for any sensitive
    information such as passwords and delete them by hand before sending the
    script to the developers. Also, as the output can be voluminous, it's best
    to wait for the developers to ask for this information before sending
  it.</p>
<p class="Pp">You can also use <b>reporter</b> to dump only a subset of the
    shell state. This is sometimes useful for creating startup files for the
    first time. Most of the output from reporter is far more detailed than
    usually is necessary for a startup file, but the <b>aliases</b>,
    <b>options</b>, and <b>zstyles</b> states may be useful because they include
    only changes from the defaults. The <b>bindings</b> state may be useful if
    you have created any of your own keymaps, because <b>reporter</b> arranges
    to dump the keymap creation commands as well as the bindings for every
    keymap.</p>
<p class="Pp">As is usual with automated tools, if you create a startup file
    with <b>reporter</b>, you should edit the results to remove unnecessary
    commands. Note that if you're using the new completion system, you should
    <i>not</i> dump the <b>functions</b> state to your startup files with
    <b>reporter</b>; use the <b>compdump</b> function instead (see
    <i>zshcompsys</i>(1)).</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>reporter</b> [ <i>state</i> ... ]</dt>
  <dd>Print to standard output the indicated subset of the current shell state.
      The <i>state</i> arguments may be one or more of:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="all"><a class="permalink" href="#all"><b>all</b></a></dt>
  <dd>Output everything listed below.</dd>
  <dt id="aliases"><a class="permalink" href="#aliases"><b>aliases</b></a></dt>
  <dd>Output alias definitions.</dd>
  <dt id="bindings"><a class="permalink" href="#bindings"><b>bindings</b></a></dt>
  <dd>Output ZLE key maps and bindings.</dd>
  <dt id="completion"><a class="permalink" href="#completion"><b>completion</b></a></dt>
  <dd>Output old-style <b>compctl</b> commands. New completion is covered by
      <b>functions</b> and <b>zstyles</b>.</dd>
  <dt id="functions"><a class="permalink" href="#functions"><b>functions</b></a></dt>
  <dd>Output autoloads and function definitions.</dd>
  <dt id="limits"><a class="permalink" href="#limits"><b>limits</b></a></dt>
  <dd>Output <b>limit</b> commands.</dd>
  <dt id="options"><a class="permalink" href="#options"><b>options</b></a></dt>
  <dd>Output <b>setopt</b> commands.</dd>
  <dt id="styles"><a class="permalink" href="#styles"><b>styles</b></a></dt>
  <dd>Same as <b>zstyles</b>.</dd>
  <dt id="variables"><a class="permalink" href="#variables"><b>variables</b></a></dt>
  <dd>Output shell parameter assignments, plus <b>export</b> commands for any
      environment variables.</dd>
  <dt id="zstyles"><a class="permalink" href="#zstyles"><b>zstyles</b></a></dt>
  <dd>Output <b>zstyle</b> commands.</dd>
</dl>
<p class="Pp">If the <i>state</i> is omitted, <b>all</b> is assumed.</p>
</div>
<p class="Pp">With the exception of `<b>all</b>', every <i>state</i> can be
    abbreviated by any prefix, even a single letter; thus <b>a</b> is the same
    as <b>aliases</b>, <b>z</b> is the same as <b>zstyles</b>, etc.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Manipulating_Hook_Functions"><a class="permalink" href="#Manipulating_Hook_Functions">Manipulating
  Hook Functions</a></h2>
<dl class="Bl-tag">
  <dt><b>add-zsh-hook</b> [ <b>-L</b> | <b>-dD</b> ] [ <b>-Uzk</b> ] <i>hook</i>
    <i>function</i></dt>
  <dd>Several functions are special to the shell, as described in the section
      SPECIAL FUNCTIONS, see <i>zshmisc</i>(1), in that they are automatically
      called at specific points during shell execution. Each has an associated
      array consisting of names of functions to be called at the same point;
      these are so-called `hook functions'. The shell function
      <b>add-zsh-hook</b> provides a simple way of adding or removing functions
      from the array.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"><i>hook</i> is one of <b>chpwd</b>, <b>periodic</b>,
    <b>precmd</b>, <b>preexec</b>, <b>zshaddhistory</b>, <b>zshexit</b>, or
    <b>zsh_directory_name</b>, the special functions in question. Note that
    <b>zsh_directory_name</b> is called in a different way from the other
    functions, but may still be manipulated as a hook.</p>
<p class="Pp"><i>function</i> is name of an ordinary shell function. If no
    options are given this will be added to the array of functions to be
    executed in the given context. Functions are invoked in the order they were
    added.</p>
<p class="Pp">If the option <b>-L</b> is given, the current values for the hook
    arrays are listed with <b>typeset</b>.</p>
<p class="Pp">If the option <b>-d</b> is given, the <i>function</i> is removed
    from the array of functions to be executed.</p>
<p class="Pp">If the option <b>-D</b> is given, the <i>function</i> is treated
    as a pattern and any matching names of functions are removed from the array
    of functions to be executed.</p>
<p class="Pp">The options <b>-U</b>, <b>-z</b> and <b>-k</b> are passed as
    arguments to <b>autoload</b> for <i>function</i>. For functions contributed
    with zsh, the options <b>-Uz</b> are appropriate.</p>
</div>
<dl class="Bl-tag">
  <dt id="add"><a class="permalink" href="#add"><b>add-zle-hook-widget</b> [
    <b>-L</b> | <b>-dD</b> ] [ <b>-Uzk</b> ] <i>hook</i>
    <i>widgetname</i></a></dt>
  <dd>Several widget names are special to the line editor, as described in the
      section Special Widgets, see <i>zshzle</i>(1), in that they are
      automatically called at specific points during editing. Unlike function
      hooks, these do not use a predefined array of other names to call at the
      same point; the shell function <b>add-zle-hook-widget</b> maintains a
      similar array and arranges for the special widget to invoke those
      additional widgets.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"><i>hook</i> is one of <b>isearch-exit</b>, <b>isearch-update</b>,
    <b>line-pre-redraw</b>, <b>line-init</b>, <b>line-finish</b>,
    <b>history-line-set</b>, or <b>keymap-select</b>, corresponding to each of
    the special widgets <b>zle-isearch-exit</b>, etc. The special widget names
    are also accepted as the <i>hook</i> argument.</p>
<p class="Pp"><i>widgetname</i> is the name of a ZLE widget. If no options are
    given this is added to the array of widgets to be invoked in the given hook
    context. Widgets are invoked in the order they were added, with</p>
<div class="Bd-indent">
<pre><b></b><b>zle </b><b></b><i>widgetname</i><b></b><b> -Nw -- &quot;$@&quot;</b><b></b><b></b></pre>
</div>
<p class="Pp">Note that this means that the `<b>WIDGET</b>' special parameter
    tracks the <i>widgetname</i> when the widget function is called, rather than
    tracking the name of the corresponding special hook widget.</p>
<p class="Pp">If the option <b>-d</b> is given, the <i>widgetname</i> is removed
    from the array of widgets to be executed.</p>
<p class="Pp">If the option <b>-D</b> is given, the <i>widgetname</i> is treated
    as a pattern and any matching names of widgets are removed from the
  array.</p>
<p class="Pp">If <i>widgetname</i> does not name an existing widget when added
    to the array, it is assumed that a shell function also named
    <i>widgetname</i> is meant to provide the implementation of the widget. This
    name is therefore marked for autoloading, and the options <b>-U</b>,
    <b>-z</b> and <b>-k</b> are passed as arguments to <b>autoload</b> as with
    <b>add-zsh-hook</b>. The widget is also created with `<b>zle -N
    </b><i>widgetname</i>' to cause the corresponding function to be loaded the
    first time the hook is called.</p>
<p class="Pp">The arrays of <i>widgetname</i> are currently maintained in
    <b>zstyle</b> contexts, one for each <i>hook</i> context, with a style of
    `<b>widgets</b>'. If the <b>-L</b> option is given, this set of styles is
    listed with `<b>zstyle -L</b>'. This implementation may change, and the
    special widgets that refer to the styles are created only if
    <b>add-zle-hook-widget</b> is called to add at least one widget, so if this
    function is used for any hooks, then all hooks should be managed only via
    this function.</p>
</div>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="REMEMBERING_RECENT_DIRECTORIES"><a class="permalink" href="#REMEMBERING_RECENT_DIRECTORIES">REMEMBERING
  RECENT DIRECTORIES</a></h1>
<p class="Pp">The function <b>cdr</b> allows you to change the working directory
    to a previous working directory from a list maintained automatically. It is
    similar in concept to the directory stack controlled by the <b>pushd</b>,
    <b>popd</b> and <b>dirs</b> builtins, but is more configurable, and as it
    stores all entries in files it is maintained across sessions and (by
    default) between terminal emulators in the current session. Duplicates are
    automatically removed, so that the list reflects the single most recent use
    of each directory.</p>
<p class="Pp">Note that the <b>pushd</b> directory stack is not actually
    modified or used by <b>cdr</b> unless you configure it to do so as described
    in the configuration section below.</p>
<section class="Ss">
<h2 class="Ss" id="Installation"><a class="permalink" href="#Installation">Installation</a></h2>
<p class="Pp">The system works by means of a hook function that is called every
    time the directory changes. To install the system, autoload the required
    functions and use the <b>add-zsh-hook</b> function described above:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -Uz chpwd_recent_dirs cdr add-zsh-hook</b>
<b>add-zsh-hook chpwd chpwd_recent_dirs</b></pre>
</div>
<p class="Pp">Now every time you change directly interactively, no matter which
    command you use, the directory to which you change will be remembered in
    most-recent-first order.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Use"><a class="permalink" href="#Use">Use</a></h2>
<p class="Pp">All direct user interaction is via the <b>cdr</b> function.</p>
<p class="Pp">The argument to cdr is a number <i>N</i> corresponding to the
    <i>N</i>th most recently changed-to directory. 1 is the immediately
    preceding directory; the current directory is remembered but is not offered
    as a destination. Note that if you have multiple windows open 1 may refer to
    a directory changed to in another window; you can avoid this by having
    per-terminal files for storing directory as described for the
    <b>recent-dirs-file</b> style below.</p>
<p class="Pp">If you set the <b>recent-dirs-default</b> style described below
    <b>cdr</b> will behave the same as <b>cd</b> if given a non-numeric
    argument, or more than one argument. The recent directory list is updated
    just the same however you change directory.</p>
<p class="Pp">If the argument is omitted, 1 is assumed. This is similar to
    <b>pushd</b>'s behaviour of swapping the two most recent directories on the
    stack.</p>
<p class="Pp">Completion for the argument to <b>cdr</b> is available if compinit
    has been run; menu selection is recommended, using:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':completion:*:*:cdr:*:*' menu selection</b></pre>
</div>
<p class="Pp">to allow you to cycle through recent directories; the order is
    preserved, so the first choice is the most recent directory before the
    current one. The verbose style is also recommended to ensure the directory
    is shown; this style is on by default so no action is required unless you
    have changed it.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Options"><a class="permalink" href="#Options">Options</a></h2>
<p class="Pp">The behaviour of <b>cdr</b> may be modified by the following
    options.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>-l</b></dt>
  <dd>lists the numbers and the corresponding directories in abbreviated form
      (i.e. with <b>~</b> substitution reapplied), one per line. The directories
      here are not quoted (this would only be an issue if a directory name
      contained a newline). This is used by the completion system.</dd>
  <dt id="r"><a class="permalink" href="#r"><b>-r</b></a></dt>
  <dd>sets the variable <b>reply</b> to the current set of directories. Nothing
      is printed and the directory is not changed.</dd>
  <dt id="e"><a class="permalink" href="#e"><b>-e</b></a></dt>
  <dd>allows you to edit the list of directories, one per line. The list can be
      edited to any extent you like; no sanity checking is performed. Completion
      is available. No quoting is necessary (except for newlines, where I have
      in any case no sympathy); directories are in unabbreviated from and
      contain an absolute path, i.e. they start with <b>/</b>. Usually the first
      entry should be left as the current directory.</dd>
  <dt id="p"><a class="permalink" href="#p"><b>-p
    '</b><i>pattern</i><b>'</b></a></dt>
  <dd>Prunes any items in the directory list that match the given extended glob
      pattern; the pattern needs to be quoted from immediate expansion on the
      command line. The pattern is matched against each completely expanded file
      name in the list; the full string must match, so wildcards at the end
      (e.g. <b>'*removeme*'</b>) are needed to remove entries with a given
      substring.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If output is to a terminal, then the function will print the new
    list after pruning and prompt for confirmation by the user. This output and
    confirmation step can be skipped by using <b>-P</b> instead of
  <b>-p</b>.</p>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Configuration"><a class="permalink" href="#Configuration">Configuration</a></h2>
<p class="Pp">Configuration is by means of the styles mechanism that should be
    familiar from completion; if not, see the description of the <b>zstyle</b>
    command in see <i>zshmodules</i>(1). The context for setting styles should
    be <b>':chpwd:*'</b> in case the meaning of the context is extended in
    future, for example:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':chpwd:*' recent-dirs-max 0</b></pre>
</div>
<p class="Pp">sets the value of the <b>recent-dirs-max</b> style to 0. In
    practice the style name is specific enough that a context of '*' should be
    fine.</p>
<p class="Pp">An exception is <b>recent-dirs-insert</b>, which is used
    exclusively by the completion system and so has the usual completion system
    context (<b>':completion:*'</b> if nothing more specific is needed), though
    again <b>'*'</b> should be fine in practice.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>recent-dirs-default</b></dt>
  <dd>If true, and the command is expecting a recent directory index, and either
      there is more than one argument or the argument is not an integer, then
      fall through to &quot;cd&quot;. This allows the lazy to use only one
      command for directory changing. Completion recognises this, too; see
      recent-dirs-insert for how to control completion when this option is in
      use.</dd>
  <dt id="recent"><a class="permalink" href="#recent"><b>recent-dirs-file</b></a></dt>
  <dd>The file where the list of directories is saved. The default is
      <b>${ZDOTDIR:-$HOME}/.chpwd-recent-dirs</b>, i.e. this is in your home
      directory unless you have set the variable <b>ZDOTDIR</b> to point
      somewhere else. Directory names are saved in <b>$'</b><i>...</i><b>'</b>
      quoted form, so each line in the file can be supplied directly to the
      shell as an argument.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The value of this style may be an array. In this case, the first
    file in the list will always be used for saving directories while any other
    files are left untouched. When reading the recent directory list, if there
    are fewer than the maximum number of entries in the first file, the contents
    of later files in the array will be appended with duplicates removed from
    the list shown. The contents of the two files are not sorted together, i.e.
    all the entries in the first file are shown first. The special value
    <b>+</b> can appear in the list to indicate the default file should be read
    at that point. This allows effects like the following:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':chpwd:*' recent-dirs-file \ </b>
<b>~/.chpwd-recent-dirs-${TTY##*/} +</b></pre>
</div>
<p class="Pp">Recent directories are read from a file numbered according to the
    terminal. If there are insufficient entries the list is supplemented from
    the default file.</p>
<p class="Pp">It is possible to use <b>zstyle -e</b> to make the directory
    configurable at run time:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle -e ':chpwd:*' recent-dirs-file pick-recent-dirs-file</b>
<b>pick-recent-dirs-file() {</b>
<b>  if [[ $PWD = ~/text/writing(|/*) ]]; then</b>
<b>    reply=(~/.chpwd-recent-dirs-writing)</b>
<b>  else</b>
<b>    reply=(+)</b>
<b>  fi</b>
<b>}</b></pre>
</div>
<p class="Pp">In this example, if the current directory is <b>~/text/writing</b>
    or a directory under it, then use a special file for saving recent
    directories, else use the default.</p>
</div>
<dl class="Bl-tag">
  <dt id="recent~2"><a class="permalink" href="#recent~2"><b>recent-dirs-insert</b></a></dt>
  <dd>Used by completion. If <b>recent-dirs-default</b> is true, then setting
      this to <b>true</b> causes the actual directory, rather than its index, to
      be inserted on the command line; this has the same effect as using the
      corresponding index, but makes the history clearer and the line easier to
      edit. With this setting, if part of an argument was already typed, normal
      directory completion rather than recent directory completion is done; this
      is because recent directory completion is expected to be done by cycling
      through entries menu fashion.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If the value of the style is <b>always</b>, then only recent
    directories will be completed; in that case, use the <b>cd</b> command when
    you want to complete other directories.</p>
<p class="Pp">If the value is <b>fallback</b>, recent directories will be tried
    first, then normal directory completion is performed if recent directory
    completion failed to find a match.</p>
<p class="Pp">Finally, if the value is <b>both</b> then both sets of completions
    are presented; the usual tag mechanism can be used to distinguish results,
    with recent directories tagged as <b>recent-dirs</b>. Note that the recent
    directories inserted are abbreviated with directory names where
  appropriate.</p>
</div>
<dl class="Bl-tag">
  <dt id="recent~3"><a class="permalink" href="#recent~3"><b>recent-dirs-max</b></a></dt>
  <dd>The maximum number of directories to save to the file. If this is zero or
      negative there is no maximum. The default is 20. Note this includes the
      current directory, which isn't offered, so the highest number of
      directories you will be offered is one less than the maximum.</dd>
  <dt id="recent~4"><a class="permalink" href="#recent~4"><b>recent-dirs-prune</b></a></dt>
  <dd>This style is an array determining what directories should (or should not)
      be added to the recent list. Elements of the array can include:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>parent</b></dt>
  <dd>Prune parents (more accurately, ancestors) from the recent list. If
      present, changing directly down by any number of directories causes the
      current directory to be overwritten. For example, changing from ~pws to
      ~pws/some/other/dir causes ~pws not to be left on the recent directory
      stack. This only applies to direct changes to descendant directories;
      earlier directories on the list are not pruned. For example, changing from
      ~pws/yet/another to ~pws/some/other/dir does not cause ~pws to be
    pruned.</dd>
  <dt id="pattern:"><a class="permalink" href="#pattern:"><b>pattern:</b><i>pattern</i><b></b><i></i></a></dt>
  <dd>Gives a zsh pattern for directories that should not be added to the recent
      list (if not already there). This element can be repeated to add different
      patterns. For example, <b>'pattern:/tmp(|/*)'</b> stops <b>/tmp</b> or its
      descendants from being added. The <b>EXTENDED_GLOB</b> option is always
      turned on for these patterns.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="recent~5"><a class="permalink" href="#recent~5"><b>recent-dirs-pushd</b></a></dt>
  <dd>If set to true, <b>cdr</b> will use <b>pushd</b> instead of <b>cd</b> to
      change the directory, so the directory is saved on the directory stack. As
      the directory stack is completely separate from the list of files saved by
      the mechanism used in this file there is no obvious reason to do
    this.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Use_with_dynamic_directory_naming"><a class="permalink" href="#Use_with_dynamic_directory_naming">Use
  with dynamic directory naming</a></h2>
<p class="Pp">It is possible to refer to recent directories using the dynamic
    directory name syntax by using the supplied function
    <b>zsh_directory_name_cdr</b> a hook:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -Uz add-zsh-hook</b>
<b>add-zsh-hook -Uz zsh_directory_name zsh_directory_name_cdr</b></pre>
</div>
<p class="Pp">When this is done, <b>~[1]</b> will refer to the most recent
    directory other than $PWD, and so on. Completion after <b>~[</b><i>...</i>
    also works.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Details_of_directory_handling"><a class="permalink" href="#Details_of_directory_handling">Details
  of directory handling</a></h2>
<p class="Pp">This section is for the curious or confused; most users will not
    need to know this information.</p>
<p class="Pp">Recent directories are saved to a file immediately and hence are
    preserved across sessions. Note currently no file locking is applied: the
    list is updated immediately on interactive commands and nowhere else (unlike
    history), and it is assumed you are only going to change directory in one
    window at once. This is not safe on shared accounts, but in any case the
    system has limited utility when someone else is changing to a different set
    of directories behind your back.</p>
<p class="Pp">To make this a little safer, only directory changes instituted
    from the command line, either directly or indirectly through shell function
    calls (but not through subshells, evals, traps, completion functions and the
    like) are saved. Shell functions should use <b>cd -q</b> or <b>pushd -q</b>
    to avoid side effects if the change to the directory is to be invisible at
    the command line. See the contents of the function <b>chpwd_recent_dirs</b>
    for more details.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ABBREVIATED_DYNAMIC_REFERENCES_TO_DIRECTORIES"><a class="permalink" href="#ABBREVIATED_DYNAMIC_REFERENCES_TO_DIRECTORIES">ABBREVIATED
  DYNAMIC REFERENCES TO DIRECTORIES</a></h1>
<p class="Pp">The dynamic directory naming system is described in the subsection
    <i>Dynamic named directories</i> of the section <i>Filename Expansion</i> in
    <i>expn</i>(1). In this, a reference to <b>~[</b><i>...</i><b>]</b> is
    expanded by a function found by the hooks mechanism.</p>
<p class="Pp">The contributed function <b>zsh_directory_name_generic</b>
    provides a system allowing the user to refer to directories with only a
    limited amount of new code. It supports all three of the standard interfaces
    for directory naming: converting from a name to a directory, converting in
    the reverse direction to find a short name, and completion of names.</p>
<p class="Pp">The main feature of this function is a path-like syntax, combining
    abbreviations at multiple levels separated by &quot;:&quot;. As an example,
    ~[g:p:s] might specify:</p>
<dl class="Bl-tag">
  <dt><b>g</b></dt>
  <dd>The top level directory for your git area. This first component has to
      match, or the function will return indicating another directory name hook
      function should be tried.</dd>
  <dt id="p~2"><a class="permalink" href="#p~2"><b>p</b></a></dt>
  <dd>The name of a project within your git area.</dd>
  <dt id="s"><a class="permalink" href="#s"><b>s</b></a></dt>
  <dd>The source area within that project. This allows you to collapse
      references to long hierarchies to a very compact form, particularly if the
      hierarchies are similar across different areas of the disk.</dd>
</dl>
<p class="Pp">Name components may be completed: if a description is shown at the
    top of the list of completions, it includes the path to which previous
    components expand, while the description for an individual completion shows
    the path segment it would add. No additional configuration is needed for
    this as the completion system is aware of the dynamic directory name
    mechanism.</p>
<section class="Ss">
<h2 class="Ss" id="Usage"><a class="permalink" href="#Usage">Usage</a></h2>
<p class="Pp">To use the function, first define a wrapper function for your
    specific case. We'll assume it's to be autoloaded. This can have any name
    but we'll refer to it as zdn_mywrapper. This wrapper function will define
    various variables and then call this function with the same arguments that
    the wrapper function gets. This configuration is described below.</p>
<p class="Pp">Then arrange for the wrapper to be run as a zsh_directory_name
    hook:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -Uz add-zsh-hook zsh_diretory_name_generic zdn_mywrapper</b>
<b>add-zsh-hook -U zsh_directory_name zdn_mywrapper</b></pre>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Configuration~2"><a class="permalink" href="#Configuration~2">Configuration</a></h2>
<p class="Pp">The wrapper function should define a local associative array
    zdn_top. Alternatively, this can be set with a style called <b>mapping</b>.
    The context for the style is <b>:zdn:</b><i>wrapper-name</i> where
    <i>wrapper-name</i> is the function calling zsh_directory_name_generic; for
    example:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :zdn:zdn_mywrapper: mapping zdn_mywrapper_top</b></pre>
</div>
<p class="Pp">The keys in this associative array correspond to the first
    component of the name. The values are matching directories. They may have an
    optional suffix with a slash followed by a colon and the name of a variable
    in the same format to give the next component. (The slash before the colon
    is to disambiguate the case where a colon is needed in the path for a drive.
    There is otherwise no syntax for escaping this, so path components whose
    names start with a colon are not supported.) A special component
    <b>:default:</b> specifies a variable in the form <b>/:</b><i>var</i> (the
    path section is ignored and so is usually empty) that will be used for the
    next component if no variable is given for the path. Variables referred to
    within <b>zdn_top</b> have the same format as <b>zdn_top</b> itself, but
    contain relative paths.</p>
<p class="Pp">For example,</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>local -A zdn_top=(</b>
<b>  g   ~/git</b>
<b>  ga  ~/alternate/git</b>
<b>  gs  /scratch/$USER/git/:second2</b>
<b>  :default: /:second1</b>
<b>)</b></pre>
</div>
<p class="Pp">This specifies the behaviour of a directory referred to as
    <b>~[g:...]</b> or <b>~[ga:...]</b> or <b>~[gs:...]</b>. Later path
    components are optional; in that case <b>~[g]</b> expands to <b>~/git</b>,
    and so on. <b>gs</b> expands to <b>/scratch/$USER/git</b> and uses the
    associative array <b>second2</b> to match the second component; <b>g</b> and
    <b>ga</b> use the associative array <b>second1</b> to match the second
    component.</p>
<p class="Pp">When expanding a name to a directory, if the first component is
    not <b>g</b> or <b>ga</b> or <b>gs</b>, it is not an error; the function
    simply returns 1 so that a later hook function can be tried. However,
    matching the first component commits the function, so if a later component
    does not match, an error is printed (though this still does not stop later
    hooks from being executed).</p>
<p class="Pp">For components after the first, a relative path is expected, but
    note that multiple levels may still appear. Here is an example of
    <b>second1</b>:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>local -A second1=(</b>
<b>  p   myproject</b>
<b>  s   somproject</b>
<b>  os  otherproject/subproject/:third</b>
<b>)</b></pre>
</div>
<p class="Pp">The path as found from <b>zdn_top</b> is extended with the
    matching directory, so <b>~[g:p]</b> becomes <b>~/git/myproject</b>. The
    slash between is added automatically (it's not possible to have a later
    component modify the name of a directory already matched). Only <b>os</b>
    specifies a variable for a third component, and there's no <b>:default:</b>,
    so it's an error to use a name like <b>~[g:p:x]</b> or <b>~[ga:s:y]</b>
    because there's nowhere to look up the <b>x</b> or <b>y</b>.</p>
<p class="Pp">The associative arrays need to be visible within this function;
    the generic function therefore uses internal variable names beginning
    <b>_zdn_</b> in order to avoid clashes. Note that the variable <b>reply</b>
    needs to be passed back to the shell, so should not be local in the calling
    function.</p>
<p class="Pp">The function does not test whether directories assembled by
    component actually exist; this allows the system to work across automounted
    file systems. The error from the command trying to use a non-existent
    directory should be sufficient to indicate the problem.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Complete_example"><a class="permalink" href="#Complete_example">Complete
  example</a></h2>
<p class="Pp">Here is a full fictitious but usable autoloadable definition of
    the example function defined by the code above. So <b>~[gs:p:s]</b> expands
    to <b>/scratch/$USER/git/myscratchproject/top/srcdir</b> (with <b>$USER</b>
    also expanded).</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>local -A zdn_top=(</b>
<b>  g   ~/git</b>
<b>  ga  ~/alternate/git</b>
<b>  gs  /scratch/$USER/git/:second2</b>
<b>  :default: /:second1</b>
<b>)</b>
<b>local -A second1=(</b>
<b>  p   myproject</b>
<b>  s   somproject</b>
<b>  os  otherproject/subproject/:third</b>
<b>)</b>
<b>local -A second2=(</b>
<b>  p   myscratchproject</b>
<b>  s   somescratchproject</b>
<b>)</b>
<b>local -A third=(</b>
<b>  s   top/srcdir</b>
<b>  d   top/documentation</b>
<b>)</b>
<b># autoload not needed if you did this at initialisation...</b>
<b>autoload -Uz zsh_directory_name_generic</b>
<b>zsh_directory_name_generic &quot;$@</b></pre>
</div>
<p class="Pp">It is also possible to use global associative arrays, suitably
    named, and set the style for the context of your wrapper function to refer
    to this. Then your set up code would contain the following:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>typeset -A zdn_mywrapper_top=(...)</b>
<b># ... and so on for other associative arrays ...</b>
<b>zstyle ':zdn:zdn_mywrapper:' mapping zdn_mywrapper_top</b>
<b>autoload -Uz add-zsh-hook zsh_directory_name_generic zdn_mywrapper</b>
<b>add-zsh-hook -U zsh_directory_name zdn_mywrapper</b></pre>
</div>
<p class="Pp">and the function <b>zdn_mywrapper</b> would contain only the
    following:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zsh_directory_name_generic &quot;$@&quot;</b></pre>
</div>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="GATHERING_INFORMATION_FROM_VERSION_CONTROL_SYSTEMS"><a class="permalink" href="#GATHERING_INFORMATION_FROM_VERSION_CONTROL_SYSTEMS">GATHERING
  INFORMATION FROM VERSION CONTROL SYSTEMS</a></h1>
<p class="Pp">In a lot of cases, it is nice to automatically retrieve
    information from version control systems (VCSs), such as subversion, CVS or
    git, to be able to provide it to the user; possibly in the user's prompt. So
    that you can instantly tell which branch you are currently on, for
  example.</p>
<p class="Pp">In order to do that, you may use the <b>vcs_info</b> function.</p>
<p class="Pp">The following VCSs are supported, showing the abbreviated name by
    which they are referred to within the system:</p>
<dl class="Bl-tag">
  <dt id="Bazaar"><a class="permalink" href="#Bazaar">Bazaar
    (<b>bzr</b>)</a></dt>
  <dd><b>https://bazaar.canonical.com/</b></dd>
  <dt id="Codeville"><a class="permalink" href="#Codeville">Codeville
    (<b>cdv</b>)</a></dt>
  <dd><b>http://freecode.com/projects/codeville/</b></dd>
  <dt id="Concurrent"><a class="permalink" href="#Concurrent">Concurrent
    Versioning System (<b>cvs</b>)</a></dt>
  <dd><b>https://www.nongnu.org/cvs/</b></dd>
  <dt id="Darcs"><a class="permalink" href="#Darcs">Darcs
    (<b>darcs</b>)</a></dt>
  <dd><b>http://darcs.net/</b></dd>
  <dt id="Fossil"><a class="permalink" href="#Fossil">Fossil
    (<b>fossil</b>)</a></dt>
  <dd><b>https://fossil-scm.org/</b></dd>
  <dt id="Git"><a class="permalink" href="#Git">Git (<b>git</b>)</a></dt>
  <dd><b>https://git-scm.com/</b></dd>
  <dt id="GNU"><a class="permalink" href="#GNU">GNU arch (<b>tla</b>)</a></dt>
  <dd><b>https://www.gnu.org/software/gnu-arch/</b></dd>
  <dt id="Mercurial"><a class="permalink" href="#Mercurial">Mercurial
    (<b>hg</b>)</a></dt>
  <dd><b>https://www.mercurial-scm.org/</b></dd>
  <dt id="Monotone"><a class="permalink" href="#Monotone">Monotone
    (<b>mtn</b>)</a></dt>
  <dd><b>https://monotone.ca/</b></dd>
  <dt id="Perforce"><a class="permalink" href="#Perforce">Perforce
    (<b>p4</b>)</a></dt>
  <dd><b>https://www.perforce.com/</b></dd>
  <dt id="Subversion"><a class="permalink" href="#Subversion">Subversion
    (<b>svn</b>)</a></dt>
  <dd><b>https://subversion.apache.org/</b></dd>
  <dt id="SVK"><a class="permalink" href="#SVK">SVK (<b>svk</b>)</a></dt>
  <dd><b>https://svk.bestpractical.com/</b></dd>
</dl>
<p class="Pp">There is also support for the patch management system <b>quilt</b>
    (<b>https://savannah.nongnu.org/projects/quilt</b>). See <b>Quilt
    Support</b> below for details.</p>
<p class="Pp">To load <b>vcs_info</b>:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -Uz vcs_info</b></pre>
</div>
<p class="Pp">It can be used in any existing prompt, because it does not require
    any specific <b>$psvar</b> entries to be available.</p>
<section class="Ss">
<h2 class="Ss" id="Quickstart"><a class="permalink" href="#Quickstart">Quickstart</a></h2>
<p class="Pp">To get this feature working quickly (including colors), you can do
    the following (assuming, you loaded <b>vcs_info</b> properly - see
  above):</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' actionformats \ </b>
<b>    '%F{5}(%f%s%F{5})%F{3}-%F{5}[%F{2}%b%F{3}|%F{1}%a%F{5}]%f '</b>
<b>zstyle ':vcs_info:*' formats       \ </b>
<b>    '%F{5}(%f%s%F{5})%F{3}-%F{5}[%F{2}%b%F{5}]%f '</b>
<b>zstyle ':vcs_info:(sv[nk]|bzr):*' branchformat '%b%F{1}:%F{3}%r'</b>
<b>precmd () { vcs_info }</b>
<b>PS1='%F{5}[%F{2}%n%F{5}] %F{3}%3~ ${vcs_info_msg_0_}%f%# '</b></pre>
</div>
<p class="Pp">Obviously, the last two lines are there for demonstration. You
    need to call <b>vcs_info</b> from your <b>precmd</b> function. Once that is
    done you need a <i>single quoted</i> <b>'${vcs_info_msg_0_}'</b> in your
    prompt.</p>
<p class="Pp">To be able to use <b>'${vcs_info_msg_0_}'</b> directly in your
    prompt like this, you will need to have the <b>PROMPT_SUBST</b> option
    enabled.</p>
<p class="Pp">Now call the <b>vcs_info_printsys</b> utility from the command
    line:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>% vcs_info_printsys</b>
<b>## list of supported version control backends:</b>
<b>## disabled systems are prefixed by a hash sign (#)</b>
<b>bzr</b>
<b>cdv</b>
<b>cvs</b>
<b>darcs</b>
<b>fossil</b>
<b>git</b>
<b>hg</b>
<b>mtn</b>
<b>p4</b>
<b>svk</b>
<b>svn</b>
<b>tla</b>
<b>## flavours (cannot be used in the enable or disable styles; they</b>
<b>## are enabled and disabled with their master [git-svn -&gt; git])</b>
<b>## they *can* be used in contexts: ':vcs_info:git-svn:*'.</b>
<b>git-p4</b>
<b>git-svn</b>
<b>hg-git</b>
<b>hg-hgsubversion</b>
<b>hg-hgsvn</b></pre>
</div>
<p class="Pp">You may not want all of these because there is no point in running
    the code to detect systems you do not use. So there is a way to disable some
    backends altogether:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' disable bzr cdv darcs mtn svk tla</b></pre>
</div>
<p class="Pp">You may also pick a few from that list and enable only those:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' enable git cvs svn</b></pre>
</div>
<p class="Pp">If you rerun <b>vcs_info_printsys</b> after one of these commands,
    you will see the backends listed in the <b>disable</b> style (or backends
    not in the <b>enable</b> style - if you used that) marked as disabled by a
    hash sign. That means the detection of these systems is skipped
    <i>completely</i>. No wasted time there.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Configuration~3"><a class="permalink" href="#Configuration~3">Configuration</a></h2>
<p class="Pp">The <b>vcs_info</b> feature can be configured via
  <b>zstyle</b>.</p>
<p class="Pp">First, the context in which we are working:</p>
<div class="Bd-indent">
<pre><b>:vcs_info:</b><i>vcs-string</i><b>:</b><i>user-context</i><b>:</b><i>repo-root-name</i><b></b><i></i></pre>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><i>vcs-string</i></dt>
  <dd>is one of: <b>git</b>, <b>git-svn</b>, <b>git-p4</b>, <b>hg</b>,
      <b>hg-git</b>, <b>hg-hgsubversion</b>, <b>hg-hgsvn</b>, <b>darcs</b>,
      <b>bzr</b>, <b>cdv</b>, <b>mtn</b>, <b>svn</b>, <b>cvs</b>, <b>svk</b>,
      <b>tla</b>, <b>p4</b> or <b>fossil</b>. This is followed by
      `<b>.quilt-</b><i>quilt-mode</i>' in Quilt mode (see <b>Quilt Support</b>
      for details) and by `<b>+</b><i>hook-name</i>' while hooks are active (see
      <b>Hooks in vcs_info</b> for details).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Currently, hooks in quilt mode don't add the
    `<b>.quilt-</b><i>quilt-mode</i>' information. This may change in the
    future.</p>
</div>
<dl class="Bl-tag">
  <dt id="user"><a class="permalink" href="#user"><i>user-context</i></a></dt>
  <dd>is a freely configurable string, assignable by the user as the first
      argument to <b>vcs_info</b> (see its description below).</dd>
  <dt id="repo"><a class="permalink" href="#repo"><i>repo-root-name</i></a></dt>
  <dd>is the name of a repository in which you want a style to match. So, if you
      want a setting specific to <b>/usr/src/zsh</b>, with that being a CVS
      checkout, you can set <i>repo-root-name</i> to <b>zsh</b> to make it
    so.</dd>
</dl>
<p class="Pp">There are three special values for <i>vcs-string</i>: The first is
    named <b>-init-</b>, that is in effect as long as there was no decision what
    VCS backend to use. The second is <b>-preinit-</b>; it is used <i>before</i>
    <b>vcs_info</b> is run, when initializing the data exporting variables. The
    third special value is <b>formats</b> and is used by the
    <b>vcs_info_lastmsg</b> for looking up its styles.</p>
<p class="Pp">The initial value of <i>repo-root-name</i> is <b>-all-</b> and it
    is replaced with the actual name, as soon as it is known. Only use this part
    of the context for defining the <b>formats</b>, <b>actionformats</b> or
    <b>branchformat</b> styles, as it is guaranteed that <i>repo-root-name</i>
    is set up correctly for these only. For all other styles, just use
    <b>'*'</b> instead.</p>
<p class="Pp">There are two pre-defined values for <i>user-context</i>:</p>
<dl class="Bl-tag">
  <dt id="default"><a class="permalink" href="#default"><b>default</b></a></dt>
  <dd>the one used if none is specified</dd>
  <dt id="command"><a class="permalink" href="#command"><b>command</b></a></dt>
  <dd>used by vcs_info_lastmsg to lookup its styles</dd>
</dl>
<p class="Pp">You can of course use <b>':vcs_info:*'</b> to match all VCSs in
    all user-contexts at once.</p>
<p class="Pp">This is a description of all styles that are looked up.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>formats</b></dt>
  <dd>A list of formats, used when actionformats is not used (which is most of
      the time).</dd>
  <dt id="actionformats"><a class="permalink" href="#actionformats"><b>actionformats</b></a></dt>
  <dd>A list of formats, used if there is a special action going on in your
      current repository; like an interactive rebase or a merge conflict.</dd>
  <dt id="branchformat"><a class="permalink" href="#branchformat"><b>branchformat</b></a></dt>
  <dd>Some backends replace <b>%b</b> in the formats and actionformats styles
      above, not only by a branch name but also by a revision number. This style
      lets you modify how that string should look.</dd>
  <dt id="nvcsformats"><a class="permalink" href="#nvcsformats"><b>nvcsformats</b></a></dt>
  <dd>These &quot;formats&quot; are set when we didn't detect a version control
      system for the current directory or <b>vcs_info</b> was disabled. This is
      useful if you want <b>vcs_info</b> to completely take over the generation
      of your prompt. You would do something like
      <b>PS1='${vcs_info_msg_0_}'</b> to accomplish that.</dd>
  <dt id="hgrevformat"><a class="permalink" href="#hgrevformat"><b>hgrevformat</b></a></dt>
  <dd><b>hg</b> uses both a hash and a revision number to reference a specific
      changeset in a repository. With this style you can format the revision
      string (see <b>branchformat</b>) to include either or both. It's only
      useful when <b>get-revision</b> is true. Note, the full 40-character
      revision id is not available (except when using the <b>use-simple</b>
      option) because executing hg more than once per prompt is too slow; you
      may customize this behavior using hooks.</dd>
  <dt id="max"><a class="permalink" href="#max"><b>max-exports</b></a></dt>
  <dd>Defines the maximum number of <b>vcs_info_msg_*_</b> variables
      <b>vcs_info</b> will set.</dd>
  <dt id="enable"><a class="permalink" href="#enable"><b>enable</b></a></dt>
  <dd>A list of backends you want to use. Checked in the <b>-init-</b> context.
      If this list contains an item called <b>NONE</b> no backend is used at all
      and <b>vcs_info</b> will do nothing. If this list contains <b>ALL</b>,
      <b>vcs_info</b> will use all known backends. Only with <b>ALL</b> in
      <b>enable</b> will the <b>disable</b> style have any effect. <b>ALL</b>
      and <b>NONE</b> are case insensitive.</dd>
  <dt id="disable"><a class="permalink" href="#disable"><b>disable</b></a></dt>
  <dd>A list of VCSs you don't want <b>vcs_info</b> to test for repositories
      (checked in the <b>-init-</b> context, too). Only used if <b>enable</b>
      contains <b>ALL</b>.</dd>
  <dt id="disable~2"><a class="permalink" href="#disable~2"><b>disable-patterns</b></a></dt>
  <dd>A list of patterns that are checked against <b>$PWD</b>. If a pattern
      matches, <b>vcs_info</b> will be disabled. This style is checked in the
      <b>:vcs_info:-init-:*:-all-</b> context.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Say, <b>~/.zsh</b> is a directory under version control, in which
    you do not want <b>vcs_info</b> to be active, do:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' disable-patterns &quot;${(b)HOME}/.zsh(|/*)&quot;</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="use"><a class="permalink" href="#use"><b>use-quilt</b></a></dt>
  <dd>If enabled, the <b>quilt</b> support code is active in `addon' mode. See
      <b>Quilt Support</b> for details.</dd>
  <dt id="quilt"><a class="permalink" href="#quilt"><b>quilt-standalone</b></a></dt>
  <dd>If enabled, `standalone' mode detection is attempted if no VCS is active
      in a given directory. See <b>Quilt Support</b> for details.</dd>
  <dt id="quilt~2"><a class="permalink" href="#quilt~2"><b>quilt-patch-dir</b></a></dt>
  <dd>Overwrite the value of the <b>$QUILT_PATCHES</b> environment variable. See
      <b>Quilt Support</b> for details.</dd>
  <dt id="quiltcommand"><a class="permalink" href="#quiltcommand"><b>quiltcommand</b></a></dt>
  <dd>When <b>quilt</b> itself is called in quilt support, the value of this
      style is used as the command name.</dd>
  <dt id="check"><a class="permalink" href="#check"><b>check-for-changes</b></a></dt>
  <dd>If enabled, this style causes the <b>%c</b> and <b>%u</b> format escapes
      to show when the working directory has uncommitted changes. The strings
      displayed by these escapes can be controlled via the <b>stagedstr</b> and
      <b>unstagedstr</b> styles. The only backends that currently support this
      option are <b>git</b>, <b>hg</b>, and <b>bzr</b> (the latter two only
      support unstaged).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">For this style to be evaluated with the <b>hg</b> backend, the
    <b>get-revision</b> style needs to be set and the <b>use-simple</b> style
    needs to be unset. The latter is the default; the former is not.</p>
<p class="Pp">With the <b>bzr</b> backend, <i>lightweight checkouts</i> only
    honor this style if the <b>use-server</b> style is set.</p>
<p class="Pp">Note, the actions taken if this style is enabled are potentially
    expensive (read: they may be slow, depending on how big the current
    repository is). Therefore, it is disabled by default.</p>
</div>
<dl class="Bl-tag">
  <dt id="check~2"><a class="permalink" href="#check~2"><b>check-for-staged-changes</b></a></dt>
  <dd>This style is like <b>check-for-changes</b>, but it never checks the
      worktree files, only the metadata in the <b>.${vcs}</b> dir. Therefore,
      this style initializes only the <b>%c</b> escape (with <b>stagedstr</b>)
      but not the <b>%u</b> escape. This style is faster than
      <b>check-for-changes</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">In the <b>git</b> backend, this style checks for changes in the
    index. Other backends do not currently implement this style.</p>
<p class="Pp">This style is disabled by default.</p>
</div>
<dl class="Bl-tag">
  <dt id="stagedstr"><a class="permalink" href="#stagedstr"><b>stagedstr</b></a></dt>
  <dd>This string will be used in the <b>%c</b> escape if there are staged
      changes in the repository.</dd>
  <dt id="unstagedstr"><a class="permalink" href="#unstagedstr"><b>unstagedstr</b></a></dt>
  <dd>This string will be used in the <b>%u</b> escape if there are unstaged
      changes in the repository.</dd>
  <dt id="command~2"><a class="permalink" href="#command~2"><b>command</b></a></dt>
  <dd>This style causes <b>vcs_info</b> to use the supplied string as the
      command to use as the VCS's binary. Note, that setting this in
      '<b>:vcs_info:*</b>' is not a good idea.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If the value of this style is empty (which is the default), the
    used binary name is the name of the backend in use (e.g. <b>svn</b> is used
    in an <b>svn</b> repository).</p>
<p class="Pp">The <b>repo-root-name</b> part in the context is always the
    default <b>-all-</b> when this style is looked up.</p>
<p class="Pp">For example, this style can be used to use binaries from
    non-default installation directories. Assume, <b>git</b> is installed in
    /usr/bin but your sysadmin installed a newer version in /usr/local/bin.
    Instead of changing the order of your <b>$PATH</b> parameter, you can do
    this:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:git:*:-all-' command /usr/local/bin/git</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="use~2"><a class="permalink" href="#use~2"><b>use-server</b></a></dt>
  <dd>This is used by the Perforce backend (<b>p4</b>) to decide if it should
      contact the Perforce server to find out if a directory is managed by
      Perforce. This is the only reliable way of doing this, but runs the risk
      of a delay if the server name cannot be found. If the server (more
      specifically, the <b>host</b><b>:</b><b>port</b> pair describing the
      server) cannot be contacted, its name is put into the associative array
      <b>vcs_info_p4_dead_servers</b> and is not contacted again during the
      session until it is removed by hand. If you do not set this style, the
      <b>p4</b> backend is only usable if you have set the environment variable
      <b>P4CONFIG</b> to a file name and have corresponding files in the root
      directories of each Perforce client. See comments in the function
      <b>VCS_INFO_detect_p4</b> for more detail.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The Bazaar backend (<b>bzr</b>) uses this to permit contacting the
    server about lightweight checkouts, see the <b>check-for-changes</b>
  style.</p>
</div>
<dl class="Bl-tag">
  <dt id="use~3"><a class="permalink" href="#use~3"><b>use-simple</b></a></dt>
  <dd>If there are two different ways of gathering information, you can select
      the simpler one by setting this style to true; the default is to use the
      not-that-simple code, which is potentially a lot slower but might be more
      accurate in all possible cases. This style is used by the <b>bzr</b> and
      <b>hg</b> backends. In the case of <b>hg</b> it will invoke the external
      hexdump program to parse the binary dirstate cache file; this method will
      not return the local revision number.</dd>
  <dt id="get"><a class="permalink" href="#get"><b>get-revision</b></a></dt>
  <dd>If set to true, vcs_info goes the extra mile to figure out the revision of
      a repository's work tree (currently for the <b>git</b> and <b>hg</b>
      backends, where this kind of information is not always vital). For
      <b>git</b>, the hash value of the currently checked out commit is
      available via the <b>%i</b> expansion. With <b>hg</b>, the local revision
      number and the corresponding global hash are available via <b>%i</b>.</dd>
  <dt id="get~2"><a class="permalink" href="#get~2"><b>get-mq</b></a></dt>
  <dd>If set to true, the <b>hg</b> backend will look for a Mercurial Queue
      (<b>mq</b>) patch directory. Information will be available via the
      `<b>%m</b>' replacement.</dd>
  <dt id="get~3"><a class="permalink" href="#get~3"><b>get-bookmarks</b></a></dt>
  <dd>If set to true, the <b>hg</b> backend will try to get a list of current
      bookmarks. They will be available via the `<b>%m</b>' replacement.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The default is to generate a comma-separated list of all bookmark
    names that refer to the currently checked out revision. If a bookmark is
    active, its name is suffixed an asterisk and placed first in the list.</p>
</div>
<dl class="Bl-tag">
  <dt id="use~4"><a class="permalink" href="#use~4"><b>use-prompt-escapes</b></a></dt>
  <dd>Determines if we assume that the assembled string from <b>vcs_info</b>
      includes prompt escapes. (Used by <b>vcs_info_lastmsg</b>.)</dd>
  <dt id="debug"><a class="permalink" href="#debug"><b>debug</b></a></dt>
  <dd>Enable debugging output to track possible problems. Currently this style
      is only used by <b>vcs_info</b>'s hooks system.</dd>
  <dt id="hooks"><a class="permalink" href="#hooks"><b>hooks</b></a></dt>
  <dd>A list style that defines hook-function names. See <b>Hooks in
      vcs_info</b> below for details.</dd>
  <dt><b>patch-format</b></dt>
  <dd></dd>
  <dt><b>nopatch-format</b></dt>
  <dd>This pair of styles format the patch information used by the <b>%m</b>
      expando in formats and actionformats for the <b>git</b> and <b>hg</b>
      backends. The value is subject to certain <b>%</b>-expansions described
      below. The expanded value is made available in the global
      <b>backend_misc</b> array as <b>${backend_misc[patches]}</b> (also if a
      <b>set-patch-format</b> hook is used).</dd>
  <dt id="get~4"><a class="permalink" href="#get~4"><b>get-unapplied</b></a></dt>
  <dd>This boolean style controls whether a backend should attempt to gather a
      list of unapplied patches (for example with Mercurial Queue patches).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Used by the <b>quilt</b> and <b>hg</b> backends.</p>
</div>
<p class="Pp">The default values for these styles in all contexts are:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="formats"><a class="permalink" href="#formats"><b>formats</b></a></dt>
  <dd>&quot; (%s)-[%b]%u%c-&quot;</dd>
  <dt id="actionformats~2"><a class="permalink" href="#actionformats~2"><b>actionformats</b></a></dt>
  <dd>&quot; (%s)-[%b|%a]%u%c-&quot;</dd>
  <dt id="branchformat~2"><a class="permalink" href="#branchformat~2"><b>branchformat</b></a></dt>
  <dd>&quot;%b:%r&quot; (for bzr, svn, svk and hg)</dd>
  <dt id="nvcsformats~2"><a class="permalink" href="#nvcsformats~2"><b>nvcsformats</b></a></dt>
  <dd>&quot;&quot;</dd>
  <dt id="hgrevformat~2"><a class="permalink" href="#hgrevformat~2"><b>hgrevformat</b></a></dt>
  <dd>&quot;%r:%h&quot;</dd>
  <dt id="max~2"><a class="permalink" href="#max~2"><b>max-exports</b></a></dt>
  <dd>2</dd>
  <dt id="enable~2"><a class="permalink" href="#enable~2"><b>enable</b></a></dt>
  <dd>ALL</dd>
  <dt id="disable~3"><a class="permalink" href="#disable~3"><b>disable</b></a></dt>
  <dd>(empty list)</dd>
  <dt id="disable~4"><a class="permalink" href="#disable~4"><b>disable-patterns</b></a></dt>
  <dd>(empty list)</dd>
  <dt id="check~3"><a class="permalink" href="#check~3"><b>check-for-changes</b></a></dt>
  <dd>false</dd>
  <dt id="check~4"><a class="permalink" href="#check~4"><b>check-for-staged-changes</b></a></dt>
  <dd>false</dd>
  <dt id="stagedstr~2"><a class="permalink" href="#stagedstr~2"><b>stagedstr</b></a></dt>
  <dd>(string: &quot;S&quot;)</dd>
  <dt id="unstagedstr~2"><a class="permalink" href="#unstagedstr~2"><b>unstagedstr</b></a></dt>
  <dd>(string: &quot;U&quot;)</dd>
  <dt id="command~3"><a class="permalink" href="#command~3"><b>command</b></a></dt>
  <dd>(empty string)</dd>
  <dt id="use~5"><a class="permalink" href="#use~5"><b>use-server</b></a></dt>
  <dd>false</dd>
  <dt id="use~6"><a class="permalink" href="#use~6"><b>use-simple</b></a></dt>
  <dd>false</dd>
  <dt id="get~5"><a class="permalink" href="#get~5"><b>get-revision</b></a></dt>
  <dd>false</dd>
  <dt id="get~6"><a class="permalink" href="#get~6"><b>get-mq</b></a></dt>
  <dd>true</dd>
  <dt id="get~7"><a class="permalink" href="#get~7"><b>get-bookmarks</b></a></dt>
  <dd>false</dd>
  <dt id="use~7"><a class="permalink" href="#use~7"><b>use-prompt-escapes</b></a></dt>
  <dd>true</dd>
  <dt id="debug~2"><a class="permalink" href="#debug~2"><b>debug</b></a></dt>
  <dd>false</dd>
  <dt id="hooks~2"><a class="permalink" href="#hooks~2"><b>hooks</b></a></dt>
  <dd>(empty list)</dd>
  <dt id="use~8"><a class="permalink" href="#use~8"><b>use-quilt</b></a></dt>
  <dd>false</dd>
  <dt id="quilt~3"><a class="permalink" href="#quilt~3"><b>quilt-standalone</b></a></dt>
  <dd>false</dd>
  <dt id="quilt~4"><a class="permalink" href="#quilt~4"><b>quilt-patch-dir</b></a></dt>
  <dd>empty - use <b>$QUILT_PATCHES</b></dd>
  <dt id="quiltcommand~2"><a class="permalink" href="#quiltcommand~2"><b>quiltcommand</b></a></dt>
  <dd>quilt</dd>
  <dt id="patch"><a class="permalink" href="#patch"><b>patch-format</b></a></dt>
  <dd><i>backend dependent</i></dd>
  <dt id="nopatch"><a class="permalink" href="#nopatch"><b>nopatch-format</b></a></dt>
  <dd><i>backend dependent</i></dd>
  <dt id="get~8"><a class="permalink" href="#get~8"><b>get-unapplied</b></a></dt>
  <dd>false</dd>
</dl>
<p class="Pp">In normal <b>formats</b> and <b>actionformats</b> the following
    replacements are done:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>%s</b></dt>
  <dd>The VCS in use (git, hg, svn, etc.).</dd>
  <dt><b>%b</b></dt>
  <dd>Information about the current branch.</dd>
  <dt><b>%a</b></dt>
  <dd>An identifier that describes the action. Only makes sense in
      <b>actionformats</b>.</dd>
  <dt><b>%i</b></dt>
  <dd>The current revision number or identifier. For <b>hg</b> the
      <b>hgrevformat</b> style may be used to customize the output.</dd>
  <dt><b>%c</b></dt>
  <dd>The string from the <b>stagedstr</b> style if there are staged changes in
      the repository.</dd>
  <dt><b>%u</b></dt>
  <dd>The string from the <b>unstagedstr</b> style if there are unstaged changes
      in the repository.</dd>
  <dt><b>%R</b></dt>
  <dd>The base directory of the repository.</dd>
  <dt><b>%r</b></dt>
  <dd>The repository name. If <b>%R</b> is <b>/foo/bar/repoXY</b>, <b>%r</b> is
      <b>repoXY</b>.</dd>
  <dt><b>%S</b></dt>
  <dd>A subdirectory within a repository. If <b>$PWD</b> is
      <b>/foo/bar/repoXY/beer/tasty</b>, <b>%S</b> is <b>beer/tasty</b>.</dd>
  <dt><b>%m</b></dt>
  <dd>A &quot;misc&quot; replacement. It is at the discretion of the backend to
      decide what this replacement expands to.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The <b>hg</b> and <b>git</b> backends use this expando to display
    patch information. <b>hg</b> sources patch information from the <b>mq</b>
    extensions; <b>git</b> from in-progress <b>rebase</b> and <b>cherry-pick</b>
    operations and from the <b>stgit</b> extension. The <b>patch-format</b> and
    <b>nopatch-format</b> styles control the generated string. The former is
    used when at least one patch from the patch queue has been applied, and the
    latter otherwise.</p>
<p class="Pp">The <b>hg</b> backend displays bookmark information in this
    expando (in addition to <b>mq</b> information). See the <b>get-mq</b> and
    <b>get-bookmarks</b> styles. Both of these styles may be enabled at the same
    time. If both are enabled, both resulting strings will be shown separated by
    a semicolon (that cannot currently be customized).</p>
<p class="Pp">The <b>quilt</b> `standalone' backend sets this expando to the
    same value as the <b>%Q</b> expando.</p>
</div>
<dl class="Bl-tag">
  <dt><b>%Q</b></dt>
  <dd>Quilt series information. When quilt is used (either in `addon' mode or as
      a `standalone' backend), this expando is set to quilt series'
      <b>patch-format</b> string. The <b>set-patch-format</b> hook and
      <b>nopatch-format</b> style are honoured.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">See <b>Quilt Support</b> below for details.</p>
</div>
<p class="Pp">In <b>branchformat</b> these replacements are done:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>%b</b></dt>
  <dd>The branch name.</dd>
  <dt><b>%r</b></dt>
  <dd>The current revision number or the <b>hgrevformat</b> style for
    <b>hg</b>.</dd>
</dl>
<p class="Pp">In <b>hgrevformat</b> these replacements are done:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>%r</b></dt>
  <dd>The current local revision number.</dd>
  <dt><b>%h</b></dt>
  <dd>The current global revision identifier.</dd>
</dl>
<p class="Pp">In <b>patch-format</b> and <b>nopatch-format</b> these
    replacements are done:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>%p</b></dt>
  <dd>The name of the top-most applied patch; may be overridden by the
      <b>applied-string</b> hook.</dd>
  <dt><b>%u</b></dt>
  <dd>The number of unapplied patches; may be overridden by the
      <b>unapplied-string</b> hook.</dd>
  <dt><b>%n</b></dt>
  <dd>The number of applied patches.</dd>
  <dt><b>%c</b></dt>
  <dd>The number of unapplied patches.</dd>
  <dt><b>%a</b></dt>
  <dd>The number of all patches (<b>%a = %n + %c</b>).</dd>
  <dt><b>%g</b></dt>
  <dd>The names of active <b>mq</b> guards (<b>hg</b> backend).</dd>
  <dt><b>%G</b></dt>
  <dd>The number of active <b>mq</b> guards (<b>hg</b> backend).</dd>
</dl>
<p class="Pp">Not all VCS backends have to support all replacements. For
    <b>nvcsformats</b> no replacements are performed at all, it is just a
    string.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Oddities"><a class="permalink" href="#Oddities">Oddities</a></h2>
<p class="Pp">If you want to use the <b>%b</b> (bold off) prompt expansion in
    <b>formats</b>, which expands <b>%b</b> itself, use <b>%%b</b>. That will
    cause the <b>vcs_info</b> expansion to replace <b>%%b</b> with <b>%b</b>, so
    that zsh's prompt expansion mechanism can handle it. Similarly, to hand down
    <b>%b</b> from <b>branchformat</b>, use <b>%%%%b</b>. Sorry for this
    inconvenience, but it cannot be easily avoided. Luckily we do not clash with
    a lot of prompt expansions and this only needs to be done for those.</p>
<p class="Pp">When one of the <b>gen-applied-string</b>,
    <b>gen-unapplied-string</b>, and <b>set-patch-format</b> hooks is defined,
    applying <b>%</b>-escaping (`<b>foo=${foo//'%'/%%}</b>') to the interpolated
    values for use in the prompt is the responsibility of those hooks (jointly);
    when neither of those hooks is defined, <b>vcs_info</b> handles escaping by
    itself. We regret this coupling, but it was required for backwards
    compatibility.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Quilt_Support"><a class="permalink" href="#Quilt_Support">Quilt
  Support</a></h2>
<p class="Pp"><b>Quilt</b> is not a version control system, therefore this is
    not implemented as a backend. It can help keeping track of a series of
    patches. People use it to keep a set of changes they want to use on top of
    software packages (which is tightly integrated into the package build
    process - the Debian project does this for a large number of packages).
    Quilt can also help individual developers keep track of their own patches on
    top of real version control systems.</p>
<p class="Pp">The <b>vcs_info</b> integration tries to support both ways of
    using quilt by having two slightly different modes of operation: `addon'
    mode and `standalone' mode).</p>
<p class="Pp">Quilt integration is off by default; to enable it, set the
    <b>use-quilt</b> style, and add <b>%Q</b> to your <b>formats</b> or
    <b>actionformats</b> style:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' use-quilt true</b></pre>
</div>
<p class="Pp">Styles looked up from the Quilt support code include
    `<b>.quilt-</b><i>quilt-mode</i>' in the <i>vcs-string</i> part of the
    context, where <i>quilt-mode</i> is either <b>addon</b> or
    <b>standalone</b>. Example:
    <b>:vcs_info:git.quilt-addon:default:</b><i>repo-root-name</i>.</p>
<p class="Pp">For `addon' mode to become active <b>vcs_info</b> must have
    already detected a real version control system controlling the directory. If
    that is the case, a directory that holds quilt's patches needs to be found.
    That directory is configurable via the `<b>QUILT_PATCHES</b>' environment
    variable. If that variable exists its value is used, otherwise the value
    `<b>patches</b>' is assumed. The value from <b>$QUILT_PATCHES</b> can be
    overwritten using the `<b>quilt-patches</b>' style. (Note: you can use
    <b>vcs_info</b> to keep the value of <b>$QUILT_PATCHES</b> correct all the
    time via the <b>post-quilt</b> hook).</p>
<p class="Pp">When the directory in question is found, quilt is assumed to be
    active. To gather more information, <b>vcs_info</b> looks for a directory
    called `.pc'; Quilt uses that directory to track its current state. If this
    directory does not exist we know that quilt has not done anything to the
    working directory (read: no patches have been applied yet).</p>
<p class="Pp">If patches are applied, <b>vcs_info</b> will try to find out
    which. If you want to know which patches of a series are not yet applied,
    you need to activate the <b>get-unapplied</b> style in the appropriate
    context.</p>
<p class="Pp"><b>vcs_info</b> allows for very detailed control over how the
    gathered information is presented (see the <b>Configuration</b> and <b>Hooks
    in vcs_info</b> sections), all of which are documented below. Note there are
    a number of other patch tracking systems that work on top of a certain
    version control system (like <b>stgit</b> for <b>git</b>, or <b>mq</b> for
    <b>hg</b>); the configuration for systems like that are generally configured
    the same way as the <b>quilt</b> support.</p>
<p class="Pp">If the <b>quilt</b> support is working in `addon' mode, the
    produced string is available as a simple format replacement (<b>%Q</b> to be
    precise), which can be used in <b>formats</b> and <b>actionformats</b>; see
    below for details).</p>
<p class="Pp">If, on the other hand, the support code is working in `standalone'
    mode, <b>vcs_info</b> will pretend as if <b>quilt</b> were an actual version
    control system. That means that the version control system identifier (which
    otherwise would be something like `svn' or `cvs') will be set to
    `<b>-quilt-</b>'. This has implications on the used style context where this
    identifier is the second element. <b>vcs_info</b> will have filled in a
    proper value for the &quot;repository's&quot; root directory and the string
    containing the information about quilt's state will be available as the
    `misc' replacement (and <b>%Q</b> for compatibility with `addon' mode).</p>
<p class="Pp">What is left to discuss is how `standalone' mode is detected. The
    detection itself is a series of searches for directories. You can have this
    detection enabled all the time in every directory that is not otherwise
    under version control. If you know there is only a limited set of trees
    where you would like <b>vcs_info</b> to try and look for Quilt in
    `standalone' mode to minimise the amount of searching on every call to
    <b>vcs_info</b>, there are a number of ways to do that:</p>
<p class="Pp">Essentially, `standalone' mode detection is controlled by a style
    called `<b>quilt-standalone</b>'. It is a string style and its value can
    have different effects. The simplest values are: `<b>always</b>' to run
    detection every time <b>vcs_info</b> is run, and `<b>never</b>' to turn the
    detection off entirely.</p>
<p class="Pp">If the value of <b>quilt-standalone</b> is something else, it is
    interpreted differently. If the value is the name of a scalar variable the
    value of that variable is checked and that value is used in the same
    `always'/`never' way as described above.</p>
<p class="Pp">If the value of <b>quilt-standalone</b> is an array, the elements
    of that array are used as directory names under which you want the detection
    to be active.</p>
<p class="Pp">If <b>quilt-standalone</b> is an associative array, the keys are
    taken as directory names under which you want the detection to be active,
    but only if the corresponding value is the string `<b>true</b>'.</p>
<p class="Pp">Last, but not least, if the value of <b>quilt-standalone</b> is
    the name of a function, the function is called without arguments and the
    return value decides whether detection should be active. A `0' return value
    is true; a non-zero return value is interpreted as false.</p>
<p class="Pp">Note, if there is both a function and a variable by the name of
    <b>quilt-standalone</b>, the function will take precedence.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Function_Descriptions_(Public_API)"><a class="permalink" href="#Function_Descriptions_(Public_API)">Function
  Descriptions (Public API)</a></h2>
<dl class="Bl-tag">
  <dt><b>vcs_info</b> [<i>user-context</i>]</dt>
  <dd>The main function, that runs all backends and assembles all data into
      <b>${vcs_info_msg_*_}</b>. This is the function you want to call from
      <b>precmd</b> if you want to include up-to-date information in your prompt
      (see <b>Variable Description</b> below). If an argument is given, that
      string will be used instead of <b>default</b> in the <i>user-context</i>
      field of the style context.</dd>
  <dt id="vcs_info_hookadd"><a class="permalink" href="#vcs_info_hookadd"><b>vcs_info_hookadd</b></a></dt>
  <dd>Statically registers a number of functions to a given hook. The hook needs
      to be given as the first argument; what follows is a list of hook-function
      names to register to the hook. The `<b>+vi-</b>' prefix needs to be left
      out here. See <b>Hooks in vcs_info</b> below for details.</dd>
  <dt id="vcs_info_hookdel"><a class="permalink" href="#vcs_info_hookdel"><b>vcs_info_hookdel</b></a></dt>
  <dd>Remove hook-functions from a given hook. The hook needs to be given as the
      first non-option argument; what follows is a list of hook-function names
      to un-register from the hook. If `<b>-a</b>' is used as the first
      argument, <b>all</b> occurrences of the functions are unregistered.
      Otherwise only the last occurrence is removed (if a function was
      registered to a hook more than once). The `<b>+vi-</b>' prefix needs to be
      left out here. See <b>Hooks in vcs_info</b> below for details.</dd>
  <dt id="vcs_info_lastmsg"><a class="permalink" href="#vcs_info_lastmsg"><b>vcs_info_lastmsg</b></a></dt>
  <dd>Outputs the last <b>${vcs_info_msg_*_}</b> value. Takes into account the
      value of the <b>use-prompt-escapes</b> style in
      <b>':vcs_info:formats:command:-all-'</b>. It also only prints
      <b>max-exports</b> values.</dd>
  <dt id="vcs_info_printsys"><a class="permalink" href="#vcs_info_printsys"><b>vcs_info_printsys</b>
    [<i>user-context</i>]</a></dt>
  <dd>Prints a list of all supported version control systems. Useful to find out
      possible contexts (and which of them are enabled) or values for the
      <b>disable</b> style.</dd>
  <dt id="vcs_info_setsys"><a class="permalink" href="#vcs_info_setsys"><b>vcs_info_setsys</b></a></dt>
  <dd>Initializes <b>vcs_info</b>'s internal list of available backends. With
      this function, you can add support for new VCSs without restarting the
      shell.</dd>
</dl>
<p class="Pp">All functions named <b>VCS_INFO_*</b> are for internal use
  only.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Variable_Description"><a class="permalink" href="#Variable_Description">Variable
  Description</a></h2>
<dl class="Bl-tag">
  <dt><b>${vcs_info_msg_</b><i>N</i><b>_}</b> (Note the trailing
    underscore)</dt>
  <dd>Where <i>N</i> is an integer, e.g., <b>vcs_info_msg_0_</b>. These
      variables are the storage for the informational message the last
      <b>vcs_info</b> call has assembled. These are strongly connected to the
      <b>formats</b>, <b>actionformats</b> and <b>nvcsformats</b> styles
      described above. Those styles are lists. The first member of that list
      gets expanded into <b>${vcs_info_msg_0_}</b>, the second into
      <b>${vcs_info_msg_1_}</b> and the Nth into <b>${vcs_info_msg_N-1_}</b>.
      (See the <b>max-exports</b> style above.)</dd>
</dl>
<p class="Pp">All variables named <b>VCS_INFO_*</b> are for internal use
  only.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Hooks_in_vcs_info"><a class="permalink" href="#Hooks_in_vcs_info">Hooks
  in vcs_info</a></h2>
<p class="Pp">Hooks are places in <b>vcs_info</b> where you can run your own
    code. That code can communicate with the code that called it and through
    that, change the system's behaviour.</p>
<p class="Pp">For configuration, hooks change the style context:</p>
<div class="Bd-indent">
<pre><b>:vcs_info:</b><i>vcs-string</i><b>+</b><i>hook-name</i><b>:</b><i>user-context</i><b>:</b><i>repo-root-name</i><b></b><i></i></pre>
</div>
<p class="Pp">To register functions to a hook, you need to list them in the
    <b>hooks</b> style in the appropriate context.</p>
<p class="Pp">Example:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*+foo:*' hooks bar baz</b></pre>
</div>
<p class="Pp">This registers functions to the hook `foo' for all backends. In
    order to avoid namespace problems, all registered function names are
    prepended by a `<b>+vi-</b>', so the actual functions called for the `foo'
    hook are `<b>+vi-bar</b>' and `<b>+vi-baz</b>'.</p>
<p class="Pp">If you would like to register a function to a hook regardless of
    the current context, you may use the <b>vcs_info_hookadd</b> function. To
    remove a function that was added like that, the <b>vcs_info_hookdel</b>
    function can be used.</p>
<p class="Pp">If something seems weird, you can enable the `debug' boolean style
    in the proper context and the hook-calling code will print what it tried to
    execute and whether the function in question existed.</p>
<p class="Pp">When you register more than one function to a hook, all functions
    are executed one after another until one function returns non-zero or until
    all functions have been called. Context-sensitive hook functions are
    executed <b>before</b> statically registered ones (the ones added by
    <b>vcs_info_hookadd</b>).</p>
<p class="Pp">You may pass data between functions via an associative array,
    <b>user_data</b>. For example:</p>
<div class="Bd-indent">
<pre><b></b>
<b>+vi-git-myfirsthook(){</b>
<b>    user_data[myval]=$myval</b>
<b>}</b>
<b>+vi-git-mysecondhook(){</b>
<b>    # do something with ${user_data[myval]}</b>
<b>}</b></pre>
</div>
<p class="Pp">There are a number of variables that are special in hook
  contexts:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>ret</b></dt>
  <dd>The return value that the hooks system will return to the caller. The
      default is an integer `zero'. If and how a changed <b>ret</b> value
      changes the execution of the caller depends on the specific hook. See the
      hook documentation below for details.</dd>
  <dt id="hook_com"><a class="permalink" href="#hook_com"><b>hook_com</b></a></dt>
  <dd>An associated array which is used for bidirectional communication from the
      caller to hook functions. The used keys depend on the specific hook.</dd>
  <dt id="context"><a class="permalink" href="#context"><b>context</b></a></dt>
  <dd>The active context of the hook. Functions that wish to change this
      variable should make it local scope first.</dd>
  <dt id="vcs"><a class="permalink" href="#vcs"><b>vcs</b></a></dt>
  <dd>The current VCS after it was detected. The same values as in the
      enable/disable style are used. Available in all hooks except
      <b>start-up</b>.</dd>
</dl>
<p class="Pp">Finally, the full list of currently available hooks:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>start-up</b></dt>
  <dd>Called after starting <b>vcs_info</b> but before the VCS in this directory
      is determined. It can be used to deactivate <b>vcs_info</b> temporarily if
      necessary. When <b>ret</b> is set to <b>1</b>, <b>vcs_info</b> aborts and
      does nothing; when set to <b>2</b>, <b>vcs_info</b> sets up everything as
      if no version control were active and exits.</dd>
  <dt id="pre"><a class="permalink" href="#pre"><b>pre-get-data</b></a></dt>
  <dd>Same as <b>start-up</b> but after the VCS was detected.</dd>
  <dt id="gen"><a class="permalink" href="#gen"><b>gen-hg-bookmark-string</b></a></dt>
  <dd>Called in the Mercurial backend when a bookmark string is generated; the
      <b>get-revision</b> and <b>get-bookmarks</b> styles must be true.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This hook gets the names of the Mercurial bookmarks that
    <b>vcs_info</b> collected from `hg'.</p>
<p class="Pp">If a bookmark is active, the key
    <b>${hook_com[hg-active-bookmark]}</b> is set to its name. The key is
    otherwise unset.</p>
<p class="Pp">When setting <b>ret</b> to non-zero, the string in
    <b>${hook_com[hg-bookmark-string]}</b> will be used in the <b>%m</b> escape
    in <b>formats</b> and <b>actionformats</b> and will be available in the
    global <b>backend_misc</b> array as <b>${backend_misc[bookmarks]}</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="gen~2"><a class="permalink" href="#gen~2"><b>gen-applied-string</b></a></dt>
  <dd>Called in the <b>git</b> (with <b>stgit</b> or during rebase or merge),
      and <b>hg</b> (with <b>mq</b>) backends and in <b>quilt</b> support when
      the <b>applied-string</b> is generated; the <b>use-quilt</b> zstyle must
      be true for <b>quilt</b> (the <b>mq</b> and <b>stgit</b> backends are
      active by default).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This hook gets the names of all applied patches which
    <b>vcs_info</b> collected so far in the opposite order, which means that the
    first argument is the top-most patch and so forth.</p>
<p class="Pp">When setting <b>ret</b> to non-zero, the string in
    <b>${hook_com[applied-string]}</b> will be available as <b>%p</b> in the
    <b>patch-format</b> and <b>nopatch-format</b> styles. This hook is, in
    concert with <b>set-patch-format</b>, responsible for <b>%</b>-escaping that
    value for use in the prompt. (See the <b>Oddities</b> section.)</p>
</div>
<dl class="Bl-tag">
  <dt id="gen~3"><a class="permalink" href="#gen~3"><b>gen-unapplied-string</b></a></dt>
  <dd>Called in the <b>git</b> (with <b>stgit</b> or during rebase), and
      <b>hg</b> (with <b>mq</b>) backend and in <b>quilt</b> support when the
      <b>unapplied-string</b> is generated; the <b>get-unapplied</b> style must
      be true.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This hook gets the names of all unapplied patches which
    <b>vcs_info</b> collected so far in order, which means that the first
    argument is the patch next-in-line to be applied and so forth.</p>
<p class="Pp">When setting <b>ret</b> to non-zero, the string in
    <b>${hook_com[unapplied-string]}</b> will be available as <b>%u</b> in the
    <b>patch-format</b> and <b>nopatch-format</b> styles. This hook is, in
    concert with <b>set-patch-format</b>, responsible for <b>%</b>-escaping that
    value for use in the prompt. (See the <b>Oddities</b> section.)</p>
</div>
<dl class="Bl-tag">
  <dt id="gen~4"><a class="permalink" href="#gen~4"><b>gen-mqguards-string</b></a></dt>
  <dd>Called in the <b>hg</b> backend when <b>guards-string</b> is generated;
      the <b>get-mq</b> style must be true (default).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This hook gets the names of any active <b>mq</b> guards.</p>
<p class="Pp">When setting <b>ret</b> to non-zero, the string in
    <b>${hook_com[guards-string]}</b> will be used in the <b>%g</b> escape in
    the <b>patch-format</b> and <b>nopatch-format</b> styles.</p>
</div>
<dl class="Bl-tag">
  <dt id="no"><a class="permalink" href="#no"><b>no-vcs</b></a></dt>
  <dd>This hooks is called when no version control system was detected.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The `<b>hook_com</b>' parameter is not used.</p>
</div>
<dl class="Bl-tag">
  <dt id="post"><a class="permalink" href="#post"><b>post-backend</b></a></dt>
  <dd>Called as soon as the backend has finished collecting information.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The `<b>hook_com</b>' keys available are as for the
    <b>set-message</b> hook.</p>
</div>
<dl class="Bl-tag">
  <dt id="post~2"><a class="permalink" href="#post~2"><b>post-quilt</b></a></dt>
  <dd>Called after the <b>quilt</b> support is done. The following information
      is passed as arguments to the hook: 1. the quilt-support mode (`addon' or
      `standalone'); 2. the directory that contains the patch series; 3. the
      directory that holds quilt's status information (the `.pc' directory) or
      the string <b>&quot;-nopc-&quot;</b> if that directory wasn't found.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The `hook_com' parameter is not used.</p>
</div>
<dl class="Bl-tag">
  <dt id="set"><a class="permalink" href="#set"><b>set-branch-format</b></a></dt>
  <dd>Called before `<b>branchformat</b>' is set. The only argument to the hook
      is the format that is configured at this point.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The `<b>hook_com</b>' keys considered are `<b>branch</b>' and
    `<b>revision</b>'. They are set to the values figured out so far by
    <b>vcs_info</b> and any change will be used directly when the actual
    replacement is done.</p>
<p class="Pp">If <b>ret</b> is set to non-zero, the string in
    <b>${hook_com[branch-replace]}</b> will be used unchanged as the `<b>%b</b>'
    replacement in the variables set by <b>vcs_info</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="set~2"><a class="permalink" href="#set~2"><b>set-hgrev-format</b></a></dt>
  <dd>Called before a `<b>hgrevformat</b>' is set. The only argument to the hook
      is the format that is configured at this point.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The `<b>hook_com</b>' keys considered are `<b>hash</b>' and
    `<b>localrev</b>'. They are set to the values figured out so far by
    <b>vcs_info</b> and any change will be used directly when the actual
    replacement is done.</p>
<p class="Pp">If <b>ret</b> is set to non-zero, the string in
    <b>${hook_com[rev-replace]}</b> will be used unchanged as the `<b>%i</b>'
    replacement in the variables set by <b>vcs_info</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="pre~2"><a class="permalink" href="#pre~2"><b>pre-addon-quilt</b></a></dt>
  <dd>This hook is used when <b>vcs_info</b>'s quilt functionality is active in
      &quot;addon&quot; mode (quilt used on top of a real version control
      system). It is activated right before any quilt specific action is
    taken.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Setting the `<b>ret</b>' variable in this hook to a non-zero value
    avoids any quilt specific actions from being run at all.</p>
</div>
<dl class="Bl-tag">
  <dt id="set~3"><a class="permalink" href="#set~3"><b>set-patch-format</b></a></dt>
  <dd>This hook is used to control some of the possible expansions in
      <b>patch-format</b> and <b>nopatch-format</b> styles with patch queue
      systems such as quilt, mqueue and the like.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This hook is used in the <b>git</b>, <b>hg</b> and <b>quilt</b>
    backends.</p>
<p class="Pp">The hook allows the control of the <b>%p</b>
    (<b>${hook_com[applied]}</b>) and <b>%u</b> (<b>${hook_com[unapplied]}</b>)
    expansion in all backends that use the hook. With the mercurial backend, the
    <b>%g</b> (<b>${hook_com[guards]}</b>) expansion is controllable in addition
    to that.</p>
<p class="Pp">If <b>ret</b> is set to non-zero, the string in
    <b>${hook_com[patch-replace]}</b> will be used unchanged instead of an
    expanded format from <b>patch-format</b> or <b>nopatch-format</b>.</p>
<p class="Pp">This hook is, in concert with the <b>gen-applied-string</b> or
    <b>gen-unapplied-string</b> hooks if they are defined, responsible for
    <b>%</b>-escaping the final <b>patch-format</b> value for use in the prompt.
    (See the <b>Oddities</b> section.)</p>
</div>
<dl class="Bl-tag">
  <dt id="set~4"><a class="permalink" href="#set~4"><b>set-message</b></a></dt>
  <dd>Called each time before a `<b>vcs_info_msg_</b><i>N</i><b>_</b>' message
      is set. It takes two arguments; the first being the `<i>N</i>' in the
      message variable name, the second is the currently configured
      <b>formats</b> or <b>actionformats</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">There are a number of `<b>hook_com</b>' keys, that are used here:
    `<b>action</b>', `<b>branch</b>', `<b>base</b>', `<b>base-name</b>',
    `<b>subdir</b>', `<b>staged</b>', `<b>unstaged</b>', `<b>revision</b>',
    `<b>misc</b>', `<b>vcs</b>' and one `<b>miscN</b>' entry for each
    backend-specific data field (<b>N</b> starting at zero). They are set to the
    values figured out so far by <b>vcs_info</b> and any change will be used
    directly when the actual replacement is done.</p>
<p class="Pp">Since this hook is triggered multiple times (once for each
    configured <b>formats</b> or <b>actionformats</b>), each of the
    `<b>hook_com</b>' keys mentioned above (except for the <b>miscN</b> entries)
    has an `<b>_orig</b>' counterpart, so even if you changed a value to your
    liking you can still get the original value in the next run. Changing the
    `<b>_orig</b>' values is probably not a good idea.</p>
<p class="Pp">If <b>ret</b> is set to non-zero, the string in
    <b>${hook_com[message]}</b> will be used unchanged as the message by
    <b>vcs_info</b>.</p>
</div>
<p class="Pp">If all of this sounds rather confusing, take a look at the
    <b>Examples</b> section below and also in the <b>Misc/vcs_info-examples</b>
    file in the Zsh source. They contain some explanatory code.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Examples"><a class="permalink" href="#Examples">Examples</a></h2>
<p class="Pp">Don't use <b>vcs_info</b> at all (even though it's in your
    prompt):</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' enable NONE</b></pre>
</div>
<p class="Pp">Disable the backends for <b>bzr</b> and <b>svk</b>:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' disable bzr svk</b></pre>
</div>
<p class="Pp">Disable everything <i>but</i> <b>bzr</b> and <b>svk</b>:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*' enable bzr svk</b></pre>
</div>
<p class="Pp">Provide a special formats for <b>git</b>:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:git:*' formats       ' GIT, BABY! [%b]'</b>
<b>zstyle ':vcs_info:git:*' actionformats ' GIT ACTION! [%b|%a]'</b></pre>
</div>
<p class="Pp">All <b>%x</b> expansion in all sorts of formats (<b>formats</b>,
    <b>actionformats</b>, <b>branchformat</b>, you name it) are done using the
    `<b>zformat</b>' builtin from the `<b>zsh/zutil</b>' module. That means you
    can do everything with these <b>%x</b> items what zformat supports. In
    particular, if you want something that is really long to have a fixed width,
    like a hash in a mercurial branchformat, you can do this: <b>%12.12i</b>.
    That'll shrink the 40 character hash to its 12 leading characters. The form
    is actually `<b>%</b><i>min</i><b>.</b><i>max</i><b>x</b>'. More is
    possible. See the section `The zsh/zutil Module' in <i>zshmodules</i>(1) for
    details.</p>
<p class="Pp">Use the quicker <b>bzr</b> backend</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:bzr:*' use-simple true</b></pre>
</div>
<p class="Pp">If you do use <b>use-simple</b>, please report if it does
    `the-right-thing[tm]'.</p>
<p class="Pp">Display the revision number in yellow for <b>bzr</b> and
    <b>svn</b>:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:(svn|bzr):*' \ </b>
<b>       branchformat '%b%{'${fg[yellow]}'%}:%r'</b></pre>
</div>
<p class="Pp">If you want colors, make sure you enclose the color codes in
    <b>%{</b><i>...</i><b>%}</b> if you want to use the string provided by
    <b>vcs_info</b> in prompts.</p>
<p class="Pp">Here is how to print the VCS information as a command (not in a
    prompt):</p>
<div class="Bd-indent">
<pre><b>alias vcsi='vcs_info command; vcs_info_lastmsg'</b></pre>
</div>
<p class="Pp">This way, you can even define different formats for output via
    <b>vcs_info_lastmsg</b> in the '<b>:vcs_info:*:command:*</b>' namespace.</p>
<p class="Pp">Now as promised, some code that uses hooks: say, you'd like to
    replace the string `svn' by `subversion' in <b>vcs_info</b>'s <b>%s</b>
    <b>formats</b> replacement.</p>
<p class="Pp">First, we will tell <b>vcs_info</b> to call a function when
    populating the message variables with the gathered information:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*+set-message:*' hooks svn2subversion</b></pre>
</div>
<p class="Pp">Nothing happens. Which is reasonable, since we didn't define the
    actual function yet. To see what the hooks subsystem is trying to do, enable
    the `<b>debug</b>' style:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*+*:*' debug true</b></pre>
</div>
<p class="Pp">That should give you an idea what is going on. Specifically, the
    function that we are looking for is `<b>+vi-svn2subversion</b>'. Note, the
    `<b>+vi-</b>' prefix. So, everything is in order, just as documented. When
    you are done checking out the debugging output, disable it again:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:*+*:*' debug false</b></pre>
</div>
<p class="Pp">Now, let's define the function:</p>
<div class="Bd-indent">
<pre><b></b>
<b>function +vi-svn2subversion() {</b>
<b>    [[ ${hook_com[vcs_orig]} == svn ]] &amp;&amp; hook_com[vcs]=subversion</b>
<b>}</b></pre>
</div>
<p class="Pp">Simple enough. And it could have even been simpler, if only we had
    registered our function in a less generic context. If we do it only in the
    `<b>svn</b>' backend's context, we don't need to test which the active
    backend is:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:svn+set-message:*' hooks svn2subversion</b></pre>
</div>
<div class="Bd-indent">
<pre><b></b>
<b>function +vi-svn2subversion() {</b>
<b>    hook_com[vcs]=subversion</b>
<b>}</b></pre>
</div>
<p class="Pp">And finally a little more elaborate example, that uses a hook to
    create a customised bookmark string for the <b>hg</b> backend.</p>
<p class="Pp">Again, we start off by registering a function:</p>
<div class="Bd-indent">
<pre><b>zstyle ':vcs_info:hg+gen-hg-bookmark-string:*' hooks hgbookmarks</b></pre>
</div>
<p class="Pp">And then we define the `<b>+vi-hgbookmarks</b>' function:</p>
<div class="Bd-indent">
<pre><b></b>
<b>function +vi-hgbookmarks() {</b>
<b>    # The default is to connect all bookmark names by</b>
<b>    # commas. This mixes things up a little.</b>
<b>    # Imagine, there's one type of bookmarks that is</b>
<b>    # special to you. Say, because it's *your* work.</b>
<b>    # Those bookmarks look always like this: &quot;sh/*&quot;</b>
<b>    # (because your initials are sh, for example).</b>
<b>    # This makes the bookmarks string use only those</b>
<b>    # bookmarks. If there's more than one, it</b>
<b>    # concatenates them using commas.</b>
<b>    # The bookmarks returned by `hg' are available in</b>
<b>    # the function's positional parameters.</b>
<b>    local s=&quot;${(Mj:,:)@:#sh/*}&quot;</b>
<b>    # Now, the communication with the code that calls</b>
<b>    # the hook functions is done via the hook_com[]</b>
<b>    # hash. The key at which the `gen-hg-bookmark-string'</b>
<b>    # hook looks is `hg-bookmark-string'. So:</b>
<b>    hook_com[hg-bookmark-string]=$s</b>
<b>    # And to signal that we want to use the string we</b>
<b>    # just generated, set the special variable `ret' to</b>
<b>    # something other than the default zero:</b>
<b>    ret=1</b>
<b>    return 0</b>
<b>}</b></pre>
</div>
<p class="Pp">Some longer examples and code snippets which might be useful are
    available in the examples file located at Misc/vcs_info-examples in the Zsh
    source directory.</p>
<p class="Pp">This concludes our guided tour through zsh's <b>vcs_info</b>.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="PROMPT_THEMES"><a class="permalink" href="#PROMPT_THEMES">PROMPT
  THEMES</a></h1>
<section class="Ss">
<h2 class="Ss" id="Installation~2"><a class="permalink" href="#Installation~2">Installation</a></h2>
<p class="Pp">You should make sure all the functions from the
    <b>Functions/Prompts</b> directory of the source distribution are available;
    they all begin with the string `<b>prompt_</b>' except for the special
    function`<b>promptinit</b>'. You also need the `<b>colors</b>' and
    `<b>add-zsh-hook</b>' functions from <b>Functions/Misc</b>. All these
    functions may already be installed on your system; if not, you will need to
    find them and copy them. The directory should appear as one of the elements
    of the <b>fpath</b> array (this should already be the case if they were
    installed), and at least the function <b>promptinit</b> should be
    autoloaded; it will autoload the rest. Finally, to initialize the use of the
    system you need to call the <b>promptinit</b> function. The following code
    in your <b>.zshrc</b> will arrange for this; assume the functions are stored
    in the directory <b>~/myfns</b>:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>fpath=(~/myfns $fpath)</b>
<b>autoload -U promptinit</b>
<b>promptinit</b></pre>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Theme_Selection"><a class="permalink" href="#Theme_Selection">Theme
  Selection</a></h2>
<p class="Pp">Use the <b>prompt</b> command to select your preferred theme. This
    command may be added to your <b>.zshrc</b> following the call to
    <b>promptinit</b> in order to start zsh with a theme already selected.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>prompt</b> [ <b>-c</b> | <b>-l</b> ]</dt>
  <dd></dd>
  <dt><b>prompt</b> [ <b>-p</b> | <b>-h</b> ] [ <i>theme</i> ... ]</dt>
  <dd></dd>
  <dt><b>prompt</b> [ <b>-s</b> ] <i>theme</i> [ <i>arg</i> ... ]</dt>
  <dd>Set or examine the prompt theme. With no options and a <i>theme</i>
      argument, the theme with that name is set as the current theme. The
      available themes are determined at run time; use the <b>-l</b> option to
      see a list. The special <i>theme</i> `<b>random</b>' selects at random one
      of the available themes and sets your prompt to that.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">In some cases the <i>theme</i> may be modified by one or more
    arguments, which should be given after the theme name. See the help for each
    theme for descriptions of these arguments.</p>
<p class="Pp">Options are:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="c"><a class="permalink" href="#c"><b>-c</b></a></dt>
  <dd>Show the currently selected theme and its parameters, if any.</dd>
  <dt id="l"><a class="permalink" href="#l"><b>-l</b></a></dt>
  <dd>List all available prompt themes.</dd>
  <dt id="p~3"><a class="permalink" href="#p~3"><b>-p</b></a></dt>
  <dd>Preview the theme named by <i>theme</i>, or all themes if no <i>theme</i>
      is given.</dd>
  <dt id="h"><a class="permalink" href="#h"><b>-h</b></a></dt>
  <dd>Show help for the theme named by <i>theme</i>, or for the <b>prompt</b>
      function if no <i>theme</i> is given.</dd>
  <dt id="s~2"><a class="permalink" href="#s~2"><b>-s</b></a></dt>
  <dd>Set <i>theme</i> as the current theme and save state.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="prompt_"><a class="permalink" href="#prompt_"><b>prompt_</b><i>theme</i><b>_setup</b></a></dt>
  <dd>Each available <i>theme</i> has a setup function which is called by the
      <b>prompt</b> function to install that theme. This function may define
      other functions as necessary to maintain the prompt, including functions
      used to preview the prompt or provide help for its use. You should not
      normally call a theme's setup function directly.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Utility_Themes"><a class="permalink" href="#Utility_Themes">Utility
  Themes</a></h2>
<dl class="Bl-tag">
  <dt><b>prompt off</b></dt>
  <dd>The theme `<b>off</b>' sets all the prompt variables to minimal values
      with no special effects.</dd>
  <dt id="prompt"><a class="permalink" href="#prompt"><b>prompt
    default</b></a></dt>
  <dd>The theme `<b>default</b>' sets all prompt variables to the same state as
      if an interactive zsh was started with no initialization files.</dd>
  <dt id="prompt~2"><a class="permalink" href="#prompt~2"><b>prompt
    restore</b></a></dt>
  <dd>The special theme `<b>restore</b>' erases all theme settings and sets
      prompt variables to their state before the first time the `<b>prompt</b>'
      function was run, provided each theme has properly defined its cleanup
      (see below).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Note that you can undo `<b>prompt off</b>' and `<b>prompt
    default</b>' with `<b>prompt restore</b>', but a second restore does not
    undo the first.</p>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Writing_Themes"><a class="permalink" href="#Writing_Themes">Writing
  Themes</a></h2>
<p class="Pp">The first step for adding your own theme is to choose a name for
    it, and create a file `<b>prompt_</b><i>name</i><b>_setup</b><i>' in a
    directory in your</i> <i></i><b>fpath</b><i>, such as </i><b>~/myfns</b><i>
    in the example above. The file should</i> <i>at minimum contain assignments
    for the prompt variables that your</i> <i>theme wishes to modify. By
    convention, themes use </i><b>PS1</b><i>, </i><b>PS2</b><i>,</i>
    <i></i><b>RPS1</b><i>, etc., rather than the longer </i><b>PROMPT</b><i> and
    </i><b>RPROMPT</b><i>.</i></p>
<p class="Pp">The file is autoloaded as a function in the current shell context,
    so it may contain any necessary commands to customize your theme, including
    defining additional functions. To make some complex tasks easier, your setup
    function may also do any of the following:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt>Assign <b>prompt_opts</b></dt>
  <dd>The array <b>prompt_opts</b> may be assigned any of
      <b>&quot;bang&quot;</b>, <b>&quot;cr&quot;</b>,
      <b>&quot;percent&quot;</b>, <b>&quot;sp&quot;</b>, and/or
      <b>&quot;subst&quot;</b> as values. The corresponding setopts
      (<b>promptbang</b>, etc.) are turned on, all other prompt-related options
      are turned off. The <b>prompt_opts</b> array preserves setopts even beyond
      the scope of <b>localoptions</b>, should your function need that.</dd>
  <dt id="Modify"><a class="permalink" href="#Modify">Modify precmd and
    preexec</a></dt>
  <dd>Use of <b>add-zsh-hook</b> is recommended. The <b>precmd</b> and
      <b>preexec</b> hooks are automatically adjusted if the prompt theme
      changes or is disabled.</dd>
  <dt id="Declare"><a class="permalink" href="#Declare">Declare cleanup</a></dt>
  <dd>If your function makes any other changes that should be undone when the
      theme is disabled, your setup function may call</dd>
</dl>
<div class="Bd-indent">
<pre><b>prompt_cleanup </b><i>command</i><b></b><i></i></pre>
</div>
where <i>command</i> should be suitably quoted. If your theme is ever disabled
  or replaced by another, <i>command</i> is executed with <b>eval</b>. You may
  declare more than one such cleanup hook.
<dl class="Bl-tag">
  <dt id="Define"><a class="permalink" href="#Define">Define preview</a></dt>
  <dd>Define or autoload a function <b>prompt_</b><i>name</i><b>_preview</b><i>
      to display</i> <i>a simulated version of your prompt. A simple default
      previewer is</i> <i>defined by </i><b>promptinit</b><i> for themes that do
      not define their own.</i> <i>This preview function is called by
      `</i><b>prompt -p</b><i>'.</i></dd>
  <dt id="Provide"><a class="permalink" href="#Provide">Provide help</a></dt>
  <dd>Define or autoload a function <b>prompt_</b><i>name</i><b>_help</b><i> to
      display</i> <i>documentation or help text for your theme.</i> <i>This help
      function is called by `</i><b>prompt -h</b><i>'.</i></dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ZLE_FUNCTIONS"><a class="permalink" href="#ZLE_FUNCTIONS">ZLE
  FUNCTIONS</a></h1>
<section class="Ss">
<h2 class="Ss" id="Widgets"><a class="permalink" href="#Widgets">Widgets</a></h2>
<p class="Pp">These functions all implement user-defined ZLE widgets (see
    <i>zshzle</i>(1)) which can be bound to keystrokes in interactive shells. To
    use them, your <b>.zshrc</b> should contain lines of the form</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload </b><i>function</i><b></b>
<b>zle -N </b><i>function</i><b></b><i></i></pre>
</div>
<p class="Pp">followed by an appropriate <b>bindkey</b> command to associate the
    function with a key sequence. Suggested bindings are described below.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt>bash-style word functions</dt>
  <dd>If you are looking for functions to implement moving over and editing
      words in the manner of bash, where only alphanumeric characters are
      considered word characters, you can use the functions described in the
      next section. The following is sufficient:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -U select-word-style</b>
<b>select-word-style bash</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt><b>forward-word-match</b>, <b>backward-word-match</b></dt>
  <dd></dd>
  <dt><b>kill-word-match</b>, <b>backward-kill-word-match</b></dt>
  <dd></dd>
  <dt><b>transpose-words-match</b>, <b>capitalize-word-match</b></dt>
  <dd></dd>
  <dt><b>up-case-word-match</b>, <b>down-case-word-match</b></dt>
  <dd></dd>
  <dt><b>delete-whole-word-match</b>, <b>select-word-match</b></dt>
  <dd></dd>
  <dt><b>select-word-style</b>, <b>match-word-context</b>,
    <b>match-words-by-style</b></dt>
  <dd>The first eight `<b>-match</b>' functions are drop-in replacements for the
      builtin widgets without the suffix. By default they behave in a similar
      way. However, by the use of styles and the function
      <b>select-word-style</b>, the way words are matched can be altered.
      <b>select-word-match</b> is intended to be used as a text object in vi
      mode but with custom word styles. For comparison, the widgets described in
      <i>zshzle</i>(1) under Text Objects use fixed definitions of words,
      compatible with the <b>vim</b> editor.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The simplest way of configuring the functions is to use
    <b>select-word-style</b>, which can either be called as a normal function
    with the appropriate argument, or invoked as a user-defined widget that will
    prompt for the first character of the word style to be used. The first time
    it is invoked, the first eight <b>-match</b> functions will automatically
    replace the builtin versions, so they do not need to be loaded
  explicitly.</p>
<p class="Pp">The word styles available are as follows. Only the first character
    is examined.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>bash</b></dt>
  <dd>Word characters are alphanumeric characters only.</dd>
  <dt id="normal"><a class="permalink" href="#normal"><b>normal</b></a></dt>
  <dd>As in normal shell operation: word characters are alphanumeric characters
      plus any characters present in the string given by the parameter
      <b>$WORDCHARS</b>.</dd>
  <dt id="shell"><a class="permalink" href="#shell"><b>shell</b></a></dt>
  <dd>Words are complete shell command arguments, possibly including complete
      quoted strings, or any tokens special to the shell.</dd>
  <dt id="whitespace"><a class="permalink" href="#whitespace"><b>whitespace</b></a></dt>
  <dd>Words are any set of characters delimited by whitespace.</dd>
  <dt id="default~2"><a class="permalink" href="#default~2"><b>default</b></a></dt>
  <dd>Restore the default settings; this is usually the same as
    `<b>normal</b>'.</dd>
</dl>
<p class="Pp">All but `<b>default</b>' can be input as an upper case character,
    which has the same effect but with subword matching turned on. In this case,
    words with upper case characters are treated specially: each separate run of
    upper case characters, or an upper case character followed by any number of
    other characters, is considered a word. The style <b>subword-range</b> can
    supply an alternative character range to the default `<b>[:upper:]</b>'; the
    value of the style is treated as the contents of a
    `<b>[</b><i>...</i><b>]</b>' pattern (note that the outer brackets should
    not be supplied, only those surrounding named ranges).</p>
<p class="Pp">More control can be obtained using the <b>zstyle</b> command, as
    described in <i>zshmodules</i>(1). Each style is looked up in the context
    <b>:zle:</b><i>widget</i> where <i>widget</i> is the name of the
    user-defined widget, not the name of the function implementing it, so in the
    case of the definitions supplied by <b>select-word-style</b> the appropriate
    contexts are <b>:zle:forward-word</b>, and so on. The function
    <b>select-word-style</b> itself always defines styles for the context
    `<b>:zle:*</b>' which can be overridden by more specific (longer) patterns
    as well as explicit contexts.</p>
<p class="Pp">The style <b>word-style</b> specifies the rules to use. This may
    have the following values.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>normal</b></dt>
  <dd>Use the standard shell rules, i.e. alphanumerics and <b>$WORDCHARS</b>,
      unless overridden by the styles <b>word-chars</b> or
    <b>word-class</b>.</dd>
  <dt id="specified"><a class="permalink" href="#specified"><b>specified</b></a></dt>
  <dd>Similar to <b>normal</b>, but <i>only</i> the specified characters, and
      not also alphanumerics, are considered word characters.</dd>
  <dt id="unspecified"><a class="permalink" href="#unspecified"><b>unspecified</b></a></dt>
  <dd>The negation of specified. The given characters are those which will
      <i>not</i> be considered part of a word.</dd>
  <dt id="shell~2"><a class="permalink" href="#shell~2"><b>shell</b></a></dt>
  <dd>Words are obtained by using the syntactic rules for generating shell
      command arguments. In addition, special tokens which are never command
      arguments such as `<b>()</b>' are also treated as words.</dd>
  <dt id="whitespace~2"><a class="permalink" href="#whitespace~2"><b>whitespace</b></a></dt>
  <dd>Words are whitespace-delimited strings of characters.</dd>
</dl>
<p class="Pp">The first three of those rules usually use <b>$WORDCHARS</b>, but
    the value in the parameter can be overridden by the style <b>word-chars</b>,
    which works in exactly the same way as <b>$WORDCHARS</b>. In addition, the
    style <b>word-class</b> uses character class syntax to group characters and
    takes precedence over <b>word-chars</b> if both are set. The
    <b>word-class</b> style does not include the surrounding brackets of the
    character class; for example, `<b>-:[:alnum:]</b>' is a valid
    <b>word-class</b> to include all alphanumerics plus the characters
    `<b>-</b>' and `<b>:</b>'. Be careful including `<b>]</b>', `<b>^</b>' and
    `<b>-</b>' as these are special inside character classes.</p>
<p class="Pp"><b>word-style</b> may also have `<b>-subword</b>' appended to its
    value to turn on subword matching, as described above.</p>
<p class="Pp">The style <b>skip-chars</b> is mostly useful for
    <b>transpose-words</b> and similar functions. If set, it gives a count of
    characters starting at the cursor position which will not be considered part
    of the word and are treated as space, regardless of what they actually are.
    For example, if</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':zle:transpose-words' skip-chars 1</b></pre>
</div>
<p class="Pp">has been set, and <b>transpose-words-match</b> is called with the
    cursor on the <i>X</i> of <b>foo</b><i>X</i><b>bar</b>, where <i>X</i> can
    be any character, then the resulting expression is
    <b>bar</b><i>X</i><b>foo</b>.</p>
<p class="Pp">Finer grained control can be obtained by setting the style
    <b>word-context</b> to an array of pairs of entries. Each pair of entries
    consists of a <i>pattern</i> and a <i>subcontext</i>. The shell argument the
    cursor is on is matched against each <i>pattern</i> in turn until one
    matches; if it does, the context is extended by a colon and the
    corresponding <i>subcontext</i>. Note that the test is made against the
    original word on the line, with no stripping of quotes. Special handling is
    done between words: the current context is examined and if it contains the
    string <b>between</b> the word is set to a single space; else if it is
    contains the string <b>back</b>, the word before the cursor is considered,
    else the word after cursor is considered. Some examples are given below.</p>
<p class="Pp">The style <b>skip-whitespace-first</b> is only used with the
    <b>forward-word</b> widget. If it is set to true, then <b>forward-word</b>
    skips any non-word-characters, followed by any non-word-characters: this is
    similar to the behaviour of other word-orientated widgets, and also that
    used by other editors, however it differs from the standard zsh behaviour.
    When using <b>select-word-style</b> the widget is set in the context
    <b>:zle:*</b> to <b>true</b> if the word style is <b>bash</b> and
    <b>false</b> otherwise. It may be overridden by setting it in the more
    specific context <b>:zle:forward-word*</b>.</p>
<p class="Pp">It is possible to create widgets with specific behaviour by
    defining a new widget implemented by the appropriate generic function, then
    setting a style for the context of the specific widget. For example, the
    following defines a widget <b>backward-kill-space-word</b> using
    <b>backward-kill-word-match</b>, the generic widget implementing
    <b>backward-kill-word</b> behaviour, and ensures that the new widget always
    implements space-delimited behaviour.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N backward-kill-space-word backward-kill-word-match</b>
<b>zstyle :zle:backward-kill-space-word word-style space</b></pre>
</div>
<p class="Pp">The widget <b>backward-kill-space-word</b> can now be bound to a
    key.</p>
<p class="Pp">Here are some further examples of use of the styles, actually
    taken from the simplified interface in <b>select-word-style</b>:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':zle:*' word-style standard</b>
<b>zstyle ':zle:*' word-chars ''</b></pre>
</div>
<p class="Pp">Implements bash-style word handling for all widgets, i.e. only
    alphanumerics are word characters; equivalent to setting the parameter
    <b>WORDCHARS</b> empty for the given context.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>style ':zle:*kill*' word-style space</b></pre>
</div>
<p class="Pp">Uses space-delimited words for widgets with the word `kill' in the
    name. Neither of the styles <b>word-chars</b> nor <b>word-class</b> is used
    in this case.</p>
<p class="Pp">Here are some examples of use of the <b>word-context</b> style to
    extend the context.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':zle:*' word-context \ </b>
<b>       &quot;*/*&quot; filename &quot;[[:space:]]&quot; whitespace</b>
<b>zstyle ':zle:transpose-words:whitespace' word-style shell</b>
<b>zstyle ':zle:transpose-words:filename' word-style normal</b>
<b>zstyle ':zle:transpose-words:filename' word-chars ''</b></pre>
</div>
<p class="Pp">This provides two different ways of using <b>transpose-words</b>
    depending on whether the cursor is on whitespace between words or on a
    filename, here any word containing a <b>/</b>. On whitespace, complete
    arguments as defined by standard shell rules will be transposed. In a
    filename, only alphanumerics will be transposed. Elsewhere, words will be
    transposed using the default style for <b>:zle:transpose-words</b>.</p>
<p class="Pp">The word matching and all the handling of <b>zstyle</b> settings
    is actually implemented by the function <b>match-words-by-style</b>. This
    can be used to create new user-defined widgets. The calling function should
    set the local parameter <b>curcontext</b> to <b>:zle:</b><i>widget</i>,
    create the local parameter <b>matched_words</b> and call
    <b>match-words-by-style</b> with no arguments. On return,
    <b>matched_words</b> will be set to an array with the elements: (1) the
    start of the line (2) the word before the cursor (3) any non-word characters
    between that word and the cursor (4) any non-word character at the cursor
    position plus any remaining non-word characters before the next word,
    including all characters specified by the <b>skip-chars</b> style, (5) the
    word at or following the cursor (6) any non-word characters following that
    word (7) the remainder of the line. Any of the elements may be an empty
    string; the calling function should test for this to decide whether it can
    perform its function.</p>
<p class="Pp">If the variable <b>matched_words</b> is defined by the caller to
    <b>match-words-by-style</b> as an associative array (<b>local -A</b>
    <b>matched_words</b>), then the seven values given above should be retrieved
    from it as elements named <b>start</b>, <b>word-before-cursor</b>,
    <b>ws-before-cursor</b>, <b>ws-after-cursor</b>, <b>word-after-cursor</b>,
    <b>ws-after-word</b>, and <b>end</b>. In addition the element
    <b>is-word-start</b> is 1 if the cursor is on the start of a word or
    subword, or on white space before it (the cases can be distinguished by
    testing the <b>ws-after-cursor</b> element) and 0 otherwise. This form is
    recommended for future compatibility.</p>
<p class="Pp">It is possible to pass options with arguments to
    <b>match-words-by-style</b> to override the use of styles. The options
  are:</p>
<dl class="Bl-tag">
  <dt id="w"><a class="permalink" href="#w"><b>-w</b></a></dt>
  <dd><i>word-style</i></dd>
  <dt id="s~3"><a class="permalink" href="#s~3"><b>-s</b></a></dt>
  <dd><i>skip-chars</i></dd>
  <dt id="c~2"><a class="permalink" href="#c~2"><b>-c</b></a></dt>
  <dd><i>word-class</i></dd>
  <dt id="C"><a class="permalink" href="#C"><b>-C</b></a></dt>
  <dd><i>word-chars</i></dd>
  <dt id="r~2"><a class="permalink" href="#r~2"><b>-r</b></a></dt>
  <dd><i>subword-range</i></dd>
</dl>
<p class="Pp">For example, <b>match-words-by-style -w shell -c 0</b> may be used
    to extract the command argument around the cursor.</p>
<p class="Pp">The <b>word-context</b> style is implemented by the function
    <b>match-word-context</b>. This should not usually need to be called
    directly.</p>
</div>
<dl class="Bl-tag">
  <dt id="bracketed"><a class="permalink" href="#bracketed"><b>bracketed-paste-magic</b></a></dt>
  <dd>The <b>bracketed-paste</b> widget (see subsection Miscellaneous in
      <i>zshzle</i>(1)) inserts pasted text literally into the editor buffer
      rather than interpret it as keystrokes. This disables some common usages
      where the self-insert widget is replaced in order to accomplish some extra
      processing. An example is the contributed <b>url-quote-magic</b> widget
      described below.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The <b>bracketed-paste-magic</b> widget is meant to replace
    <b>bracketed-paste</b> with a wrapper that re-enables these self-insert
    actions, and other actions as selected by zstyles. Therefore this widget is
    installed with</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -Uz bracketed-paste-magic</b>
<b>zle -N bracketed-paste bracketed-paste-magic</b></pre>
</div>
<p class="Pp">Other than enabling some widget processing,
    <b>bracketed-paste-magic</b> attempts to replicate <b>bracketed-paste</b> as
    faithfully as possible.</p>
<p class="Pp">The following zstyles may be set to control processing of pasted
    text. All are looked up in the context `<b>:bracketed-paste-magic</b>'.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>active-widgets</b></dt>
  <dd>A list of patterns matching widget names that should be activated during
      the paste. All other key sequences are processed as self-insert-unmeta.
      The default is `<b>self-*</b>' so any user-defined widgets named with that
      prefix are active along with the builtin self-insert.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If this style is not set (explicitly deleted) or set to an empty
    value, no widgets are active and the pasted text is inserted literally. If
    the value includes `<b>undefined-key</b>', any unknown sequences are
    discarded from the pasted text.</p>
</div>
<dl class="Bl-tag">
  <dt id="inactive"><a class="permalink" href="#inactive"><b>inactive-keys</b></a></dt>
  <dd>The inverse of <b>active-widgets</b>, a list of key sequences that always
      use <b>self-insert-unmeta</b> even when bound to an active widget. Note
      that this is a list of literal key sequences, not patterns.</dd>
  <dt id="paste"><a class="permalink" href="#paste"><b>paste-init</b></a></dt>
  <dd>A list of function names, called in widget context (but not as widgets).
      The functions are called in order until one of them returns a non-zero
      status. The parameter `<b>PASTED</b>' contains the initial state of the
      pasted text. All other ZLE parameters such as `<b>BUFFER</b>' have their
      normal values and side-effects, and full history is available, so for
      example <b>paste-init</b> functions may move words from <b>BUFFER</b> into
      <b>PASTED</b> to make those words visible to the
    <b>active-widgets</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">A non-zero return from a <b>paste-init</b> function does
    <i>not</i> prevent the paste itself from proceeding.</p>
<p class="Pp">Loading <b>bracketed-paste-magic</b> defines
    <b>backward-extend-paste</b>, a helper function for use in
    <b>paste-init</b>.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :bracketed-paste-magic paste-init \ </b>
<b>       backward-extend-paste</b></pre>
</div>
<p class="Pp">When a paste would insert into the middle of a word or append text
    to a word already on the line, <b>backward-extend-paste</b> moves the prefix
    from <b>LBUFFER</b> into <b>PASTED</b> so that the <b>active-widgets</b> see
    the full word so far. This may be useful with <b>url-quote-magic</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="paste~2"><a class="permalink" href="#paste~2"><b>paste-finish</b></a></dt>
  <dd>Another list of function names called in order until one returns non-zero.
      These functions are called <i>after</i> the pasted text has been processed
      by the <b>active-widgets</b>, but <i>before</i> it is inserted into
      `<b>BUFFER</b>'. ZLE parameters have their normal values and
    side-effects.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">A non-zero return from a <b>paste-finish</b> function does
    <i>not</i> prevent the paste itself from proceeding.</p>
<p class="Pp">Loading <b>bracketed-paste-magic</b> also defines
    <b>quote-paste</b>, a helper function for use in <b>paste-finish</b>.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :bracketed-paste-magic paste-finish \ </b>
<b>       quote-paste</b>
<b>zstyle :bracketed-paste-magic:finish quote-style \ </b>
<b>       qqq</b></pre>
</div>
<p class="Pp">When the pasted text is inserted into <b>BUFFER</b>, it is quoted
    per the <b>quote-style</b> value. To forcibly turn off the built-in numeric
    prefix quoting of <b>bracketed-paste</b>, use:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :bracketed-paste-magic:finish quote-style \ </b>
<b>       none</b></pre>
</div>
</div>
<p class="Pp"><i>Important:</i> During <b>active-widgets</b> processing of the
    paste (after <b>paste-init</b> and before <b>paste-finish</b>),
    <b>BUFFER</b> starts empty and history is restricted, so cursor motions,
    etc., may not pass outside of the pasted content. Text assigned to
    <b>BUFFER</b> by the active widgets is copied back into <b>PASTED</b> before
    <b>paste-finish</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="copy"><a class="permalink" href="#copy"><b>copy-earlier-word</b></a></dt>
  <dd>This widget works like a combination of <b>insert-last-word</b> and
      <b>copy-prev-shell-word</b>. Repeated invocations of the widget retrieve
      earlier words on the relevant history line. With a numeric argument
      <i>N</i>, insert the <i>N</i>th word from the history line; <i>N</i> may
      be negative to count from the end of the line.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If <b>insert-last-word</b> has been used to retrieve the last word
    on a previous history line, repeated invocations will replace that word with
    earlier words from the same line.</p>
<p class="Pp">Otherwise, the widget applies to words on the line currently being
    edited. The <b>widget</b> style can be set to the name of another widget
    that should be called to retrieve words. This widget must accept the same
    three arguments as <b>insert-last-word</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="cycle"><a class="permalink" href="#cycle"><b>cycle-completion-positions</b></a></dt>
  <dd>After inserting an unambiguous string into the command line, the new
      function based completion system may know about multiple places in this
      string where characters are missing or differ from at least one of the
      possible matches. It will then place the cursor on the position it
      considers to be the most interesting one, i.e. the one where one can
      disambiguate between as many matches as possible with as little typing as
      possible.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This widget allows the cursor to be easily moved to the other
    interesting spots. It can be invoked repeatedly to cycle between all
    positions reported by the completion system.</p>
</div>
<dl class="Bl-tag">
  <dt id="delete"><a class="permalink" href="#delete"><b>delete-whole-word-match</b></a></dt>
  <dd>This is another function which works like the <b>-match</b> functions
      described immediately above, i.e. using styles to decide the word
      boundaries. However, it is not a replacement for any existing
    function.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The basic behaviour is to delete the word around the cursor. There
    is no numeric argument handling; only the single word around the cursor is
    considered. If the widget contains the string <b>kill</b>, the removed text
    will be placed in the cutbuffer for future yanking. This can be obtained by
    defining <b>kill-whole-word-match</b> as follows:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N kill-whole-word-match delete-whole-word-match</b></pre>
</div>
<p class="Pp">and then binding the widget <b>kill-whole-word-match</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="up"><a class="permalink" href="#up"><b>up-line-or-beginning-search</b>,
    <b>down-line-or-beginning-search</b></a></dt>
  <dd>These widgets are similar to the builtin functions
      <b>up-line-or-search</b> and <b>down-line-or-search</b>: if in a multiline
      buffer they move up or down within the buffer, otherwise they search for a
      history line matching the start of the current line. In this case,
      however, they search for a line which matches the current line up to the
      current cursor position, in the manner of
      <b>history-beginning-search-backward</b> and <b>-forward</b>, rather than
      the first word on the line.</dd>
  <dt id="edit"><a class="permalink" href="#edit"><b>edit-command-line</b></a></dt>
  <dd>Edit the command line using your visual editor, as in <b>ksh</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>bindkey -M vicmd v edit-command-line</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="expand"><a class="permalink" href="#expand"><b>expand-absolute-path</b></a></dt>
  <dd>Expand the file name under the cursor to an absolute path, resolving
      symbolic links. Where possible, the initial path segment is turned into a
      named directory or reference to a user's home directory.</dd>
  <dt id="history"><a class="permalink" href="#history"><b>history-search-end</b></a></dt>
  <dd>This function implements the widgets
      <b>history-beginning-search-backward-end</b> and
      <b>history-beginning-search-forward-end</b>. These commands work by first
      calling the corresponding builtin widget (see `History Control' in
      <i>zshzle</i>(1)) and then moving the cursor to the end of the line. The
      original cursor position is remembered and restored before calling the
      builtin widget a second time, so that the same search is repeated to look
      farther through the history.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Although you <b>autoload</b> only one function, the commands to
    use it are slightly different because it implements two widgets.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N history-beginning-search-backward-end \ </b>
<b>       history-search-end</b>
<b>zle -N history-beginning-search-forward-end \ </b>
<b>       history-search-end</b>
<b>bindkey '\e^P' history-beginning-search-backward-end</b>
<b>bindkey '\e^N' history-beginning-search-forward-end</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="history~2"><a class="permalink" href="#history~2"><b>history-beginning-search-menu</b></a></dt>
  <dd>This function implements yet another form of history searching. The text
      before the cursor is used to select lines from the history, as for
      <b>history-beginning-search-backward</b> except that all matches are shown
      in a numbered menu. Typing the appropriate digits inserts the full history
      line. Note that leading zeroes must be typed (they are only shown when
      necessary for removing ambiguity). The entire history is searched; there
      is no distinction between forwards and backwards.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">With a numeric argument, the search is not anchored to the start
    of the line; the string typed by the use may appear anywhere in the line in
    the history.</p>
<p class="Pp">If the widget name contains `<b>-end</b>' the cursor is moved to
    the end of the line inserted. If the widget name contains `<b>-space</b>'
    any space in the text typed is treated as a wildcard and can match anything
    (hence a leading space is equivalent to giving a numeric argument). Both
    forms can be combined, for example:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N history-beginning-search-menu-space-end \ </b>
<b>       history-beginning-search-menu</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="history~3"><a class="permalink" href="#history~3"><b>history-pattern-search</b></a></dt>
  <dd>The function <b>history-pattern-search</b> implements widgets which prompt
      for a pattern with which to search the history backwards or forwards. The
      pattern is in the usual zsh format, however the first character may be
      <b>^</b> to anchor the search to the start of the line, and the last
      character may be <b>$</b> to anchor the search to the end of the line. If
      the search was not anchored to the end of the line the cursor is
      positioned just after the pattern found.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The commands to create bindable widgets are similar to those in
    the example immediately above:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -U history-pattern-search</b>
<b>zle -N history-pattern-search-backward history-pattern-search</b>
<b>zle -N history-pattern-search-forward history-pattern-search</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="incarg"><a class="permalink" href="#incarg"><b>incarg</b></a></dt>
  <dd>Typing the keystrokes for this widget with the cursor placed on or to the
      left of an integer causes that integer to be incremented by one. With a
      numeric argument, the number is incremented by the amount of the argument
      (decremented if the numeric argument is negative). The shell parameter
      <b>incarg</b> may be set to change the default increment to something
      other than one.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>bindkey '^X+' incarg</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="incremental"><a class="permalink" href="#incremental"><b>incremental-complete-word</b></a></dt>
  <dd>This allows incremental completion of a word. After starting this command,
      a list of completion choices can be shown after every character you type,
      which you can delete with <b>^H</b> or <b>DEL</b>. Pressing return accepts
      the completion so far and returns you to normal editing (that is, the
      command line is <i>not</i> immediately executed). You can hit <b>TAB</b>
      to do normal completion, <b>^G</b> to abort back to the state when you
      started, and <b>^D</b> to list the matches.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This works only with the new function based completion system.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>bindkey '^Xi' incremental-complete-word</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="insert"><a class="permalink" href="#insert"><b>insert-composed-char</b></a></dt>
  <dd>This function allows you to compose characters that don't appear on the
      keyboard to be inserted into the command line. The command is followed by
      two keys corresponding to ASCII characters (there is no prompt). For
      accented characters, the two keys are a base character followed by a code
      for the accent, while for other special characters the two characters
      together form a mnemonic for the character to be inserted. The
      two-character codes are a subset of those given by RFC 1345 (see for
      example <b>http://www.faqs.org/rfcs/rfc1345.html</b>).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The function may optionally be followed by up to two characters
    which replace one or both of the characters read from the keyboard; if both
    characters are supplied, no input is read. For example,
    <b>insert-composed-char a:</b> can be used within a widget to insert an a
    with umlaut into the command line. This has the advantages over use of a
    literal character that it is more portable.</p>
<p class="Pp">For best results zsh should have been built with support for
    multibyte characters (configured with <b>--enable-multibyte</b>); however,
    the function works for the limited range of characters available in
    single-byte character sets such as ISO-8859-1.</p>
<p class="Pp">The character is converted into the local representation and
    inserted into the command line at the cursor position. (The conversion is
    done within the shell, using whatever facilities the C library provides.)
    With a numeric argument, the character and its code are previewed in the
    status line</p>
<p class="Pp">The function may be run outside zle in which case it prints the
    character (together with a newline) to standard output. Input is still read
    from keystrokes.</p>
<p class="Pp">See <b>insert-unicode-char</b> for an alternative way of inserting
    Unicode characters using their hexadecimal character number.</p>
<p class="Pp">The set of accented characters is reasonably complete up to
    Unicode character U+0180, the set of special characters less so. However, it
    is very sporadic from that point. Adding new characters is easy, however;
    see the function <b>define-composed-chars</b>. Please send any additions to
    <b>zsh-workers@zsh.org</b>.</p>
<p class="Pp">The codes for the second character when used to accent the first
    are as follows. Note that not every character can take every accent.</p>
<dl class="Bl-tag">
  <dt><b>!</b></dt>
  <dd>Grave.</dd>
  <dt><b>'</b></dt>
  <dd>Acute.</dd>
  <dt><b>&gt;</b></dt>
  <dd>Circumflex.</dd>
  <dt><b>?</b></dt>
  <dd>Tilde. (This is not <b>~</b> as RFC 1345 does not assume that character is
      present on the keyboard.)</dd>
  <dt><b>-</b></dt>
  <dd>Macron. (A horizontal bar over the base character.)</dd>
  <dt><b>(</b></dt>
  <dd>Breve. (A shallow dish shape over the base character.)</dd>
  <dt><b>.</b></dt>
  <dd>Dot above the base character, or in the case of <b>i</b> no dot, or in the
      case of <b>L</b> and <b>l</b> a centered dot.</dd>
  <dt><b>:</b></dt>
  <dd>Diaeresis (Umlaut).</dd>
  <dt id="c~3"><a class="permalink" href="#c~3"><b>c</b></a></dt>
  <dd>Cedilla.</dd>
  <dt><b>_</b></dt>
  <dd>Underline, however there are currently no underlined characters.</dd>
  <dt><b>/</b></dt>
  <dd>Stroke through the base character.</dd>
  <dt><b>&quot;</b></dt>
  <dd>Double acute (only supported on a few letters).</dd>
  <dt><b>;</b></dt>
  <dd>Ogonek. (A little forward facing hook at the bottom right of the
      character.)</dd>
  <dt><b>&lt;</b></dt>
  <dd>Caron. (A little v over the letter.)</dd>
  <dt><b>0</b></dt>
  <dd>Circle over the base character.</dd>
  <dt><b>2</b></dt>
  <dd>Hook over the base character.</dd>
  <dt><b>9</b></dt>
  <dd>Horn over the base character.</dd>
</dl>
<p class="Pp">The most common characters from the Arabic, Cyrillic, Greek and
    Hebrew alphabets are available; consult RFC 1345 for the appropriate
    sequences. In addition, a set of two letter codes not in RFC 1345 are
    available for the double-width characters corresponding to ASCII characters
    from <b>!</b> to <b>~</b> (0x21 to 0x7e) by preceding the character with
    <b>^</b>, for example <b>^A</b> for a double-width <b>A</b>.</p>
<p class="Pp">The following other two-character sequences are understood.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt>ASCII characters</dt>
  <dd>These are already present on most keyboards:</dd>
  <dt><b>&lt;(</b></dt>
  <dd>Left square bracket</dd>
  <dt><b>//</b></dt>
  <dd>Backslash (solidus)</dd>
  <dt><b>)&gt;</b></dt>
  <dd>Right square bracket</dd>
  <dt><b>(!</b></dt>
  <dd>Left brace (curly bracket)</dd>
  <dt><b>!!</b></dt>
  <dd>Vertical bar (pipe symbol)</dd>
  <dt><b>!)</b></dt>
  <dd>Right brace (curly bracket)</dd>
  <dt><b>'?</b></dt>
  <dd>Tilde</dd>
  <dt id="Special"><a class="permalink" href="#Special">Special letters</a></dt>
  <dd>Characters found in various variants of the Latin alphabet:</dd>
  <dt id="ss"><a class="permalink" href="#ss"><b>ss</b></a></dt>
  <dd>Eszett (scharfes S)</dd>
  <dt id="D"><a class="permalink" href="#D"><b>D-</b>, <b>d-</b></a></dt>
  <dd>Eth</dd>
  <dt id="TH"><a class="permalink" href="#TH"><b>TH</b>, <b>th</b></a></dt>
  <dd>Thorn</dd>
  <dt id="kk"><a class="permalink" href="#kk"><b>kk</b></a></dt>
  <dd>Kra</dd>
  <dt><b>'n</b></dt>
  <dd>'n</dd>
  <dt id="NG"><a class="permalink" href="#NG"><b>NG</b>, <b>ng</b></a></dt>
  <dd>Ng</dd>
  <dt id="OI"><a class="permalink" href="#OI"><b>OI</b>, <b>oi</b></a></dt>
  <dd>Oi</dd>
  <dt id="yr"><a class="permalink" href="#yr"><b>yr</b></a></dt>
  <dd>yr</dd>
  <dt id="ED"><a class="permalink" href="#ED"><b>ED</b></a></dt>
  <dd>ezh</dd>
  <dt id="Currency"><a class="permalink" href="#Currency">Currency
    symbols</a></dt>
  <dd></dd>
  <dt id="Ct"><a class="permalink" href="#Ct"><b>Ct</b></a></dt>
  <dd>Cent</dd>
  <dt id="Pd"><a class="permalink" href="#Pd"><b>Pd</b></a></dt>
  <dd>Pound sterling (also lira and others)</dd>
  <dt id="Cu"><a class="permalink" href="#Cu"><b>Cu</b></a></dt>
  <dd>Currency</dd>
  <dt id="Ye"><a class="permalink" href="#Ye"><b>Ye</b></a></dt>
  <dd>Yen</dd>
  <dt id="Eu"><a class="permalink" href="#Eu"><b>Eu</b></a></dt>
  <dd>Euro (N.B. not in RFC 1345)</dd>
  <dt id="Punctuation"><a class="permalink" href="#Punctuation">Punctuation
    characters</a></dt>
  <dd>References to &quot;right&quot; quotes indicate the shape (like a 9 rather
      than 6) rather than their grammatical use. (For example, a
      &quot;right&quot; low double quote is used to open quotations in
    German.)</dd>
  <dt><b>!I</b></dt>
  <dd>Inverted exclamation mark</dd>
  <dt id="BB"><a class="permalink" href="#BB"><b>BB</b></a></dt>
  <dd>Broken vertical bar</dd>
  <dt id="SE"><a class="permalink" href="#SE"><b>SE</b></a></dt>
  <dd>Section</dd>
  <dt id="Co"><a class="permalink" href="#Co"><b>Co</b></a></dt>
  <dd>Copyright</dd>
  <dt id="a"><a class="permalink" href="#a"><b>-a</b></a></dt>
  <dd>Spanish feminine ordinal indicator</dd>
  <dt><b>&lt;&lt;</b></dt>
  <dd>Left guillemet</dd>
  <dt><b>-</b><b>-</b></dt>
  <dd>Soft hyphen</dd>
  <dt id="Rg"><a class="permalink" href="#Rg"><b>Rg</b></a></dt>
  <dd>Registered trade mark</dd>
  <dt id="PI"><a class="permalink" href="#PI"><b>PI</b></a></dt>
  <dd>Pilcrow (paragraph)</dd>
  <dt id="o"><a class="permalink" href="#o"><b>-o</b></a></dt>
  <dd>Spanish masculine ordinal indicator</dd>
  <dt><b>&gt;&gt;</b></dt>
  <dd>Right guillemet</dd>
  <dt><b>?I</b></dt>
  <dd>Inverted question mark</dd>
  <dt><b>-1</b></dt>
  <dd>Hyphen</dd>
  <dt id="N"><a class="permalink" href="#N"><b>-N</b></a></dt>
  <dd>En dash</dd>
  <dt id="M"><a class="permalink" href="#M"><b>-M</b></a></dt>
  <dd>Em dash</dd>
  <dt><b>-3</b></dt>
  <dd>Horizontal bar</dd>
  <dt><b>:3</b></dt>
  <dd>Vertical ellipsis</dd>
  <dt><b>.3</b></dt>
  <dd>Horizontal midline ellipsis</dd>
  <dt><b>!2</b></dt>
  <dd>Double vertical line</dd>
  <dt><b>=2</b></dt>
  <dd>Double low line</dd>
  <dt><b>'6</b></dt>
  <dd>Left single quote</dd>
  <dt><b>'9</b></dt>
  <dd>Right single quote</dd>
  <dt><b>.9</b></dt>
  <dd>&quot;Right&quot; low quote</dd>
  <dt><b>9'</b></dt>
  <dd>Reversed &quot;right&quot; quote</dd>
  <dt><b>&quot;6</b></dt>
  <dd>Left double quote</dd>
  <dt><b>&quot;9</b></dt>
  <dd>Right double quote</dd>
  <dt><b>:9</b></dt>
  <dd>&quot;Right&quot; low double quote</dd>
  <dt><b>9&quot;</b></dt>
  <dd>Reversed &quot;right&quot; double quote</dd>
  <dt><b>/-</b></dt>
  <dd>Dagger</dd>
  <dt><b>/=</b></dt>
  <dd>Double dagger</dd>
  <dt id="Mathematical"><a class="permalink" href="#Mathematical">Mathematical
    symbols</a></dt>
  <dd></dd>
  <dt id="DG"><a class="permalink" href="#DG"><b>DG</b></a></dt>
  <dd>Degree</dd>
  <dt><b>-2</b>, <b>+-</b>, <b>-+</b></dt>
  <dd>- sign, +/- sign, -/+ sign</dd>
  <dt><b>2S</b></dt>
  <dd>Superscript 2</dd>
  <dt><b>3S</b></dt>
  <dd>Superscript 3</dd>
  <dt><b>1S</b></dt>
  <dd>Superscript 1</dd>
  <dt id="My"><a class="permalink" href="#My"><b>My</b></a></dt>
  <dd>Micro</dd>
  <dt><b>.M</b></dt>
  <dd>Middle dot</dd>
  <dt><b>14</b></dt>
  <dd>Quarter</dd>
  <dt><b>12</b></dt>
  <dd>Half</dd>
  <dt><b>34</b></dt>
  <dd>Three quarters</dd>
  <dt><b>*X</b></dt>
  <dd>Multiplication</dd>
  <dt><b>-:</b></dt>
  <dd>Division</dd>
  <dt><b>%0</b></dt>
  <dd>Per mille</dd>
  <dt id="FA"><a class="permalink" href="#FA"><b>FA</b>, <b>TE</b>,
    <b>/0</b></a></dt>
  <dd>For all, there exists, empty set</dd>
  <dt id="dP"><a class="permalink" href="#dP"><b>dP</b>, <b>DE</b>,
    <b>NB</b></a></dt>
  <dd>Partial derivative, delta (increment), del (nabla)</dd>
  <dt><b>(-</b>, <b>-)</b></dt>
  <dd>Element of, contains</dd>
  <dt><b>*P</b>, <b>+Z</b></dt>
  <dd>Product, sum</dd>
  <dt><b>*-</b>, <b>Ob</b>, <b>Sb</b></dt>
  <dd>Asterisk, ring, bullet</dd>
  <dt id="RT"><a class="permalink" href="#RT"><b>RT</b>, <b>0(</b>,
    <b>00</b></a></dt>
  <dd>Root sign, proportional to, infinity</dd>
  <dt id="Other"><a class="permalink" href="#Other">Other symbols</a></dt>
  <dd></dd>
  <dt id="cS"><a class="permalink" href="#cS"><b>cS</b>, <b>cH</b>, <b>cD</b>,
    <b>cC</b></a></dt>
  <dd>Card suits: spades, hearts, diamonds, clubs</dd>
  <dt id="Md"><a class="permalink" href="#Md"><b>Md</b>, <b>M8</b>, <b>M2</b>,
    <b>Mb</b>, <b>Mx</b>, <b>MX</b></a></dt>
  <dd>Musical notation: crotchet (quarter note), quaver (eighth note),
      semiquavers (sixteenth notes), flag sign, natural sign, sharp sign</dd>
  <dt id="Fm"><a class="permalink" href="#Fm"><b>Fm</b>, <b>Ml</b></a></dt>
  <dd>Female, male</dd>
  <dt id="Accents"><a class="permalink" href="#Accents">Accents on their
    own</a></dt>
  <dd></dd>
  <dt><b>'&gt;</b></dt>
  <dd>Circumflex (same as caret, <b>^</b>)</dd>
  <dt><b>'!</b></dt>
  <dd>Grave (same as backtick, <b>`</b>)</dd>
  <dt><b>',</b></dt>
  <dd>Cedilla</dd>
  <dt><b>':</b></dt>
  <dd>Diaeresis (Umlaut)</dd>
  <dt><b>'m</b></dt>
  <dd>Macron</dd>
  <dt><b>''</b></dt>
  <dd>Acute</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="insert~2"><a class="permalink" href="#insert~2"><b>insert-files</b></a></dt>
  <dd>This function allows you type a file pattern, and see the results of the
      expansion at each step. When you hit return, all expansions are inserted
      into the command line.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>bindkey '^Xf' insert-files</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="insert~3"><a class="permalink" href="#insert~3"><b>insert-unicode-char</b></a></dt>
  <dd>When first executed, the user inputs a set of hexadecimal digits. This is
      terminated with another call to <b>insert-unicode-char</b>. The digits are
      then turned into the corresponding Unicode character. For example, if the
      widget is bound to <b>^XU</b>, the character sequence `<b>^XU 4 c ^XU</b>'
      inserts <b>L</b> (Unicode U+004c).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">See <b>insert-composed-char</b> for a way of inserting characters
    using a two-character mnemonic.</p>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>narrow-to-region </b>[ <b>-p</b> <i>pre</i> ] [ <b>-P</b> <i>post</i>
    ]</dt>
  <dd></dd>
  <dt><b> </b>[ <b>-S</b> <i>statepm</i> | <b>-R</b> <i>statepm</i> | [
    <b>-l</b> <i>lbufvar</i> ] [ <b>-r</b> <i>rbufvar</i> ] ]</dt>
  <dd></dd>
  <dt><b> </b>[ <b>-n</b> ] [ <i>start</i> <i>end</i> ]</dt>
  <dd></dd>
  <dt><b>narrow-to-region-invisible</b></dt>
  <dd>Narrow the editable portion of the buffer to the region between the cursor
      and the mark, which may be in either order. The region may not be
    empty.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"><b>narrow-to-region</b> may be used as a widget or called as a
    function from a user-defined widget; by default, the text outside the
    editable area remains visible. A <b>recursive-edit</b> is performed and the
    original widening status is then restored. Various options and arguments are
    available when it is called as a function.</p>
<p class="Pp">The options <b>-p</b> <i>pretext</i> and <b>-P</b> <i>posttext</i>
    may be used to replace the text before and after the display for the
    duration of the function; either or both may be an empty string.</p>
<p class="Pp">If the option <b>-n</b> is also given, <i>pretext</i> or
    <i>posttext</i> will only be inserted if there is text before or after the
    region respectively which will be made invisible.</p>
<p class="Pp">Two numeric arguments may be given which will be used instead of
    the cursor and mark positions.</p>
<p class="Pp">The option <b>-S</b> <i>statepm</i> is used to narrow according to
    the other options while saving the original state in the parameter with name
    <i>statepm</i>, while the option <b>-R</b> <i>statepm</i> is used to restore
    the state from the parameter; note in both cases the <i>name</i> of the
    parameter is required. In the second case, other options and arguments are
    irrelevant. When this method is used, no <b>recursive-edit</b> is performed;
    the calling widget should call this function with the option <b>-S</b>,
    perform its own editing on the command line or pass control to the user via
    `<b>zle recursive-edit</b>', then call this function with the option
    <b>-R</b>. The argument <i>statepm</i> must be a suitable name for an
    ordinary parameter, except that parameters beginning with the prefix
    <b>_ntr_</b> are reserved for use within <b>narrow-to-region</b>. Typically
    the parameter will be local to the calling function.</p>
<p class="Pp">The options <b>-l</b> <i>lbufvar</i> and <b>-r</b> <i>rbufvar</i>
    may be used to specify parameters where the widget will store the resulting
    text from the operation. The parameter <i>lbufvar</i> will contain
    <b>LBUFFER</b> and <i>rbufvar</i> will contain <b>RBUFFER</b>. Neither of
    these two options may be used with <b>-S</b> or <b>-R</b>.</p>
<p class="Pp"><b>narrow-to-region-invisible</b> is a simple widget which calls
    <b>narrow-to-region</b> with arguments which replace any text outside the
    region with `<b>...</b>'. It does not take any arguments.</p>
<p class="Pp">The display is restored (and the widget returns) upon any zle
    command which would usually cause the line to be accepted or aborted. Hence
    an additional such command is required to accept or abort the current
  line.</p>
<p class="Pp">The return status of both widgets is zero if the line was
    accepted, else non-zero.</p>
<p class="Pp">Here is a trivial example of a widget using this feature.</p>
<div class="Bd-indent">
<pre><b>local state</b>
<b>narrow-to-region -p $'Editing restricted region\n' \ </b>
<b>  -P '' -S state</b>
<b>zle recursive-edit</b>
<b>narrow-to-region -R state</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="predict"><a class="permalink" href="#predict"><b>predict-on</b></a></dt>
  <dd>This set of functions implements predictive typing using history search.
      After <b>predict-on</b>, typing characters causes the editor to look
      backward in the history for the first line beginning with what you have
      typed so far. After <b>predict-off</b>, editing returns to normal for the
      line found. In fact, you often don't even need to use <b>predict-off</b>,
      because if the line doesn't match something in the history, adding a key
      performs standard completion, and then inserts itself if no completions
      were found. However, editing in the middle of a line is liable to confuse
      prediction; see the <b>toggle</b> style below.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">With the function based completion system (which is needed for
    this), you should be able to type <b>TAB</b> at almost any point to advance
    the cursor to the next ``interesting'' character position (usually the end
    of the current word, but sometimes somewhere in the middle of the word). And
    of course as soon as the entire line is what you want, you can accept with
    return, without needing to move the cursor to the end first.</p>
<p class="Pp">The first time <b>predict-on</b> is used, it creates several
    additional widget functions:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="delete~2"><a class="permalink" href="#delete~2"><b>delete-backward-and-predict</b></a></dt>
  <dd>Replaces the <b>backward-delete-char</b> widget. You do not need to bind
      this yourself.</dd>
  <dt id="insert~4"><a class="permalink" href="#insert~4"><b>insert-and-predict</b></a></dt>
  <dd>Implements predictive typing by replacing the <b>self-insert</b> widget.
      You do not need to bind this yourself.</dd>
  <dt id="predict~2"><a class="permalink" href="#predict~2"><b>predict-off</b></a></dt>
  <dd>Turns off predictive typing.</dd>
</dl>
<p class="Pp">Although you <b>autoload</b> only the <b>predict-on</b> function,
    it is necessary to create a keybinding for <b>predict-off</b> as well.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N predict-on</b>
<b>zle -N predict-off</b>
<b>bindkey '^X^Z' predict-on</b>
<b>bindkey '^Z' predict-off</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="read"><a class="permalink" href="#read"><b>read-from-minibuffer</b></a></dt>
  <dd>This is most useful when called as a function from inside a widget, but
      will work correctly as a widget in its own right. It prompts for a value
      below the current command line; a value may be input using all of the
      standard zle operations (and not merely the restricted set available when
      executing, for example, <b>execute-named-cmd</b>). The value is then
      returned to the calling function in the parameter <b>$REPLY</b> and the
      editing buffer restored to its previous state. If the read was aborted by
      a keyboard break (typically <b>^G</b>), the function returns status 1 and
      <b>$REPLY</b> is not set.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If one argument is supplied to the function it is taken as a
    prompt, otherwise `<b>? </b>' is used. If two arguments are supplied, they
    are the prompt and the initial value of <b>$LBUFFER</b>, and if a third
    argument is given it is the initial value of <b>$RBUFFER</b>. This provides
    a default value and starting cursor placement. Upon return the entire buffer
    is the value of <b>$REPLY</b>.</p>
<p class="Pp">One option is available: `<b>-k</b> <i>num</i>' specifies that
    <i>num</i> characters are to be read instead of a whole line. The line
    editor is not invoked recursively in this case, so depending on the terminal
    settings the input may not be visible, and only the input keys are placed in
    <b>$REPLY</b>, not the entire buffer. Note that unlike the <b>read</b>
    builtin <i>num</i> must be given; there is no default.</p>
<p class="Pp">The name is a slight misnomer, as in fact the shell's own
    minibuffer is not used. Hence it is still possible to call
    <b>executed-named-cmd</b> and similar functions while reading a value.</p>
</div>
<dl class="Bl-tag">
  <dt id="replace"><a class="permalink" href="#replace"><b>replace-argument</b>,
    <b>replace-argument-edit</b></a></dt>
  <dd>The function <b>replace-argument</b> can be used to replace a command line
      argument in the current command line or, if the current command line is
      empty, in the last command line executed (the new command line is not
      executed). Arguments are as delimited by standard shell syntax,</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If a numeric argument is given, that specifies the argument to be
    replaced. 0 means the command name, as in history expansion. A negative
    numeric argument counts backward from the last word.</p>
<p class="Pp">If no numeric argument is given, the current argument is replaced;
    this is the last argument if the previous history line is being used.</p>
<p class="Pp">The function prompts for a replacement argument.</p>
<p class="Pp">If the widget contains the string <b>edit</b>, for example is
    defined as</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N replace-argument-edit replace-argument</b></pre>
</div>
<p class="Pp">then the function presents the current value of the argument for
    editing, otherwise the editing buffer for the replacement is initially
    empty.</p>
</div>
<dl class="Bl-tag">
  <dt><b>replace-string</b>, <b>replace-pattern</b></dt>
  <dd></dd>
  <dt><b>replace-string-again</b>, <b>replace-pattern-again</b></dt>
  <dd>The function <b>replace-string</b> implements three widgets. If defined
      under the same name as the function, it prompts for two strings; the first
      (source) string will be replaced by the second everywhere it occurs in the
      line editing buffer.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If the widget name contains the word `<b>pattern</b>', for example
    by defining the widget using the command `<b>zle -N replace-pattern</b>
    <b>replace-string</b>', then the matching is performed using zsh patterns.
    All zsh extended globbing patterns can be used in the source string; note
    that unlike filename generation the pattern does not need to match an entire
    word, nor do glob qualifiers have any effect. In addition, the replacement
    string can contain parameter or command substitutions. Furthermore, a
    `<b>&amp;</b>' in the replacement string will be replaced with the matched
    source string, and a backquoted digit `<b>\</b><i>N</i>' will be replaced by
    the <i>N</i>th parenthesised expression matched. The form
    `<b>\{</b><i>N</i><b>}</b>' may be used to protect the digit from following
    digits.</p>
<p class="Pp">If the widget instead contains the word `<b>regex</b>' (or
    `<b>regexp</b>'), then the matching is performed using regular expressions,
    respecting the setting of the option <b>RE_MATCH_PCRE</b> (see the
    description of the function <b>regexp-replace</b> below). The special
    replacement facilities described above for pattern matching are
  available.</p>
<p class="Pp">By default the previous source or replacement string will not be
    offered for editing. However, this feature can be activated by setting the
    style <b>edit-previous</b> in the context <b>:zle:</b><i>widget</i> (for
    example, <b>:zle:replace-string</b>) to <b>true</b>. In addition, a positive
    numeric argument forces the previous values to be offered, a negative or
    zero argument forces them not to be.</p>
<p class="Pp">The function <b>replace-string-again</b> can be used to repeat the
    previous replacement; no prompting is done. As with <b>replace-string</b>,
    if the name of the widget contains the word `<b>pattern</b>' or
    `<b>regex</b>', pattern or regular expression matching is performed, else a
    literal string replacement. Note that the previous source and replacement
    text are the same whether pattern, regular expression or string matching is
    used.</p>
<p class="Pp">In addition, <b>replace-string</b> shows the previous replacement
    above the prompt, so long as there was one during the current session; if
    the source string is empty, that replacement will be repeated without the
    widget prompting for a replacement string.</p>
<p class="Pp">For example, starting from the line:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>print This line contains fan and fond</b></pre>
</div>
<p class="Pp">and invoking <b>replace-pattern</b> with the source string
    `<b>f(?)n</b>' and the replacement string `<b>c\1r</b>' produces the not
    very useful line:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>print This line contains car and cord</b></pre>
</div>
<p class="Pp">The range of the replacement string can be limited by using the
    <b>narrow-to-region-invisible</b> widget. One limitation of the current
    version is that <b>undo</b> will cycle through changes to the replacement
    and source strings before undoing the replacement itself.</p>
</div>
<dl class="Bl-tag">
  <dt id="send"><a class="permalink" href="#send"><b>send-invisible</b></a></dt>
  <dd>This is similar to read-from-minibuffer in that it may be called as a
      function from a widget or as a widget of its own, and interactively reads
      input from the keyboard. However, the input being typed is concealed and a
      string of asterisks (`<b>*</b>') is shown instead. The value is saved in
      the parameter <b>$INVISIBLE</b> to which a reference is inserted into the
      editing buffer at the restored cursor position. If the read was aborted by
      a keyboard break (typically <b>^G</b>) or another escape from editing such
      as <b>push-line</b>, <b>$INVISIBLE</b> is set to empty and the original
      buffer is restored unchanged.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">If one argument is supplied to the function it is taken as a
    prompt, otherwise `<b>Non-echoed text: </b>' is used (as in emacs). If a
    second and third argument are supplied they are used to begin and end the
    reference to <b>$INVISIBLE</b> that is inserted into the buffer. The default
    is to open with <b>${</b>, then <b>INVISIBLE</b>, and close with <b>}</b>,
    but many other effects are possible.</p>
</div>
<dl class="Bl-tag">
  <dt id="smart"><a class="permalink" href="#smart"><b>smart-insert-last-word</b></a></dt>
  <dd>This function may replace the <b>insert-last-word</b> widget, like
    so:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N insert-last-word smart-insert-last-word</b></pre>
</div>
<p class="Pp">With a numeric argument, or when passed command line arguments in
    a call from another widget, it behaves like <b>insert-last-word</b>, except
    that words in comments are ignored when <b>INTERACTIVE_COMMENTS</b> is
  set.</p>
<p class="Pp">Otherwise, the rightmost ``interesting'' word from the previous
    command is found and inserted. The default definition of ``interesting'' is
    that the word contains at least one alphabetic character, slash, or
    backslash. This definition may be overridden by use of the <b>match</b>
    style. The context used to look up the style is the widget name, so usually
    the context is <b>:insert-last-word</b>. However, you can bind this function
    to different widgets to use different patterns:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zle -N insert-last-assignment smart-insert-last-word</b>
<b>zstyle :insert-last-assignment match '[[:alpha:]][][[:alnum:]]#=*'</b>
<b>bindkey '\e=' insert-last-assignment</b></pre>
</div>
<p class="Pp">If no interesting word is found and the <b>auto-previous</b> style
    is set to a true value, the search continues upward through the history.
    When <b>auto-previous</b> is unset or false (the default), the widget must
    be invoked repeatedly in order to search earlier history lines.</p>
</div>
<dl class="Bl-tag">
  <dt id="transpose"><a class="permalink" href="#transpose"><b>transpose-lines</b></a></dt>
  <dd>Only useful with a multi-line editing buffer; the lines here are lines
      within the current on-screen buffer, not history lines. The effect is
      similar to the function of the same name in Emacs.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Transpose the current line with the previous line and move the
    cursor to the start of the next line. Repeating this (which can be done by
    providing a positive numeric argument) has the effect of moving the line
    above the cursor down by a number of lines.</p>
<p class="Pp">With a negative numeric argument, requires two lines above the
    cursor. These two lines are transposed and the cursor moved to the start of
    the previous line. Using a numeric argument less than -1 has the effect of
    moving the line above the cursor up by minus that number of lines.</p>
</div>
<dl class="Bl-tag">
  <dt id="url"><a class="permalink" href="#url"><b>url-quote-magic</b></a></dt>
  <dd>This widget replaces the built-in <b>self-insert</b> to make it easier to
      type URLs as command line arguments. As you type, the input character is
      analyzed and, if it may need quoting, the current word is checked for a
      URI scheme. If one is found and the current word is not already in quotes,
      a backslash is inserted before the input character.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Styles to control quoting behavior:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>url-metas</b></dt>
  <dd>This style is looked up in the context
      `<b>:url-quote-magic:</b><i>scheme</i>' (where <i>scheme</i> is that of
      the current URL, e.g. &quot;<b>ftp</b>&quot;). The value is a string
      listing the characters to be treated as globbing metacharacters when
      appearing in a URL using that scheme. The default is to quote all zsh
      extended globbing characters, excluding '<b>&lt;</b>' and '<b>&gt;</b>'
      but including braces (as in brace expansion). See also
    <b>url-seps</b>.</dd>
  <dt id="url~2"><a class="permalink" href="#url~2"><b>url-seps</b></a></dt>
  <dd>Like <b>url-metas</b>, but lists characters that should be considered
      command separators, redirections, history references, etc. The default is
      to quote the standard set of shell separators, excluding those that
      overlap with the extended globbing characters, but including '<b>&lt;</b>'
      and '<b>&gt;</b>' and the first character of <b>$histchars</b>.</dd>
  <dt id="url~3"><a class="permalink" href="#url~3"><b>url-globbers</b></a></dt>
  <dd>This style is looked up in the context `<b>:url-quote-magic</b>'. The
      values form a list of command names that are expected to do their own
      globbing on the URL string. This implies that they are aliased to use the
      `<b>noglob</b>' modifier. When the first word on the line matches one of
      the values <i>and</i> the URL refers to a local file (see
      <b>url-local-schema</b>), only the <b>url-seps</b> characters are quoted;
      the <b>url-metas</b> are left alone, allowing them to affect command-line
      parsing, completion, etc. The default values are a literal `<b>noglob</b>'
      plus (when the <b>zsh/parameter</b> module is available) any commands
      aliased to the helper function `<b>urlglobber</b>' or its alias
      `<b>globurl</b>'.</dd>
  <dt id="url~4"><a class="permalink" href="#url~4"><b>url-local-schema</b></a></dt>
  <dd>This style is always looked up in the context `<b>:urlglobber</b>', even
      though it is used by both url-quote-magic and urlglobber. The values form
      a list of URI schema that should be treated as referring to local files by
      their real local path names, as opposed to files which are specified
      relative to a web-server-defined document root. The defaults are
      &quot;<b>ftp</b>&quot; and &quot;<b>file</b>&quot;.</dd>
  <dt id="url~5"><a class="permalink" href="#url~5"><b>url-other-schema</b></a></dt>
  <dd>Like <b>url-local-schema</b>, but lists all other URI schema upon which
      <b>urlglobber</b> and <b>url-quote-magic</b> should act. If the URI on the
      command line does not have a scheme appearing either in this list or in
      <b>url-local-schema</b>, it is not magically quoted. The default values
      are &quot;<b>http</b>&quot;, &quot;<b>https</b>&quot;, and
      &quot;<b>ftp</b>&quot;. When a scheme appears both here and in
      <b>url-local-schema</b>, it is quoted differently depending on whether the
      command name appears in <b>url-globbers</b>.</dd>
</dl>
<p class="Pp">Loading <b>url-quote-magic</b> also defines a helper function
    `<b>urlglobber</b>' and aliases `<b>globurl</b>' to `<b>noglob
    urlglobber</b>'. This function takes a local URL apart, attempts to
    pattern-match the local file portion of the URL path, and then puts the
    results back into URL format again.</p>
</div>
<dl class="Bl-tag">
  <dt id="vi"><a class="permalink" href="#vi"><b>vi-pipe</b></a></dt>
  <dd>This function reads a movement command from the keyboard and then prompts
      for an external command. The part of the buffer covered by the movement is
      piped to the external command and then replaced by the command's output.
      If the movement command is bound to vi-pipe, the current line is
    used.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The function serves as an example for reading a vi movement
    command from within a user-defined widget.</p>
</div>
<dl class="Bl-tag">
  <dt id="which"><a class="permalink" href="#which"><b>which-command</b></a></dt>
  <dd>This function is a drop-in replacement for the builtin widget
      <b>which-command</b>. It has enhanced behaviour, in that it correctly
      detects whether or not the command word needs to be expanded as an alias;
      if so, it continues tracing the command word from the expanded alias until
      it reaches the command that will be executed.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The style <b>whence</b> is available in the context
    <b>:zle:$WIDGET</b>; this may be set to an array to give the command and
    options that will be used to investigate the command word found. The default
    is <b>whence -c</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="zcalc"><a class="permalink" href="#zcalc"><b>zcalc-auto-insert</b></a></dt>
  <dd>This function is useful together with the <b>zcalc</b> function described
      in the section Mathematical Functions. It should be bound to a key
      representing a binary operator such as `<b>+</b>', `<b>-</b>', `<b>*</b>'
      or `<b>/</b>'. When running in zcalc, if the key occurs at the start of
      the line or immediately following an open parenthesis, the text
      <b>&quot;ans &quot;</b> is inserted before the representation of the key
      itself. This allows easy use of the answer from the previous calculation
      in the current line. The text to be inserted before the symbol typed can
      be modified by setting the variable <b>ZCALC_AUTO_INSERT_PREFIX</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Hence, for example, typing `<b>+12</b>' followed by return adds 12
    to the previous result.</p>
<p class="Pp">If zcalc is in RPN mode (<b>-r</b> option) the effect of this
    binding is automatically suppressed as operators alone on a line are
    meaningful.</p>
<p class="Pp">When not in zcalc, the key simply inserts the symbol itself.</p>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Utility_Functions"><a class="permalink" href="#Utility_Functions">Utility
  Functions</a></h2>
<p class="Pp">These functions are useful in constructing widgets. They should be
    loaded with `<b>autoload -U</b> <i>function</i>' and called as indicated
    from user-defined widgets.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>split-shell-arguments</b></dt>
  <dd>This function splits the line currently being edited into shell arguments
      and whitespace. The result is stored in the array <b>reply</b>. The array
      contains all the parts of the line in order, starting with any whitespace
      before the first argument, and finishing with any whitespace after the
      last argument. Hence (so long as the option <b>KSH_ARRAYS</b> is not set)
      whitespace is given by odd indices in the array and arguments by even
      indices. Note that no stripping of quotes is done; joining together all
      the elements of <b>reply</b> in order is guaranteed to produce the
      original line.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The parameter <b>REPLY</b> is set to the index of the word in
    <b>reply</b> which contains the character after the cursor, where the first
    element has index 1. The parameter <b>REPLY2</b> is set to the index of the
    character under the cursor in that word, where the first character has index
    1.</p>
<p class="Pp">Hence <b>reply</b>, <b>REPLY</b> and <b>REPLY2</b> should all be
    made local to the enclosing function.</p>
<p class="Pp">See the function <b>modify-current-argument</b>, described below,
    for an example of how to call this function.</p>
</div>
<dl class="Bl-tag">
  <dt id="modify"><a class="permalink" href="#modify"><b>modify-current-argument</b>
    [ <i>expr-using-</i><b>$ARG</b> | <i>func</i> ]</a></dt>
  <dd>This function provides a simple method of allowing user-defined widgets to
      modify the command line argument under the cursor (or immediately to the
      left of the cursor if the cursor is between arguments).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The argument can be an expression which when evaluated operates on
    the shell parameter <b>ARG</b>, which will have been set to the command line
    argument under the cursor. The expression should be suitably quoted to
    prevent it being evaluated too early.</p>
<p class="Pp">Alternatively, if the argument does not contain the string
    <b>ARG</b>, it is assumed to be a shell function, to which the current
    command line argument is passed as the only argument. The function should
    set the variable <b>REPLY</b> to the new value for the command line
    argument. If the function returns non-zero status, so does the calling
    function.</p>
<p class="Pp">For example, a user-defined widget containing the following code
    converts the characters in the argument under the cursor into all upper
    case:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>modify-current-argument '${(U)ARG}'</b></pre>
</div>
<p class="Pp">The following strips any quoting from the current word (whether
    backslashes or one of the styles of quotes), and replaces it with single
    quoting throughout:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>modify-current-argument '${(qq)${(Q)ARG}}'</b></pre>
</div>
<p class="Pp">The following performs directory expansion on the command line
    argument and replaces it by the absolute path:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>expand-dir() {</b>
<b>  REPLY=${~1}</b>
<b>  REPLY=${REPLY:a}</b>
<b>}</b>
<b>modify-current-argument expand-dir</b></pre>
</div>
<p class="Pp">In practice the function <b>expand-dir</b> would probably not be
    defined within the widget where <b>modify-current-argument</b> is
  called.</p>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Styles"><a class="permalink" href="#Styles">Styles</a></h2>
<p class="Pp">The behavior of several of the above widgets can be controlled by
    the use of the <b>zstyle</b> mechanism. In particular, widgets that interact
    with the completion system pass along their context to any completions that
    they invoke.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>break-keys</b></dt>
  <dd>This style is used by the <b>incremental-complete-word</b> widget. Its
      value should be a pattern, and all keys matching this pattern will cause
      the widget to stop incremental completion without the key having any
      further effect. Like all styles used directly by
      <b>incremental-complete-word</b>, this style is looked up using the
      context `<b>:incremental</b>'.</dd>
  <dt id="completer"><a class="permalink" href="#completer"><b>completer</b></a></dt>
  <dd>The <b>incremental-complete-word</b> and <b>insert-and-predict</b> widgets
      set up their top-level context name before calling completion. This allows
      one to define different sets of completer functions for normal completion
      and for these widgets. For example, to use completion, approximation and
      correction for normal completion, completion and correction for
      incremental completion and only completion for prediction one could
    use:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':completion:*' completer \ </b>
<b>        _complete _correct _approximate</b>
<b>zstyle ':completion:incremental:*' completer \ </b>
<b>        _complete _correct</b>
<b>zstyle ':completion:predict:*' completer \ </b>
<b>        _complete</b></pre>
</div>
<p class="Pp">It is a good idea to restrict the completers used in prediction,
    because they may be automatically invoked as you type. The <b>_list</b> and
    <b>_menu</b> completers should never be used with prediction. The
    <b>_approximate</b>, <b>_correct</b>, <b>_expand</b>, and <b>_match</b>
    completers may be used, but be aware that they may change characters
    anywhere in the word behind the cursor, so you need to watch carefully that
    the result is what you intended.</p>
</div>
<dl class="Bl-tag">
  <dt id="cursor"><a class="permalink" href="#cursor"><b>cursor</b></a></dt>
  <dd>The <b>insert-and-predict</b> widget uses this style, in the context
      `<b>:predict</b>', to decide where to place the cursor after completion
      has been tried. Values are:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>complete</b></dt>
  <dd>The cursor is left where it was when completion finished, but only if it
      is after a character equal to the one just inserted by the user. If it is
      after another character, this value is the same as `<b>key</b>'.</dd>
  <dt id="key"><a class="permalink" href="#key"><b>key</b></a></dt>
  <dd>The cursor is left after the <i>n</i>th occurrence of the character just
      inserted, where <i>n</i> is the number of times that character appeared in
      the word before completion was attempted. In short, this has the effect of
      leaving the cursor after the character just typed even if the completion
      code found out that no other characters need to be inserted at that
      position.</dd>
</dl>
<p class="Pp">Any other value for this style unconditionally leaves the cursor
    at the position where the completion code left it.</p>
</div>
<dl class="Bl-tag">
  <dt id="list"><a class="permalink" href="#list"><b>list</b></a></dt>
  <dd>When using the <b>incremental-complete-word</b> widget, this style says if
      the matches should be listed on every key press (if they fit on the
      screen). Use the context prefix `<b>:completion:incremental</b>'.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The <b>insert-and-predict</b> widget uses this style to decide if
    the completion should be shown even if there is only one possible
    completion. This is done if the value of this style is the string
    <b>always</b>. In this case the context is `<b>:predict</b>' (<i>not</i>
    `<b>:completion:predict</b>').</p>
</div>
<dl class="Bl-tag">
  <dt id="match"><a class="permalink" href="#match"><b>match</b></a></dt>
  <dd>This style is used by <b>smart-insert-last-word</b> to provide a pattern
      (using full <b>EXTENDED_GLOB</b> syntax) that matches an interesting word.
      The context is the name of the widget to which
      <b>smart-insert-last-word</b> is bound (see above). The default behavior
      of <b>smart-insert-last-word</b> is equivalent to:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :insert-last-word match '*[[:alpha:]/\\]*'</b></pre>
</div>
<p class="Pp">However, you might want to include words that contain spaces:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :insert-last-word match '*[[:alpha:][:space:]/\\]*'</b></pre>
</div>
<p class="Pp">Or include numbers as long as the word is at least two characters
    long:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :insert-last-word match '*([[:digit:]]?|[[:alpha:]/\\])*'</b></pre>
</div>
<p class="Pp">The above example causes redirections like &quot;2&gt;&quot; to be
    included.</p>
</div>
<dl class="Bl-tag">
  <dt id="prompt~3"><a class="permalink" href="#prompt~3"><b>prompt</b></a></dt>
  <dd>The <b>incremental-complete-word</b> widget shows the value of this style
      in the status line during incremental completion. The string value may
      contain any of the following substrings in the manner of the <b>PS1</b>
      and other prompt parameters:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>%c</b></dt>
  <dd>Replaced by the name of the completer function that generated the matches
      (without the leading underscore).</dd>
  <dt><b>%l</b></dt>
  <dd>When the <b>list</b> style is set, replaced by `<b>...</b>' if the list of
      matches is too long to fit on the screen and with an empty string
      otherwise. If the <b>list</b> style is `false' or not set, `<b>%l</b>' is
      always removed.</dd>
  <dt><b>%n</b></dt>
  <dd>Replaced by the number of matches generated.</dd>
  <dt><b>%s</b></dt>
  <dd>Replaced by `<b>-no match-</b>', `<b>-no prefix-</b>', or an empty string
      if there is no completion matching the word on the line, if the matches
      have no common prefix different from the word on the line, or if there is
      such a common prefix, respectively.</dd>
  <dt><b>%u</b></dt>
  <dd>Replaced by the unambiguous part of all matches, if there is any, and if
      it is different from the word on the line.</dd>
</dl>
<p class="Pp">Like `<b>break-keys</b>', this uses the `<b>:incremental</b>'
    context.</p>
</div>
<dl class="Bl-tag">
  <dt id="stop"><a class="permalink" href="#stop"><b>stop-keys</b></a></dt>
  <dd>This style is used by the <b>incremental-complete-word</b> widget. Its
      value is treated similarly to the one for the <b>break-keys</b> style (and
      uses the same context: `<b>:incremental</b>'). However, in this case all
      keys matching the pattern given as its value will stop incremental
      completion and will then execute their usual function.</dd>
  <dt id="toggle"><a class="permalink" href="#toggle"><b>toggle</b></a></dt>
  <dd>This boolean style is used by <b>predict-on</b> and its related widgets in
      the context `<b>:predict</b>'. If set to one of the standard `true'
      values, predictive typing is automatically toggled off in situations where
      it is unlikely to be useful, such as when editing a multi-line buffer or
      after moving into the middle of a line and then deleting a character. The
      default is to leave prediction turned on until an explicit call to
      <b>predict-off</b>.</dd>
  <dt id="verbose"><a class="permalink" href="#verbose"><b>verbose</b></a></dt>
  <dd>This boolean style is used by <b>predict-on</b> and its related widgets in
      the context `<b>:predict</b>'. If set to one of the standard `true'
      values, these widgets display a message below the prompt when the
      predictive state is toggled. This is most useful in combination with the
      <b>toggle</b> style. The default does not display these messages.</dd>
  <dt id="widget"><a class="permalink" href="#widget"><b>widget</b></a></dt>
  <dd>This style is similar to the <b>command</b> style: For widget functions
      that use <b>zle</b> to call other widgets, this style can sometimes be
      used to override the widget which is called. The context for this style is
      the name of the calling widget (<i>not</i> the name of the calling
      function, because one function may be bound to multiple widget
    names).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle :copy-earlier-word widget smart-insert-last-word</b></pre>
</div>
<p class="Pp">Check the documentation for the calling widget or function to
    determine whether the <b>widget</b> style is used.</p>
</div>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="EXCEPTION_HANDLING"><a class="permalink" href="#EXCEPTION_HANDLING">EXCEPTION
  HANDLING</a></h1>
<p class="Pp">Two functions are provided to enable zsh to provide exception
    handling in a form that should be familiar from other languages.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>throw</b> <i>exception</i></dt>
  <dd>The function <b>throw</b> throws the named <i>exception</i>. The name is
      an arbitrary string and is only used by the <b>throw</b> and <b>catch</b>
      functions. An exception is for the most part treated the same as a shell
      error, i.e. an unhandled exception will cause the shell to abort all
      processing in a function or script and to return to the top level in an
      interactive shell.</dd>
  <dt id="catch"><a class="permalink" href="#catch"><b>catch</b>
    <i>exception-pattern</i></a></dt>
  <dd>The function <b>catch</b> returns status zero if an exception was thrown
      and the pattern <i>exception-pattern</i> matches its name. Otherwise it
      returns status 1. <i>exception-pattern</i> is a standard shell pattern,
      respecting the current setting of the <b>EXTENDED_GLOB</b> option. An
      alias <b>catch</b> is also defined to prevent the argument to the function
      from matching filenames, so patterns may be used unquoted. Note that as
      exceptions are not fundamentally different from other shell errors it is
      possible to catch shell errors by using an empty string as the exception
      name. The shell variable <b>CAUGHT</b> is set by <b>catch</b> to the name
      of the exception caught. It is possible to rethrow an exception by calling
      the <b>throw</b> function again once an exception has been caught.</dd>
</dl>
<p class="Pp">The functions are designed to be used together with the
    <b>always</b> construct described in <i>zshmisc</i>(1). This is important as
    only this construct provides the required support for exceptions. A typical
    example is as follows.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>{</b>
<b>  # &quot;try&quot; block</b>
<b>  # ... nested code here calls &quot;throw MyExcept&quot;</b>
<b>} always {</b>
<b>  # &quot;always&quot; block</b>
<b>  if catch MyExcept; then</b>
<b>    print &quot;Caught exception MyExcept&quot;</b>
<b>  elif catch ''; then</b>
<b>    print &quot;Caught a shell error.  Propagating...&quot;</b>
<b>    throw ''</b>
<b>  fi</b>
<b>  # Other exceptions are not handled but may be caught further</b>
<b>  # up the call stack.</b>
<b>}</b></pre>
</div>
<p class="Pp">If all exceptions should be caught, the following idiom might be
    preferable.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>{</b>
<b>  # ... nested code here throws an exception</b>
<b>} always {</b>
<b>  if catch *; then</b>
<b>    case $CAUGHT in</b>
<b>      (MyExcept)</b>
<b>      print &quot;Caught my own exception&quot;</b>
<b>      ;;</b>
<b>      (*)</b>
<b>      print &quot;Caught some other exception&quot;</b>
<b>      ;;</b>
<b>    esac</b>
<b>  fi</b>
<b>}</b></pre>
</div>
<p class="Pp">In common with exception handling in other languages, the
    exception may be thrown by code deeply nested inside the `try' block.
    However, note that it must be thrown inside the current shell, not in a
    subshell forked for a pipeline, parenthesised current-shell construct, or
    some form of command or process substitution.</p>
<p class="Pp">The system internally uses the shell variable <b>EXCEPTION</b> to
    record the name of the exception between throwing and catching. One drawback
    of this scheme is that if the exception is not handled the variable
    <b>EXCEPTION</b> remains set and may be incorrectly recognised as the name
    of an exception if a shell error subsequently occurs. Adding <b>unset
    EXCEPTION</b> at the start of the outermost layer of any code that uses
    exception handling will eliminate this problem.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="MIME_FUNCTIONS"><a class="permalink" href="#MIME_FUNCTIONS">MIME
  FUNCTIONS</a></h1>
<p class="Pp">Three functions are available to provide handling of files
    recognised by extension, for example to dispatch a file <b>text.ps</b> when
    executed as a command to an appropriate viewer.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>zsh-mime-setup</b> [ <b>-fv</b> ] [ <b>-l</b> [ <i>suffix</i> ... ]
    ]</dt>
  <dd></dd>
  <dt><b>zsh-mime-handler</b> [ <b>-l</b> ] <i>command argument</i> ...</dt>
  <dd>These two functions use the files <b>~/.mime.types</b> and
      <b>/etc/mime.types</b>, which associate types and extensions, as well as
      <b>~/.mailcap</b> and <b>/etc/mailcap</b> files, which associate types and
      the programs that handle them. These are provided on many systems with the
      Multimedia Internet Mail Extensions.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">To enable the system, the function <b>zsh-mime-setup</b> should be
    autoloaded and run. This allows files with extensions to be treated as
    executable; such files be completed by the function completion system. The
    function <b>zsh-mime-handler</b> should not need to be called by the
  user.</p>
<p class="Pp">The system works by setting up suffix aliases with `<b>alias
    -s</b>'. Suffix aliases already installed by the user will not be
    overwritten.</p>
<p class="Pp">For suffixes defined in lower case, upper case variants will also
    automatically be handled (e.g. <b>PDF</b> is automatically handled if
    handling for the suffix <b>pdf</b> is defined), but not vice versa.</p>
<p class="Pp">Repeated calls to <b>zsh-mime-setup</b> do not override the
    existing mapping between suffixes and executable files unless the option
    <b>-f</b> is given. Note, however, that this does not override existing
    suffix aliases assigned to handlers other than <b>zsh-mime-handler</b>.</p>
<p class="Pp">Calling <b>zsh-mime-setup</b> with the option <b>-l</b> lists the
    existing mappings without altering them. Suffixes to list (which may contain
    pattern characters that should be quoted from immediate interpretation on
    the command line) may be given as additional arguments, otherwise all
    suffixes are listed.</p>
<p class="Pp">Calling <b>zsh-mime-setup</b> with the option <b>-v</b> causes
    verbose output to be shown during the setup operation.</p>
<p class="Pp">The system respects the <b>mailcap</b> flags <b>needsterminal</b>
    and <b>copiousoutput</b>, see <i>mailcap</i>(4).</p>
<p class="Pp">The functions use the following styles, which are defined with the
    <b>zstyle</b> builtin command (see <i>zshmodules</i>(1)). They should be
    defined before <b>zsh-mime-setup</b> is run. The contexts used all start
    with <b>:mime:</b>, with additional components in some cases. It is
    recommended that a trailing <b>*</b> (suitably quoted) be appended to style
    patterns in case the system is extended in future. Some examples are given
    below.</p>
<p class="Pp">For files that have multiple suffixes, e.g. <b>.pdf.gz</b>, where
    the context includes the suffix it will be looked up starting with the
    longest possible suffix until a match for the style is found. For example,
    if <b>.pdf.gz</b> produces a match for the handler, that will be used;
    otherwise the handler for <b>.gz</b> will be used. Note that, owing to the
    way suffix aliases work, it is always required that there be a handler for
    the shortest possible suffix, so in this example <b>.pdf.gz</b> can only be
    handled if <b>.gz</b> is also handled (though not necessarily in the same
    way). Alternatively, if no handling for <b>.gz</b> on its own is needed,
    simply adding the command</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>alias -s gz=zsh-mime-handler</b></pre>
</div>
<p class="Pp">to the initialisation code is sufficient; <b>.gz</b> will not be
    handled on its own, but may be in combination with other suffixes.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>current-shell</b></dt>
  <dd>If this boolean style is true, the mailcap handler for the context in
      question is run using the <b>eval</b> builtin instead of by starting a new
      <b>sh</b> process. This is more efficient, but may not work in the
      occasional cases where the mailcap handler uses strict POSIX syntax.</dd>
  <dt id="disown"><a class="permalink" href="#disown"><b>disown</b></a></dt>
  <dd>If this boolean style is true, mailcap handlers started in the background
      will be disowned, i.e. not subject to job control within the parent shell.
      Such handlers nearly always produce their own windows, so the only likely
      harmful side effect of setting the style is that it becomes harder to kill
      jobs from within the shell.</dd>
  <dt id="execute"><a class="permalink" href="#execute"><b>execute-as-is</b></a></dt>
  <dd>This style gives a list of patterns to be matched against files passed for
      execution with a handler program. If the file matches the pattern, the
      entire command line is executed in its current form, with no handler. This
      is useful for files which might have suffixes but nonetheless be
      executable in their own right. If the style is not set, the pattern
      <b>*(*) *(/)</b> is used; hence executable files are executed directly and
      not passed to a handler, and the option <b>AUTO_CD</b> may be used to
      change to directories that happen to have MIME suffixes.</dd>
  <dt id="execute~2"><a class="permalink" href="#execute~2"><b>execute-never</b></a></dt>
  <dd>This style is useful in combination with <b>execute-as-is</b>. It is set
      to an array of patterns corresponding to full paths to files that should
      never be treated as executable, even if the file passed to the MIME
      handler matches <b>execute-as-is</b>. This is useful for file systems that
      don't handle execute permission or that contain executables from another
      operating system. For example, if <b>/mnt/windows</b> is a Windows mount,
      then</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':mime:*' execute-never '/mnt/windows/*'</b></pre>
</div>
<p class="Pp">will ensure that any files found in that area will be executed as
    MIME types even if they are executable. As this example shows, the complete
    file name is matched against the pattern, regardless of how the file was
    passed to the handler. The file is resolved to a full path using the
    <b>:P</b> modifier described in the subsection Modifiers in
    <i>zshexpn</i>(1); this means that symbolic links are resolved where
    possible, so that links into other file systems behave in the correct
    fashion.</p>
</div>
<dl class="Bl-tag">
  <dt id="file"><a class="permalink" href="#file"><b>file-path</b></a></dt>
  <dd>Used if the style <b>find-file-in-path</b> is true for the same context.
      Set to an array of directories that are used for searching for the file to
      be handled; the default is the command path given by the special parameter
      <b>path</b>. The shell option <b>PATH_DIRS</b> is respected; if that is
      set, the appropriate path will be searched even if the name of the file to
      be handled as it appears on the command line contains a `<b>/</b>'. The
      full context is <b>:mime:.</b><i>suffix</i><b>:</b>, as described for the
      style <b>handler</b>.</dd>
  <dt id="find"><a class="permalink" href="#find"><b>find-file-in-path</b></a></dt>
  <dd>If set, allows files whose names do not contain absolute paths to be
      searched for in the command path or the path specified by the
      <b>file-path</b> style. If the file is not found in the path, it is looked
      for locally (whether or not the current directory is in the path); if it
      is not found locally, the handler will abort unless the
      <b>handle-nonexistent</b> style is set. Files found in the path are tested
      as described for the style <b>execute-as-is</b>. The full context is
      <b>:mime:.</b><i>suffix</i><b>:</b>, as described for the style
      <b>handler</b>.</dd>
  <dt id="flags"><a class="permalink" href="#flags"><b>flags</b></a></dt>
  <dd>Defines flags to go with a handler; the context is as for the
      <b>handler</b> style, and the format is as for the flags in
      <b>mailcap</b>.</dd>
  <dt id="handle"><a class="permalink" href="#handle"><b>handle-nonexistent</b></a></dt>
  <dd>By default, arguments that don't correspond to files are not passed to the
      MIME handler in order to prevent it from intercepting commands found in
      the path that happen to have suffixes. This style may be set to an array
      of extended glob patterns for arguments that will be passed to the handler
      even if they don't exist. If it is not explicitly set it defaults to
      <b>[[:alpha:]]#:/*</b> which allows URLs to be passed to the MIME handler
      even though they don't exist in that format in the file system. The full
      context is <b>:mime:.</b><i>suffix</i><b>:</b>, as described for the style
      <b>handler</b>.</dd>
  <dt id="handler"><a class="permalink" href="#handler"><b>handler</b></a></dt>
  <dd>Specifies a handler for a suffix; the suffix is given by the context as
      <b>:mime:.</b><i>suffix</i><b>:</b>, and the format of the handler is
      exactly that in <b>mailcap</b>. Note in particular the `<b>.</b>' and
      trailing colon to distinguish this use of the context. This overrides any
      handler specified by the <b>mailcap</b> files. If the handler requires a
      terminal, the <b>flags</b> style should be set to include the word
      <b>needsterminal</b>, or if the output is to be displayed through a pager
      (but not if the handler is itself a pager), it should include
      <b>copiousoutput</b>.</dd>
  <dt id="mailcap"><a class="permalink" href="#mailcap"><b>mailcap</b></a></dt>
  <dd>A list of files in the format of <b>~/.mailcap</b> and <b>/etc/mailcap</b>
      to be read during setup, replacing the default list which consists of
      those two files. The context is <b>:mime:</b>. A <b>+</b> in the list will
      be replaced by the default files.</dd>
  <dt id="mailcap~2"><a class="permalink" href="#mailcap~2"><b>mailcap-priorities</b></a></dt>
  <dd>This style is used to resolve multiple mailcap entries for the same MIME
      type. It consists of an array of the following elements, in descending
      order of priority; later entries will be used if earlier entries are
      unable to resolve the entries being compared. If none of the tests resolve
      the entries, the first entry encountered is retained.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>files</b></dt>
  <dd>The order of files (entries in the <b>mailcap</b> style) read. Earlier
      files are preferred. (Note this does not resolve entries in the same
      file.)</dd>
  <dt id="priority"><a class="permalink" href="#priority"><b>priority</b></a></dt>
  <dd>The priority flag from the mailcap entry. The priority is an integer from
      0 to 9 with the default value being 5.</dd>
  <dt id="flags~2"><a class="permalink" href="#flags~2"><b>flags</b></a></dt>
  <dd>The test given by the <b>mailcap-prio-flags</b> option is used to resolve
      entries.</dd>
  <dt id="place"><a class="permalink" href="#place"><b>place</b></a></dt>
  <dd>Later entries are preferred; as the entries are strictly ordered, this
      test always succeeds.</dd>
</dl>
<p class="Pp">Note that as this style is handled during initialisation, the
    context is always <b>:mime:</b>, with no discrimination by suffix.</p>
</div>
<dl class="Bl-tag">
  <dt id="mailcap~3"><a class="permalink" href="#mailcap~3"><b>mailcap-prio-flags</b></a></dt>
  <dd>This style is used when the keyword <b>flags</b> is encountered in the
      list of tests specified by the <b>mailcap-priorities</b> style. It should
      be set to a list of patterns, each of which is tested against the flags
      specified in the mailcap entry (in other words, the sets of assignments
      found with some entries in the mailcap file). Earlier patterns in the list
      are preferred to later ones, and matched patterns are preferred to
      unmatched ones.</dd>
  <dt id="mime"><a class="permalink" href="#mime"><b>mime-types</b></a></dt>
  <dd>A list of files in the format of <b>~/.mime.types</b> and
      <b>/etc/mime.types</b> to be read during setup, replacing the default list
      which consists of those two files. The context is <b>:mime:</b>. A
      <b>+</b> in the list will be replaced by the default files.</dd>
  <dt id="never"><a class="permalink" href="#never"><b>never-background</b></a></dt>
  <dd>If this boolean style is set, the handler for the given context is always
      run in the foreground, even if the flags provided in the mailcap entry
      suggest it need not be (for example, it doesn't require a terminal).</dd>
  <dt id="pager"><a class="permalink" href="#pager"><b>pager</b></a></dt>
  <dd>If set, will be used instead of <b>$PAGER</b> or <b>more</b> to handle
      suffixes where the <b>copiousoutput</b> flag is set. The context is as for
      <b>handler</b>, i.e. <b>:mime:.</b><i>suffix</i><b>:</b> for handling a
      file with the given <i>suffix</i>.</dd>
</dl>
<p class="Pp">Examples:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':mime:*' mailcap ~/.mailcap /usr/local/etc/mailcap</b>
<b>zstyle ':mime:.txt:' handler less %s</b>
<b>zstyle ':mime:.txt:' flags needsterminal</b></pre>
</div>
<p class="Pp">When <b>zsh-mime-setup</b> is subsequently run, it will look for
    <b>mailcap</b> entries in the two files given. Files of suffix <b>.txt</b>
    will be handled by running `<b>less</b> <i>file.txt</i>'. The flag
    <b>needsterminal</b> is set to show that this program must run attached to a
    terminal.</p>
<p class="Pp">As there are several steps to dispatching a command, the following
    should be checked if attempting to execute a file by extension
    <b>.</b><i>ext</i> does not have the expected effect.</p>
<p class="Pp">The command `<b>alias -s</b> <i>ext</i>' should show
    `<b>ps=zsh-mime-handler</b>'. If it shows something else, another suffix
    alias was already installed and was not overwritten. If it shows nothing, no
    handler was installed: this is most likely because no handler was found in
    the <b>.mime.types</b> and <b>mailcap</b> combination for <b>.ext</b> files.
    In that case, appropriate handling should be added to <b>~/.mime.types</b>
    and <b>mailcap</b>.</p>
<p class="Pp">If the extension is handled by <b>zsh-mime-handler</b> but the
    file is not opened correctly, either the handler defined for the type is
    incorrect, or the flags associated with it are in appropriate. Running
    <b>zsh-mime-setup -l</b> will show the handler and, if there are any, the
    flags. A <b>%s</b> in the handler is replaced by the file (suitably quoted
    if necessary). Check that the handler program listed lists and can be run in
    the way shown. Also check that the flags <b>needsterminal</b> or
    <b>copiousoutput</b> are set if the handler needs to be run under a
    terminal; the second flag is used if the output should be sent to a pager.
    An example of a suitable <b>mailcap</b> entry for such a program is:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>text/html; /usr/bin/lynx '%s'; needsterminal</b></pre>
</div>
<p class="Pp">Running `<b>zsh-mime-handler -l</b> <i>command line</i>' prints
    the command line that would be executed, simplified to remove the effect of
    any flags, and quoted so that the output can be run as a complete zsh
    command line. This is used by the completion system to decide how to
    complete after a file handled by <b>zsh-mime-setup</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="pick"><a class="permalink" href="#pick"><b>pick-web-browser</b></a></dt>
  <dd>This function is separate from the two MIME functions described above and
      can be assigned directly to a suffix:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -U pick-web-browser</b>
<b>alias -s html=pick-web-browser</b></pre>
</div>
<p class="Pp">It is provided as an intelligent front end to dispatch a web
    browser. It may be run as either a function or a shell script. The status
    255 is returned if no browser could be started.</p>
<p class="Pp">Various styles are available to customize the choice of
  browsers:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>browser-style</b></dt>
  <dd>The value of the style is an array giving preferences in decreasing order
      for the type of browser to use. The values of elements may be</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>running</b></dt>
  <dd>Use a GUI browser that is already running when an X Window display is
      available. The browsers listed in the <b>x-browsers</b> style are tried in
      order until one is found; if it is, the file will be displayed in that
      browser, so the user may need to check whether it has appeared. If no
      running browser is found, one is not started. Browsers other than Firefox,
      Opera and Konqueror are assumed to understand the Mozilla syntax for
      opening a URL remotely.</dd>
  <dt id="x"><a class="permalink" href="#x"><b>x</b></a></dt>
  <dd>Start a new GUI browser when an X Window display is available. Search for
      the availability of one of the browsers listed in the <b>x-browsers</b>
      style and start the first one that is found. No check is made for an
      already running browser.</dd>
  <dt id="tty"><a class="permalink" href="#tty"><b>tty</b></a></dt>
  <dd>Start a terminal-based browser. Search for the availability of one of the
      browsers listed in the <b>tty-browsers</b> style and start the first one
      that is found.</dd>
</dl>
<p class="Pp">If the style is not set the default <b>running x tty</b> is
  used.</p>
</div>
<dl class="Bl-tag">
  <dt id="x~2"><a class="permalink" href="#x~2"><b>x-browsers</b></a></dt>
  <dd>An array in decreasing order of preference of browsers to use when running
      under the X Window System. The array consists of the command name under
      which to start the browser. They are looked up in the context
      <b>:mime:</b> (which may be extended in future, so appending `<b>*</b>' is
      recommended). For example,</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle ':mime:*' x-browsers opera konqueror firefox</b></pre>
</div>
<p class="Pp">specifies that <b>pick-web-browser</b> should first look for a
    running instance of Opera, Konqueror or Firefox, in that order, and if it
    fails to find any should attempt to start Opera. The default is <b>firefox
    mozilla netscape opera konqueror</b>.</p>
</div>
<dl class="Bl-tag">
  <dt id="tty~2"><a class="permalink" href="#tty~2"><b>tty-browsers</b></a></dt>
  <dd>An array similar to <b>x-browsers</b>, except that it gives browsers to
      use when no X Window display is available. The default is <b>elinks links
      lynx</b>.</dd>
  <dt id="command~4"><a class="permalink" href="#command~4"><b>command</b></a></dt>
  <dd>If it is set this style is used to pick the command used to open a page
      for a browser. The context is <b>:mime:browser:new:$browser:</b> to start
      a new browser or <b>:mime:browser:running:$browser:</b> to open a URL in a
      browser already running on the current X display, where <b>$browser</b> is
      the value matched in the <b>x-browsers</b> or <b>tty-browsers</b> style.
      The escape sequence <b>%b</b> in the style's value will be replaced by the
      browser, while <b>%u</b> will be replaced by the URL. If the style is not
      set, the default for all new instances is equivalent to <b>%b %u</b> and
      the defaults for using running browsers are equivalent to the values
      <b>kfmclient openURL %u</b> for Konqueror, <b>firefox -new-tab %u</b> for
      Firefox, <b>opera -newpage %u</b> for Opera, and <b>%b -remote
      &quot;openUrl(%u)&quot;</b> for all others.</dd>
</dl>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="MATHEMATICAL_FUNCTIONS"><a class="permalink" href="#MATHEMATICAL_FUNCTIONS">MATHEMATICAL
  FUNCTIONS</a></h1>
<dl class="Bl-tag">
  <dt><b>zcalc</b> [ <b>-erf</b> ] [ <i>expression</i> ... ]</dt>
  <dd>A reasonably powerful calculator based on zsh's arithmetic evaluation
      facility. The syntax is similar to that of formulae in most programming
      languages; see the section `Arithmetic Evaluation' in <i>zshmisc</i>(1)
      for details.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Non-programmers should note that, as in many other programming
    languages, expressions involving only integers (whether constants without a
    `<b>.</b>', variables containing such constants as strings, or variables
    declared to be integers) are by default evaluated using integer arithmetic,
    which is not how an ordinary desk calculator operates. To force floating
    point operation, pass the option <b>-f</b>; see further notes below.</p>
<p class="Pp">If the file <b>~/.zcalcrc</b> exists it will be sourced inside the
    function once it is set up and about to process the command line. This can
    be used, for example, to set shell options; <b>emulate -L zsh</b> and
    <b>setopt extendedglob</b> are in effect at this point. Any failure to
    source the file if it exists is treated as fatal. As with other
    initialisation files, the directory <b>$ZDOTDIR</b> is used instead of
    <b>$HOME</b> if it is set.</p>
<p class="Pp">The mathematical library <b>zsh/mathfunc</b> will be loaded if it
    is available; see the section `The zsh/mathfunc Module' in
    <i>zshmodules</i>(1). The mathematical functions correspond to the raw
    system libraries, so trigonometric functions are evaluated using radians,
    and so on.</p>
<p class="Pp">Each line typed is evaluated as an expression. The prompt shows a
    number, which corresponds to a positional parameter where the result of that
    calculation is stored. For example, the result of the calculation on the
    line preceded by `<b>4&gt; </b>' is available as <b>$4</b>. The last value
    calculated is available as <b>ans</b>. Full command line editing, including
    the history of previous calculations, is available; the history is saved in
    the file <b>~/.zcalc_history</b>. To exit, enter a blank line or type
    `<b>:q</b>' on its own (`<b>q</b>' is allowed for historical
  compatibility).</p>
<p class="Pp">A line ending with a single backslash is treated in the same
    fashion as it is in command line editing: the backslash is removed, the
    function prompts for more input (the prompt is preceded by `<b>...</b>' to
    indicate this), and the lines are combined into one to get the final result.
    In addition, if the input so far contains more open than close parentheses
    <b>zcalc</b> will prompt for more input.</p>
<p class="Pp">If arguments are given to <b>zcalc</b> on start up, they are used
    to prime the first few positional parameters. A visual indication of this is
    given when the calculator starts.</p>
<p class="Pp">The constants <b>PI</b> (3.14159...) and <b>E</b> (2.71828...) are
    provided. Parameter assignment is possible, but note that all parameters
    will be put into the global namespace unless the <b>:local</b> special
    command is used. The function creates local variables whose names start with
    <b>_</b>, so users should avoid doing so. The variables <b>ans</b> (the last
    answer) and <b>stack</b> (the stack in RPN mode) may be referred to
    directly; <b>stack</b> is an array but elements of it are numeric. Various
    other special variables are used locally with their standard meaning, for
    example <b>compcontext</b>, <b>match</b>, <b>mbegin</b>, <b>mend</b>,
    <b>psvar</b>.</p>
<p class="Pp">The output base can be initialised by passing the option
    `<b>-#</b><i>base</i>', for example `<b>zcalc -#16</b>' (the `<b>#</b>' may
    have to be quoted, depending on the globbing options set).</p>
<p class="Pp">If the option `<b>-e</b>' is set, the function runs
    non-interactively: the arguments are treated as expressions to be evaluated
    as if entered interactively line by line.</p>
<p class="Pp">If the option `<b>-f</b>' is set, all numbers are treated as
    floating point, hence for example the expression `<b>3/4</b>' evaluates to
    0.75 rather than 0. Options must appear in separate words.</p>
<p class="Pp">If the option `<b>-r</b>' is set, RPN (Reverse Polish Notation)
    mode is entered. This has various additional properties:</p>
<dl class="Bl-tag">
  <dt>Stack</dt>
  <dd>Evaluated values are maintained in a stack; this is contained in an array
      named <b>stack</b> with the most recent value in <b>${stack[1]}</b>.</dd>
  <dt id="Operators"><a class="permalink" href="#Operators">Operators and
    functions</a></dt>
  <dd>If the line entered matches an operator (<b>+</b>, <b>-</b>, <b>*</b>,
      <b>/</b>, <b>**</b>, <b>^</b>, <b>|</b> or <b>&amp;</b>) or a function
      supplied by the <b>zsh/mathfunc</b> library, the bottom element or
      elements of the stack are popped to use as the argument or arguments. The
      higher elements of stack (least recent) are used as earlier arguments. The
      result is then pushed into <b>${stack[1]}</b>.</dd>
  <dt id="Expressions"><a class="permalink" href="#Expressions">Expressions</a></dt>
  <dd>Other expressions are evaluated normally, printed, and added to the stack
      as numeric values. The syntax within expressions on a single line is
      normal shell arithmetic (not RPN).</dd>
  <dt id="Stack"><a class="permalink" href="#Stack">Stack listing</a></dt>
  <dd>If an integer follows the option <b>-r</b> with no space, then on every
      evaluation that many elements of the stack, where available, are printed
      instead of just the most recent result. Hence, for example, <b>zcalc
      -r4</b> shows <b>$stack[4]</b> to <b>$stack[1]</b> each time results are
      printed.</dd>
  <dt id="Duplication:"><a class="permalink" href="#Duplication:">Duplication:
    <b>=</b></a></dt>
  <dd>The pseudo-operator <b>=</b> causes the most recent element of the stack
      to be duplicated onto the stack.</dd>
  <dt id="pop"><a class="permalink" href="#pop"><b>pop</b></a></dt>
  <dd>The pseudo-function <b>pop</b> causes the most recent element of the stack
      to be popped. A `<b>&gt;</b>' on its own has the same effect.</dd>
  <dt><b>&gt;</b><i>ident</i></dt>
  <dd>The expression <b>&gt;</b> followed (with no space) by a shell identifier
      causes the most recent element of the stack to be popped and assigned to
      the variable with that name. The variable is local to the <b>zcalc</b>
      function.</dd>
  <dt><b>&lt;</b><i>ident</i></dt>
  <dd>The expression <b>&lt;</b> followed (with no space) by a shell identifier
      causes the value of the variable with that name to be pushed onto the
      stack. <i>ident</i> may be an integer, in which case the previous result
      with that number (as shown before the <b>&gt;</b> in the standard
      <b>zcalc</b> prompt) is put on the stack.</dd>
  <dt id="Exchange:"><a class="permalink" href="#Exchange:">Exchange:
    <b>xy</b></a></dt>
  <dd>The pseudo-function <b>xy</b> causes the most recent two elements of the
      stack to be exchanged. `<b>&lt;&gt;</b>' has the same effect.</dd>
</dl>
<p class="Pp">The prompt is configurable via the parameter <b>ZCALCPROMPT</b>,
    which undergoes standard prompt expansion. The index of the current entry is
    stored locally in the first element of the array <b>psvar</b>, which can be
    referred to in <b>ZCALCPROMPT</b> as `<b>%1v</b>'. The default prompt is
    `<b>%1v&gt; </b>'.</p>
<p class="Pp">The variable <b>ZCALC_ACTIVE</b> is set within the function and
    can be tested by nested functions; it has the value <b>rpn</b> if RPN mode
    is active, else 1.</p>
<p class="Pp">A few special commands are available; these are introduced by a
    colon. For backward compatibility, the colon may be omitted for certain
    commands. Completion is available if <b>compinit</b> has been run.</p>
<p class="Pp">The output precision may be specified within zcalc by special
    commands familiar from many calculators.</p>
<dl class="Bl-tag">
  <dt><b>:norm</b></dt>
  <dd>The default output format. It corresponds to the printf <b>%g</b>
      specification. Typically this shows six decimal digits.</dd>
  <dt><b>:sci</b> <i>digits</i></dt>
  <dd>Scientific notation, corresponding to the printf <b>%g</b> output format
      with the precision given by <i>digits</i>. This produces either fixed
      point or exponential notation depending on the value output.</dd>
  <dt><b>:fix</b> <i>digits</i></dt>
  <dd>Fixed point notation, corresponding to the printf <b>%f</b> output format
      with the precision given by <i>digits</i>.</dd>
  <dt><b>:eng</b> <i>digits</i></dt>
  <dd>Exponential notation, corresponding to the printf <b>%E</b> output format
      with the precision given by <i>digits</i>.</dd>
  <dt><b>:raw</b></dt>
  <dd>Raw output: this is the default form of the output from a math evaluation.
      This may show more precision than the number actually possesses.</dd>
</dl>
<p class="Pp">Other special commands:</p>
<dl class="Bl-tag">
  <dt><b>:!</b><i>line...</i></dt>
  <dd>Execute <i>line...</i> as a normal shell command line. Note that it is
      executed in the context of the function, i.e. with local variables. Space
      is optional after <b>:!</b>.</dd>
  <dt><b>:local</b> <i>arg</i> ...</dt>
  <dd>Declare variables local to the function. Other variables may be used, too,
      but they will be taken from or put into the global scope.</dd>
  <dt><b>:function</b> <i>name</i> [ <i>body</i> ]</dt>
  <dd>Define a mathematical function or (with no <i>body</i>) delete it.
      <b>:function</b> may be abbreviated to <b>:func</b> or simply <b>:f</b>.
      The <i>name</i> may contain the same characters as a shell function name.
      The function is defined using <b>zmathfuncdef</b>, see below.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Note that <b>zcalc</b> takes care of all quoting. Hence for
    example:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>:f cube $1 * $1 * $1</b></pre>
</div>
<p class="Pp">defines a function to cube the sole argument. Functions so
    defined, or indeed any functions defined directly or indirectly using
    <b>functions</b> <b>-M</b>, are available to execute by typing only the name
    on the line in RPN mode; this pops the appropriate number of arguments off
    the stack to pass to the function, i.e. 1 in the case of the example
    <b>cube</b> function. If there are optional arguments only the mandatory
    arguments are supplied by this means.</p>
</div>
<dl class="Bl-tag">
  <dt><b>[#</b><i>base</i><b>]</b></dt>
  <dd>This is not a special command, rather part of normal arithmetic syntax;
      however, when this form appears on a line by itself the default output
      radix is set to <i>base</i>. Use, for example, `<b>[#16]</b>' to display
      hexadecimal output preceded by an indication of the base, or
      `<b>[##16]</b>' just to display the raw number in the given base. Bases
      themselves are always specified in decimal. `<b>[#]</b>' restores the
      normal output format. Note that setting an output base suppresses floating
      point output; use `<b>[#]</b>' to return to normal operation.</dd>
  <dt><b>$</b><i>var</i></dt>
  <dd>Print out the value of var literally; does not affect the calculation. To
      use the value of var, omit the leading `<b>$</b>'.</dd>
</dl>
<p class="Pp">See the comments in the function for a few extra tips.</p>
</div>
<dl class="Bl-tag">
  <dt><b>min(</b><i>arg</i><b>, ...)</b></dt>
  <dd></dd>
  <dt><b>max(</b><i>arg</i><b>, ...)</b></dt>
  <dd></dd>
  <dt><b>sum(</b><i>arg</i><b>, ...)</b></dt>
  <dd></dd>
  <dt><b>zmathfunc</b></dt>
  <dd>The function <b>zmathfunc</b> defines the three mathematical functions
      <b>min</b>, <b>max</b>, and <b>sum</b>. The functions <b>min</b> and
      <b>max</b> take one or more arguments. The function <b>sum</b> takes zero
      or more arguments. Arguments can be of different types (ints and
    floats).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Not to be confused with the <b>zsh/mathfunc</b> module, described
    in the section `The zsh/mathfunc Module' in <i>zshmodules</i>(1).</p>
</div>
<dl class="Bl-tag">
  <dt id="zmathfuncdef"><a class="permalink" href="#zmathfuncdef"><b>zmathfuncdef</b>
    [ <i>mathfunc</i> [ <i>body</i> ] ]</a></dt>
  <dd>A convenient front end to <b>functions -M</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">With two arguments, define a mathematical function named
    <i>mathfunc</i> which can be used in any form of arithmetic evaluation.
    <i>body</i> is a mathematical expression to implement the function. It may
    contain references to position parameters <b>$1</b>, <b>$2</b>, ... to refer
    to mandatory parameters and <b>${1:-</b><i>defvalue</i><b>}</b> ... to refer
    to optional parameters. Note that the forms must be strictly adhered to for
    the function to calculate the correct number of arguments. The
    implementation is held in a shell function named
    <b>zsh_math_func_</b><i>mathfunc</i>; usually the user will not need to
    refer to the shell function directly. Any existing function of the same name
    is silently replaced.</p>
<p class="Pp">With one argument, remove the mathematical function
    <i>mathfunc</i> as well as the shell function implementation.</p>
<p class="Pp">With no arguments, list all <i>mathfunc</i> functions in a form
    suitable for restoring the definition. The functions have not necessarily
    been defined by <b>zmathfuncdef</b>.</p>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="USER_CONFIGURATION_FUNCTIONS"><a class="permalink" href="#USER_CONFIGURATION_FUNCTIONS">USER
  CONFIGURATION FUNCTIONS</a></h1>
<p class="Pp">The <b>zsh/newuser</b> module comes with a function to aid in
    configuring shell options for new users. If the module is installed, this
    function can also be run by hand. It is available even if the module's
    default behaviour, namely running the function for a new user logging in
    without startup files, is inhibited.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>zsh-newuser-install</b> [ <b>-f</b> ]</dt>
  <dd>The function presents the user with various options for customizing their
      initialization scripts. Currently only <b>~/.zshrc</b> is handled.
      <b>$ZDOTDIR/.zshrc</b> is used instead if the parameter <b>ZDOTDIR</b> is
      set; this provides a way for the user to configure a file without altering
      an existing <b>.zshrc</b>.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">By default the function exits immediately if it finds any of the
    files <b>.zshenv</b>, <b>.zprofile</b>, <b>.zshrc</b>, or <b>.zlogin</b> in
    the appropriate directory. The option <b>-f</b> is required in order to
    force the function to continue. Note this may happen even if <b>.zshrc</b>
    itself does not exist.</p>
<p class="Pp">As currently configured, the function will exit immediately if the
    user has root privileges; this behaviour cannot be overridden.</p>
<p class="Pp">Once activated, the function's behaviour is supposed to be
    self-explanatory. Menus are present allowing the user to alter the value of
    options and parameters. Suggestions for improvements are always welcome.</p>
<p class="Pp">When the script exits, the user is given the opportunity to save
    the new file or not; changes are not irreversible until this point. However,
    the script is careful to restrict changes to the file only to a group marked
    by the lines `<b># Lines configured by zsh-newuser-install</b>' and `<b>#
    End of lines configured by zsh-newuser-install</b>'. In addition, the old
    version of <b>.zshrc</b> is saved to a file with the suffix <b>.zni</b>
    appended.</p>
<p class="Pp">If the function edits an existing <b>.zshrc</b>, it is up to the
    user to ensure that the changes made will take effect. For example, if
    control usually returns early from the existing <b>.zshrc</b> the lines will
    not be executed; or a later initialization file may override options or
    parameters, and so on. The function itself does not attempt to detect any
    such conflicts.</p>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="OTHER_FUNCTIONS"><a class="permalink" href="#OTHER_FUNCTIONS">OTHER
  FUNCTIONS</a></h1>
<p class="Pp">There are a large number of helpful functions in the
    <b>Functions/Misc</b> directory of the zsh distribution. Most are very
    simple and do not require documentation here, but a few are worthy of
    special mention.</p>
<section class="Ss">
<h2 class="Ss" id="Descriptions"><a class="permalink" href="#Descriptions">Descriptions</a></h2>
<dl class="Bl-tag">
  <dt><b>colors</b></dt>
  <dd>This function initializes several associative arrays to map color names to
      (and from) the ANSI standard eight-color terminal codes. These are used by
      the prompt theme system (see above). You seldom should need to run
      <b>colors</b> more than once.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The eight base colors are: <b>black</b>, <b>red</b>, <b>green</b>,
    <b>yellow</b>, <b>blue</b>, <b>magenta</b>, <b>cyan</b>, and <b>white</b>.
    Each of these has codes for foreground and background. In addition there are
    seven intensity attributes: <b>bold</b>, <b>faint</b>, <b>standout</b>,
    <b>underline</b>, <b>blink</b>, <b>reverse</b>, and <b>conceal</b>. Finally,
    there are seven codes used to negate attributes: <b>none</b> (reset all
    attributes to the defaults), <b>normal</b> (neither bold nor faint),
    <b>no-standout</b>, <b>no-underline</b>, <b>no-blink</b>, <b>no-reverse</b>,
    and <b>no-conceal</b>.</p>
<p class="Pp">Some terminals do not support all combinations of colors and
    intensities.</p>
<p class="Pp">The associative arrays are:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt><b>color</b></dt>
  <dd></dd>
  <dt><b>colour</b></dt>
  <dd>Map all the color names to their integer codes, and integer codes to the
      color names. The eight base names map to the foreground color codes, as do
      names prefixed with `<b>fg-</b>', such as `<b>fg-red</b>'. Names prefixed
      with `<b>bg-</b>', such as `<b>bg-blue</b>', refer to the background
      codes. The reverse mapping from code to color yields base name for
      foreground codes and the <b>bg-</b> form for backgrounds.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Although it is a misnomer to call them `colors', these arrays also
    map the other fourteen attributes from names to codes and codes to
  names.</p>
</div>
<dl class="Bl-tag">
  <dt><b>fg</b></dt>
  <dd></dd>
  <dt><b>fg_bold</b></dt>
  <dd></dd>
  <dt><b>fg_no_bold</b></dt>
  <dd>Map the eight basic color names to ANSI terminal escape sequences that set
      the corresponding foreground text properties. The <b>fg</b> sequences
      change the color without changing the eight intensity attributes.</dd>
  <dt><b>bg</b></dt>
  <dd></dd>
  <dt><b>bg_bold</b></dt>
  <dd></dd>
  <dt><b>bg_no_bold</b></dt>
  <dd>Map the eight basic color names to ANSI terminal escape sequences that set
      the corresponding background properties. The <b>bg</b> sequences change
      the color without changing the eight intensity attributes.</dd>
</dl>
<p class="Pp">In addition, the scalar parameters <b>reset_color</b> and
    <b>bold_color</b> are set to the ANSI terminal escapes that turn off all
    attributes and turn on bold intensity, respectively.</p>
</div>
<dl class="Bl-tag">
  <dt id="fned"><a class="permalink" href="#fned"><b>fned</b> [ <b>-x</b>
    <i>num</i> ] <i>name</i></a></dt>
  <dd>Same as <b>zed -f</b>. This function does not appear in the zsh
      distribution, but can be created by linking <b>zed</b> to the name
      <b>fned</b> in some directory in your <b>fpath</b>.</dd>
  <dt id="is"><a class="permalink" href="#is"><b>is-at-least</b> <i>needed</i> [
    <i>present</i> ]</a></dt>
  <dd>Perform a greater-than-or-equal-to comparison of two strings having the
      format of a zsh version number; that is, a string of numbers and text with
      segments separated by dots or dashes. If the <i>present</i> string is not
      provided, <b>$ZSH_VERSION</b> is used. Segments are paired left-to-right
      in the two strings with leading non-number parts ignored. If one string
      has fewer segments than the other, the missing segments are considered
      zero.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This is useful in startup files to set options and other state
    that are not available in all versions of zsh.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>is-at-least 3.1.6-15 &amp;&amp; setopt NO_GLOBAL_RCS</b>
<b>is-at-least 3.1.0 &amp;&amp; setopt HIST_REDUCE_BLANKS</b>
<b>is-at-least 2.6-17 || print &quot;You can't use is-at-least here.&quot;</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="nslookup"><a class="permalink" href="#nslookup"><b>nslookup</b> [
    <i>arg</i> ... ]</a></dt>
  <dd>This wrapper function for the <b>nslookup</b> command requires the
      <b>zsh/zpty</b> module (see <i>zshmodules</i>(1)). It behaves exactly like
      the standard <b>nslookup</b> except that it provides customizable prompts
      (including a right-side prompt) and completion of nslookup commands, host
      names, etc. (if you use the function-based completion system). Completion
      styles may be set with the context prefix
    `<b>:completion:nslookup</b>'.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">See also the <b>pager</b>, <b>prompt</b> and <b>rprompt</b> styles
    below.</p>
</div>
<dl class="Bl-tag">
  <dt id="regexp"><a class="permalink" href="#regexp"><b>regexp-replace</b>
    <i>var</i> <i>regexp</i> <i>replace</i></a></dt>
  <dd>Use regular expressions to perform a global search and replace operation
      on a variable. POSIX extended regular expressions are used, unless the
      option <b>RE_MATCH_PCRE</b> has been set, in which case Perl-compatible
      regular expressions are used (this requires the shell to be linked against
      the <b>pcre</b> library).</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"><i>var</i> is the name of the variable containing the string to be
    matched. The variable will be modified directly by the function. The
    variables <b>MATCH</b>, <b>MBEGIN</b>, <b>MEND</b>, <b>match</b>,
    <b>mbegin</b>, <b>mend</b> should be avoided as these are used by the
    regular expression code.</p>
<p class="Pp"><i>regexp</i> is the regular expression to match against the
    string.</p>
<p class="Pp"><i>replace</i> is the replacement text. This can contain
    parameter, command and arithmetic expressions which will be replaced: in
    particular, a reference to <b>$MATCH</b> will be replaced by the text
    matched by the pattern.</p>
<p class="Pp">The return status is 0 if at least one match was performed, else
    1.</p>
</div>
<dl class="Bl-tag">
  <dt id="run"><a class="permalink" href="#run"><b>run-help</b>
    <i>cmd</i></a></dt>
  <dd>This function is designed to be invoked by the <b>run-help</b> ZLE widget,
      in place of the default alias. See `Accessing On-Line Help' above for
      setup instructions.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">In the discussion which follows, if <i>cmd</i> is a file system
    path, it is first reduced to its rightmost component (the file name).</p>
<p class="Pp">Help is first sought by looking for a file named <i>cmd</i> in the
    directory named by the <b>HELPDIR</b> parameter. If no file is found, an
    assistant function, alias, or command named
    <b>run-help-</b><i>cmd</i><b></b><i> is sought. If</i> <i>found, the
    assistant is executed with the rest of the current command line</i>
    <i>(everything after the command name </i><i>cmd</i><i>) as its arguments.
    When</i> <i>neither file nor assistant is found, the external command</i>
    <i>`</i><b>man</b><i> </i><i>cmd</i><i>' is run.</i></p>
<p class="Pp">An example assistant for the &quot;ssh&quot; command:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>run-help-ssh() {</b>
<b>    emulate -LR zsh</b>
<b>    local -a args</b>
<b>    # Delete the &quot;-l username&quot; option</b>
<b>    zparseopts -D -E -a args l:</b>
<b>    # Delete other options, leaving: host command</b>
<b>    args=(${@:#-*})</b>
<b>    if [[ ${#args} -lt 2 ]]; then</b>
<b>        man ssh</b>
<b>    else</b>
<b>        run-help $args[2]</b>
<b>    fi</b>
<b>}</b></pre>
</div>
<p class="Pp">Several of these assistants are provided in the
    <b>Functions/Misc</b> directory. These must be autoloaded, or placed as
    executable scripts in your search path, in order to be found and used by
    <b>run-help</b>.</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt>run-help-git</dt>
  <dd></dd>
  <dt>run-help-ip</dt>
  <dd></dd>
  <dt>run-help-openssl</dt>
  <dd></dd>
  <dt>run-help-p4</dt>
  <dd></dd>
  <dt>run-help-sudo</dt>
  <dd></dd>
  <dt>run-help-svk</dt>
  <dd></dd>
  <dt><b>run-help-svn</b></dt>
  <dd>Assistant functions for the <b>git</b>, <b>ip</b>, <b>openssl</b>,
      <b>p4</b>, <b>sudo</b>, <b>svk</b>, and <b>svn</b>, commands.</dd>
</dl>
</div>
<dl class="Bl-tag">
  <dt id="tetris"><a class="permalink" href="#tetris"><b>tetris</b></a></dt>
  <dd>Zsh was once accused of not being as complete as Emacs, because it lacked
      a Tetris game. This function was written to refute this vicious
    slander.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This function must be used as a ZLE widget:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -U tetris</b>
<b>zle -N tetris</b>
<b>bindkey </b><i>keys</i><b> tetris</b><i></i></pre>
</div>
<p class="Pp">To start a game, execute the widget by typing the <i>keys</i>.
    Whatever command line you were editing disappears temporarily, and your
    keymap is also temporarily replaced by the Tetris control keys. The previous
    editor state is restored when you quit the game (by pressing `<b>q</b>') or
    when you lose.</p>
<p class="Pp">If you quit in the middle of a game, the next invocation of the
    <b>tetris</b> widget will continue where you left off. If you lost, it will
    start a new game.</p>
</div>
<dl class="Bl-tag">
  <dt id="tetriscurses"><a class="permalink" href="#tetriscurses"><b>tetriscurses</b></a></dt>
  <dd>This is a port of the above to zcurses. The input handling is improved a
      bit so that moving a block sideways doesn't automatically advance a
      timestep, and the graphics use unicode block graphics.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">This version does not save the game state between invocations, and
    is not invoked as a widget, but rather as:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -U tetriscurses</b>
<b>tetriscurses</b></pre>
</div>
</div>
<dl class="Bl-tag">
  <dt id="zargs"><a class="permalink" href="#zargs"><b>zargs</b> [ <i>option</i>
    ... <b>-</b><b>-</b> ] [ <i>input</i> ... ] [ <b>-</b><b>-</b>
    <i>command</i> [ <i>arg</i> ... ] ]</a></dt>
  <dd>This function has a similar purpose to GNU xargs. Instead of reading lines
      of arguments from the standard input, it takes them from the command line.
      This is useful because zsh, especially with recursive glob operators,
      often can construct a command line for a shell function that is longer
      than can be accepted by an external command.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">The <i>option</i> list represents options of the <b>zargs</b>
    command itself, which are the same as those of <b>xargs</b>. The
    <i>input</i> list is the collection of strings (often file names) that
    become the arguments of the <b>command</b>, analogous to the standard input
    of <b>xargs</b>. Finally, the <i>arg</i> list consists of those arguments
    (usually options) that are passed to the <i>command</i> each time it runs.
    The <i>arg</i> list precedes the elements from the <b>input</b> list in each
    run. If no <i>command</i> is provided, then no <i>arg</i> list may be
    provided, and in that event the default command is `<b>print</b>' with
    arguments `<b>-r -</b><b>-</b>'.</p>
<p class="Pp">For example, to get a long <b>ls</b> listing of all non-hidden
    plain files in the current directory or its subdirectories:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>autoload -U zargs</b>
<b>zargs -- **/*(.) -- ls -ld --</b></pre>
</div>
<p class="Pp">The first and third occurrences of `<b>-</b><b>-</b>' are used to
    mark the end of options for <b>zargs</b> and <b>ls</b> respectively to guard
    against filenames starting with `<b>-</b>', while the second is used to
    separate the list of files from the command to run (`<b>ls -ld --</b>').</p>
<p class="Pp">The first `<b>-</b><b>-</b>' would also be needed if there was a
    chance the list might be empty as in:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zargs -r -- ./*.back(#qN) -- rm -f</b></pre>
</div>
<p class="Pp">In the event that the string `<b>-</b><b>-</b>' is or may be an
    <i>input</i>, the <b>-e</b> option may be used to change the end-of-inputs
    marker. Note that this does <i>not</i> change the end-of-options marker. For
    example, to use `<b>..</b>' as the marker:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zargs -e.. -- **/*(.) .. ls -ld --</b></pre>
</div>
<p class="Pp">This is a good choice in that example because no plain file can be
    named `<b>..</b>', but the best end-marker depends on the circumstances.</p>
<p class="Pp">The options <b>-i</b>, <b>-I</b>, <b>-l</b>, <b>-L</b>, and
    <b>-n</b> differ slightly from their usage in <b>xargs</b>. There are no
    input lines for <b>zargs</b> to count, so <b>-l</b> and <b>-L</b> count
    through the <i>input</i> list, and <b>-n</b> counts the number of arguments
    passed to each execution of <i>command</i>, <i>including</i> any <i>arg</i>
    list. Also, any time <b>-i</b> or <b>-I</b> is used, each <i>input</i> is
    processed separately as if by `<b>-L</b> <b>1</b>'.</p>
<p class="Pp">For details of the other <b>zargs</b> options, see <i>xargs</i>(1)
    (but note the difference in function between <b>zargs</b> and <b>xargs</b>)
    or run <b>zargs</b> with the <b>-</b><b>-help</b> option.</p>
</div>
<dl class="Bl-tag">
  <dt><b>zed</b> [ <b>-f</b> [ <b>-x</b> <i>num</i> ] ] <i>name</i></dt>
  <dd></dd>
  <dt><b>zed -b</b></dt>
  <dd>This function uses the ZLE editor to edit a file or function.</dd>
</dl>
<div class="Bd-indent">
<p class="Pp">Only one <i>name</i> argument is allowed. If the <b>-f</b> option
    is given, the name is taken to be that of a function; if the function is
    marked for autoloading, <b>zed</b> searches for it in the <b>fpath</b> and
    loads it. Note that functions edited this way are installed into the current
    shell, but <i>not</i> written back to the autoload file. In this case the
    <b>-x</b> option specifies that leading tabs indenting the function
    according to syntax should be converted into the given number of spaces;
    `<b>-x 2</b>' is consistent with the layout of functions distributed with
    the shell.</p>
<p class="Pp">Without <b>-f</b>, <i>name</i> is the path name of the file to
    edit, which need not exist; it is created on write, if necessary.</p>
<p class="Pp">While editing, the function sets the main keymap to <b>zed</b> and
    the vi command keymap to <b>zed-vicmd</b>. These will be copied from the
    existing <b>main</b> and <b>vicmd</b> keymaps if they do not exist the first
    time <b>zed</b> is run. They can be used to provide special key bindings
    used only in zed.</p>
<p class="Pp">If it creates the keymap, <b>zed</b> rebinds the return key to
    insert a line break and `<b>^X^W</b>' to accept the edit in the <b>zed</b>
    keymap, and binds `<b>ZZ</b>' to accept the edit in the <b>zed-vicmd</b>
    keymap.</p>
<p class="Pp">The bindings alone can be installed by running `<b>zed -b</b>'.
    This is suitable for putting into a startup file. Note that, if rerun, this
    will overwrite the existing <b>zed</b> and <b>zed-vicmd</b> keymaps.</p>
<p class="Pp">Completion is available, and styles may be set with the context
    prefix `<b>:completion:zed</b>'.</p>
<p class="Pp">A zle widget <b>zed-set-file-name</b> is available. This can be
    called by name from within zed using `<b>\ex zed-set-file-name</b>' (note,
    however, that because of zed's rebindings you will have to type <b>^j</b> at
    the end instead of the return key), or can be bound to a key in either of
    the <b>zed</b> or <b>zed-vicmd</b> keymaps after `<b>zed -b</b>' has been
    run. When the widget is called, it prompts for a new name for the file being
    edited. When zed exits the file will be written under that name and the
    original file will be left alone. The widget has no effect with `<b>zed
    -f</b>'.</p>
<p class="Pp">While <b>zed-set-file-name</b> is running, zed uses the keymap
    <b>zed-normal-keymap</b>, which is linked from the main keymap in effect at
    the time zed initialised its bindings. (This is to make the return key
    operate normally.) The result is that if the main keymap has been changed,
    the widget won't notice. This is not a concern for most users.</p>
</div>
<dl class="Bl-tag">
  <dt><b>zcp</b> [ <b>-finqQvwW</b> ] <i>srcpat</i> <i>dest</i></dt>
  <dd></dd>
  <dt><b>zln</b> [ <b>-finqQsvwW</b> ] <i>srcpat</i> <i>dest</i></dt>
  <dd>Same as <b>zmv -C</b> and <b>zmv -L</b>, respectively. These functions do
      not appear in the zsh distribution, but can be created by linking
      <b>zmv</b> to the names <b>zcp</b> and <b>zln</b> in some directory in
      your <b>fpath</b>.</dd>
  <dt id="zkbd"><a class="permalink" href="#zkbd"><b>zkbd</b></a></dt>
  <dd>See `Keyboard Definition' above.
    <p class="Pp"></p>
  </dd>
  <dt><b>zmv</b> [ <b>-finqQsvwW</b> ] [ <b>-C</b> | <b>-L</b> | <b>-M</b> |
    -{<b>p</b>|<b>P</b>} <i>program</i> ] [ <b>-o</b> <i>optstring</i> ]</dt>
  <dd></dd>
  <dt><b> </b><i>srcpat</i> <i>dest</i></dt>
  <dd>Move (usually, rename) files matching the pattern <i>srcpat</i> to
      corresponding files having names of the form given by <i>dest</i>, where
      <i>srcpat</i> contains parentheses surrounding patterns which will be
      replaced in turn by <b>$1</b>, <b>$2</b>, ... in <i>dest</i>. For
    example,</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zmv '(*).lis' '$1.txt'</b></pre>
</div>
<p class="Pp">renames `<b>foo.lis</b>' to `<b>foo.txt</b>',
    `<b>my.old.stuff.lis</b>' to `<b>my.old.stuff.txt</b>', and so on.</p>
<p class="Pp">The pattern is always treated as an <b>EXTENDED_GLOB</b> pattern.
    Any file whose name is not changed by the substitution is simply ignored.
    Any error (a substitution resulted in an empty string, two substitutions
    gave the same result, the destination was an existing regular file and
    <b>-f</b> was not given) causes the entire function to abort without doing
    anything.</p>
<p class="Pp">In addition to pattern replacement, the variable <b>$f</b> can be
    referrred to in the second (replacement) argument. This makes it possible to
    use variable substitution to alter the argument; see examples below.</p>
<p class="Pp">Options:</p>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt id="f"><a class="permalink" href="#f"><b>-f</b></a></dt>
  <dd>Force overwriting of destination files. Not currently passed down to the
      <b>mv</b>/<b>cp</b>/<b>ln</b> command due to vagaries of implementations
      (but you can use <b>-o-f</b> to do that).</dd>
  <dt id="i"><a class="permalink" href="#i"><b>-i</b></a></dt>
  <dd>Interactive: show each line to be executed and ask the user whether to
      execute it. `<b>Y</b>' or `<b>y</b>' will execute it, anything else will
      skip it. Note that you just need to type one character.</dd>
  <dt id="n"><a class="permalink" href="#n"><b>-n</b></a></dt>
  <dd>No execution: print what would happen, but don't do it.</dd>
  <dt id="q"><a class="permalink" href="#q"><b>-q</b></a></dt>
  <dd>Turn bare glob qualifiers off: now assumed by default, so this has no
      effect.</dd>
  <dt id="Q"><a class="permalink" href="#Q"><b>-Q</b></a></dt>
  <dd>Force bare glob qualifiers on. Don't turn this on unless you are actually
      using glob qualifiers in a pattern.</dd>
  <dt id="s~4"><a class="permalink" href="#s~4"><b>-s</b></a></dt>
  <dd>Symbolic, passed down to <b>ln</b>; only works with <b>-L</b>.</dd>
  <dt id="v"><a class="permalink" href="#v"><b>-v</b></a></dt>
  <dd>Verbose: print each command as it's being executed.</dd>
  <dt id="w~2"><a class="permalink" href="#w~2"><b>-w</b></a></dt>
  <dd>Pick out wildcard parts of the pattern, as described above, and implicitly
      add parentheses for referring to them.</dd>
  <dt id="W"><a class="permalink" href="#W"><b>-W</b></a></dt>
  <dd>Just like <b>-w</b>, with the addition of turning wildcards in the
      replacement pattern into sequential <b>${1}</b> .. <b>${N}</b>
    references.</dd>
  <dt id="C~2"><a class="permalink" href="#C~2"><b>-C</b></a></dt>
  <dd></dd>
  <dt id="L"><a class="permalink" href="#L"><b>-L</b></a></dt>
  <dd></dd>
  <dt id="M~2"><a class="permalink" href="#M~2"><b>-M</b></a></dt>
  <dd>Force <b>cp</b>, <b>ln</b> or <b>mv</b>, respectively, regardless of the
      name of the function.</dd>
  <dt id="p~4"><a class="permalink" href="#p~4"><b>-p</b>
    <i>program</i></a></dt>
  <dd>Call <i>program</i> instead of <b>cp</b>, <b>ln</b> or <b>mv</b>. Whatever
      it does, it should at least understand the form `<i>program</i>
      <b>-</b><b>-</b> <i>oldname</i> <i>newname</i>' where <i>oldname</i> and
      <i>newname</i> are filenames generated by <b>zmv</b>. <i>program</i> will
      be split into words, so might be e.g. the name of an archive tool plus a
      copy or rename subcommand.</dd>
  <dt id="P"><a class="permalink" href="#P"><b>-P</b> <i>program</i></a></dt>
  <dd>As <b>-p</b> <i>program</i>, except that <i>program</i> does not accept a
      following <b>-</b><b>-</b> to indicate the end of options. In this case
      filenames must already be in a sane form for the program in question.</dd>
  <dt id="o~2"><a class="permalink" href="#o~2"><b>-o</b>
    <i>optstring</i></a></dt>
  <dd>The <i>optstring</i> is split into words and passed down verbatim to the
      <b>cp</b>, <b>ln</b> or <b>mv</b> command called to perform the work. It
      should probably begin with a `<b>-</b>'.</dd>
</dl>
<p class="Pp">Further examples:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zmv -v '(* *)' '${1// /_}'</b></pre>
</div>
<p class="Pp">For any file in the current directory with at least one space in
    the name, replace every space by an underscore and display the commands
    executed.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zmv -v '* *' '${f// /_}'</b></pre>
</div>
<p class="Pp">This does exactly the same by referring to the file name stored in
    <b>$f</b>.</p>
<p class="Pp">For more complete examples and other implementation details, see
    the <b>zmv</b> source file, usually located in one of the directories named
    in your <b>fpath</b>, or in <b>Functions/Misc/zmv</b> in the zsh
    distribution.</p>
</div>
<dl class="Bl-tag">
  <dt id="zrecompile"><a class="permalink" href="#zrecompile"><b>zrecompile</b></a></dt>
  <dd>See `Recompiling Functions' above.</dd>
  <dt id="zstyle+"><a class="permalink" href="#zstyle+"><b>zstyle+</b>
    <i>context</i> <i>style</i> <i>value</i> [ <b>+</b> <i>subcontext</i>
    <i>style</i> <i>value</i> ... ]</a></dt>
  <dd>This makes defining styles a bit simpler by using a single `<b>+</b>' as a
      special token that allows you to append a context name to the previously
      used context name. Like this:</dd>
</dl>
<div class="Bd-indent">
<p class="Pp"></p>
<div class="Bd-indent">
<pre><b>zstyle+ ':foo:bar' </b><i>style1</i><b> </b><i>value1</i><b> \ </b>
<b>       +':baz'     </b><i>style2</i><b> </b><i>value2</i><b> \ </b>
<b>       +':frob'    </b><i>style3</i><b> </b><i>value3</i><b></b><i></i></pre>
</div>
<p class="Pp">This defines <i>style1</i> with <i>value1</i> for the context
    <b>:foo:bar</b> as usual, but it also defines <i>style2</i> with
    <i>value2</i> for the context <b>:foo:bar:baz</b> and <i>style3</i> with
    <i>value3</i> for <b>:foo:bar:frob</b>. Any <i>subcontext</i> may be the
    empty string to re-use the first context unchanged.</p>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Styles~2"><a class="permalink" href="#Styles~2">Styles</a></h2>
<dl class="Bl-tag">
  <dt><b>insert-tab</b></dt>
  <dd>The <b>zed</b> function <i>sets</i> this style in context
      `<b>:completion:zed:*</b>' to turn off completion when <b>TAB</b> is typed
      at the beginning of a line. You may override this by setting your own
      value for this context and style.</dd>
  <dt id="pager~2"><a class="permalink" href="#pager~2"><b>pager</b></a></dt>
  <dd>The <b>nslookup</b> function looks up this style in the context
      `<b>:nslookup</b>' to determine the program used to display output that
      does not fit on a single screen.</dd>
  <dt><b>prompt</b></dt>
  <dd></dd>
  <dt><b>rprompt</b></dt>
  <dd>The <b>nslookup</b> function looks up this style in the context
      `<b>:nslookup</b>' to set the prompt and the right-side prompt,
      respectively. The usual expansions for the <b>PS1</b> and <b>RPS1</b>
      parameters may be used (see EXPANSION OF PROMPT SEQUENCES in
      <i>zshmisc</i>(1)).</dd>
</dl>
</section>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">February 12, 2022</td>
    <td class="foot-os">zsh 5.8.1</td>
  </tr>
</table>
</body>
</html>
