<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Copyright (c) 2016-2020, Apple Inc.  All rights reserved.
   -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>KTRACE(1)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">KTRACE(1)</td>
    <td class="head-vol">General Commands Manual</td>
    <td class="head-rtitle">KTRACE(1)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">ktrace</code> &#x2014;
    <span class="Nd">configure, record, and print events from kernel
    trace</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<dl class="Bl-hang Bl-compact">
  <dt><code class="Nm">ktrace</code> <code class="Cm">info</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">trace</code></dt>
  <dd>[<code class="Fl">-ACNnrSstu</code>] [<code class="Fl">-R</code>
      <var class="Ar">path</var> | <code class="Fl">-E</code>]
      [<code class="Fl">-C</code> <var class="Ar">codes-path</var>
      [<var class="Ar">...</var>]] [<code class="Fl">-T</code>
      <var class="Ar">timeout</var>] [<code class="Fl">-f</code>
      <var class="Ar">filter-desc</var>] [<code class="Fl">-b</code>
      <var class="Ar">buffer-size-mb</var>] [<code class="Fl">-x</code>
      <var class="Ar">pid-or-process-name</var> [<var class="Ar">...</var>] |
      <code class="Fl">-p</code> <var class="Ar">pid-or-process-name</var>
      [<var class="Ar">...</var>]] [<code class="Fl">--json</code> |
      <code class="Fl">--csv</code> | <code class="Fl">--ndjson</code> |
      <code class="Fl">--json-64</code>] [<code class="Fl">-c</code>
      <var class="Ar">command</var> [...]]
      [<code class="Fl">--only-named-events</code>]
      [<code class="Fl">--no-default-codes-files</code>]
      [<code class="Fl">--continuous</code>]
      [<code class="Fl">--disable-coprocessors</code>]</dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">dump</code></dt>
  <dd>[<code class="Fl">-E</code>] [<code class="Fl">-f</code>
      <var class="Ar">filter-desc</var>] [<code class="Fl">-l</code>
      <var class="Ar">compression-level</var>] [<code class="Fl">-T</code>
      <var class="Ar">timeout</var>] [<code class="Fl">-b</code>
      <var class="Ar">buffer-size-mb</var>] [<code class="Fl">-p</code>
      <var class="Ar">pid-or-process-name</var>]
      [<code class="Fl">--stackshot-flags</code>
      <var class="Ar">extra-flags</var>]
      [<code class="Fl">--include-log-content</code>]
      [<code class="Fl">--disable-coprocessors</code>]
      [<code class="Fl">--notify-tracing-started</code>
      <var class="Ar">key</var>] [<var class="Ar">path</var>]</dd>
  <dt id="b"><code class="Nm">ktrace</code> <code class="Cm">init</code></dt>
  <dd><a class="permalink" href="#b"><code class="Fl">-b</code></a>
      <var class="Ar">buffer-size-mb</var> |
      <a class="permalink" href="#n"><code class="Fl" id="n">-n</code></a>
      <var class="Ar">n-events</var></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">setopt</code></dt>
  <dd>[<code class="Fl">-f</code> <var class="Ar">filter-desc</var>]
      [<code class="Fl">-w</code>] [<code class="Fl">-x</code>
      <var class="Ar">pid-or-process-name</var> [<var class="Ar">...</var>] |
      <code class="Fl">-p</code> <var class="Ar">pid-or-process-name</var>
      [<var class="Ar">...</var>]]</dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">enable</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">disable</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">remove</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">reset</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">decode</code>
    <var class="Ar">debugid</var> [<var class="Ar">debugid</var>
    [<var class="Ar">...</var>]]</dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">emit</code></dt>
  <dd><var class="Ar">debugid</var> [arg1 [arg2 [arg3 [arg4]]]]</dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">symbolicate</code></dt>
  <dd><var class="Ar">path</var></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">machine</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">config</code></dt>
  <dd></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">compress</code></dt>
  <dd>[<code class="Fl">-l</code> <code class="Fl">-fast|balanced|small</code>]
      <var class="Ar">path</var></dd>
  <dt><code class="Nm">ktrace</code> <code class="Cm">artrace</code></dt>
  <dd>[<code class="Fl">-nr</code>] [<code class="Fl">-t</code>
      <var class="Ar">timeout</var>] [<code class="Fl">-i</code>
      <var class="Ar">interval</var>] [<code class="Fl">-o</code>
      <var class="Ar">filename</var>] [<code class="Fl">-b</code>
      <var class="Ar">buffer-size-mb</var>] [<code class="Fl">-f</code>
      <var class="Ar">filter-desc</var>] [<code class="Fl">-F</code>
      <var class="Ar">filter-desc</var>] [<code class="Fl">-p</code>
      <var class="Ar">pid-or-process-name</var>]
      [<code class="Fl">--kperf</code>=<var class="Ar">sampler-name</var>[,<var class="Ar">sampler-name</var>@]<var class="Ar">timer-period</var>|<var class="Ar">timer-frequency</var>|<var class="Ar">kdebug-filter-desc</var>]
      [<code class="Fl">--remote</code>[=<var class="Ar">remote-device</var>]]
      [<code class="Fl">--type</code>=<var class="Ar">full</var>|<var class="Ar">profile</var>|<var class="Ar">lite</var>|<var class="Ar">morelite</var>|<var class="Ar">none</var>]
      [<code class="Fl">--stackshot-flags</code>
      <var class="Ar">extra-flags</var>]
      [<code class="Fl">--notify-tracing-started</code>
      <var class="Ar">key</var>] [<code class="Fl">-c</code>
      <var class="Ar">command</var> [...]]</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp"><code class="Nm">ktrace</code> can configure the system to trace
    events, or record them to a file, and print a human-readable representation
    of the events.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SUBCOMMANDS"><a class="permalink" href="#SUBCOMMANDS">SUBCOMMANDS</a></h1>
<p class="Pp"><code class="Nm">ktrace</code> uses a subcommand syntax to
    separate different functionality into logical groups. Each subcommand takes
    its own set of options, though a few options may be used in multiple
    subcommands.</p>
<dl class="Bl-tag">
  <dt id="info"><a class="permalink" href="#info"><code class="Cm">info</code></a></dt>
  <dd>Print information about the current configuration of kernel trace.</dd>
  <dt id="trace"><a class="permalink" href="#trace"><code class="Cm">trace</code></a>
    [<code class="Fl">-ACNnrSstu</code>] [<code class="Fl">-R</code>
    <var class="Ar">path</var> | <code class="Fl">-E</code>]
    [<code class="Fl">-C</code> <var class="Ar">codes-path</var>
    [<var class="Ar">...</var>]] [<code class="Fl">-T</code>
    <var class="Ar">timeout</var>] [<code class="Fl">-f</code>
    <var class="Ar">filter-desc</var>] [<code class="Fl">-b</code>
    <var class="Ar">buffer-size-mb</var>] [<code class="Fl">-x</code>
    <var class="Ar">pid-or-process-name</var> [<var class="Ar">...</var>] |
    <code class="Fl">-p</code> <var class="Ar">pid-or-process-name</var>
    [<var class="Ar">...</var>]] [<code class="Fl">--json</code> |
    <code class="Fl">--csv</code> | <code class="Fl">--ndjson</code> |
    <code class="Fl">--json-64</code>] [<code class="Fl">-c</code>
    <var class="Ar">command</var> [...]]
    [<code class="Fl">--only-named-events</code>]
    [<code class="Fl">--no-default-codes-files</code>]
    [<code class="Fl">--continuous</code>]
    [<code class="Fl">--disable-coprocessors</code>]</dt>
  <dd>
    <p class="Pp">Print events to <a class="Xr" href="../4/stdout">stdout(4)</a>
        in a human-readable format, automatically providing wall clock time,
        process names, and event names for each event. Without the
        <code class="Fl">-R</code> or <code class="Fl">-E</code> options,
        <code class="Nm">ktrace</code> initializes the trace buffers to a
        reasonable size and enables tracing until it terminates.</p>
    <dl class="Bl-tag">
      <dt id="R"><a class="permalink" href="#R"><code class="Fl">-R</code></a>
        <var class="Ar">path</var></dt>
      <dd>Print events from the trace file at <var class="Ar">path</var>.</dd>
      <dt id="E"><a class="permalink" href="#E"><code class="Fl">-E</code></a></dt>
      <dd>Use an existing configuration, instead of creating a new
          configuration. This is necessary to use the
          <code class="Cm">trace</code> subcommand with other
          <code class="Nm">ktrace</code> subcommands, like
          <code class="Cm">init</code> and <code class="Cm">setopt</code>.</dd>
      <dt id="N"><a class="permalink" href="#N"><code class="Fl">-N</code></a></dt>
      <dd>Don't display names of events.</dd>
      <dt id="C"><a class="permalink" href="#C"><code class="Fl">-C</code></a></dt>
      <dd>Print timestamps in continuous time.</dd>
      <dt id="n~2"><a class="permalink" href="#n~2"><code class="Fl">-n</code></a></dt>
      <dd>Display thread names.</dd>
      <dt id="r"><a class="permalink" href="#r"><code class="Fl">-r</code></a></dt>
      <dd>Just configure and start trace running in windowed or ring buffer mode
          -- do not print the events. <code class="Nm">ktrace</code>
          <code class="Cm">trace</code> <code class="Fl">-E</code> can later be
          used to read the in-memory events.</dd>
      <dt id="S"><a class="permalink" href="#S"><code class="Fl">-S</code></a></dt>
      <dd>Print arguments as strings for tracepoints known to include
        strings</dd>
      <dt id="s"><a class="permalink" href="#s"><code class="Fl">-s</code></a></dt>
      <dd>Attempt to symbolicate addresses found in arguments to symbols.</dd>
      <dt id="t"><a class="permalink" href="#t"><code class="Fl">-t</code></a></dt>
      <dd>Print times as Mach absolute timestamps, instead of the default local
          wall clock time.</dd>
      <dt id="A"><a class="permalink" href="#A"><code class="Fl">-A</code></a></dt>
      <dd>Print times as seconds since the start of trace.</dd>
      <dt id="u"><a class="permalink" href="#u"><code class="Fl">-u</code></a></dt>
      <dd>Attempt to symbolicate addressess to uuid-offset tuples.</dd>
      <dt id="C~2"><a class="permalink" href="#C~2"><code class="Fl">-C</code></a>
        <var class="Ar">codes-path</var></dt>
      <dd>Use a custom codes file to provide event ID to name mappings. See
          <a class="Xr" href="../1/trace">trace(1)</a> for more details on the
          format of codes files.</dd>
      <dt id="b~2"><a class="permalink" href="#b~2"><code class="Fl">-b</code></a>
        <var class="Ar">buffer-size-mb</var></dt>
      <dd>Set a custom buffer size in megabytes.</dd>
      <dt id="f"><a class="permalink" href="#f"><code class="Fl">-f</code></a>
        <var class="Ar">filter-desc</var></dt>
      <dd>Apply a filter description to the trace session, controlling which
          events are traced. See
          <a class="Sx" href="#FILTER_DESCRIPTIONS">FILTER DESCRIPTIONS</a> for
          details on the syntax of a filter. If no filter description is
          provided, all events will be traced.</dd>
      <dt id="T"><a class="permalink" href="#T"><code class="Fl">-T</code></a>
        <var class="Ar">timeout</var></dt>
      <dd>End tracing after <var class="Ar">timeout</var> has elapsed. Suffixes
          like <code class="Li">ns</code> or <code class="Li">ms</code> are
          supported, but seconds are the default if just a number is
        supplied.</dd>
      <dt id="x"><a class="permalink" href="#x"><code class="Fl">-x</code></a>
        <var class="Ar">pid-or-process-name</var> [<var class="Ar">...</var>] |
        <a class="permalink" href="#p"><code class="Fl" id="p">-p</code></a>
        <var class="Ar">pid-or-process-name</var>
        [<var class="Ar">...</var>]</dt>
      <dd>Restrict the processes that can trace events. Either exclude
          (<code class="Fl">-x</code>) or only trace events
          (<code class="Fl">-p</code>) from the provided processes by name or
          pid. These options are mutually exlusive. Processes that cannot be
          attached to are always excluded on release kernels. Similarly, events
          in the Mach scheduling subclass are included, regardless of the this
          option, to allow tools to maintain thread scheduling state
        machines.</dd>
      <dt id="json"><a class="permalink" href="#json"><code class="Fl">--json</code></a></dt>
      <dd>Print events as an array of JSON objects.</dd>
      <dt id="csv"><a class="permalink" href="#csv"><code class="Fl">--csv</code></a></dt>
      <dd>Print events as CSV entries.</dd>
      <dt id="ndjson"><a class="permalink" href="#ndjson"><code class="Fl">--ndjson</code></a></dt>
      <dd>Print events as a stream of newline-delimited JSON objects.</dd>
      <dt id="json-64"><a class="permalink" href="#json-64"><code class="Fl">--json-64</code></a></dt>
      <dd>Print events as JSON objects, with 64-bit numbers.</dd>
      <dt id="c"><a class="permalink" href="#c"><code class="Fl">-c</code></a>
        <var class="Ar">command</var> [...]</dt>
      <dd>Run the command specified by <var class="Ar">command</var> and stop
          tracing when it exits. All arguments after this option are passed to
          the command.</dd>
    </dl>
  </dd>
  <dt id="dump"><a class="permalink" href="#dump"><code class="Cm">dump</code></a></dt>
  <dd>
    <p class="Pp">Write trace to a file at <var class="Ar">path</var> for later
        inspection with <code class="Nm">ktrace</code>
        <code class="Cm">trace</code> <code class="Fl">-R</code>. If no
        <var class="Ar">path</var> is specified, the tool writes to a new,
        numbered file in the working directory, starting with
        <code class="Li">trace001.ktrace</code>. The command continues to write
        events until <code class="Nm">ktrace</code> is terminated, the optional
        timeout triggers, or the trace buffers fill up when using an existing
        configuration with wrapping disabled. If a compression level is
        specified, the file is compressed as it is written. Using non-default
        values for this option may increase the overhead of collecting
      events.</p>
    <dl class="Bl-tag">
      <dt id="E~2"><a class="permalink" href="#E~2"><code class="Fl">-E</code></a></dt>
      <dd>Use an existing configuration, instead of creating a new
          configuration.</dd>
      <dt id="f~2"><a class="permalink" href="#f~2"><code class="Fl">-f</code></a>
        <var class="Ar">filter-desc</var></dt>
      <dd>Apply a filter description to events written to the file, controlling
          which events are traced. See
          <a class="Sx" href="#FILTER_DESCRIPTIONS">FILTER DESCRIPTIONS</a> for
          details on the syntax of a filter. If no filter description is
          provided, all events will be traced.</dd>
      <dt id="p~2"><a class="permalink" href="#p~2"><code class="Fl">-p</code></a>
        <var class="Ar">pid-or-process-name</var></dt>
      <dd>Only record events that occur for the process identified by
          <var class="Ar">pid</var> or <var class="Ar">process-name</var>. Only
          the first 16 characters of the name are observed, due to a kernel
          limitation. <a class="Sx" href="#FILTER_DESCRIPTIONS">FILTER
          DESCRIPTIONS</a> for details on the syntax of a filter. If no filter
          description is provided, all events will be traced.</dd>
      <dt id="p~3"><a class="permalink" href="#p~3"><code class="Fl">-p</code></a></dt>
      <dd>Enable kperf sampling.</dd>
      <dt id="T~2"><a class="permalink" href="#T~2"><code class="Fl">-T</code></a>
        <var class="Ar">timeout</var></dt>
      <dd>End tracing after <var class="Ar">timeout</var> has elapsed. Suffixes
          like <code class="Li">ns</code> or <code class="Li">ms</code> are
          supported, but seconds are the default if just a number is
        supplied.</dd>
      <dt id="stackshot-flags"><a class="permalink" href="#stackshot-flags"><code class="Fl">--stackshot-flags</code></a>
        <var class="Ar">extra-flags</var></dt>
      <dd>Pass the provided <var class="Ar">extra-flags</var> integer as
          additional flags when recording stackshots.</dd>
      <dt id="notify-tracing-started"><a class="permalink" href="#notify-tracing-started"><code class="Fl">--notify-tracing-started</code></a>
        <var class="Ar">key</var></dt>
      <dd>Post a notification on <var class="Ar">key</var> after tracing has
          started.</dd>
    </dl>
  </dd>
  <dt id="init"><a class="permalink" href="#init"><code class="Cm">init</code></a>
    <code class="Fl">-b</code> <var class="Ar">buffer-size-mb</var> |
    <a class="permalink" href="#n~3"><code class="Fl" id="n~3">-n</code></a>
    <var class="Ar">n-events</var></dt>
  <dd>
    <p class="Pp">Initialize trace to allocate
        <var class="Ar">buffer-size-mb</var> megabytes of space or
        <var class="Ar">n-events</var> events for its trace buffers. This
        subcommand must be provided before using the
        <code class="Cm">setopt</code>, <code class="Cm">enable</code>, or
        <code class="Cm">disable</code> subcommands initially or after using the
        <code class="Cm">remove</code> subcommand.</p>
  </dd>
  <dt id="setopt"><a class="permalink" href="#setopt"><code class="Cm">setopt</code></a>
    [<code class="Fl">-f</code> <var class="Ar">filter-desc</var>]
    [<code class="Fl">-w</code>] [<code class="Fl">-x</code>
    <var class="Ar">pid-or-process-name</var> [<var class="Ar">...</var>] |
    <code class="Fl">-p</code> <var class="Ar">pid-or-process-name</var>
    [<var class="Ar">...</var>]]</dt>
  <dd>
    <p class="Pp">Set options on the existing trace configuration. The trace
        configuration must already be initialized.</p>
    <dl class="Bl-tag">
      <dt id="f~3"><a class="permalink" href="#f~3"><code class="Fl">-f</code></a>
        <var class="Ar">filter-desc</var></dt>
      <dd>Apply a filter description to the current configuration, controlling
          which events are traced. See
          <a class="Sx" href="#FILTER_DESCRIPTIONS">FILTER DESCRIPTIONS</a> for
          details on the syntax of a filter. If no filter description is
          provided, all events will be traced.</dd>
      <dt id="w"><a class="permalink" href="#w"><code class="Fl">-w</code></a></dt>
      <dd>Configure trace to operate in &#x201C;windowed&#x201D; mode, where the
          trace buffer acts as a ring buffer, removing old events to make room
          for new ones. By default, tracing ends when the buffer runs out of
          space for new events.</dd>
      <dt id="x~2"><a class="permalink" href="#x~2"><code class="Fl">-x</code></a>
        <var class="Ar">pid-or-process-name</var> [<var class="Ar">...</var>] |
        <a class="permalink" href="#p~4"><code class="Fl" id="p~4">-p</code></a>
        <var class="Ar">pid-or-process-name</var>
        [<var class="Ar">...</var>]</dt>
      <dd>Restrict the processes that can trace events. Either exclude
          (<code class="Fl">-x</code>) or only trace events
          (<code class="Fl">-p</code>) from the provided processes by name or
          pid. These options are mutually exlusive. Processes that cannot be
          attached to are always excluded on release kernels. Similarly, events
          in the Mach scheduling subclass are included, regardless of the this
          option, to allow tools to maintain thread scheduling state
        machines.</dd>
    </dl>
  </dd>
  <dt id="enable"><a class="permalink" href="#enable"><code class="Cm">enable</code></a></dt>
  <dd>Start tracing events.</dd>
  <dt id="disable"><a class="permalink" href="#disable"><code class="Cm">disable</code></a></dt>
  <dd>Stop tracing events. Tracing can be started again after it has been
      disabled, using the same configuration.</dd>
  <dt id="remove"><a class="permalink" href="#remove"><code class="Cm">remove</code></a></dt>
  <dd>Remove the current trace configuration and free the memory associated with
      tracing.</dd>
  <dt id="reset"><a class="permalink" href="#reset"><code class="Cm">reset</code></a></dt>
  <dd>Reset tracing and associated subsystems, including kperf, to their default
      state.</dd>
  <dt id="decode"><a class="permalink" href="#decode"><code class="Cm">decode</code></a>
    <var class="Ar">debugid</var> [debugid [<var class="Ar">...</var>]]</dt>
  <dd>Print the components that make up the provided
      <var class="Ar">debugids</var>.</dd>
  <dt id="emit"><a class="permalink" href="#emit"><code class="Cm">emit</code></a>
    <var class="Ar">debugid</var> [arg1 [arg2 [arg3 [arg4]]]]</dt>
  <dd>
    <p class="Pp">Emit an event into the trace stream with the provided
        <var class="Ar">debugid</var> and arguments.</p>
  </dd>
  <dt id="symbolicate"><a class="permalink" href="#symbolicate"><code class="Cm">symbolicate</code></a>
    <var class="Ar">path</var></dt>
  <dd>Symbolicate the trace file located at <var class="Ar">path</var>.</dd>
  <dt id="config"><a class="permalink" href="#config"><code class="Cm">config</code></a></dt>
  <dd>Print the current system's trace configuration.</dd>
  <dt id="machine"><a class="permalink" href="#machine"><code class="Cm">machine</code></a></dt>
  <dd>Print the current system's machine information.</dd>
  <dt id="compress"><a class="permalink" href="#compress"><code class="Cm">compress</code></a>
    [<code class="Fl">-l</code> <span class="No">fast|balanced|small</span>]
    <var class="Ar">path</var></dt>
  <dd>Compress the trace file located at <var class="Ar">path</var> using the
      small compression level, unless otherwise specified with the
      <code class="Fl">-l</code> option.</dd>
  <dt id="artrace"><a class="permalink" href="#artrace"><code class="Cm">artrace</code></a>
    [<code class="Fl">-nr</code>] [<code class="Fl">-t</code>
    <var class="Ar">timeout</var>] [<code class="Fl">-i</code>
    <var class="Ar">interval</var>] [<code class="Fl">-o</code>
    <var class="Ar">filename</var>] [<code class="Fl">-b</code>
    <var class="Ar">buffer-size-mb</var>] [<code class="Fl">-f</code>
    <var class="Ar">filter-desc</var>] [<code class="Fl">-F</code>
    <var class="Ar">filter-desc</var>] [<code class="Fl">-p</code>
    <var class="Ar">pid-or-process-name</var>]
    [<code class="Fl">--remote</code>[=<var class="Ar">device-name</var>]]
    [<code class="Fl">--type</code>=<var class="Ar">full</var>|<var class="Ar">profile</var>|<var class="Ar">lite</var>|<var class="Ar">morelite</var>|<var class="Ar">none</var>]
    [<code class="Fl">--kperf</code>=<var class="Ar">sampler-name</var>,<var class="Ar">sampler-name</var>@<var class="Ar">timer-period</var>|<var class="Ar">timer-frequency</var>|<var class="Ar">kdebug-filter-desc</var>]
    [<code class="Fl">-d</code> <var class="Ar">group</var>]
    [<code class="Fl">-e</code> <var class="Ar">group</var>]
    [<code class="Fl">--stackshot-flags</code>
    <var class="Ar">extra-flags</var>]
    [<code class="Fl">--disable-coprocessors</code>] [<code class="Fl">-c</code>
    <var class="Ar">command</var> [...]]</dt>
  <dd>Profile the system, writing trace events to an automatically named file.
      By default, this measures scheduler, VM, and system call usage, and
      samples threads on-core periodically.
    <dl class="Bl-tag">
      <dt id="o"><a class="permalink" href="#o"><code class="Fl">-o</code></a>
        <var class="Ar">path</var></dt>
      <dd>Specify the name of the file to be created.</dd>
      <dt id="f~4"><a class="permalink" href="#f~4"><code class="Fl">-f</code></a>
        <var class="Ar">filter-desc</var></dt>
      <dd>Trace the classes and subclasses specified by the filter description.
          See <a class="Sx" href="#FILTER_DESCRIPTIONS">FILTER DESCRIPTIONS</a>
          for details on the syntax of a filter.</dd>
      <dt id="F"><a class="permalink" href="#F"><code class="Fl">-F</code></a>
        <var class="Ar">filter-desc</var></dt>
      <dd>Exclude events from the default set. Use this options with care, since
          analysis tools may rely on certain events being present.</dd>
      <dt id="t~2"><a class="permalink" href="#t~2"><code class="Fl">-t</code></a>
        <var class="Ar">timeout</var></dt>
      <dd>Stop tracing and exit after <var class="Ar">timeout</var> option is
          provided, stop tracing and exit after <var class="Ar">timeout</var>
          has elapsed. The timeout value may have <code class="Li">us</code>,
          <code class="Li">ms</code>, or <code class="Li">s</code> appended to
          indicate the time units.</dd>
      <dt id="i"><a class="permalink" href="#i"><code class="Fl">-i</code></a>
        <var class="Ar">interval</var></dt>
      <dd>Set the interval that the profiling timer fires (supports the same
          time suffixes as <code class="Fl">-t</code>).</dd>
      <dt id="n~4"><a class="permalink" href="#n~4"><code class="Fl">-n</code></a></dt>
      <dd>Disable the profiling timer entirely.</dd>
      <dt id="b~3"><a class="permalink" href="#b~3"><code class="Fl">-b</code></a>
        <var class="Ar">buffer-size-mb</var></dt>
      <dd>Set the trace buffer size.</dd>
      <dt id="r~2"><a class="permalink" href="#r~2"><code class="Fl">-r</code></a></dt>
      <dd>Configure tracing and leave it running in ring buffer mode.</dd>
      <dt id="p~5"><a class="permalink" href="#p~5"><code class="Fl">-p</code></a>
        <var class="Ar">pid-or-process-name</var></dt>
      <dd>Only record events that occur for the process identified by
          <var class="Ar">pid</var> or <var class="Ar">process-name</var>. Only
          the first 16 characters of the name are observed, due to a kernel
          limitation.</dd>
      <dt id="d"><a class="permalink" href="#d"><code class="Fl">-d</code></a>
        <var class="Ar">group</var></dt>
      <dd>Disable the group named <var class="Ar">group</var>. See
          <a class="Sx" href="#GROUPS">GROUPS</a> for a list of groups.</dd>
      <dt id="e"><a class="permalink" href="#e"><code class="Fl">-e</code></a>
        <var class="Ar">group</var></dt>
      <dd>Enable the group named <var class="Ar">group</var>. See
          <a class="Sx" href="#GROUPS">GROUPS</a> for a list of groups.</dd>
      <dt id="remote"><a class="permalink" href="#remote"><code class="Fl">--remote</code></a>[=<var class="Ar">device-name</var>]</dt>
      <dd>Also trace on the provided <var class="Ar">device-name</var> or the
          local bridge if not specified.</dd>
      <dt id="type"><a class="permalink" href="#type"><code class="Fl">--type</code></a>=<var class="Ar">full</var>|<var class="Ar">profile</var>|<var class="Ar">lite</var>|<var class="Ar">morelite</var>|<var class="Ar">none</var></dt>
      <dd>Trace using the specified type. <var class="Ar">full</var> is the
          default, while <var class="Ar">profile</var> just enables the
          profiling timer, but does not closely track scheduling events. The
          <var class="Ar">lite</var> and <var class="Ar">morelite</var> trace
          types are meant for long-running, low overhead analysis and prioritize
          analyzing threads that are blocked for relatively long periods of
          time, at the cost of an unbiased sample towards threads that cause a
          CPU to come out of idle.
        <p class="Pp">The &#x2018;<code class="Li">lite</code>&#x2019; modes
            work by lazily sampling threads as they are unblocked, and only
            those threads that block for more than a set threshold. Further, the
            typical profiling timer is disabled, in lieu of sampling the CPUs
            opportunistically, on other interrupts. The
            <var class="Ar">morelite</var> mode has a more restrictive
            typefilter than <var class="Ar">lite</var>.
            <var class="Ar">none</var> mode acts like <code class="Cm">ktrace
            dump</code>.</p>
      </dd>
      <dt id="stackshot-flags~2"><a class="permalink" href="#stackshot-flags~2"><code class="Fl">--stackshot-flags</code></a>
        <var class="Ar">extra-flags</var></dt>
      <dd>Pass the provided <var class="Ar">extra-flags</var> integer as
          additional flags when recording stackshots.</dd>
      <dt id="c~2"><a class="permalink" href="#c~2"><code class="Fl">-c</code></a>
        <var class="Ar">command</var> [...]</dt>
      <dd>Run the command specified by <var class="Ar">command</var> and stop
          tracing when it exits. All arguments after this option are passed to
          the command.</dd>
      <dt id="kperf"><a class="permalink" href="#kperf"><code class="Fl">--kperf</code></a>=<var class="Ar">sampler-name</var>[,<var class="Ar">sampler-name</var>]@<var class="Ar">timer-period</var>|<var class="Ar">timer-frequency</var>|<var class="Ar">kdebug-filter-desc</var></dt>
      <dd>Sample using kperf according to the given sampling description. For
          the syntax of sampling descriptions, see
          <a class="Sx" href="#SAMPLING_DESCRIPTIONS">SAMPLING
        DESCRIPTIONS</a>.</dd>
    </dl>
  </dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="FILTER_DESCRIPTIONS"><a class="permalink" href="#FILTER_DESCRIPTIONS">FILTER
  DESCRIPTIONS</a></h1>
<p class="Pp">A filter description is a comma-separated list of class and
    subclass specifiers that indicate which events should be traced. A class
    specifier starts with &#x2018;<code class="Li">C</code>&#x2019; and contains
    a single byte, specified in either decimal or hex. A subclass specifier
    starts with &#x2018;<code class="Li">S</code>&#x2019; and takes two bytes.
    The high byte is the class and the low byte is the subclass of that
  class.</p>
<p class="Pp">For example, this filter description would enable classes 1 and 37
    and the subclasses 33 and 35 of class 5:
    &#x2018;<code class="Li">C1,C0x25,S0x0521,S0x0523</code>&#x2019;. The
    &#x2018;<code class="Li">ALL</code>&#x2019; filter description enables
    events from all classes.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SAMPLING_DESCRIPTIONS"><a class="permalink" href="#SAMPLING_DESCRIPTIONS">SAMPLING
  DESCRIPTIONS</a></h1>
<p class="Pp">A sampling description is similar to a filter description, but it
    configures sampling. It's composed of two parts: a samplers section and a
    trigger section, separated by <code class="Li">@</code>. The overall form is
    <var class="Ar">sampler-name</var>[,<var class="Ar">sampler-name</var>]@ Ns
    <var class="Ar">timer-period</var>|<var class="Ar">timer-frequency</var>|<var class="Ar">kdebug-filter-desc</var>.
    The valid names of samplers are
    &#x2018;<code class="Li">ustack</code>&#x2019;,
    &#x2018;<code class="Li">kstack</code>&#x2019;,
    &#x2018;<code class="Li">thinfo</code>&#x2019;,
    &#x2018;<code class="Li">thsnapshot</code>&#x2019;,
    &#x2018;<code class="Li">meminfo</code>&#x2019;,
    &#x2018;<code class="Li">thsched</code>&#x2019;,
    &#x2018;<code class="Li">thdispatch</code>&#x2019;,
    &#x2018;<code class="Li">tksnapshot</code>&#x2019;,
    &#x2018;<code class="Li">sysmem</code>&#x2019;, and
    &#x2018;<code class="Li">thinstrscycles</code>&#x2019;.</p>
<p class="Pp">For example, to sample user stacks every 10 milliseconds, use
    &#x2018;<code class="Li">ustack@10ms</code>&#x2019;. To sample thread
    scheduling information and system memory every time the
    &#x2018;<code class="Li">0xfeedfac0</code>&#x2019; event is emitted, use
    &#x2018;<code class="Li">thsched,sysmem@D0xfeedfac0</code>&#x2019;.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="GROUPS"><a class="permalink" href="#GROUPS">GROUPS</a></h1>
<dl class="Bl-tag">
  <dt>syscall-sampling</dt>
  <dd>Sample backtraces on system calls.</dd>
  <dt>fault-sampling</dt>
  <dd>Sample backtraces on page faults.</dd>
  <dt>graphics</dt>
  <dd>Include graphics events.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="EXIT_STATUS"><a class="permalink" href="#EXIT_STATUS">EXIT
  STATUS</a></h1>
<p class="Pp">The <code class="Nm">ktrace</code> utility exits&#x00A0;0 on
    success, and&#x00A0;&gt;0 if an error occurs.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp">Once trace has been initialized with the
    <code class="Cm">init</code> subcommand (or the
    <code class="Cm">trace</code> and <code class="Cm">artrace</code>
    subcommands with the <code class="Fl">-r</code> flag), it remains in use
    until the space is reclaimed with the <code class="Cm">remove</code>
    subcommand. This prevents background diagnostic tools from making use of
    trace.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr" href="../1/fs_usage">fs_usage(1)</a>,
    <a class="Xr" href="../5/ktrace">ktrace(5)</a>,
    <a class="Xr" href="../3/notify">notify(3)</a>, and
    <a class="Xr" href="../1/trace">trace(1)</a></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">February 10, 2020</td>
    <td class="foot-os">Darwin</td>
  </tr>
</table>
</body>
</html>
