<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   $NetBSD: pthread_mutexattr.3,v 1.11 2010/07/08 22:46:34 jruoho Exp $
  
   Copyright (c) 2002, 2010 The NetBSD Foundation, Inc.
   All rights reserved.
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
   THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
   ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
   TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
   PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
   BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
  
   Copyright (C) 2000 Jason Evans <jasone@FreeBSD.org>.
   All rights reserved.
  
   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:
   1. Redistributions of source code must retain the above copyright
      notice(s), this list of conditions and the following disclaimer as
      the first lines of this file unmodified other than the possible
      addition of one or more copyright notices.
   2. Redistributions in binary form must reproduce the above copyright
      notice(s), this list of conditions and the following disclaimer in
      the documentation and/or other materials provided with the
      distribution.
  
   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER(S) ``AS IS'' AND ANY
   EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
   PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER(S) BE
   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
   BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
   WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
   OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
   EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  
   $FreeBSD$
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>PTHREAD_MUTEXATTR(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PTHREAD_MUTEXATTR(3)</td>
    <td class="head-vol">Library Functions Manual</td>
    <td class="head-rtitle">PTHREAD_MUTEXATTR(3)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">pthread_mutexattr_init</code>,
    <code class="Nm">pthread_mutexattr_destroy</code>,
    <code class="Nm">pthread_mutexattr_setprioceiling</code>,
    <code class="Nm">pthread_mutexattr_getprioceiling</code>,
    <code class="Nm">pthread_mutexattr_setprotocol</code>,
    <code class="Nm">pthread_mutexattr_getprotocol</code>,
    <code class="Nm">pthread_mutexattr_settype</code>,
    <code class="Nm">pthread_mutexattr_gettype</code> &#x2014;
    <span class="Nd">mutex attribute operations</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><code class="In">#include
    &lt;<a class="In">pthread.h</a>&gt;</code></p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_init</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_destroy</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_setprioceiling</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
    prioceiling</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_getprioceiling</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
    *prioceiling</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_setprotocol</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
    protocol</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_getprotocol</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
    *protocol</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_settype</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
  type</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_gettype</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
  *type</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_setpolicy_np</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
  policy</var>);</p>
<p class="Pp"><var class="Ft">int</var>
  <br/>
  <code class="Fn">pthread_mutexattr_getpolicy_np</code>(<var class="Fa" style="white-space: nowrap;">pthread_mutexattr_t
    *attr</var>, <var class="Fa" style="white-space: nowrap;">int
    *policy</var>);</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Mutex attributes are used to specify parameters to
    <a class="permalink" href="#pthread_mutex_init"><code class="Fn" id="pthread_mutex_init">pthread_mutex_init</code></a>().
    Like with thread attributes, one attribute object can be used in multiple
    calls to
    <a class="Xr" href="../3/pthread_mutex_init">pthread_mutex_init(3)</a>, with
    or without modifications between calls.</p>
<p class="Pp" id="pthread_mutexattr_init">The
    <a class="permalink" href="#pthread_mutexattr_init"><code class="Fn">pthread_mutexattr_init</code></a>()
    function initializes <var class="Fa">attr</var> with all the default mutex
    attributes.</p>
<p class="Pp" id="pthread_mutexattr_destroy">The
    <a class="permalink" href="#pthread_mutexattr_destroy"><code class="Fn">pthread_mutexattr_destroy</code></a>()
    function destroys <var class="Fa">attr</var>.</p>
<p class="Pp" id="pthread_mutexattr_settype">The
    <a class="permalink" href="#pthread_mutexattr_settype"><code class="Fn">pthread_mutexattr_settype</code></a>()
    functions set the mutex <var class="Fa">type</var> value of the attribute.
    Valid mutex types are:</p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="PTHREAD_MUTEX_NORMAL"><a class="permalink" href="#PTHREAD_MUTEX_NORMAL"><code class="Dv">PTHREAD_MUTEX_NORMAL</code></a></dt>
  <dd>This type of mutex does not check for usage errors. It will deadlock if
      reentered, and result in undefined behavior if a locked mutex is unlocked
      by another thread. Attempts to unlock an already unlocked
      <code class="Dv">PTHREAD_MUTEX_NORMAL</code> mutex will result in
      undefined behavior.</dd>
  <dt id="PTHREAD_MUTEX_ERRORCHECK"><a class="permalink" href="#PTHREAD_MUTEX_ERRORCHECK"><code class="Dv">PTHREAD_MUTEX_ERRORCHECK</code></a></dt>
  <dd>These mutexes do check for usage errors. If an attempt is made to relock a
      <code class="Dv">PTHREAD_MUTEX_ERRORCHECK</code> mutex without first
      dropping the lock, an error will be returned. If a thread attempts to
      unlock a <code class="Dv">PTHREAD_MUTEX_ERRORCHECK</code> mutex that is
      locked by another thread, an error will be returned. If a thread attempts
      to unlock a <code class="Dv">PTHREAD_MUTEX_ERRORCHECK</code> thread that
      is unlocked, an error will be returned.</dd>
  <dt id="PTHREAD_MUTEX_RECURSIVE"><a class="permalink" href="#PTHREAD_MUTEX_RECURSIVE"><code class="Dv">PTHREAD_MUTEX_RECURSIVE</code></a></dt>
  <dd>These mutexes allow recursive locking. An attempt to relock a
      <code class="Dv">PTHREAD_MUTEX_RECURSIVE</code> mutex that is already
      locked by the same thread succeeds. An equivalent number of
      <a class="Xr" href="../3/pthread_mutex_unlock">pthread_mutex_unlock(3)</a>
      calls are needed before the mutex will wake another thread waiting on this
      lock. If a thread attempts to unlock a
      <code class="Dv">PTHREAD_MUTEX_RECURSIVE</code> mutex that is locked by
      another thread, an error will be returned. If a thread attempts to unlock
      a <code class="Dv">PTHREAD_MUTEX_RECURSIVE</code> thread that is unlocked,
      an error will be returned.
    <p class="Pp">It is advised that
        <code class="Dv">PTHREAD_MUTEX_RECURSIVE</code> mutexes are not used
        with condition variables. This is because of the implicit unlocking done
        by <a class="Xr" href="../3/pthread_cond_wait">pthread_cond_wait(3)</a>
        and
        <a class="Xr" href="../3/pthread_cond_timedwait">pthread_cond_timedwait(3)</a>.</p>
  </dd>
  <dt id="PTHREAD_MUTEX_DEFAULT"><a class="permalink" href="#PTHREAD_MUTEX_DEFAULT"><code class="Dv">PTHREAD_MUTEX_DEFAULT</code></a></dt>
  <dd>Also this type of mutex will cause undefined behavior if reentered.
      Unlocking a <code class="Dv">PTHREAD_MUTEX_DEFAULT</code> mutex locked by
      another thread will result in undefined behavior. Attempts to unlock an
      already unlocked <code class="Dv">PTHREAD_MUTEX_DEFAULT</code> mutex will
      result in undefined behavior. This is the default mutex type for
      <a class="permalink" href="#pthread_mutexaddr_init"><code class="Fn" id="pthread_mutexaddr_init">pthread_mutexaddr_init</code></a>().</dd>
</dl>
</div>
<p class="Pp" id="pthread_mutexattr_gettype"><a class="permalink" href="#pthread_mutexattr_gettype"><code class="Fn">pthread_mutexattr_gettype</code></a>()
    functions copy the type value of the attribute to the location pointed to by
    the second parameter.</p>
<p class="Pp" id="pthread_mutexattr_setpolicy_np">The
    <a class="permalink" href="#pthread_mutexattr_setpolicy_np"><code class="Fn">pthread_mutexattr_setpolicy_np</code></a>()
    function sets the mutex <var class="Fa">policy</var> value of the attribute.
    Valid mutex policies are:</p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="PTHREAD_MUTEX_POLICY_FIRSTFIT_NP"><a class="permalink" href="#PTHREAD_MUTEX_POLICY_FIRSTFIT_NP"><code class="Dv">PTHREAD_MUTEX_POLICY_FIRSTFIT_NP</code></a></dt>
  <dd>The first-fit mutex policy allows acquisition of the mutex to occur in any
      order. This policy is similar in operation to os_unfair_lock, new
      contending acquirers may obtain ownership of the mutex ahead of existing
      waiters.</dd>
  <dt id="PTHREAD_MUTEX_POLICY_FAIRSHARE_NP"><a class="permalink" href="#PTHREAD_MUTEX_POLICY_FAIRSHARE_NP"><code class="Dv">PTHREAD_MUTEX_POLICY_FAIRSHARE_NP</code></a></dt>
  <dd>The fairshare mutex policy guarantees that ownership of a contended mutex
      will be granted to waiters on a strictly ordered first-in, first-out
      basis. That is, a mutex holder that unlocks the mutex and then attempts to
      relock will wait behind existing threads already waiting on the mutex
      before being granted ownership again.</dd>
</dl>
</div>
<p class="Pp" id="pthread_mutexattr_getpolicy_np">The
    <a class="permalink" href="#pthread_mutexattr_getpolicy_np"><code class="Fn">pthread_mutexattr_getpolicy_np</code></a>()
    function copies the mutex <var class="Fa">policy</var> value of the
    attribute to the location pointed to by the second parameter.</p>
<p class="Pp" id="pthread_mutexattr_set*">The
    <a class="permalink" href="#pthread_mutexattr_set*"><code class="Fn">pthread_mutexattr_set*</code></a>()
    functions set the attribute that corresponds to each function name.</p>
<p class="Pp" id="pthread_mutexattr_get*">The
    <a class="permalink" href="#pthread_mutexattr_get*"><code class="Fn">pthread_mutexattr_get*</code></a>()
    functions copy the value of the attribute that corresponds to each function
    name to the location pointed to by the second function parameter.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="RETURN_VALUES"><a class="permalink" href="#RETURN_VALUES">RETURN
  VALUES</a></h1>
<p class="Pp">If successful, these functions return 0. Otherwise, an error
    number is returned to indicate the error.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<p class="Pp">The following environment variables change the behavior of the
    pthread mutex implementation.</p>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="PTHREAD_MUTEX_DEFAULT_POLICY"><a class="permalink" href="#PTHREAD_MUTEX_DEFAULT_POLICY"><code class="Ev">PTHREAD_MUTEX_DEFAULT_POLICY</code></a></dt>
  <dd>Controls the process-wide policy used when initializing a pthread_mutex_t
      that has not had a policy set via
      <code class="Fn">pthread_mutexattr_setpolicy_np</code>(). The valid values
      are mapped as:
    <dl class="Bl-tag">
      <dt id="PTHREAD_MUTEX_POLICY_FAIRSHARE_NP~2"><var class="Fa">1</var></dt>
      <dd><a class="permalink" href="#PTHREAD_MUTEX_POLICY_FAIRSHARE_NP~2"><code class="Dv">PTHREAD_MUTEX_POLICY_FAIRSHARE_NP</code></a></dd>
      <dt id="PTHREAD_MUTEX_POLICY_FIRSTFIT_NP~2"><var class="Fa">3</var></dt>
      <dd><a class="permalink" href="#PTHREAD_MUTEX_POLICY_FIRSTFIT_NP~2"><code class="Dv">PTHREAD_MUTEX_POLICY_FIRSTFIT_NP</code></a></dd>
    </dl>
  </dd>
</dl>
</div>
</section>
<section class="Sh">
<h1 class="Sh" id="BACKWARDS_COMPATIBILITY"><a class="permalink" href="#BACKWARDS_COMPATIBILITY">BACKWARDS
  COMPATIBILITY</a></h1>
<p class="Pp">Prior to macOS 10.14 (iOS and tvOS 12.0, watchOS 5.0) the only
    available pthread mutex policy mode was
    <code class="Dv">PTHREAD_MUTEX_POLICY_FAIRSHARE_NP</code>. macOS 10.14 (iOS
    and tvOS 12.0, watchOS 5.0) introduces
    <code class="Dv">PTHREAD_MUTEX_POLICY_FIRSTFIT_NP</code> and also makes this
    the default mode for mutexes initialized without a policy attribute set.</p>
<p class="Pp" id="pthread_mutexattr_setpolicy_np~2">Attempting to use
    <a class="permalink" href="#pthread_mutexattr_setpolicy_np~2"><code class="Fn">pthread_mutexattr_setpolicy_np</code></a>()
    to set the policy of a pthread_mutex_t to
    <code class="Dv">PTHREAD_MUTEX_POLICY_FIRSTFIT_NP</code> on earlier releases
    will fail with <code class="Er">EINVAL</code> and the mutex will continue to
    operate in fairshare mode.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ERRORS"><a class="permalink" href="#ERRORS">ERRORS</a></h1>
<p class="Pp">The <code class="Fn">pthread_mutexattr_init</code>() function
    shall fail if:</p>
<dl class="Bl-tag">
  <dt id="ENOMEM">[<a class="permalink" href="#ENOMEM"><code class="Er">ENOMEM</code></a>]</dt>
  <dd>Out of memory.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_destroy</code>() function
    will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL">[<a class="permalink" href="#EINVAL"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_setprioceiling</code>()
    function will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~2">[<a class="permalink" href="#EINVAL~2"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>, or invalid value for
      <var class="Fa">prioceiling</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_getprioceiling</code>()
    function will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~3">[<a class="permalink" href="#EINVAL~3"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_setprotocol</code>()
    function will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~4">[<a class="permalink" href="#EINVAL~4"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>, or invalid value for
      <var class="Fa">protocol</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_getprotocol</code>()
    function will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~5">[<a class="permalink" href="#EINVAL~5"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_settype</code>() function
    shall fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~6">[<a class="permalink" href="#EINVAL~6"><code class="Er">EINVAL</code></a>]</dt>
  <dd>The value specified either by <var class="Fa">type</var> or
      <var class="Fa">attr</var> is invalid.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_gettype</code>() function
    will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~7">[<a class="permalink" href="#EINVAL~7"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_setpolicy_np</code>()
    function will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~8">[<a class="permalink" href="#EINVAL~8"><code class="Er">EINVAL</code></a>]</dt>
  <dd>Invalid value for <var class="Fa">attr</var>.</dd>
</dl>
<p class="Pp">The <code class="Fn">pthread_mutexattr_getpolicy_np</code>()
    function will fail if:</p>
<dl class="Bl-tag">
  <dt id="EINVAL~9">[<a class="permalink" href="#EINVAL~9"><code class="Er">EINVAL</code></a>]</dt>
  <dd>The value specified either by <var class="Fa">type</var> or
      <var class="Fa">attr</var> is invalid.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr" href="../3/pthread_mutex_init">pthread_mutex_init(3)</a></p>
</section>
<section class="Sh">
<h1 class="Sh" id="STANDARDS"><a class="permalink" href="#STANDARDS">STANDARDS</a></h1>
<p class="Pp">The <code class="Fn">pthread_mutexattr_init</code>() and
    <code class="Fn">pthread_mutexattr_destroy</code>() functions conform to
    <span class="St">ISO/IEC 9945-1:1996 (&#x201C;POSIX.1&#x201D;)</span></p>
<p class="Pp">The <code class="Fn">pthread_mutexattr_setprioceiling</code>(),
    <code class="Fn">pthread_mutexattr_getprioceiling</code>(),
    <code class="Fn">pthread_mutexattr_setprotocol</code>(),
    <code class="Fn">pthread_mutexattr_getprotocol</code>(),
    <code class="Fn">pthread_mutexattr_settype</code>(), and
    <code class="Fn">pthread_mutexattr_gettype</code>() functions conform to
    <span class="St">Version&#x00A0;2 of the Single UNIX Specification
    (&#x201C;SUSv2&#x201D;)</span></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">July 9, 2010</td>
    <td class="foot-os">macOS 12.6</td>
  </tr>
</table>
</body>
</html>
