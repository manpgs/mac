<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>DBI(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBI(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBI(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">DBI - Database independent interface for Perl</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>  use DBI;
  @driver_names = DBI-&gt;available_drivers;
  %drivers      = DBI-&gt;installed_drivers;
  @data_sources = DBI-&gt;data_sources($driver_name, \%attr);
  $dbh = DBI-&gt;connect($data_source, $username, $auth, \%attr);
  $rv  = $dbh-&gt;do($statement);
  $rv  = $dbh-&gt;do($statement, \%attr);
  $rv  = $dbh-&gt;do($statement, \%attr, @bind_values);
  $ary_ref  = $dbh-&gt;selectall_arrayref($statement);
  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field);
  $ary_ref  = $dbh-&gt;selectcol_arrayref($statement);
  $ary_ref  = $dbh-&gt;selectcol_arrayref($statement, \%attr);
  @row_ary  = $dbh-&gt;selectrow_array($statement);
  $ary_ref  = $dbh-&gt;selectrow_arrayref($statement);
  $hash_ref = $dbh-&gt;selectrow_hashref($statement);
  $sth = $dbh-&gt;prepare($statement);
  $sth = $dbh-&gt;prepare_cached($statement);
  $rc = $sth-&gt;bind_param($p_num, $bind_value);
  $rc = $sth-&gt;bind_param($p_num, $bind_value, $bind_type);
  $rc = $sth-&gt;bind_param($p_num, $bind_value, \%attr);
  $rv = $sth-&gt;execute;
  $rv = $sth-&gt;execute(@bind_values);
  $rv = $sth-&gt;execute_array(\%attr, ...);
  $rc = $sth-&gt;bind_col($col_num, \$col_variable);
  $rc = $sth-&gt;bind_columns(@list_of_refs_to_vars_to_bind);
  @row_ary  = $sth-&gt;fetchrow_array;
  $ary_ref  = $sth-&gt;fetchrow_arrayref;
  $hash_ref = $sth-&gt;fetchrow_hashref;
  $ary_ref  = $sth-&gt;fetchall_arrayref;
  $ary_ref  = $sth-&gt;fetchall_arrayref( $slice, $max_rows );
  $hash_ref = $sth-&gt;fetchall_hashref( $key_field );
  $rv  = $sth-&gt;rows;
  $rc  = $dbh-&gt;begin_work;
  $rc  = $dbh-&gt;commit;
  $rc  = $dbh-&gt;rollback;
  $quoted_string = $dbh-&gt;quote($string);
  $rc  = $h-&gt;err;
  $str = $h-&gt;errstr;
  $rv  = $h-&gt;state;
  $rc  = $dbh-&gt;disconnect;
</pre>
<p class="Pp"><i>The synopsis above only lists the major methods and
    parameters.</i></p>
<section class="Ss">
<h2 class="Ss">GETTING HELP</h2>
<p class="Pp"><i>General</i></p>
<p class="Pp">Before asking any questions, reread this document, consult the
    archives and read the DBI FAQ. The archives are listed at the end of this
    document and on the DBI home page &lt;http://dbi.perl.org/support/&gt;</p>
<p class="Pp">You might also like to read the Advanced DBI Tutorial at
    &lt;http://www.slideshare.net/Tim.Bunce/dbi-advanced-tutorial-2007&gt;</p>
<p class="Pp">To help you make the best use of the dbi-users mailing list, and
    any other lists or forums you may use, I recommend that you read
    &quot;Getting Answers&quot; by Mike Ash:
    &lt;http://mikeash.com/getting_answers.html&gt;.</p>
<p class="Pp"><i>Mailing Lists</i></p>
<p class="Pp">If you have questions about DBI, or DBD driver modules, you can
    get help from the <i>dbi-users@perl.org</i> mailing list. This is the best
    way to get help. You don't have to subscribe to the list in order to post,
    though I'd recommend it. You can get help on subscribing and using the list
    by emailing <i>dbi-users-help@perl.org</i>.</p>
<p class="Pp">Please note that Tim Bunce does not maintain the mailing lists or
    the web pages (generous volunteers do that). So please don't send mail
    directly to him; he just doesn't have the time to answer questions
    personally. The <i>dbi-users</i> mailing list has lots of experienced people
    who should be able to help you if you need it. If you do email Tim he is
    very likely to just forward it to the mailing list.</p>
<p class="Pp"><i>IRC</i></p>
<p class="Pp">DBI IRC Channel: #dbi on irc.perl.org
    (&lt;irc://irc.perl.org/#dbi&gt;)</p>
<p class="Pp"><i>Online</i></p>
<p class="Pp">StackOverflow has a DBI tag
    &lt;http://stackoverflow.com/questions/tagged/dbi&gt; with over 800
    questions.</p>
<p class="Pp">The DBI home page at &lt;http://dbi.perl.org/&gt; and the DBI FAQ
    at &lt;http://faq.dbi-support.com/&gt; may be worth a visit. They include
    links to other resources, but <i>are rather out-dated</i>.</p>
<p class="Pp"><i>Reporting a Bug</i></p>
<p class="Pp">If you think you've found a bug then please read &quot;How to
    Report Bugs Effectively&quot; by Simon Tatham:
    &lt;http://www.chiark.greenend.org.uk/~sgtatham/bugs.html&gt;.</p>
<p class="Pp">If you think you've found a memory leak then read &quot;Memory
    Leaks&quot;.</p>
<p class="Pp">Your problem is most likely related to the specific DBD driver
    module you're using. If that's the case then click on the 'Bugs' link on the
    &lt;http://metacpan.org&gt; page for your driver. Only submit a bug report
    against the DBI itself if you're sure that your issue isn't related to the
    driver you're using.</p>
</section>
<section class="Ss">
<h2 class="Ss">NOTES</h2>
<p class="Pp">This is the DBI specification that corresponds to DBI version
    1.642 (see DBI::Changes for details).</p>
<p class="Pp">The DBI is evolving at a steady pace, so it's good to check that
    you have the latest copy.</p>
<p class="Pp">The significant user-visible changes in each release are
    documented in the DBI::Changes module so you can read them by executing
    <span class="Li">&quot;perldoc DBI::Changes&quot;</span>.</p>
<p class="Pp">Some DBI changes require changes in the drivers, but the drivers
    can take some time to catch up. Newer versions of the DBI have added
    features that may not yet be supported by the drivers you use. Talk to the
    authors of your drivers if you need a new feature that is not yet
  supported.</p>
<p class="Pp">Features added after DBI 1.21 (February 2002) are marked in the
    text with the version number of the DBI release they first appeared in.</p>
<p class="Pp">Extensions to the DBI API often use the
    <span class="Li">&quot;DBIx::*&quot;</span> namespace. See &quot;Naming
    Conventions and Name Space&quot;. DBI extension modules can be found at
    &lt;https://metacpan.org/search?q=DBIx&gt;. And all modules related to the
    DBI can be found at &lt;https://metacpan.org/search?q=DBI&gt;.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The DBI is a database access module for the Perl programming
    language. It defines a set of methods, variables, and conventions that
    provide a consistent database interface, independent of the actual database
    being used.</p>
<p class="Pp">It is important to remember that the DBI is just an interface. The
    DBI is a layer of &quot;glue&quot; between an application and one or more
    database <i>driver</i> modules. It is the driver modules which do most of
    the real work. The DBI provides a standard interface and framework for the
    drivers to operate within.</p>
<p class="Pp">This document often uses terms like <i>references</i>,
    <i>objects</i>, <i>methods</i>. If you're not familiar with those terms then
    it would be a good idea to read at least the following perl manuals first:
    perlreftut, perldsc, perllol, and perlboot.</p>
<section class="Ss">
<h2 class="Ss" id="Architecture_of_a_"><a class="permalink" href="#Architecture_of_a_">Architecture
  of a DBI Application</a></h2>
<pre>             |&lt;- Scope of DBI -&gt;|
                  .-.   .--------------.   .-------------.
  .-------.       | |---| XYZ Driver   |---| XYZ Engine  |
  | Perl  |       | |   `--------------'   `-------------'
  | script|  |A|  |D|   .--------------.   .-------------.
  | using |--|P|--|B|---|Oracle Driver |---|Oracle Engine|
  | DBI   |  |I|  |I|   `--------------'   `-------------'
  | API   |       | |...
  |methods|       | |... Other drivers
  `-------'       | |...
                  `-'
</pre>
<p class="Pp">The API, or Application Programming Interface, defines the call
    interface and variables for Perl scripts to use. The API is implemented by
    the Perl DBI extension.</p>
<p class="Pp">The DBI &quot;dispatches&quot; the method calls to the appropriate
    driver for actual execution. The DBI is also responsible for the dynamic
    loading of drivers, error checking and handling, providing default
    implementations for methods, and many other non-database specific
  duties.</p>
<p class="Pp">Each driver contains implementations of the DBI methods using the
    private interface functions of the corresponding database engine. Only
    authors of sophisticated/multi-database applications or generic library
    functions need be concerned with drivers.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Notation_and_Conventions"><a class="permalink" href="#Notation_and_Conventions">Notation
  and Conventions</a></h2>
<p class="Pp">The following conventions are used in this document:</p>
<p class="Pp"></p>
<pre>  $dbh    Database handle object
  $sth    Statement handle object
  $drh    Driver handle object (rarely seen or used in applications)
  $h      Any of the handle types above ($dbh, $sth, or $drh)
  $rc     General Return Code  (boolean: true=ok, false=error)
  $rv     General Return Value (typically an integer)
  @ary    List of values returned from the database, typically a row of data
  $rows   Number of rows processed (if available, else -1)
  $fh     A filehandle
  undef   NULL values are represented by undefined values in Perl
  \%attr  Reference to a hash of attribute values passed to methods
</pre>
<p class="Pp">Note that Perl will automatically destroy database and statement
    handle objects if all references to them are deleted.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Outline_Usage"><a class="permalink" href="#Outline_Usage">Outline
  Usage</a></h2>
<p class="Pp">To use DBI, first you need to load the DBI module:</p>
<p class="Pp"></p>
<pre>  use DBI;
  use strict;
</pre>
<p class="Pp">(The <span class="Li">&quot;use strict;&quot;</span> isn't
    required but is strongly recommended.)</p>
<p class="Pp">Then you need to &quot;connect&quot; to your data source and get a
    <i>handle</i> for that connection:</p>
<p class="Pp"></p>
<pre>  $dbh = DBI-&gt;connect($dsn, $user, $password,
                      { RaiseError =&gt; 1, AutoCommit =&gt; 0 });
</pre>
<p class="Pp">Since connecting can be expensive, you generally just connect at
    the start of your program and disconnect at the end.</p>
<p class="Pp">Explicitly defining the required
    <span class="Li">&quot;AutoCommit&quot;</span> behaviour is strongly
    recommended and may become mandatory in a later version. This determines
    whether changes are automatically committed to the database when executed,
    or need to be explicitly committed later.</p>
<p class="Pp">The DBI allows an application to &quot;prepare&quot; statements
    for later execution. A prepared statement is identified by a statement
    handle held in a Perl variable. We'll call the Perl variable
    <span class="Li">$sth</span> in our examples.</p>
<p class="Pp">The typical method call sequence for a
    <span class="Li">&quot;SELECT&quot;</span> statement is:</p>
<p class="Pp"></p>
<pre>  prepare,
    execute, fetch, fetch, ...
    execute, fetch, fetch, ...
    execute, fetch, fetch, ...
</pre>
<p class="Pp">for example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(&quot;SELECT foo, bar FROM table WHERE baz=?&quot;);
  $sth-&gt;execute( $baz );
  while ( @row = $sth-&gt;fetchrow_array ) {
    print &quot;@row\n&quot;;
  }
</pre>
<p class="Pp">For queries that are not executed many times at once, it is often
    cleaner to use the higher level select wrappers:</p>
<p class="Pp"></p>
<pre>  $row_hashref = $dbh-&gt;selectrow_hashref(&quot;SELECT foo, bar FROM table WHERE baz=?&quot;, undef, $baz);
  $arrayref_of_row_hashrefs = $dbh-&gt;selectall_arrayref(
    &quot;SELECT foo, bar FROM table WHERE baz BETWEEN ? AND ?&quot;,
    { Slice =&gt; {} }, $baz_min, $baz_max);
</pre>
<p class="Pp">The typical method call sequence for a
    <i>non</i>-<span class="Li">&quot;SELECT&quot;</span> statement is:</p>
<p class="Pp"></p>
<pre>  prepare,
    execute,
    execute,
    execute.
</pre>
<p class="Pp">for example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(&quot;INSERT INTO table(foo,bar,baz) VALUES (?,?,?)&quot;);
  while(&lt;CSV&gt;) {
    chomp;
    my ($foo,$bar,$baz) = split /,/;
        $sth-&gt;execute( $foo, $bar, $baz );
  }
</pre>
<p class="Pp">The <span class="Li">&quot;do()&quot;</span> method is a wrapper
    of prepare and execute that can be simpler for non repeated
    <i>non</i>-<span class="Li">&quot;SELECT&quot;</span> statements (or with
    drivers that don't support placeholders):</p>
<p class="Pp"></p>
<pre>  $rows_affected = $dbh-&gt;do(&quot;UPDATE your_table SET foo = foo + 1&quot;);
  $rows_affected = $dbh-&gt;do(&quot;DELETE FROM table WHERE foo = ?&quot;, undef, $foo);
</pre>
<p class="Pp">To commit your changes to the database (when
    &quot;AutoCommit&quot; is off):</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;commit;  # or call $dbh-&gt;rollback; to undo changes
</pre>
<p class="Pp">Finally, when you have finished working with the data source, you
    should &quot;disconnect&quot; from it:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;disconnect;
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="General_Interface_Rules_&amp;_Caveats"><a class="permalink" href="#General_Interface_Rules_&amp;_Caveats">General
  Interface Rules &amp; Caveats</a></h2>
<p class="Pp">The DBI does not have a concept of a &quot;current session&quot;.
    Every session has a handle object (i.e., a <span class="Li">$dbh</span>)
    returned from the <span class="Li">&quot;connect&quot;</span> method. That
    handle object is used to invoke database related methods.</p>
<p class="Pp">Most data is returned to the Perl script as strings. (Null values
    are returned as <span class="Li">&quot;undef&quot;</span>.) This allows
    arbitrary precision numeric data to be handled without loss of accuracy.
    Beware that Perl may not preserve the same accuracy when the string is used
    as a number.</p>
<p class="Pp">Dates and times are returned as character strings in the current
    default format of the corresponding database engine. Time zone effects are
    database/driver dependent.</p>
<p class="Pp">Perl supports binary data in Perl strings, and the DBI will pass
    binary data to and from the driver without change. It is up to the driver
    implementors to decide how they wish to handle such binary data.</p>
<p class="Pp">Perl supports two kinds of strings: Unicode (utf8 internally) and
    non-Unicode (defaults to iso-8859-1 if forced to assume an encoding).
    Drivers should accept both kinds of strings and, if required, convert them
    to the character set of the database being used. Similarly, when fetching
    from the database character data that isn't iso-8859-1 the driver should
    convert it into utf8.</p>
<p class="Pp">Multiple SQL statements may not be combined in a single statement
    handle (<span class="Li">$sth</span>), although some databases and drivers
    do support this (notably Sybase and SQL Server).</p>
<p class="Pp">Non-sequential record reads are not supported in this version of
    the DBI. In other words, records can only be fetched in the order that the
    database returned them, and once fetched they are forgotten.</p>
<p class="Pp">Positioned updates and deletes are not directly supported by the
    DBI. See the description of the
    <span class="Li">&quot;CursorName&quot;</span> attribute for an
  alternative.</p>
<p class="Pp">Individual driver implementors are free to provide any private
    functions and/or handle attributes that they feel are useful. Private driver
    functions can be invoked using the DBI
    <span class="Li">&quot;func()&quot;</span> method. Private driver attributes
    are accessed just like standard attributes.</p>
<p class="Pp">Many methods have an optional
    <span class="Li">&quot;\%attr&quot;</span> parameter which can be used to
    pass information to the driver implementing the method. Except where
    specifically documented, the <span class="Li">&quot;\%attr&quot;</span>
    parameter can only be used to pass driver specific hints. In general, you
    can ignore <span class="Li">&quot;\%attr&quot;</span> parameters or pass it
    as <span class="Li">&quot;undef&quot;</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Naming_Conventions_and_Name_Space"><a class="permalink" href="#Naming_Conventions_and_Name_Space">Naming
  Conventions and Name Space</a></h2>
<p class="Pp">The DBI package and all packages below it
    (<span class="Li">&quot;DBI::*&quot;</span>) are reserved for use by the
    DBI. Extensions and related modules use the
    <span class="Li">&quot;DBIx::&quot;</span> namespace (see
    &lt;http://www.perl.com/CPAN/modules/by-module/DBIx/&gt;). Package names
    beginning with <span class="Li">&quot;DBD::&quot;</span> are reserved for
    use by DBI database drivers. All environment variables used by the DBI or by
    individual DBDs begin with
    &quot;<span class="Li">&quot;DBI_&quot;</span>&quot; or
    &quot;<span class="Li">&quot;DBD_&quot;</span>&quot;.</p>
<p class="Pp">The letter case used for attribute names is significant and plays
    an important part in the portability of DBI scripts. The case of the
    attribute name is used to signify who defined the meaning of that name and
    its values.</p>
<p class="Pp"></p>
<pre>  Case of name  Has a meaning defined by
  ------------  ------------------------
  UPPER_CASE    Standards, e.g.,  X/Open, ISO SQL92 etc (portable)
  MixedCase     DBI API (portable), underscores are not used.
  lower_case    Driver or database engine specific (non-portable)
</pre>
<p class="Pp">It is of the utmost importance that Driver developers only use
    lowercase attribute names when defining private attributes. Private
    attribute names must be prefixed with the driver name or suitable
    abbreviation (e.g., &quot;<span class="Li">&quot;ora_&quot;</span>&quot; for
    Oracle, &quot;<span class="Li">&quot;ing_&quot;</span>&quot; for Ingres,
    etc).</p>
</section>
<section class="Ss">
<h2 class="Ss">SQL - A Query Language</h2>
<p class="Pp">Most DBI drivers require applications to use a dialect of SQL
    (Structured Query Language) to interact with the database engine. The
    &quot;Standards Reference Information&quot; section provides links to useful
    information about SQL.</p>
<p class="Pp">The DBI itself does not mandate or require any particular language
    to be used; it is language independent. In ODBC terms, the DBI is in
    &quot;pass-thru&quot; mode, although individual drivers might not be. The
    only requirement is that queries and other statements must be expressed as a
    single string of characters passed as the first argument to the
    &quot;prepare&quot; or &quot;do&quot; methods.</p>
<p class="Pp">For an interesting diversion on the <i>real</i> history of RDBMS
    and SQL, from the people who made it happen, see:</p>
<p class="Pp"></p>
<pre>  http://www.mcjones.org/System_R/SQL_Reunion_95/sqlr95.html
</pre>
<p class="Pp">Follow the &quot;Full Contents&quot; then &quot;Intergalactic
    dataspeak&quot; links for the SQL history.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Placeholders_and_Bind_Values"><a class="permalink" href="#Placeholders_and_Bind_Values">Placeholders
  and Bind Values</a></h2>
<p class="Pp">Some drivers support placeholders and bind values.
    <i>Placeholders</i>, also called parameter markers, are used to indicate
    values in a database statement that will be supplied later, before the
    prepared statement is executed. For example, an application might use the
    following to insert a row of data into the SALES table:</p>
<p class="Pp"></p>
<pre>  INSERT INTO sales (product_code, qty, price) VALUES (?, ?, ?)
</pre>
<p class="Pp">or the following, to select the description for a product:</p>
<p class="Pp"></p>
<pre>  SELECT description FROM products WHERE product_code = ?
</pre>
<p class="Pp">The <span class="Li">&quot;?&quot;</span> characters are the
    placeholders. The association of actual values with placeholders is known as
    <i>binding</i>, and the values are referred to as <i>bind values</i>. Note
    that the <span class="Li">&quot;?&quot;</span> is not enclosed in quotation
    marks, even when the placeholder represents a string.</p>
<p class="Pp">Some drivers also allow placeholders like
    <span class="Li">&quot;:&quot;</span><i>name</i> and
    <span class="Li">&quot;:&quot;</span><i>N</i> (e.g.,
    <span class="Li">&quot;:1&quot;</span>,
    <span class="Li">&quot;:2&quot;</span>, and so on) in addition to
    <span class="Li">&quot;?&quot;</span>, but their use is not portable.</p>
<p class="Pp">If the <span class="Li">&quot;:&quot;</span><i>N</i> form of
    placeholder is supported by the driver you're using, then you should be able
    to use either &quot;bind_param&quot; or &quot;execute&quot; to bind values.
    Check your driver documentation.</p>
<p class="Pp">Some drivers allow you to prevent the recognition of a placeholder
    by placing a single backslash character
    (<span class="Li">&quot;\&quot;</span>) immediately before it. The driver
    will remove the backslash character and ignore the placeholder, passing it
    unchanged to the backend. If the driver supports this then
    &quot;get_info&quot;(9000) will return true.</p>
<p class="Pp">With most drivers, placeholders can't be used for any element of a
    statement that would prevent the database server from validating the
    statement and creating a query execution plan for it. For example:</p>
<p class="Pp"></p>
<pre>  &quot;SELECT name, age FROM ?&quot;         # wrong (will probably fail)
  &quot;SELECT name, ?   FROM people&quot;    # wrong (but may not 'fail')
</pre>
<p class="Pp">Also, placeholders can only represent single scalar values. For
    example, the following statement won't work as expected for more than one
    value:</p>
<p class="Pp"></p>
<pre>  &quot;SELECT name, age FROM people WHERE name IN (?)&quot;    # wrong
  &quot;SELECT name, age FROM people WHERE name IN (?,?)&quot;  # two names
</pre>
<p class="Pp">When using placeholders with the SQL
    <span class="Li">&quot;LIKE&quot;</span> qualifier, you must remember that
    the placeholder substitutes for the whole string. So you should use
    &quot;<span class="Li">&quot;... LIKE ? ...&quot;</span>&quot; and include
    any wildcard characters in the value that you bind to the placeholder.</p>
<p class="Pp"><b>NULL Values</b></p>
<p class="Pp">Undefined values, or <span class="Li">&quot;undef&quot;</span>,
    are used to indicate NULL values. You can insert and update columns with a
    NULL value as you would a non-NULL value. These examples insert and update
    the column <span class="Li">&quot;age&quot;</span> with a NULL value:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(qq{
    INSERT INTO people (fullname, age) VALUES (?, ?)
  });
  $sth-&gt;execute(&quot;Joe Bloggs&quot;, undef);
  $sth = $dbh-&gt;prepare(qq{
    UPDATE people SET age = ? WHERE fullname = ?
  });
  $sth-&gt;execute(undef, &quot;Joe Bloggs&quot;);
</pre>
<p class="Pp">However, care must be taken when trying to use NULL values in a
    <span class="Li">&quot;WHERE&quot;</span> clause. Consider:</p>
<p class="Pp"></p>
<pre>  SELECT fullname FROM people WHERE age = ?
</pre>
<p class="Pp">Binding an <span class="Li">&quot;undef&quot;</span> (NULL) to the
    placeholder will <i>not</i> select rows which have a NULL
    <span class="Li">&quot;age&quot;</span>! At least for database engines that
    conform to the SQL standard. Refer to the SQL manual for your database
    engine or any SQL book for the reasons for this. To explicitly select NULLs
    you have to say &quot;<span class="Li">&quot;WHERE age IS
    NULL&quot;</span>&quot;.</p>
<p class="Pp">A common issue is to have a code fragment handle a value that
    could be either <span class="Li">&quot;defined&quot;</span> or
    <span class="Li">&quot;undef&quot;</span> (non-NULL or NULL) at runtime. A
    simple technique is to prepare the appropriate statement as needed, and
    substitute the placeholder for non-NULL cases:</p>
<p class="Pp"></p>
<pre>  $sql_clause = defined $age? &quot;age = ?&quot; : &quot;age IS NULL&quot;;
  $sth = $dbh-&gt;prepare(qq{
    SELECT fullname FROM people WHERE $sql_clause
  });
  $sth-&gt;execute(defined $age ? $age : ());
</pre>
<p class="Pp">The following technique illustrates qualifying a
    <span class="Li">&quot;WHERE&quot;</span> clause with several columns, whose
    associated values (<span class="Li">&quot;defined&quot;</span> or
    <span class="Li">&quot;undef&quot;</span>) are in a hash
    <span class="Li">%h:</span></p>
<p class="Pp"></p>
<pre>  for my $col (&quot;age&quot;, &quot;phone&quot;, &quot;email&quot;) {
    if (defined $h{$col}) {
      push @sql_qual, &quot;$col = ?&quot;;
      push @sql_bind, $h{$col};
    }
    else {
      push @sql_qual, &quot;$col IS NULL&quot;;
    }
  }
  $sql_clause = join(&quot; AND &quot;, @sql_qual);
  $sth = $dbh-&gt;prepare(qq{
      SELECT fullname FROM people WHERE $sql_clause
  });
  $sth-&gt;execute(@sql_bind);
</pre>
<p class="Pp">The techniques above call prepare for the SQL statement with each
    call to execute. Because calls to <b>prepare()</b> can be expensive,
    performance can suffer when an application iterates many times over
    statements like the above.</p>
<p class="Pp">A better solution is a single
    <span class="Li">&quot;WHERE&quot;</span> clause that supports both NULL and
    non-NULL comparisons. Its SQL statement would need to be prepared only once
    for all cases, thus improving performance. Several examples of
    <span class="Li">&quot;WHERE&quot;</span> clauses that support this are
    presented below. But each example lacks portability, robustness, or
    simplicity. Whether an example is supported on your database engine depends
    on what SQL extensions it provides, and where it supports the
    <span class="Li">&quot;?&quot;</span> placeholder in a statement.</p>
<p class="Pp"></p>
<pre>  0)  age = ?
  1)  NVL(age, xx) = NVL(?, xx)
  2)  ISNULL(age, xx) = ISNULL(?, xx)
  3)  DECODE(age, ?, 1, 0) = 1
  4)  age = ? OR (age IS NULL AND ? IS NULL)
  5)  age = ? OR (age IS NULL AND SP_ISNULL(?) = 1)
  6)  age = ? OR (age IS NULL AND ? = 1)
</pre>
<p class="Pp">Statements formed with the above
    <span class="Li">&quot;WHERE&quot;</span> clauses require execute statements
    as follows. The arguments are required, whether their values are
    <span class="Li">&quot;defined&quot;</span> or
    <span class="Li">&quot;undef&quot;</span>.</p>
<p class="Pp"></p>
<pre>  0,1,2,3)  $sth-&gt;execute($age);
  4,5)      $sth-&gt;execute($age, $age);
  6)        $sth-&gt;execute($age, defined($age) ? 0 : 1);
</pre>
<p class="Pp">Example 0 should not work (as mentioned earlier), but may work on
    a few database engines anyway (e.g. Sybase). Example 0 is part of examples
    4, 5, and 6, so if example 0 works, these other examples may work, even if
    the engine does not properly support the right hand side of the
    <span class="Li">&quot;OR&quot;</span> expression.</p>
<p class="Pp">Examples 1 and 2 are not robust: they require that you provide a
    valid column value xx (e.g. '~') which is not present in any row. That means
    you must have some notion of what data won't be stored in the column, and
    expect clients to adhere to that.</p>
<p class="Pp">Example 5 requires that you provide a stored procedure (SP_ISNULL
    in this example) that acts as a function: it checks whether a value is null,
    and returns 1 if it is, or 0 if not.</p>
<p class="Pp">Example 6, the least simple, is probably the most portable, i.e.,
    it should work with most, if not all, database engines.</p>
<p class="Pp">Here is a table that indicates which examples above are known to
    work on various database engines:</p>
<p class="Pp"></p>
<pre>                   -----Examples------
                   0  1  2  3  4  5  6
                   -  -  -  -  -  -  -
  Oracle 9         N  Y  N  Y  Y  ?  Y
  Informix IDS 9   N  N  N  Y  N  Y  Y
  MS SQL           N  N  Y  N  Y  ?  Y
  Sybase           Y  N  N  N  N  N  Y
  AnyData,DBM,CSV  Y  N  N  N  Y  Y* Y
  SQLite 3.3       N  N  N  N  Y  N  N
  MSAccess         N  N  N  N  Y  N  Y
</pre>
<p class="Pp">* Works only because Example 0 works.</p>
<p class="Pp">DBI provides a sample perl script that will test the examples
    above on your database engine and tell you which ones work. It is located in
    the <i>ex/</i> subdirectory of the DBI source distribution, or here:
    &lt;https://github.com/perl5-dbi/dbi/blob/master/ex/perl_dbi_nulls_test.pl&gt;
    Please use the script to help us fill-in and maintain this table.</p>
<p class="Pp"><b>Performance</b></p>
<p class="Pp">Without using placeholders, the insert statement shown previously
    would have to contain the literal values to be inserted and would have to be
    re-prepared and re-executed for each row. With placeholders, the insert
    statement only needs to be prepared once. The bind values for each row can
    be given to the <span class="Li">&quot;execute&quot;</span> method each time
    it's called. By avoiding the need to re-prepare the statement for each row,
    the application typically runs many times faster. Here's an example:</p>
<p class="Pp"></p>
<pre>  my $sth = $dbh-&gt;prepare(q{
    INSERT INTO sales (product_code, qty, price) VALUES (?, ?, ?)
  }) or die $dbh-&gt;errstr;
  while (&lt;&gt;) {
      chomp;
      my ($product_code, $qty, $price) = split /,/;
      $sth-&gt;execute($product_code, $qty, $price) or die $dbh-&gt;errstr;
  }
  $dbh-&gt;commit or die $dbh-&gt;errstr;
</pre>
<p class="Pp">See &quot;execute&quot; and &quot;bind_param&quot; for more
    details.</p>
<p class="Pp">The <span class="Li">&quot;q{...}&quot;</span> style quoting used
    in this example avoids clashing with quotes that may be used in the SQL
    statement. Use the double-quote like
    <span class="Li">&quot;qq{...}&quot;</span> operator if you want to
    interpolate variables into the string. See &quot;Quote and Quote-like
    Operators&quot; in perlop for more details.</p>
<p class="Pp">See also the &quot;bind_columns&quot; method, which is used to
    associate Perl variables with the output columns of a
    <span class="Li">&quot;SELECT&quot;</span> statement.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="THE_DBI_PACKAGE_AND_CLASS"><a class="permalink" href="#THE_DBI_PACKAGE_AND_CLASS">THE
  DBI PACKAGE AND CLASS</a></h1>
<p class="Pp">In this section, we cover the DBI class methods, utility
    functions, and the dynamic attributes associated with generic DBI
  handles.</p>
<section class="Ss">
<h2 class="Ss">DBI Constants</h2>
<p class="Pp">Constants representing the values of the SQL standard types can be
    imported individually by name, or all together by importing the special
    <span class="Li">&quot;:sql_types&quot;</span> tag.</p>
<p class="Pp">The names and values of all the defined SQL standard types can be
    produced like this:</p>
<p class="Pp"></p>
<pre>  foreach (@{ $DBI::EXPORT_TAGS{sql_types} }) {
    printf &quot;%s=%d\n&quot;, $_, &amp;{&quot;DBI::$_&quot;};
  }
</pre>
<p class="Pp">These constants are defined by SQL/CLI, ODBC or both.
    <span class="Li">&quot;SQL_BIGINT&quot;</span> has conflicting codes in
    SQL/CLI and ODBC, DBI uses the ODBC one.</p>
<p class="Pp">See the &quot;type_info&quot;, &quot;type_info_all&quot;, and
    &quot;bind_param&quot; methods for possible uses.</p>
<p class="Pp">Note that just because the DBI defines a named constant for a
    given data type doesn't mean that drivers will support that data type.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI Class Methods</h2>
<p class="Pp">The following methods are provided by the DBI class:</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;parse_dsn&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  ($scheme, $driver, $attr_string, $attr_hash, $driver_dsn) = DBI-&gt;parse_dsn($dsn)
      or die &quot;Can't parse DBI DSN '$dsn'&quot;;
</pre>
<p class="Pp">Breaks apart a DBI Data Source Name (DSN) and returns the
    individual parts. If <span class="Li">$dsn</span> doesn't contain a valid
    DSN then <b>parse_dsn()</b> returns an empty list.</p>
<p class="Pp"><span class="Li">$scheme</span> is the first part of the DSN and
    is currently always 'dbi'. <span class="Li">$driver</span> is the driver
    name, possibly defaulted to <span class="Li">$ENV</span>{DBI_DRIVER}, and
    may be undefined. <span class="Li">$attr_string</span> is the contents of
    the optional attribute string, which may be undefined. If
    <span class="Li">$attr_string</span> is not empty then
    <span class="Li">$attr_hash</span> is a reference to a hash containing the
    parsed attribute names and values. <span class="Li">$driver_dsn</span> is
    the last part of the DBI DSN string. For example:</p>
<p class="Pp"></p>
<pre>  ($scheme, $driver, $attr_string, $attr_hash, $driver_dsn)
      = DBI-&gt;parse_dsn(&quot;dbi:MyDriver(RaiseError=&gt;1):db=test;port=42&quot;);
  $scheme      = 'dbi';
  $driver      = 'MyDriver';
  $attr_string = 'RaiseError=&gt;1';
  $attr_hash   = { 'RaiseError' =&gt; '1' };
  $driver_dsn  = 'db=test;port=42';
</pre>
<p class="Pp">The <b>parse_dsn()</b> method was added in DBI 1.43.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;connect&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $dbh = DBI-&gt;connect($data_source, $username, $password)
            or die $DBI::errstr;
  $dbh = DBI-&gt;connect($data_source, $username, $password, \%attr)
            or die $DBI::errstr;
</pre>
<p class="Pp">Establishes a database connection, or session, to the requested
    <span class="Li">$data_source</span>. Returns a database handle object if
    the connection succeeds. Use
    <span class="Li">&quot;$dbh-&gt;disconnect&quot;</span> to terminate the
    connection.</p>
<p class="Pp">If the connect fails (see below), it returns
    <span class="Li">&quot;undef&quot;</span> and sets both
    <span class="Li">$DBI::err</span> and <span class="Li">$DBI::errstr</span>.
    (It does <i>not</i> explicitly set <span class="Li">$!</span>.) You should
    generally test the return status of
    <span class="Li">&quot;connect&quot;</span> and <span class="Li">&quot;print
    $DBI::errstr&quot;</span> if it has failed.</p>
<p class="Pp">Multiple simultaneous connections to multiple databases through
    multiple drivers can be made via the DBI. Simply make one
    <span class="Li">&quot;connect&quot;</span> call for each database and keep
    a copy of each returned database handle.</p>
<p class="Pp">The <span class="Li">$data_source</span> value must begin with
    &quot;<span class="Li">&quot;dbi:&quot;</span><i>driver_name</i><span class="Li">&quot;:&quot;</span>&quot;.
    The <i>driver_name</i> specifies the driver that will be used to make the
    connection. (Letter case is significant.)</p>
<p class="Pp">As a convenience, if the <span class="Li">$data_source</span>
    parameter is undefined or empty, the DBI will substitute the value of the
    environment variable <span class="Li">&quot;DBI_DSN&quot;</span>. If just
    the <i>driver_name</i> part is empty (i.e., the
    <span class="Li">$data_source</span> prefix is
    &quot;<span class="Li">&quot;dbi::&quot;</span>&quot;), the environment
    variable <span class="Li">&quot;DBI_DRIVER&quot;</span> is used. If neither
    variable is set, then <span class="Li">&quot;connect&quot;</span> dies.</p>
<p class="Pp">Examples of <span class="Li">$data_source</span> values are:</p>
<p class="Pp"></p>
<pre>  dbi:DriverName:database_name
  dbi:DriverName:database_name@hostname:port
  dbi:DriverName:database=database_name;host=hostname;port=port
</pre>
<p class="Pp">There is <i>no standard</i> for the text following the driver
    name. Each driver is free to use whatever syntax it wants. The only
    requirement the DBI makes is that all the information is supplied in a
    single string. You must consult the documentation for the drivers you are
    using for a description of the syntax they require.</p>
<p class="Pp">It is recommended that drivers support the ODBC style, shown in
    the last example above. It is also recommended that they support the three
    common names '<span class="Li">&quot;host&quot;</span>',
    '<span class="Li">&quot;port&quot;</span>', and
    '<span class="Li">&quot;database&quot;</span>' (plus
    '<span class="Li">&quot;db&quot;</span>' as an alias for
    <span class="Li">&quot;database&quot;</span>). This simplifies automatic
    construction of basic DSNs:
    <span class="Li">&quot;dbi:$driver:database=$db;host=$host;port=$port&quot;</span>.
    Drivers should aim to 'do something reasonable' when given a DSN in this
    form, but if any part is meaningless for that driver (such as 'port' for
    Informix) it should generate an error if that part is not empty.</p>
<p class="Pp">If the environment variable
    <span class="Li">&quot;DBI_AUTOPROXY&quot;</span> is defined (and the driver
    in <span class="Li">$data_source</span> is not
    &quot;<span class="Li">&quot;Proxy&quot;</span>&quot;) then the connect
    request will automatically be changed to:</p>
<p class="Pp"></p>
<pre>  $ENV{DBI_AUTOPROXY};dsn=$data_source
</pre>
<p class="Pp"><span class="Li">&quot;DBI_AUTOPROXY&quot;</span> is typically set
    as
    &quot;<span class="Li">&quot;dbi:Proxy:hostname=...;port=...&quot;</span>&quot;.
    If <span class="Li">$ENV</span>{DBI_AUTOPROXY} doesn't begin with
    '<span class="Li">&quot;dbi:&quot;</span>' then &quot;dbi:Proxy:&quot; will
    be prepended to it first. See the DBD::Proxy documentation for more
  details.</p>
<p class="Pp">If <span class="Li">$username</span> or
    <span class="Li">$password</span> are undefined (rather than just empty),
    then the DBI will substitute the values of the
    <span class="Li">&quot;DBI_USER&quot;</span> and
    <span class="Li">&quot;DBI_PASS&quot;</span> environment variables,
    respectively. The DBI will warn if the environment variables are not
    defined. However, the everyday use of these environment variables is not
    recommended for security reasons. The mechanism is primarily intended to
    simplify testing. See below for alternative way to specify the username and
    password.</p>
<p class="Pp"><span class="Li">&quot;DBI-&gt;connect&quot;</span> automatically
    installs the driver if it has not been installed yet. Driver installation
    either returns a valid driver handle, or it <i>dies</i> with an error
    message that includes the string
    &quot;<span class="Li">&quot;install_driver&quot;</span>&quot; and the
    underlying problem. So <span class="Li">&quot;DBI-&gt;connect&quot;</span>
    will die on a driver installation failure and will only return
    <span class="Li">&quot;undef&quot;</span> on a connect failure, in which
    case <span class="Li">$DBI::errstr</span> will hold the error message. Use
    <span class="Li">&quot;eval&quot;</span> if you need to catch the
    &quot;<span class="Li">&quot;install_driver&quot;</span>&quot; error.</p>
<p class="Pp">The <span class="Li">$data_source</span> argument (with the
    &quot;<span class="Li">&quot;dbi:...:&quot;</span>&quot; prefix removed) and
    the <span class="Li">$username</span> and <span class="Li">$password</span>
    arguments are then passed to the driver for processing. The DBI does not
    define any interpretation for the contents of these fields. The driver is
    free to interpret the <span class="Li">$data_source</span>,
    <span class="Li">$username</span>, and <span class="Li">$password</span>
    fields in any way, and supply whatever defaults are appropriate for the
    engine being accessed. (Oracle, for example, uses the ORACLE_SID and
    TWO_TASK environment variables if no <span class="Li">$data_source</span> is
    specified.)</p>
<p class="Pp">The <span class="Li">&quot;AutoCommit&quot;</span> and
    <span class="Li">&quot;PrintError&quot;</span> attributes for each
    connection default to &quot;on&quot;. (See &quot;AutoCommit&quot; and
    &quot;PrintError&quot; for more information.) However, it is strongly
    recommended that you explicitly define
    <span class="Li">&quot;AutoCommit&quot;</span> rather than rely on the
    default. The <span class="Li">&quot;PrintWarn&quot;</span> attribute
    defaults to true. The <span class="Li">&quot;RaiseWarn&quot;</span>
    attribute defaults to false.</p>
<p class="Pp">The <span class="Li">&quot;\%attr&quot;</span> parameter can be
    used to alter the default settings of
    <span class="Li">&quot;PrintError&quot;</span>,
    <span class="Li">&quot;RaiseError&quot;</span>,
    <span class="Li">&quot;AutoCommit&quot;</span>, and other attributes. For
    example:</p>
<p class="Pp"></p>
<pre>  $dbh = DBI-&gt;connect($data_source, $user, $pass, {
        PrintError =&gt; 0,
        AutoCommit =&gt; 0
  });
</pre>
<p class="Pp">The username and password can also be specified using the
    attributes <span class="Li">&quot;Username&quot;</span> and
    <span class="Li">&quot;Password&quot;</span>, in which case they take
    precedence over the <span class="Li">$username</span> and
    <span class="Li">$password</span> parameters.</p>
<p class="Pp">You can also define connection attribute values within the
    <span class="Li">$data_source</span> parameter. For example:</p>
<p class="Pp"></p>
<pre>  dbi:DriverName(PrintWarn=&gt;0,PrintError=&gt;0,Taint=&gt;1):...
</pre>
<p class="Pp">Individual attributes values specified in this way take precedence
    over any conflicting values specified via the
    <span class="Li">&quot;\%attr&quot;</span> parameter to
    <span class="Li">&quot;connect&quot;</span>.</p>
<p class="Pp">The <span class="Li">&quot;dbi_connect_method&quot;</span>
    attribute can be used to specify which driver method should be called to
    establish the connection. The only useful values are 'connect',
    'connect_cached', or some specialized case like 'Apache::DBI::connect'
    (which is automatically the default when running within Apache).</p>
<p class="Pp">Where possible, each session (<span class="Li">$dbh</span>) is
    independent from the transactions in other sessions. This is useful when you
    need to hold cursors open across transactions--for example, if you use one
    session for your long lifespan cursors (typically read-only) and another for
    your short update transactions.</p>
<p class="Pp">For compatibility with old DBI scripts, the driver can be
    specified by passing its name as the fourth argument to
    <span class="Li">&quot;connect&quot;</span> (instead of
    <span class="Li">&quot;\%attr&quot;</span>):</p>
<p class="Pp"></p>
<pre>  $dbh = DBI-&gt;connect($data_source, $user, $pass, $driver);
</pre>
<p class="Pp">In this &quot;old-style&quot; form of
    <span class="Li">&quot;connect&quot;</span>, the
    <span class="Li">$data_source</span> should not start with
    &quot;<span class="Li">&quot;dbi:driver_name:&quot;</span>&quot;. (If it
    does, the embedded driver_name will be ignored). Also note that in this
    older form of <span class="Li">&quot;connect&quot;</span>, the
    <span class="Li">&quot;$dbh-&gt;{AutoCommit}&quot;</span> attribute is
    <i>undefined</i>, the
    <span class="Li">&quot;$dbh-&gt;{PrintError}&quot;</span> attribute is off,
    and the old <span class="Li">&quot;DBI_DBNAME&quot;</span> environment
    variable is checked if <span class="Li">&quot;DBI_DSN&quot;</span> is not
    defined. Beware that this &quot;old-style&quot;
    <span class="Li">&quot;connect&quot;</span> will soon be withdrawn in a
    future version of DBI.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;connect_cached&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $dbh = DBI-&gt;connect_cached($data_source, $username, $password)
            or die $DBI::errstr;
  $dbh = DBI-&gt;connect_cached($data_source, $username, $password, \%attr)
            or die $DBI::errstr;
</pre>
<p class="Pp"><span class="Li">&quot;connect_cached&quot;</span> is like
    &quot;connect&quot;, except that the database handle returned is also stored
    in a hash associated with the given parameters. If another call is made to
    <span class="Li">&quot;connect_cached&quot;</span> with the same parameter
    values, then the corresponding cached <span class="Li">$dbh</span> will be
    returned if it is still valid. The cached database handle is replaced with a
    new connection if it has been disconnected or if the
    <span class="Li">&quot;ping&quot;</span> method fails.</p>
<p class="Pp">Note that the behaviour of this method differs in several respects
    from the behaviour of persistent connections implemented by Apache::DBI.
    However, if Apache::DBI is loaded then
    <span class="Li">&quot;connect_cached&quot;</span> will use it.</p>
<p class="Pp">Caching connections can be useful in some applications, but it can
    also cause problems, such as too many connections, and so should be used
    with care. In particular, avoid changing the attributes of a database handle
    created via <b>connect_cached()</b> because it will affect other code that
    may be using the same handle. When <b>connect_cached()</b> returns a handle
    the attributes will be reset to their initial values. This can cause
    problems, especially with the <span class="Li">&quot;AutoCommit&quot;</span>
    attribute.</p>
<p class="Pp">Also, to ensure that the attributes passed are always the same,
    avoid passing references inline. For example, the
    <span class="Li">&quot;Callbacks&quot;</span> attribute is specified as a
    hash reference. Be sure to declare it external to the call to
    <b>connect_cached()</b>, such that the hash reference is not re-created on
    every call. A package-level lexical works well:</p>
<p class="Pp"></p>
<pre>  package MyDBH;
  my $cb = {
      'connect_cached.reused' =&gt; sub { delete $_[4]-&gt;{AutoCommit} },
  };
  sub dbh {
      DBI-&gt;connect_cached( $dsn, $username, $auth, { Callbacks =&gt; $cb });
  }
</pre>
<p class="Pp">Where multiple separate parts of a program are using
    <b>connect_cached()</b> to connect to the same database with the same
    (initial) attributes it is a good idea to add a private attribute to the
    <b>connect_cached()</b> call to effectively limit the scope of the caching.
    For example:</p>
<p class="Pp"></p>
<pre>  DBI-&gt;connect_cached(..., { private_foo_cachekey =&gt; &quot;Bar&quot;, ... });
</pre>
<p class="Pp">Handles returned from that <b>connect_cached()</b> call will only
    be returned by other <b>connect_cached()</b> call elsewhere in the code if
    those other calls also pass in the same attribute values, including the
    private one. (I've used
    <span class="Li">&quot;private_foo_cachekey&quot;</span> here as an example,
    you can use any attribute name with a
    <span class="Li">&quot;private_&quot;</span> prefix.)</p>
<p class="Pp">Taking that one step further, you can limit a particular
    <b>connect_cached()</b> call to return handles unique to that one place in
    the code by setting the private attribute to a unique value for that
  place:</p>
<p class="Pp"></p>
<pre>  DBI-&gt;connect_cached(..., { private_foo_cachekey =&gt; __FILE__.__LINE__, ... });
</pre>
<p class="Pp">By using a private attribute you still get connection caching for
    the individual calls to <b>connect_cached()</b> but, by making separate
    database connections for separate parts of the code, the database handles
    are isolated from any attribute changes made to other handles.</p>
<p class="Pp">The cache can be accessed (and cleared) via the
    &quot;CachedKids&quot; attribute:</p>
<p class="Pp"></p>
<pre>  my $CachedKids_hashref = $dbh-&gt;{Driver}-&gt;{CachedKids};
  %$CachedKids_hashref = () if $CachedKids_hashref;
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;available_drivers&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @ary = DBI-&gt;available_drivers;
  @ary = DBI-&gt;available_drivers($quiet);
</pre>
<p class="Pp">Returns a list of all available drivers by searching for
    <span class="Li">&quot;DBD::*&quot;</span> modules through the directories
    in <span class="Li">@INC</span>. By default, a warning is given if some
    drivers are hidden by others of the same name in earlier directories.
    Passing a true value for <span class="Li">$quiet</span> will inhibit the
    warning.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;installed_drivers&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  %drivers = DBI-&gt;installed_drivers();
</pre>
<p class="Pp">Returns a list of driver name and driver handle pairs for all
    drivers 'installed' (loaded) into the current process. The driver name does
    not include the 'DBD::' prefix.</p>
<p class="Pp">To get a list of all drivers available in your perl installation
    you can use &quot;available_drivers&quot;.</p>
<p class="Pp">Added in DBI 1.49.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;installed_versions&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  DBI-&gt;installed_versions;
  @ary  = DBI-&gt;installed_versions;
  $hash = DBI-&gt;installed_versions;
</pre>
<p class="Pp">Calls <b>available_drivers()</b> and attempts to load each of them
    in turn using <b>install_driver()</b>. For each load that succeeds the
    driver name and version number are added to a hash. When running under
    DBI::PurePerl drivers which appear not be pure-perl are ignored.</p>
<p class="Pp">When called in array context the list of successfully loaded
    drivers is returned (without the 'DBD::' prefix).</p>
<p class="Pp">When called in scalar context an extra entry for the
    <span class="Li">&quot;DBI&quot;</span> is added (and
    <span class="Li">&quot;DBI::PurePerl&quot;</span> if appropriate) and a
    reference to the hash is returned.</p>
<p class="Pp">When called in a void context the <b>installed_versions()</b>
    method will print out a formatted list of the hash contents, one per line,
    along with some other information about the DBI version and OS.</p>
<p class="Pp">Due to the potentially high memory cost and unknown risks of
    loading in an unknown number of drivers that just happen to be installed on
    the system, this method is not recommended for general use. Use
    <b>available_drivers()</b> instead.</p>
<p class="Pp">The <b>installed_versions()</b> method is primarily intended as a
    quick way to see from the command line what's installed. For example:</p>
<p class="Pp"></p>
<pre>  perl -MDBI -e 'DBI-&gt;installed_versions'
</pre>
<p class="Pp">The <b>installed_versions()</b> method was added in DBI 1.38.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;data_sources&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @ary = DBI-&gt;data_sources($driver);
  @ary = DBI-&gt;data_sources($driver, \%attr);
</pre>
<p class="Pp">Returns a list of data sources (databases) available via the named
    driver. If <span class="Li">$driver</span> is empty or
    <span class="Li">&quot;undef&quot;</span>, then the value of the
    <span class="Li">&quot;DBI_DRIVER&quot;</span> environment variable is
  used.</p>
<p class="Pp">The driver will be loaded if it hasn't been already. Note that if
    the driver loading fails then <b>data_sources()</b> <i>dies</i> with an
    error message that includes the string
    &quot;<span class="Li">&quot;install_driver&quot;</span>&quot; and the
    underlying problem.</p>
<p class="Pp">Data sources are returned in a form suitable for passing to the
    &quot;connect&quot; method (that is, they will include the
    &quot;<span class="Li">&quot;dbi:$driver:&quot;</span>&quot; prefix).</p>
<p class="Pp">Note that many drivers have no way of knowing what data sources
    might be available for it. These drivers return an empty or incomplete list
    or may require driver-specific attributes.</p>
<p class="Pp">There is also a <b>data_sources()</b> method defined for database
    handles.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;trace&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  DBI-&gt;trace($trace_setting)
  DBI-&gt;trace($trace_setting, $trace_filename)
  DBI-&gt;trace($trace_setting, $trace_filehandle)
  $trace_setting = DBI-&gt;trace;
</pre>
<p class="Pp">The <span class="Li">&quot;DBI-&gt;trace&quot;</span> method sets
    the <i>global default</i> trace settings and returns the <i>previous</i>
    trace settings. It can also be used to change where the trace output is
    sent.</p>
<p class="Pp">There's a similar method,
    <span class="Li">&quot;$h-&gt;trace&quot;</span>, which sets the trace
    settings for the specific handle it's called on.</p>
<p class="Pp">See the &quot;TRACING&quot; section for full details about the
    DBI's powerful tracing facilities.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;visit_handles&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  DBI-&gt;visit_handles( $coderef );
  DBI-&gt;visit_handles( $coderef, $info );
</pre>
<p class="Pp">Where <span class="Li">$coderef</span> is a reference to a
    subroutine and <span class="Li">$info</span> is an arbitrary value which, if
    undefined, defaults to a reference to an empty hash. Returns
    <span class="Li">$info</span>.</p>
<p class="Pp">For each installed driver handle, if any,
    <span class="Li">$coderef</span> is invoked as:</p>
<p class="Pp"></p>
<pre>  $coderef-&gt;($driver_handle, $info);
</pre>
<p class="Pp">If the execution of <span class="Li">$coderef</span> returns a
    true value then &quot;visit_child_handles&quot; is called on that child
    handle and passed the returned value as <span class="Li">$info</span>.</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  my $info = $dbh-&gt;{Driver}-&gt;visit_child_handles(sub {
      my ($h, $info) = @_;
      ++$info-&gt;{ $h-&gt;{Type} }; # count types of handles (dr/db/st)
      return $info; # visit kids
  });
</pre>
<p class="Pp">See also &quot;visit_child_handles&quot;.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI Utility Functions</h2>
<p class="Pp">In addition to the DBI methods listed in the previous section, the
    DBI package also provides several utility functions.</p>
<p class="Pp">These can be imported into your code by listing them in the
    <span class="Li">&quot;use&quot;</span> statement. For example:</p>
<p class="Pp"></p>
<pre>  use DBI qw(neat data_diff);
</pre>
<p class="Pp">Alternatively, all these utility functions (except hash) can be
    imported using the <span class="Li">&quot;:utils&quot;</span> import tag.
    For example:</p>
<p class="Pp"></p>
<pre>  use DBI qw(:utils);
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;data_string_desc&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $description = data_string_desc($string);
</pre>
<p class="Pp">Returns an informal description of the string. For example:</p>
<p class="Pp"></p>
<pre>  UTF8 off, ASCII, 42 characters 42 bytes
  UTF8 off, non-ASCII, 42 characters 42 bytes
  UTF8 on, non-ASCII, 4 characters 6 bytes
  UTF8 on but INVALID encoding, non-ASCII, 4 characters 6 bytes
  UTF8 off, undef
</pre>
<p class="Pp">The initial <span class="Li">&quot;UTF8&quot;</span> on/off refers
    to Perl's internal SvUTF8 flag. If <span class="Li">$string</span> has the
    SvUTF8 flag set but the sequence of bytes it contains are not a valid UTF-8
    encoding then <b>data_string_desc()</b> will report
    <span class="Li">&quot;UTF8 on but INVALID encoding&quot;</span>.</p>
<p class="Pp">The <span class="Li">&quot;ASCII&quot;</span> vs
    <span class="Li">&quot;non-ASCII&quot;</span> portion shows
    <span class="Li">&quot;ASCII&quot;</span> if <i>all</i> the characters in
    the string are ASCII (have code points &lt;= 127).</p>
<p class="Pp">The <b>data_string_desc()</b> function was added in DBI 1.46.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;data_string_diff&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $diff = data_string_diff($a, $b);
</pre>
<p class="Pp">Returns an informal description of the first character difference
    between the strings. If both <span class="Li">$a</span> and
    <span class="Li">$b</span> contain the same sequence of characters then
    <b>data_string_diff()</b> returns an empty string. For example:</p>
<p class="Pp"></p>
<pre> Params a &amp; b     Result
 ------------     ------
 'aaa', 'aaa'     ''
 'aaa', 'abc'     'Strings differ at index 2: a[2]=a, b[2]=b'
 'aaa', undef     'String b is undef, string a has 3 characters'
 'aaa', 'aa'      'String b truncated after 2 characters'
</pre>
<p class="Pp">Unicode characters are reported in
    <span class="Li">&quot;\x{XXXX}&quot;</span> format. Unicode code points in
    the range U+0800 to U+08FF are unassigned and most likely to occur due to
    double-encoding. Characters in this range are reported as
    <span class="Li">&quot;\x{08XX}='C'&quot;</span> where
    <span class="Li">&quot;C&quot;</span> is the corresponding latin-1
    character.</p>
<p class="Pp">The <b>data_string_diff()</b> function only considers logical
    <i>characters</i> and not the underlying encoding. See &quot;data_diff&quot;
    for an alternative.</p>
<p class="Pp">The <b>data_string_diff()</b> function was added in DBI 1.46.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;data_diff&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $diff = data_diff($a, $b);
  $diff = data_diff($a, $b, $logical);
</pre>
<p class="Pp">Returns an informal description of the difference between two
    strings. It calls &quot;data_string_desc&quot; and
    &quot;data_string_diff&quot; and returns the combined results as a
    multi-line string.</p>
<p class="Pp">For example, <span class="Li">&quot;data_diff(&quot;abc&quot;,
    &quot;ab\x{263a}&quot;)&quot;</span> will return:</p>
<p class="Pp"></p>
<pre>  a: UTF8 off, ASCII, 3 characters 3 bytes
  b: UTF8 on, non-ASCII, 3 characters 5 bytes
  Strings differ at index 2: a[2]=c, b[2]=\x{263A}
</pre>
<p class="Pp">If <span class="Li">$a</span> and <span class="Li">$b</span> are
    identical in both the characters they contain <i>and</i> their physical
    encoding then <b>data_diff()</b> returns an empty string. If
    <span class="Li">$logical</span> is true then physical encoding differences
    are ignored (but are still reported if there is a difference in the
    characters).</p>
<p class="Pp">The <b>data_diff()</b> function was added in DBI 1.46.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;neat&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $str = neat($value);
  $str = neat($value, $maxlen);
</pre>
<p class="Pp">Return a string containing a neat (and tidy) representation of the
    supplied value.</p>
<p class="Pp">Strings will be quoted, although internal quotes will <i>not</i>
    be escaped. Values known to be numeric will be unquoted. Undefined (NULL)
    values will be shown as <span class="Li">&quot;undef&quot;</span> (without
    quotes).</p>
<p class="Pp">If the string is flagged internally as utf8 then double quotes
    will be used, otherwise single quotes are used and unprintable characters
    will be replaced by dot (.).</p>
<p class="Pp">For result strings longer than <span class="Li">$maxlen</span> the
    result string will be truncated to
    <span class="Li">&quot;$maxlen-4&quot;</span> and
    &quot;<span class="Li">&quot;...'&quot;</span>&quot; will be appended. If
    <span class="Li">$maxlen</span> is 0 or
    <span class="Li">&quot;undef&quot;</span>, it defaults to
    <span class="Li">$DBI::neat_maxlen</span> which, in turn, defaults to
  400.</p>
<p class="Pp">This function is designed to format values for human consumption.
    It is used internally by the DBI for &quot;trace&quot; output. It should
    typically <i>not</i> be used for formatting values for database use. (See
    also &quot;quote&quot;.)</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;neat_list&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $str = neat_list(\@listref, $maxlen, $field_sep);
</pre>
<p class="Pp">Calls <span class="Li">&quot;neat&quot;</span> on each element of
    the list and returns a string containing the results joined with
    <span class="Li">$field_sep</span>. <span class="Li">$field_sep</span>
    defaults to <span class="Li">&quot;, &quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;looks_like_number&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @bool = looks_like_number(@array);
</pre>
<p class="Pp">Returns true for each element that looks like a number. Returns
    false for each element that does not look like a number. Returns
    <span class="Li">&quot;undef&quot;</span> for each element that is undefined
    or empty.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;hash&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $hash_value = DBI::hash($buffer, $type);
</pre>
<p class="Pp">Return a 32-bit integer 'hash' value corresponding to the contents
    of <span class="Li">$buffer</span>. The <span class="Li">$type</span>
    parameter selects which kind of hash algorithm should be used.</p>
<p class="Pp">For the technically curious, type 0 (which is the default if
    <span class="Li">$type</span> isn't specified) is based on the Perl 5.1 hash
    except that the value is forced to be negative (for obscure historical
    reasons). Type 1 is the better &quot;Fowler / Noll / Vo&quot; (FNV) hash.
    See &lt;http://www.isthe.com/chongo/tech/comp/fnv/&gt; for more information.
    Both types are implemented in C and are very fast.</p>
<p class="Pp">This function doesn't have much to do with databases, except that
    it can sometimes be handy to store such values in a database. It also
    doesn't have much to do with perl hashes, like
  <span class="Li">%foo</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;sql_type_cast&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sts = DBI::sql_type_cast($sv, $sql_type, $flags);
</pre>
<p class="Pp">sql_type_cast attempts to cast <span class="Li">$sv</span> to the
    SQL type (see DBI Constants) specified in <span class="Li">$sql_type</span>.
    At present only the SQL types
    <span class="Li">&quot;SQL_INTEGER&quot;</span>,
    <span class="Li">&quot;SQL_DOUBLE&quot;</span> and
    <span class="Li">&quot;SQL_NUMERIC&quot;</span> are supported.</p>
<p class="Pp">For <span class="Li">&quot;SQL_INTEGER&quot;</span> the effect is
    similar to using the value in an expression that requires an integer. It
    gives the perl scalar an 'integer aspect'. (Technically the value gains an
    IV, or possibly a UV or NV if the value is too large for an IV.)</p>
<p class="Pp">For <span class="Li">&quot;SQL_DOUBLE&quot;</span> the effect is
    similar to using the value in an expression that requires a general numeric
    value. It gives the perl scalar a 'numeric aspect'. (Technically the value
    gains an NV.)</p>
<p class="Pp"><span class="Li">&quot;SQL_NUMERIC&quot;</span> is similar to
    <span class="Li">&quot;SQL_INTEGER&quot;</span> or
    <span class="Li">&quot;SQL_DOUBLE&quot;</span> but more general and more
    cautious. It will look at the string first and if it looks like an integer
    (that will fit in an IV or UV) it will act like
    <span class="Li">&quot;SQL_INTEGER&quot;</span>, if it looks like a floating
    point value it will act like <span class="Li">&quot;SQL_DOUBLE&quot;</span>,
    if it looks like neither then it will do nothing - and thereby avoid the
    warnings that would be generated by
    <span class="Li">&quot;SQL_INTEGER&quot;</span> and
    <span class="Li">&quot;SQL_DOUBLE&quot;</span> when given non-numeric
  data.</p>
<p class="Pp"><span class="Li">$flags</span> may be:</p>
<dl class="Bl-tag">
  <dt>&quot;DBIstcf_DISCARD_STRING&quot;</dt>
  <dd>If this flag is specified then when the driver successfully casts the
      bound perl scalar to a non-string type then the string portion of the
      scalar will be discarded.</dd>
  <dt>&quot;DBIstcf_STRICT&quot;</dt>
  <dd>If <span class="Li">$sv</span> cannot be cast to the requested
      <span class="Li">$sql_type</span> then by default it is left untouched and
      no error is generated. If you specify
      <span class="Li">&quot;DBIstcf_STRICT&quot;</span> and the cast fails,
      this will generate an error.</dd>
</dl>
<p class="Pp">The returned <span class="Li">$sts</span> value is:</p>
<p class="Pp"></p>
<pre>  -2 sql_type is not handled
  -1 sv is undef so unchanged
   0 sv could not be cast cleanly and DBIstcf_STRICT was used
   1 sv could not be cast and DBIstcf_STRICT was not used
   2 sv was cast successfully
</pre>
<p class="Pp">This method is exported by the :utils tag and was introduced in
    DBI 1.611.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI Dynamic Attributes</h2>
<p class="Pp">Dynamic attributes are always associated with the <i>last handle
    used</i> (that handle is represented by <span class="Li">$h</span> in the
    descriptions below).</p>
<p class="Pp">Where an attribute is equivalent to a method call, then refer to
    the method call for all related documentation.</p>
<p class="Pp">Warning: these attributes are provided as a convenience but they
    do have limitations. Specifically, they have a short lifespan: because they
    are associated with the last handle used, they should only be used
    <i>immediately</i> after calling the method that &quot;sets&quot; them. If
    in any doubt, use the corresponding method call.</p>
<p class="Pp"><i></i><span class="Li"><i>$DBI::err</i></span><i></i></p>
<p class="Pp">Equivalent to <span class="Li">&quot;$h-&gt;err&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>$DBI::errstr</i></span><i></i></p>
<p class="Pp">Equivalent to
  <span class="Li">&quot;$h-&gt;errstr&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>$DBI::state</i></span><i></i></p>
<p class="Pp">Equivalent to
  <span class="Li">&quot;$h-&gt;state&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>$DBI::rows</i></span><i></i></p>
<p class="Pp">Equivalent to <span class="Li">&quot;$h-&gt;rows&quot;</span>.
    Please refer to the documentation for the &quot;rows&quot; method.</p>
<p class="Pp"><i></i><span class="Li"><i>$DBI::lasth</i></span><i></i></p>
<p class="Pp">Returns the DBI object handle used for the most recent DBI method
    call. If the last DBI method call was a DESTROY then
    <span class="Li">$DBI::lasth</span> will return the handle of the parent of
    the destroyed handle, if there is one.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS_COMMON_TO_ALL_HANDLES"><a class="permalink" href="#METHODS_COMMON_TO_ALL_HANDLES">METHODS
  COMMON TO ALL HANDLES</a></h1>
<p class="Pp">The following methods can be used by all types of DBI handles.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;err&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rv = $h-&gt;err;
</pre>
<p class="Pp">Returns the <i>native</i> database engine error code from the last
    driver method called. The code is typically an integer but you should not
    assume that.</p>
<p class="Pp">The DBI resets <span class="Li">$h</span>-&gt;err to undef before
    almost all DBI method calls, so the value only has a short lifespan. Also,
    for most drivers, the statement handles share the same error variable as the
    parent database handle, so calling a method on one handle may reset the
    error on the related handles.</p>
<p class="Pp">(Methods which don't reset err before being called include
    <b>err()</b> and <b>errstr()</b>, obviously, <b>state()</b>, <b>rows()</b>,
    <b>func()</b>, <b>trace()</b>, <b>trace_msg()</b>, <b>ping()</b>, and the
    tied hash attribute <b>FETCH()</b> and <b>STORE()</b> methods.)</p>
<p class="Pp">If you need to test for specific error conditions <i>and</i> have
    your program be portable to different database engines, then you'll need to
    determine what the corresponding error codes are for all those engines and
    test for all of them.</p>
<p class="Pp">The DBI uses the value of <span class="Li">$DBI::stderr</span> as
    the <span class="Li">&quot;err&quot;</span> value for internal errors.
    Drivers should also do likewise. The default value for
    <span class="Li">$DBI::stderr</span> is 2000000000.</p>
<p class="Pp">A driver may return <span class="Li">0</span> from <b>err()</b> to
    indicate a warning condition after a method call. Similarly, a driver may
    return an empty string to indicate a 'success with information' condition.
    In both these cases the value is false but not undef. The <b>errstr()</b>
    and <b>state()</b> methods may be used to retrieve extra information in
    these cases.</p>
<p class="Pp">See &quot;set_err&quot; for more information.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;errstr&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $str = $h-&gt;errstr;
</pre>
<p class="Pp">Returns the native database engine error message from the last DBI
    method called. This has the same lifespan issues as the &quot;err&quot;
    method described above.</p>
<p class="Pp">The returned string may contain multiple messages separated by
    newline characters.</p>
<p class="Pp">The <b>errstr()</b> method should not be used to test for errors,
    use <b>err()</b> for that, because drivers may return 'success with
    information' or warning messages via <b>errstr()</b> for methods that have
    not 'failed'.</p>
<p class="Pp">See &quot;set_err&quot; for more information.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;state&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $str = $h-&gt;state;
</pre>
<p class="Pp">Returns a state code in the standard SQLSTATE five character
    format. Note that the specific success code <span class="Li">00000</span> is
    translated to any empty string (false). If the driver does not support
    SQLSTATE (and most don't), then <b>state()</b> will return
    <span class="Li">&quot;S1000&quot;</span> (General Error) for all
  errors.</p>
<p class="Pp">The driver is free to return any value via
    <span class="Li">&quot;state&quot;</span>, e.g., warning codes, even if it
    has not declared an error by returning a true value via the &quot;err&quot;
    method described above.</p>
<p class="Pp">The <b>state()</b> method should not be used to test for errors,
    use <b>err()</b> for that, because drivers may return a 'success with
    information' or warning state code via <b>state()</b> for methods that have
    not 'failed'.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;set_err&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rv = $h-&gt;set_err($err, $errstr);
  $rv = $h-&gt;set_err($err, $errstr, $state);
  $rv = $h-&gt;set_err($err, $errstr, $state, $method);
  $rv = $h-&gt;set_err($err, $errstr, $state, $method, $rv);
</pre>
<p class="Pp">Set the <span class="Li">&quot;err&quot;</span>,
    <span class="Li">&quot;errstr&quot;</span>, and
    <span class="Li">&quot;state&quot;</span> values for the handle. This method
    is typically only used by DBI drivers and DBI subclasses.</p>
<p class="Pp">If the &quot;HandleSetErr&quot; attribute holds a reference to a
    subroutine it is called first. The subroutine can alter the
    <span class="Li">$err</span>, <span class="Li">$errstr</span>,
    <span class="Li">$state</span>, and <span class="Li">$method</span> values.
    See &quot;HandleSetErr&quot; for full details. If the subroutine returns a
    true value then the handle <span class="Li">&quot;err&quot;</span>,
    <span class="Li">&quot;errstr&quot;</span>, and
    <span class="Li">&quot;state&quot;</span> values are not altered and
    <b>set_err()</b> returns an empty list (it normally returns
    <span class="Li">$rv</span> which defaults to undef, see below).</p>
<p class="Pp">Setting <span class="Li">&quot;err&quot;</span> to a <i>true</i>
    value indicates an error and will trigger the normal DBI error handling
    mechanisms, such as <span class="Li">&quot;RaiseError&quot;</span> and
    <span class="Li">&quot;HandleError&quot;</span>, if they are enabled, when
    execution returns from the DBI back to the application.</p>
<p class="Pp">Setting <span class="Li">&quot;err&quot;</span> to
    <span class="Li">&quot;&quot;</span> indicates an 'information' state, and
    setting it to <span class="Li">&quot;0&quot;</span> indicates a 'warning'
    state. Setting <span class="Li">&quot;err&quot;</span> to
    <span class="Li">&quot;undef&quot;</span> also sets
    <span class="Li">&quot;errstr&quot;</span> to undef, and
    <span class="Li">&quot;state&quot;</span> to
    <span class="Li">&quot;&quot;</span>, irrespective of the values of the
    <span class="Li">$errstr</span> and <span class="Li">$state</span>
    parameters.</p>
<p class="Pp">The <span class="Li">$method</span> parameter provides an
    alternate method name for the
    <span class="Li">&quot;RaiseError&quot;</span>/<span class="Li">&quot;PrintError&quot;</span>/<span class="Li">&quot;RaiseWarn&quot;</span>/<span class="Li">&quot;PrintWarn&quot;</span>
    error string instead of the fairly unhelpful
    '<span class="Li">&quot;set_err&quot;</span>'.</p>
<p class="Pp">The <span class="Li">&quot;set_err&quot;</span> method normally
    returns undef. The <span class="Li">$rv</span> parameter provides an
    alternate return value.</p>
<p class="Pp">Some special rules apply if the
    <span class="Li">&quot;err&quot;</span> or
    <span class="Li">&quot;errstr&quot;</span> values for the handle are
    <i>already</i> set...</p>
<p class="Pp">If <span class="Li">&quot;errstr&quot;</span> is true then:
    &quot;<span class="Li">&quot; [err was %s now %s]&quot;</span>&quot; is
    appended if <span class="Li">$err</span> is true and
    <span class="Li">&quot;err&quot;</span> is already true and the new err
    value differs from the original one. Similarly &quot;<span class="Li">&quot;
    [state was %s now %s]&quot;</span>&quot; is appended if
    <span class="Li">$state</span> is true and
    <span class="Li">&quot;state&quot;</span> is already true and the new state
    value differs from the original one. Finally
    &quot;<span class="Li">&quot;\n&quot;</span>&quot; and the new
    <span class="Li">$errstr</span> are appended if
    <span class="Li">$errstr</span> differs from the existing errstr value.
    Obviously the <span class="Li">%s</span>'s above are replaced by the
    corresponding values.</p>
<p class="Pp">The handle <span class="Li">&quot;err&quot;</span> value is set to
    <span class="Li">$err</span> if: <span class="Li">$err</span> is true; or
    handle <span class="Li">&quot;err&quot;</span> value is undef; or
    <span class="Li">$err</span> is defined and the length is greater than the
    handle <span class="Li">&quot;err&quot;</span> length. The effect is that an
    'information' state only overrides undef; a 'warning' overrides undef or
    'information', and an 'error' state overrides anything.</p>
<p class="Pp">The handle <span class="Li">&quot;state&quot;</span> value is set
    to <span class="Li">$state</span> if <span class="Li">$state</span> is true
    and the handle <span class="Li">&quot;err&quot;</span> value was set (by the
    rules above).</p>
<p class="Pp">Support for warning and information states was added in DBI
  1.41.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;trace&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $h-&gt;trace($trace_settings);
  $h-&gt;trace($trace_settings, $trace_filename);
  $trace_settings = $h-&gt;trace;
</pre>
<p class="Pp">The <b>trace()</b> method is used to alter the trace settings for
    a handle (and any future children of that handle). It can also be used to
    change where the trace output is sent.</p>
<p class="Pp">There's a similar method,
    <span class="Li">&quot;DBI-&gt;trace&quot;</span>, which sets the global
    default trace settings.</p>
<p class="Pp">See the &quot;TRACING&quot; section for full details about the
    DBI's powerful tracing facilities.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;trace_msg&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $h-&gt;trace_msg($message_text);
  $h-&gt;trace_msg($message_text, $min_level);
</pre>
<p class="Pp">Writes <span class="Li">$message_text</span> to the trace file if
    the trace level is greater than or equal to
    <span class="Li">$min_level</span> (which defaults to 1). Can also be called
    as <span class="Li">&quot;DBI-&gt;trace_msg($msg)&quot;</span>.</p>
<p class="Pp">See &quot;TRACING&quot; for more details.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;func&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $h-&gt;func(@func_arguments, $func_name) or die ...;
</pre>
<p class="Pp">The <span class="Li">&quot;func&quot;</span> method can be used to
    call private non-standard and non-portable methods implemented by the
    driver. Note that the function name is given as the <i>last</i>
  argument.</p>
<p class="Pp">It's also important to note that the <b>func()</b> method does not
    clear a previous error ($DBI::err etc.) and it does not trigger automatic
    error detection (RaiseError etc.) so you must check the return status and/or
    <span class="Li">$h</span>-&gt;err to detect errors.</p>
<p class="Pp">(This method is not directly related to calling stored procedures.
    Calling stored procedures is currently not defined by the DBI. Some drivers,
    such as DBD::Oracle, support it in non-portable ways. See driver
    documentation for more details.)</p>
<p class="Pp">See also <b>install_method()</b> in DBI::DBD for how you can avoid
    needing to use <b>func()</b> and gain direct access to driver-private
    methods.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;can&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $is_implemented = $h-&gt;can($method_name);
</pre>
<p class="Pp">Returns true if <span class="Li">$method_name</span> is
    implemented by the driver or a default method is provided by the DBI's
    driver base class. It returns false where a driver hasn't implemented a
    method and the default method is provided by the DBI's driver base class is
    just an empty stub.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;parse_trace_flags&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $trace_settings_integer = $h-&gt;parse_trace_flags($trace_settings);
</pre>
<p class="Pp">Parses a string containing trace settings and returns the
    corresponding integer value used internally by the DBI and drivers.</p>
<p class="Pp">The <span class="Li">$trace_settings</span> argument is a string
    containing a trace level between 0 and 15 and/or trace flag names separated
    by vertical bar (&quot;<span class="Li">&quot;|&quot;</span>&quot;) or comma
    (&quot;<span class="Li">&quot;,&quot;</span>&quot;) characters. For example:
    <span class="Li">&quot;SQL|3|foo&quot;</span>.</p>
<p class="Pp">It uses the <b>parse_trace_flag()</b> method, described below, to
    process the individual trace flag names.</p>
<p class="Pp">The <b>parse_trace_flags()</b> method was added in DBI 1.42.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;parse_trace_flag&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $bit_flag = $h-&gt;parse_trace_flag($trace_flag_name);
</pre>
<p class="Pp">Returns the bit flag corresponding to the trace flag name in
    <span class="Li">$trace_flag_name</span>. Drivers are expected to override
    this method and check if <span class="Li">$trace_flag_name</span> is a
    driver specific trace flags and, if not, then call the DBI's default
    <b>parse_trace_flag()</b>.</p>
<p class="Pp">The <b>parse_trace_flag()</b> method was added in DBI 1.42.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;private_attribute_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $hash_ref = $h-&gt;private_attribute_info();
</pre>
<p class="Pp">Returns a reference to a hash whose keys are the names of
    driver-private handle attributes available for the kind of handle (driver,
    database, statement) that the method was called on.</p>
<p class="Pp">For example, the return value when called with a DBD::Sybase
    <span class="Li">$dbh</span> could look like this:</p>
<p class="Pp"></p>
<pre>  {
      syb_dynamic_supported =&gt; undef,
      syb_oc_version =&gt; undef,
      syb_server_version =&gt; undef,
      syb_server_version_string =&gt; undef,
  }
</pre>
<p class="Pp">and when called with a DBD::Sybase <span class="Li">$sth</span>
    they could look like this:</p>
<p class="Pp"></p>
<pre>  {
      syb_types =&gt; undef,
      syb_proc_status =&gt; undef,
      syb_result_type =&gt; undef,
  }
</pre>
<p class="Pp">The values should be undef. Meanings may be assigned to particular
    values in future.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;swap_inner_handle&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $h1-&gt;swap_inner_handle( $h2 );
  $rc = $h1-&gt;swap_inner_handle( $h2, $allow_reparent );
</pre>
<p class="Pp">Brain transplants for handles. You don't need to know about this
    unless you want to become a handle surgeon.</p>
<p class="Pp">A DBI handle is a reference to a tied hash. A tied hash has an
    <i>inner</i> hash that actually holds the contents. The
    <b>swap_inner_handle()</b> method swaps the inner hashes between two
    handles. The <span class="Li">$h1</span> and <span class="Li">$h2</span>
    handles still point to the same tied hashes, but what those hashes are tied
    to has been swapped. In effect <span class="Li">$h1</span> <i>becomes</i>
    <span class="Li">$h2</span> and vice-versa. This is powerful stuff, expect
    problems. Use with care.</p>
<p class="Pp">As a small safety measure, the two handles,
    <span class="Li">$h1</span> and <span class="Li">$h2</span>, have to share
    the same parent unless <span class="Li">$allow_reparent</span> is true.</p>
<p class="Pp">The <b>swap_inner_handle()</b> method was added in DBI 1.44.</p>
<p class="Pp">Here's a quick kind of 'diagram' as a worked example to help think
    about what's happening:</p>
<p class="Pp"></p>
<pre>    Original state:
            dbh1o -&gt; dbh1i
            sthAo -&gt; sthAi(dbh1i)
            dbh2o -&gt; dbh2i
    swap_inner_handle dbh1o with dbh2o:
            dbh2o -&gt; dbh1i
            sthAo -&gt; sthAi(dbh1i)
            dbh1o -&gt; dbh2i
    create new sth from dbh1o:
            dbh2o -&gt; dbh1i
            sthAo -&gt; sthAi(dbh1i)
            dbh1o -&gt; dbh2i
            sthBo -&gt; sthBi(dbh2i)
    swap_inner_handle sthAo with sthBo:
            dbh2o -&gt; dbh1i
            sthBo -&gt; sthAi(dbh1i)
            dbh1o -&gt; dbh2i
            sthAo -&gt; sthBi(dbh2i)
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;visit_child_handles&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $h-&gt;visit_child_handles( $coderef );
  $h-&gt;visit_child_handles( $coderef, $info );
</pre>
<p class="Pp">Where <span class="Li">$coderef</span> is a reference to a
    subroutine and <span class="Li">$info</span> is an arbitrary value which, if
    undefined, defaults to a reference to an empty hash. Returns
    <span class="Li">$info</span>.</p>
<p class="Pp">For each child handle of <span class="Li">$h</span>, if any,
    <span class="Li">$coderef</span> is invoked as:</p>
<p class="Pp"></p>
<pre>  $coderef-&gt;($child_handle, $info);
</pre>
<p class="Pp">If the execution of <span class="Li">$coderef</span> returns a
    true value then <span class="Li">&quot;visit_child_handles&quot;</span> is
    called on that child handle and passed the returned value as
    <span class="Li">$info</span>.</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  # count database connections with names (DSN) matching a pattern
  my $connections = 0;
  $dbh-&gt;{Driver}-&gt;visit_child_handles(sub {
      my ($h, $info) = @_;
      ++$connections if $h-&gt;{Name} =~ /foo/;
      return 0; # don't visit kids
  })
</pre>
<p class="Pp">See also &quot;visit_handles&quot;.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ATTRIBUTES_COMMON_TO_ALL_HANDLES"><a class="permalink" href="#ATTRIBUTES_COMMON_TO_ALL_HANDLES">ATTRIBUTES
  COMMON TO ALL HANDLES</a></h1>
<p class="Pp">These attributes are common to all types of DBI handles.</p>
<p class="Pp">Some attributes are inherited by child handles. That is, the value
    of an inherited attribute in a newly created statement handle is the same as
    the value in the parent database handle. Changes to attributes in the new
    statement handle do not affect the parent database handle and changes to the
    database handle do not affect existing statement handles, only future
  ones.</p>
<p class="Pp">Attempting to set or get the value of an unknown attribute
    generates a warning, except for private driver specific attributes (which
    all have names starting with a lowercase letter).</p>
<p class="Pp">Example:</p>
<p class="Pp"></p>
<pre>  $h-&gt;{AttributeName} = ...;    # set/write
  ... = $h-&gt;{AttributeName};    # get/read
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;Warn&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;Warn&quot;</span> attribute enables
    useful warnings for certain bad practices. It is enabled by default and
    should only be disabled in rare circumstances. Since warnings are generated
    using the Perl <span class="Li">&quot;warn&quot;</span> function, they can
    be intercepted using the Perl <span class="Li">$SIG{__WARN__}</span>
  hook.</p>
<p class="Pp">The <span class="Li">&quot;Warn&quot;</span> attribute is not
    related to the <span class="Li">&quot;PrintWarn&quot;</span> attribute.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Active&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, read-only</p>
<p class="Pp">The <span class="Li">&quot;Active&quot;</span> attribute is true
    if the handle object is &quot;active&quot;. This is rarely used in
    applications. The exact meaning of active is somewhat vague at the moment.
    For a database handle it typically means that the handle is connected to a
    database (<span class="Li">&quot;$dbh-&gt;disconnect&quot;</span> sets
    <span class="Li">&quot;Active&quot;</span> off). For a statement handle it
    typically means that the handle is a
    <span class="Li">&quot;SELECT&quot;</span> that may have more data to fetch.
    (Fetching all the data or calling
    <span class="Li">&quot;$sth-&gt;finish&quot;</span> sets
    <span class="Li">&quot;Active&quot;</span> off.)</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Executed&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean</p>
<p class="Pp">The <span class="Li">&quot;Executed&quot;</span> attribute is true
    if the handle object has been &quot;executed&quot;. Currently only the
    <span class="Li">$dbh</span> <b>do()</b> method and the
    <span class="Li">$sth</span> <b>execute()</b>, <b>execute_array()</b>, and
    <b>execute_for_fetch()</b> methods set the
    <span class="Li">&quot;Executed&quot;</span> attribute.</p>
<p class="Pp">When it's set on a handle it is also set on the parent handle at
    the same time. So calling <b>execute()</b> on a <span class="Li">$sth</span>
    also sets the <span class="Li">&quot;Executed&quot;</span> attribute on the
    parent <span class="Li">$dbh</span>.</p>
<p class="Pp">The <span class="Li">&quot;Executed&quot;</span> attribute for a
    database handle is cleared by the <b>commit()</b> and <b>rollback()</b>
    methods (even if they fail). The
    <span class="Li">&quot;Executed&quot;</span> attribute of a statement handle
    is not cleared by the DBI under any circumstances and so acts as a permanent
    record of whether the statement handle was ever used.</p>
<p class="Pp">The <span class="Li">&quot;Executed&quot;</span> attribute was
    added in DBI 1.41.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Kids&quot;</i></span><i></i></p>
<p class="Pp">Type: integer, read-only</p>
<p class="Pp">For a driver handle, <span class="Li">&quot;Kids&quot;</span> is
    the number of currently existing database handles that were created from
    that driver handle. For a database handle,
    <span class="Li">&quot;Kids&quot;</span> is the number of currently existing
    statement handles that were created from that database handle. For a
    statement handle, the value is zero.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ActiveKids&quot;</i></span><i></i></p>
<p class="Pp">Type: integer, read-only</p>
<p class="Pp">Like <span class="Li">&quot;Kids&quot;</span>, but only counting
    those that are <span class="Li">&quot;Active&quot;</span> (as above).</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;CachedKids&quot;</i></span><i></i></p>
<p class="Pp">Type: hash ref</p>
<p class="Pp">For a database handle,
    <span class="Li">&quot;CachedKids&quot;</span> returns a reference to the
    cache (hash) of statement handles created by the &quot;prepare_cached&quot;
    method. For a driver handle, returns a reference to the cache (hash) of
    database handles created by the &quot;connect_cached&quot; method.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Type&quot;</i></span><i></i></p>
<p class="Pp">Type: scalar, read-only</p>
<p class="Pp">The <span class="Li">&quot;Type&quot;</span> attribute identifies
    the type of a DBI handle. Returns &quot;dr&quot; for driver handles,
    &quot;db&quot; for database handles and &quot;st&quot; for statement
    handles.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ChildHandles&quot;</i></span><i></i></p>
<p class="Pp">Type: array ref</p>
<p class="Pp">The ChildHandles attribute contains a reference to an array of all
    the handles created by this handle which are still accessible. The contents
    of the array are weak-refs and will become undef when the handle goes out of
    scope. (They're cleared out occasionally.)</p>
<p class="Pp"><span class="Li">&quot;ChildHandles&quot;</span> returns undef if
    your perl version does not support weak references (check the Scalar::Util
    module). The referenced array returned should be treated as read-only.</p>
<p class="Pp">For example, to enumerate all driver handles, database handles and
    statement handles:</p>
<p class="Pp"></p>
<pre>    sub show_child_handles {
        my ($h, $level) = @_;
        printf &quot;%sh %s %s\n&quot;, $h-&gt;{Type}, &quot;\t&quot; x $level, $h;
        show_child_handles($_, $level + 1)
            for (grep { defined } @{$h-&gt;{ChildHandles}});
    }
    my %drivers = DBI-&gt;installed_drivers();
    show_child_handles($_, 0) for (values %drivers);
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;CompatMode&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;CompatMode&quot;</span> attribute is
    used by emulation layers (such as Oraperl) to enable compatible behaviour in
    the underlying driver (e.g., DBD::Oracle) for this handle. Not normally set
    by application code.</p>
<p class="Pp">It also has the effect of disabling the 'quick FETCH' of attribute
    values from the handles attribute cache. So all attribute values are handled
    by the drivers own FETCH method. This makes them slightly slower but is
    useful for special-purpose drivers like DBD::Multiplex.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;InactiveDestroy&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean</p>
<p class="Pp">The default value, false, means a handle will be fully destroyed
    as normal when the last reference to it is removed, just as you'd
  expect.</p>
<p class="Pp">If set true then the handle will be treated by the DESTROY as if
    it was no longer Active, and so the <i>database engine</i> related effects
    of DESTROYing a handle will be skipped. Think of the name as meaning 'treat
    the handle as not-Active in the DESTROY method'.</p>
<p class="Pp">For a database handle, this attribute does not disable an
    <i>explicit</i> call to the disconnect method, only the implicit call from
    DESTROY that happens if the handle is still marked as
    <span class="Li">&quot;Active&quot;</span>.</p>
<p class="Pp">This attribute is specifically designed for use in Unix
    applications that &quot;fork&quot; child processes. For some drivers, when
    the child process exits the destruction of inherited handles cause the
    corresponding handles in the parent process to cease working.</p>
<p class="Pp">Either the parent or the child process, but not both, should set
    <span class="Li">&quot;InactiveDestroy&quot;</span> true on all their shared
    handles. Alternatively, and preferably, the &quot;AutoInactiveDestroy&quot;
    can be set in the parent on connect.</p>
<p class="Pp">To help tracing applications using fork the process id is shown in
    the trace log whenever a DBI or handle <b>trace()</b> method is called. The
    process id also shown for <i>every</i> method call if the DBI trace level
    (not handle trace level) is set high enough to show the trace from the DBI's
    method dispatcher, e.g. &gt;= 9.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;AutoInactiveDestroy&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The &quot;InactiveDestroy&quot; attribute, described above, needs
    to be explicitly set in the child process after a <b>fork()</b>, on every
    active database and statement handle. This is a problem if the code that
    performs the <b>fork()</b> is not under your control, perhaps in a
    third-party module. Use
    <span class="Li">&quot;AutoInactiveDestroy&quot;</span> to get around this
    situation.</p>
<p class="Pp">If set true, the DESTROY method will check the process id of the
    handle and, if different from the current process id, it will set the
    <i>InactiveDestroy</i> attribute. It is strongly recommended that
    <span class="Li">&quot;AutoInactiveDestroy&quot;</span> is enabled on all
    new code (it's only not enabled by default to avoid backwards compatibility
    problems).</p>
<p class="Pp">This is the example it's designed to deal with:</p>
<p class="Pp"></p>
<pre>    my $dbh = DBI-&gt;connect(...);
    some_code_that_forks(); # Perhaps without your knowledge
    # Child process dies, destroying the inherited dbh
    $dbh-&gt;do(...); # Breaks because parent $dbh is now broken
</pre>
<p class="Pp">The <span class="Li">&quot;AutoInactiveDestroy&quot;</span>
    attribute was added in DBI 1.614.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;PrintWarn&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;PrintWarn&quot;</span> attribute
    controls the printing of warnings recorded by the driver. When set to a true
    value (the default) the DBI will check method calls to see if a warning
    condition has been set. If so, the DBI will effectively do a
    <span class="Li">&quot;warn(&quot;$class $method warning:
    $DBI::errstr&quot;)&quot;</span> where <span class="Li">$class</span> is the
    driver class and <span class="Li">$method</span> is the name of the method
    which failed. E.g.,</p>
<p class="Pp"></p>
<pre>  DBD::Oracle::db execute warning: ... warning text here ...
</pre>
<p class="Pp">If desired, the warnings can be caught and processed using a
    <span class="Li">$SIG{__WARN__}</span> handler or modules like CGI::Carp and
    CGI::ErrorWrap.</p>
<p class="Pp">See also &quot;set_err&quot; for how warnings are recorded and
    &quot;HandleSetErr&quot; for how to influence it.</p>
<p class="Pp">Fetching the full details of warnings can require an extra
    round-trip to the database server for some drivers. In which case the driver
    may opt to only fetch the full details of warnings if the
    <span class="Li">&quot;PrintWarn&quot;</span> attribute is true. If
    <span class="Li">&quot;PrintWarn&quot;</span> is false then these drivers
    should still indicate the fact that there were warnings by setting the
    warning string to, for example: &quot;3 warnings&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;PrintError&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;PrintError&quot;</span> attribute can
    be used to force errors to generate warnings (using
    <span class="Li">&quot;warn&quot;</span>) in addition to returning error
    codes in the normal way. When set &quot;on&quot;, any method which results
    in an error occurring will cause the DBI to effectively do a
    <span class="Li">&quot;warn(&quot;$class $method failed:
    $DBI::errstr&quot;)&quot;</span> where <span class="Li">$class</span> is the
    driver class and <span class="Li">$method</span> is the name of the method
    which failed. E.g.,</p>
<p class="Pp"></p>
<pre>  DBD::Oracle::db prepare failed: ... error text here ...
</pre>
<p class="Pp">By default, <span class="Li">&quot;DBI-&gt;connect&quot;</span>
    sets <span class="Li">&quot;PrintError&quot;</span> &quot;on&quot;.</p>
<p class="Pp">If desired, the warnings can be caught and processed using a
    <span class="Li">$SIG{__WARN__}</span> handler or modules like CGI::Carp and
    CGI::ErrorWrap.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;RaiseWarn&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;RaiseWarn&quot;</span> attribute can be
    used to force warnings to raise exceptions rather then simply printing them.
    It is &quot;off&quot; by default. When set &quot;on&quot;, any method which
    sets warning condition will cause the DBI to effectively do a
    <span class="Li">&quot;die(&quot;$class $method warning:
    $DBI::errstr&quot;)&quot;</span>, where <span class="Li">$class</span> is
    the driver class and <span class="Li">$method</span> is the name of the
    method that sets warning condition. E.g.,</p>
<p class="Pp"></p>
<pre>  DBD::Oracle::db execute warning: ... warning text here ...
</pre>
<p class="Pp">If you turn <span class="Li">&quot;RaiseWarn&quot;</span> on then
    you'd normally turn <span class="Li">&quot;PrintWarn&quot;</span> off. If
    <span class="Li">&quot;PrintWarn&quot;</span> is also on, then the
    <span class="Li">&quot;PrintWarn&quot;</span> is done first (naturally).</p>
<p class="Pp">This attribute was added in DBI 1.643.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;RaiseError&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;RaiseError&quot;</span> attribute can
    be used to force errors to raise exceptions rather than simply return error
    codes in the normal way. It is &quot;off&quot; by default. When set
    &quot;on&quot;, any method which results in an error will cause the DBI to
    effectively do a <span class="Li">&quot;die(&quot;$class $method failed:
    $DBI::errstr&quot;)&quot;</span>, where <span class="Li">$class</span> is
    the driver class and <span class="Li">$method</span> is the name of the
    method that failed. E.g.,</p>
<p class="Pp"></p>
<pre>  DBD::Oracle::db prepare failed: ... error text here ...
</pre>
<p class="Pp">If you turn <span class="Li">&quot;RaiseError&quot;</span> on then
    you'd normally turn <span class="Li">&quot;PrintError&quot;</span> off. If
    <span class="Li">&quot;PrintError&quot;</span> is also on, then the
    <span class="Li">&quot;PrintError&quot;</span> is done first
  (naturally).</p>
<p class="Pp">Typically <span class="Li">&quot;RaiseError&quot;</span> is used
    in conjunction with <span class="Li">&quot;eval&quot;</span>, or a module
    like Try::Tiny or TryCatch, to catch the exception that's been thrown and
    handle it. For example:</p>
<p class="Pp"></p>
<pre>  use Try::Tiny;
  try {
    ...
    $sth-&gt;execute();
    ...
  } catch {
    # $sth-&gt;err and $DBI::err will be true if error was from DBI
    warn $_; # print the error (which Try::Tiny puts into $_)
    ... # do whatever you need to deal with the error
  };
</pre>
<p class="Pp">In the catch block the <span class="Li">$DBI::lasth</span>
    variable can be useful for diagnosis and reporting if you can't be sure
    which handle triggered the error. For example,
    <span class="Li">$DBI::lasth</span>-&gt;{Type} and
    <span class="Li">$DBI::lasth</span>-&gt;{Statement}.</p>
<p class="Pp">See also &quot;Transactions&quot;.</p>
<p class="Pp">If you want to temporarily turn
    <span class="Li">&quot;RaiseError&quot;</span> off (inside a library
    function that is likely to fail, for example), the recommended way is like
    this:</p>
<p class="Pp"></p>
<pre>  {
    local $h-&gt;{RaiseError};  # localize and turn off for this block
    ...
  }
</pre>
<p class="Pp">The original value will automatically and reliably be restored by
    Perl, regardless of how the block is exited. The same logic applies to other
    attributes, including <span class="Li">&quot;PrintError&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;HandleError&quot;</i></span><i></i></p>
<p class="Pp">Type: code ref, inherited</p>
<p class="Pp">The <span class="Li">&quot;HandleError&quot;</span> attribute can
    be used to provide your own alternative behaviour in case of errors. If set
    to a reference to a subroutine then that subroutine is called when an error
    is detected (at the same point that
    <span class="Li">&quot;RaiseError&quot;</span> and
    <span class="Li">&quot;PrintError&quot;</span> are handled). It is called
    also when <span class="Li">&quot;RaiseWarn&quot;</span> is enabled and a
    warning is detected.</p>
<p class="Pp">The subroutine is called with three parameters: the error message
    string that <span class="Li">&quot;RaiseError&quot;</span>,
    <span class="Li">&quot;RaiseWarn&quot;</span> or
    <span class="Li">&quot;PrintError&quot;</span> would use, the DBI handle
    being used, and the first value being returned by the method that failed
    (typically undef).</p>
<p class="Pp">If the subroutine returns a false value then the
    <span class="Li">&quot;RaiseError&quot;</span>,
    <span class="Li">&quot;RaiseWarn&quot;</span> and/or
    <span class="Li">&quot;PrintError&quot;</span> attributes are checked and
    acted upon as normal.</p>
<p class="Pp">For example, to <span class="Li">&quot;die&quot;</span> with a
    full stack trace for any error:</p>
<p class="Pp"></p>
<pre>  use Carp;
  $h-&gt;{HandleError} = sub { confess(shift) };
</pre>
<p class="Pp">Or to turn errors into exceptions:</p>
<p class="Pp"></p>
<pre>  use Exception; # or your own favourite exception module
  $h-&gt;{HandleError} = sub { Exception-&gt;new('DBI')-&gt;raise($_[0]) };
</pre>
<p class="Pp">It is possible to 'stack' multiple HandleError handlers by using
    closures:</p>
<p class="Pp"></p>
<pre>  sub your_subroutine {
    my $previous_handler = $h-&gt;{HandleError};
    $h-&gt;{HandleError} = sub {
      return 1 if $previous_handler and &amp;$previous_handler(@_);
      ... your code here ...
    };
  }
</pre>
<p class="Pp">Using a <span class="Li">&quot;my&quot;</span> inside a subroutine
    to store the previous <span class="Li">&quot;HandleError&quot;</span> value
    is important. See perlsub and perlref for more information about
    <i>closures</i>.</p>
<p class="Pp">It is possible for <span class="Li">&quot;HandleError&quot;</span>
    to alter the error message that will be used by
    <span class="Li">&quot;RaiseError&quot;</span>,
    <span class="Li">&quot;RaiseWarn&quot;</span> and
    <span class="Li">&quot;PrintError&quot;</span> if it returns false. It can
    do that by altering the value of <span class="Li">$_</span>[0]. This example
    appends a stack trace to all errors and, unlike the previous example using
    Carp::confess, this will work <span class="Li">&quot;PrintError&quot;</span>
    as well as <span class="Li">&quot;RaiseError&quot;</span>:</p>
<p class="Pp"></p>
<pre>  $h-&gt;{HandleError} = sub { $_[0]=Carp::longmess($_[0]); 0; };
</pre>
<p class="Pp">It is also possible for
    <span class="Li">&quot;HandleError&quot;</span> to hide an error, to a
    limited degree, by using &quot;set_err&quot; to reset
    <span class="Li">$DBI::err</span> and <span class="Li">$DBI::errstr</span>,
    and altering the return value of the failed method. For example:</p>
<p class="Pp"></p>
<pre>  $h-&gt;{HandleError} = sub {
    return 0 unless $_[0] =~ /^\S+ fetchrow_arrayref failed:/;
    return 0 unless $_[1]-&gt;err == 1234; # the error to 'hide'
    $h-&gt;set_err(undef,undef);   # turn off the error
    $_[2] = [ ... ];    # supply alternative return value
    return 1;
  };
</pre>
<p class="Pp">This only works for methods which return a single value and is
    hard to make reliable (avoiding infinite loops, for example) and so isn't
    recommended for general use! If you find a <i>good</i> use for it then
    please let me know.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;HandleSetErr&quot;</i></span><i></i></p>
<p class="Pp">Type: code ref, inherited</p>
<p class="Pp">The <span class="Li">&quot;HandleSetErr&quot;</span> attribute can
    be used to intercept the setting of handle
    <span class="Li">&quot;err&quot;</span>,
    <span class="Li">&quot;errstr&quot;</span>, and
    <span class="Li">&quot;state&quot;</span> values. If set to a reference to a
    subroutine then that subroutine is called whenever <b>set_err()</b> is
    called, typically by the driver or a subclass.</p>
<p class="Pp">The subroutine is called with five arguments, the first five that
    were passed to <b>set_err()</b>: the handle, the
    <span class="Li">&quot;err&quot;</span>,
    <span class="Li">&quot;errstr&quot;</span>, and
    <span class="Li">&quot;state&quot;</span> values being set, and the method
    name. These can be altered by changing the values in the
    <span class="Li">@_</span> array. The return value affects <b>set_err()</b>
    behaviour, see &quot;set_err&quot; for details.</p>
<p class="Pp">It is possible to 'stack' multiple HandleSetErr handlers by using
    closures. See &quot;HandleError&quot; for an example.</p>
<p class="Pp">The <span class="Li">&quot;HandleSetErr&quot;</span> and
    <span class="Li">&quot;HandleError&quot;</span> subroutines differ in subtle
    but significant ways. HandleError is only invoked at the point where the DBI
    is about to return to the application with
    <span class="Li">&quot;err&quot;</span> set true. It's not invoked by the
    failure of a method that's been called by another DBI method. HandleSetErr,
    on the other hand, is called whenever <b>set_err()</b> is called with a
    defined <span class="Li">&quot;err&quot;</span> value, even if false. So
    it's not just for errors, despite the name, but also warn and info states.
    The <b>set_err()</b> method, and thus HandleSetErr, may be called multiple
    times within a method and is usually invoked from deep within driver
  code.</p>
<p class="Pp">In theory a driver can use the return value from HandleSetErr via
    <b>set_err()</b> to decide whether to continue or not. If <b>set_err()</b>
    returns an empty list, indicating that the HandleSetErr code has 'handled'
    the 'error', the driver could then continue instead of failing (if that's a
    reasonable thing to do). This isn't excepted to be common and any such cases
    should be clearly marked in the driver documentation and discussed on the
    dbi-dev mailing list.</p>
<p class="Pp">The <span class="Li">&quot;HandleSetErr&quot;</span> attribute was
    added in DBI 1.41.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ErrCount&quot;</i></span><i></i></p>
<p class="Pp">Type: unsigned integer</p>
<p class="Pp">The <span class="Li">&quot;ErrCount&quot;</span> attribute is
    incremented whenever the <b>set_err()</b> method records an error. It isn't
    incremented by warnings or information states. It is not reset by the DBI at
    any time.</p>
<p class="Pp">The <span class="Li">&quot;ErrCount&quot;</span> attribute was
    added in DBI 1.41. Older drivers may not have been updated to use
    <b>set_err()</b> to record errors and so this attribute may not be
    incremented when using them.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ShowErrorStatement&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;ShowErrorStatement&quot;</span>
    attribute can be used to cause the relevant Statement text to be appended to
    the error messages generated by the
    <span class="Li">&quot;RaiseError&quot;</span>,
    <span class="Li">&quot;PrintError&quot;</span>,
    <span class="Li">&quot;RaiseWarn&quot;</span> and
    <span class="Li">&quot;PrintWarn&quot;</span> attributes. Only applies to
    errors on statement handles plus the <b>prepare()</b>, <b>do()</b>, and the
    various <span class="Li">&quot;select*()&quot;</span> database handle
    methods. (The exact format of the appended text is subject to change.)</p>
<p class="Pp">If <span class="Li">&quot;$h-&gt;{ParamValues}&quot;</span>
    returns a hash reference of parameter (placeholder) values then those are
    formatted and appended to the end of the Statement text in the error
    message.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;TraceLevel&quot;</i></span><i></i></p>
<p class="Pp">Type: integer, inherited</p>
<p class="Pp">The <span class="Li">&quot;TraceLevel&quot;</span> attribute can
    be used as an alternative to the &quot;trace&quot; method to set the DBI
    trace level and trace flags for a specific handle. See &quot;TRACING&quot;
    for more details.</p>
<p class="Pp">The <span class="Li">&quot;TraceLevel&quot;</span> attribute is
    especially useful combined with <span class="Li">&quot;local&quot;</span> to
    alter the trace settings for just a single block of code.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;FetchHashKeyName&quot;</i></span><i></i></p>
<p class="Pp">Type: string, inherited</p>
<p class="Pp">The <span class="Li">&quot;FetchHashKeyName&quot;</span> attribute
    is used to specify whether the <b>fetchrow_hashref()</b> method should
    perform case conversion on the field names used for the hash keys. For
    historical reasons it defaults to '<span class="Li">&quot;NAME&quot;</span>'
    but it is recommended to set it to
    '<span class="Li">&quot;NAME_lc&quot;</span>' (convert to lower case) or
    '<span class="Li">&quot;NAME_uc&quot;</span>' (convert to upper case)
    according to your preference. It can only be set for driver and database
    handles. For statement handles the value is frozen when <b>prepare()</b> is
    called.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ChopBlanks&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;ChopBlanks&quot;</span> attribute can
    be used to control the trimming of trailing space characters from fixed
    width character (CHAR) fields. No other field types are affected, even where
    field values have trailing spaces.</p>
<p class="Pp">The default is false (although it is possible that the default may
    change). Applications that need specific behaviour should set the attribute
    as needed.</p>
<p class="Pp">Drivers are not required to support this attribute, but any driver
    which does not support it must arrange to return
    <span class="Li">&quot;undef&quot;</span> as the attribute value.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;LongReadLen&quot;</i></span><i></i></p>
<p class="Pp">Type: unsigned integer, inherited</p>
<p class="Pp">The <span class="Li">&quot;LongReadLen&quot;</span> attribute may
    be used to control the maximum length of 'long' type fields (LONG, BLOB,
    CLOB, MEMO, etc.) which the driver will read from the database automatically
    when it fetches each row of data.</p>
<p class="Pp">The <span class="Li">&quot;LongReadLen&quot;</span> attribute only
    relates to fetching and reading long values; it is not involved in inserting
    or updating them.</p>
<p class="Pp">A value of 0 means not to automatically fetch any long data.
    Drivers may return undef or an empty string for long fields when
    <span class="Li">&quot;LongReadLen&quot;</span> is 0.</p>
<p class="Pp">The default is typically 0 (zero) or 80 bytes but may vary between
    drivers. Applications fetching long fields should set this value to slightly
    larger than the longest long field value to be fetched.</p>
<p class="Pp">Some databases return some long types encoded as pairs of hex
    digits. For these types, <span class="Li">&quot;LongReadLen&quot;</span>
    relates to the underlying data length and not the doubled-up length of the
    encoded string.</p>
<p class="Pp">Changing the value of
    <span class="Li">&quot;LongReadLen&quot;</span> for a statement handle after
    it has been <span class="Li">&quot;prepare&quot;</span>'d will typically
    have no effect, so it's common to set
    <span class="Li">&quot;LongReadLen&quot;</span> on the
    <span class="Li">$dbh</span> before calling
    <span class="Li">&quot;prepare&quot;</span>.</p>
<p class="Pp">For most drivers the value used here has a direct effect on the
    memory used by the statement handle while it's active, so don't be too
    generous. If you can't be sure what value to use you could execute an extra
    select statement to determine the longest value. For example:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{LongReadLen} = $dbh-&gt;selectrow_array(qq{
      SELECT MAX(OCTET_LENGTH(long_column_name))
      FROM table WHERE ...
  });
  $sth = $dbh-&gt;prepare(qq{
      SELECT long_column_name, ... FROM table WHERE ...
  });
</pre>
<p class="Pp">You may need to take extra care if the table can be modified
    between the first select and the second being executed. You may also need to
    use a different function if <b>OCTET_LENGTH()</b> does not work for long
    types in your database. For example, for Sybase use <b>DATALENGTH()</b> and
    for Oracle use <b>LENGTHB()</b>.</p>
<p class="Pp">See also &quot;LongTruncOk&quot; for information on truncation of
    long types.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;LongTruncOk&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;LongTruncOk&quot;</span> attribute may
    be used to control the effect of fetching a long field value which has been
    truncated (typically because it's longer than the value of the
    <span class="Li">&quot;LongReadLen&quot;</span> attribute).</p>
<p class="Pp">By default, <span class="Li">&quot;LongTruncOk&quot;</span> is
    false and so fetching a long value that needs to be truncated will cause the
    fetch to fail. (Applications should always be sure to check for errors after
    a fetch loop in case an error, such as a divide by zero or long field
    truncation, caused the fetch to terminate prematurely.)</p>
<p class="Pp">If a fetch fails due to a long field truncation when
    <span class="Li">&quot;LongTruncOk&quot;</span> is false, many drivers will
    allow you to continue fetching further rows.</p>
<p class="Pp">See also &quot;LongReadLen&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;TaintIn&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">If the <span class="Li">&quot;TaintIn&quot;</span> attribute is
    set to a true value <i>and</i> Perl is running in taint mode (e.g., started
    with the <span class="Li">&quot;-T&quot;</span> option), then all the
    arguments to most DBI method calls are checked for being tainted. <i>This
    may change.</i></p>
<p class="Pp">The attribute defaults to off, even if Perl is in taint mode. See
    perlsec for more about taint mode. If Perl is not running in taint mode,
    this attribute has no effect.</p>
<p class="Pp">When fetching data that you trust you can turn off the TaintIn
    attribute, for that statement handle, for the duration of the fetch
  loop.</p>
<p class="Pp">The <span class="Li">&quot;TaintIn&quot;</span> attribute was
    added in DBI 1.31.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;TaintOut&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">If the <span class="Li">&quot;TaintOut&quot;</span> attribute is
    set to a true value <i>and</i> Perl is running in taint mode (e.g., started
    with the <span class="Li">&quot;-T&quot;</span> option), then most data
    fetched from the database is considered tainted. <i>This may change.</i></p>
<p class="Pp">The attribute defaults to off, even if Perl is in taint mode. See
    perlsec for more about taint mode. If Perl is not running in taint mode,
    this attribute has no effect.</p>
<p class="Pp">When fetching data that you trust you can turn off the TaintOut
    attribute, for that statement handle, for the duration of the fetch
  loop.</p>
<p class="Pp">Currently only fetched data is tainted. It is possible that the
    results of other DBI method calls, and the value of fetched attributes, may
    also be tainted in future versions. That change may well break your
    applications unless you take great care now. If you use DBI Taint mode,
    please report your experience and any suggestions for changes.</p>
<p class="Pp">The <span class="Li">&quot;TaintOut&quot;</span> attribute was
    added in DBI 1.31.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Taint&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">The <span class="Li">&quot;Taint&quot;</span> attribute is a
    shortcut for &quot;TaintIn&quot; and &quot;TaintOut&quot; (it is also
    present for backwards compatibility).</p>
<p class="Pp">Setting this attribute sets both &quot;TaintIn&quot; and
    &quot;TaintOut&quot;, and retrieving it returns a true value if and only if
    &quot;TaintIn&quot; and &quot;TaintOut&quot; are both set to true
  values.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Profile&quot;</i></span><i></i></p>
<p class="Pp">Type: inherited</p>
<p class="Pp">The <span class="Li">&quot;Profile&quot;</span> attribute enables
    the collection and reporting of method call timing statistics. See the
    DBI::Profile module documentation for <i>much</i> more detail.</p>
<p class="Pp">The <span class="Li">&quot;Profile&quot;</span> attribute was
    added in DBI 1.24.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ReadOnly&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean, inherited</p>
<p class="Pp">An application can set the
    <span class="Li">&quot;ReadOnly&quot;</span> attribute of a handle to a true
    value to indicate that it will not be attempting to make any changes using
    that handle or any children of it.</p>
<p class="Pp">Note that the exact definition of 'read only' is rather fuzzy. For
    more details see the documentation for the driver you're using.</p>
<p class="Pp">If the driver can make the handle truly read-only then it should
    (unless doing so would have unpleasant side effect, like changing the
    consistency level from per-statement to per-session). Otherwise the
    attribute is simply advisory.</p>
<p class="Pp">A driver can set the <span class="Li">&quot;ReadOnly&quot;</span>
    attribute itself to indicate that the data it is connected to cannot be
    changed for some reason.</p>
<p class="Pp">If the driver cannot ensure the
    <span class="Li">&quot;ReadOnly&quot;</span> attribute is adhered to it will
    record a warning. In this case reading the
    <span class="Li">&quot;ReadOnly&quot;</span> attribute back after it is set
    true will return true even if the underlying driver cannot ensure this (so
    any application knows the application declared itself ReadOnly).</p>
<p class="Pp">Library modules and proxy drivers can use the attribute to
    influence their behavior. For example, the DBD::Gofer driver considers the
    <span class="Li">&quot;ReadOnly&quot;</span> attribute when making a
    decision about whether to retry an operation that failed.</p>
<p class="Pp">The attribute should be set to 1 or 0 (or undef). Other values are
    reserved.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Callbacks&quot;</i></span><i></i></p>
<p class="Pp">Type: hash ref</p>
<p class="Pp">The DBI callback mechanism lets you intercept, and optionally
    replace, any method call on a DBI handle. At the extreme, it lets you become
    a puppet master, deceiving the application in any way you want.</p>
<p class="Pp">The <span class="Li">&quot;Callbacks&quot;</span> attribute is a
    hash reference where the keys are DBI method names and the values are code
    references. For each key naming a method, the DBI will execute the
    associated code reference before executing the method.</p>
<p class="Pp">The arguments to the code reference will be the same as to the
    method, including the invocant (a database handle or statement handle). For
    example, say that to callback to some code on a call to
    <span class="Li">&quot;prepare()&quot;</span>:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{Callbacks} = {
      prepare =&gt; sub {
          my ($dbh, $query, $attrs) = @_;
          print &quot;Preparing q{$query}\n&quot;
      },
  };
</pre>
<p class="Pp">The callback would then be executed when you called the
    <span class="Li">&quot;prepare()&quot;</span> method:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;prepare('SELECT 1');
</pre>
<p class="Pp">And the output of course would be:</p>
<p class="Pp"></p>
<pre>  Preparing q{SELECT 1}
</pre>
<p class="Pp">Because callbacks are executed <i>before</i> the methods they're
    associated with, you can modify the arguments before they're passed on to
    the method call. For example, to make sure that all calls to
    <span class="Li">&quot;prepare()&quot;</span> are immediately prepared by
    DBD::Pg, add a callback that makes sure that the
    <span class="Li">&quot;pg_prepare_now&quot;</span> attribute is always
  set:</p>
<p class="Pp"></p>
<pre>  my $dbh = DBI-&gt;connect($dsn, $username, $auth, {
      Callbacks =&gt; {
          prepare =&gt; sub {
              $_[2] ||= {};
              $_[2]-&gt;{pg_prepare_now} = 1;
              return; # must return nothing
          },
      }
  });
</pre>
<p class="Pp">Note that we are editing the contents of
    <span class="Li">@_</span> directly. In this case we've created the
    attributes hash if it's not passed to the
    <span class="Li">&quot;prepare&quot;</span> call.</p>
<p class="Pp">You can also prevent the associated method from ever executing.
    While a callback executes, <span class="Li">$_</span> holds the method name.
    (This allows multiple callbacks to share the same code reference and still
    know what method was called.) To prevent the method from executing, simply
    <span class="Li">&quot;undef $_&quot;</span>. For example, if you wanted to
    disable calls to <span class="Li">&quot;ping()&quot;</span>, you could do
    this:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{Callbacks} = {
      ping =&gt; sub {
          # tell dispatch to not call the method:
          undef $_;
          # return this value instead:
          return &quot;42 bells&quot;;
      }
  };
</pre>
<p class="Pp">As with other attributes, Callbacks can be specified on a handle
    or via the attributes to <span class="Li">&quot;connect()&quot;</span>.
    Callbacks can also be applied to a statement methods on a statement handle.
    For example:</p>
<p class="Pp"></p>
<pre>  $sth-&gt;{Callbacks} = {
      execute =&gt; sub {
          print &quot;Executing &quot;, shift-&gt;{Statement}, &quot;\n&quot;;
      }
  };
</pre>
<p class="Pp">The <span class="Li">&quot;Callbacks&quot;</span> attribute of a
    database handle isn't copied to any statement handles it creates. So setting
    callbacks for a statement handle requires you to set the
    <span class="Li">&quot;Callbacks&quot;</span> attribute on the statement
    handle yourself, as in the example above, or use the special
    <span class="Li">&quot;ChildCallbacks&quot;</span> key described below.</p>
<p class="Pp"><b>Special Keys in Callbacks Attribute</b></p>
<p class="Pp">In addition to DBI handle method names, the
    <span class="Li">&quot;Callbacks&quot;</span> hash reference supports four
    additional keys.</p>
<p class="Pp">The first is the
    <span class="Li">&quot;ChildCallbacks&quot;</span> key. When a statement
    handle is created from a database handle the
    <span class="Li">&quot;ChildCallbacks&quot;</span> key of the database
    handle's <span class="Li">&quot;Callbacks&quot;</span> attribute, if any,
    becomes the new <span class="Li">&quot;Callbacks&quot;</span> attribute of
    the statement handle. This allows you to define callbacks for all statement
    handles created from a database handle. For example, if you wanted to count
    how many times <span class="Li">&quot;execute&quot;</span> was called in
    your application, you could write:</p>
<p class="Pp"></p>
<pre>  my $exec_count = 0;
  my $dbh = DBI-&gt;connect( $dsn, $username, $auth, {
      Callbacks =&gt; {
          ChildCallbacks =&gt; {
              execute =&gt; sub { $exec_count++; return; }
          }
      }
  });
  END {
      print &quot;The execute method was called $exec_count times\n&quot;;
  }
</pre>
<p class="Pp">The other three special keys are
    <span class="Li">&quot;connect_cached.new&quot;</span>,
    <span class="Li">&quot;connect_cached.connected&quot;</span>, and
    <span class="Li">&quot;connect_cached.reused&quot;</span>. These keys define
    callbacks that are called when
    <span class="Li">&quot;connect_cached()&quot;</span> is called, but allow
    different behaviors depending on whether a new handle is created or a handle
    is returned. The callback is invoked with these arguments:
    <span class="Li">&quot;$dbh, $dsn, $user, $auth, $attr&quot;</span>.</p>
<p class="Pp">For example, some applications uses
    <span class="Li">&quot;connect_cached()&quot;</span> to connect with
    <span class="Li">&quot;AutoCommit&quot;</span> enabled and then disable
    <span class="Li">&quot;AutoCommit&quot;</span> temporarily for transactions.
    If <span class="Li">&quot;connect_cached()&quot;</span> is called during a
    transaction, perhaps in a utility method, then it might select the same
    cached handle and then force <span class="Li">&quot;AutoCommit&quot;</span>
    on, forcing a commit of the transaction. See the &quot;connect_cached&quot;
    documentation for one way to deal with that. Here we'll describe an
    alternative approach using a callback.</p>
<p class="Pp">Because the <span class="Li">&quot;connect_cached.new&quot;</span>
    and <span class="Li">&quot;connect_cached.reused&quot;</span> callbacks are
    invoked before <span class="Li">&quot;connect_cached()&quot;</span> has
    applied the connect attributes, you can use them to edit the attributes that
    will be applied. To prevent a cached handle from having its transactions
    committed before it's returned, you can eliminate the
    <span class="Li">&quot;AutoCommit&quot;</span> attribute in a
    <span class="Li">&quot;connect_cached.reused&quot;</span> callback, like
  so:</p>
<p class="Pp"></p>
<pre>  my $cb = {
      'connect_cached.reused' =&gt; sub { delete $_[4]-&gt;{AutoCommit} },
  };
  sub dbh {
      my $self = shift;
      DBI-&gt;connect_cached( $dsn, $username, $auth, {
          PrintError =&gt; 0,
          RaiseError =&gt; 1,
          AutoCommit =&gt; 1,
          Callbacks  =&gt; $cb,
      });
  }
</pre>
<p class="Pp">The upshot is that new database handles are created with
    <span class="Li">&quot;AutoCommit&quot;</span> enabled, while cached
    database handles are left in whatever transaction state they happened to be
    in when retrieved from the cache.</p>
<p class="Pp">Note that we've also used a lexical for the callbacks hash
    reference. This is because
    <span class="Li">&quot;connect_cached()&quot;</span> returns a new database
    handle if any of the attributes passed to is have changed. If we used an
    inline hash reference, <span class="Li">&quot;connect_cached()&quot;</span>
    would return a new database handle every time. Which would rather defeat the
    purpose.</p>
<p class="Pp">A more common application for callbacks is setting connection
    state only when a new connection is made (by <b>connect()</b> or
    <b>connect_cached()</b>). Adding a callback to the connected method (when
    using <span class="Li">&quot;connect&quot;</span>) or via
    <span class="Li">&quot;connect_cached.connected&quot;</span> (when useing
    <b>connect_cached()</b>&gt;) makes this easy. The <b>connected()</b> method
    is a no-op by default (unless you subclass the DBI and change it). The DBI
    calls it to indicate that a new connection has been made and the connection
    attributes have all been set. You can give it a bit of added functionality
    by applying a callback to it. For example, to make sure that MySQL
    understands your application's ANSI-compliant SQL, set it up like so:</p>
<p class="Pp"></p>
<pre>  my $dbh = DBI-&gt;connect($dsn, $username, $auth, {
      Callbacks =&gt; {
          connected =&gt; sub {
              shift-&gt;do(q{
                  SET SESSION sql_mode='ansi,strict_trans_tables,no_auto_value_on_zero';
              });
              return;
          },
      }
  });
</pre>
<p class="Pp">If you're using
    <span class="Li">&quot;connect_cached()&quot;</span>, use the
    <span class="Li">&quot;connect_cached.connected&quot;</span> callback,
    instead. This is because <span class="Li">&quot;connected()&quot;</span> is
    called for both new and reused database handles, but you want to execute a
    callback only the when a new database handle is returned. For example, to
    set the time zone on connection to a PostgreSQL database, try this:</p>
<p class="Pp"></p>
<pre>  my $cb = {
      'connect_cached.connected' =&gt; sub {
          shift-&gt;do('SET timezone = UTC');
      }
  };
  sub dbh {
      my $self = shift;
      DBI-&gt;connect_cached( $dsn, $username, $auth, { Callbacks =&gt; $cb });
  }
</pre>
<p class="Pp">One significant limitation with callbacks is that there can only
    be one per method per handle. This means it's easy for one use of callbacks
    to interfere with, or typically simply overwrite, another use of callbacks.
    For this reason modules using callbacks should document the fact clearly so
    application authors can tell if use of callbacks by the module will clash
    with use of callbacks by the application.</p>
<p class="Pp">You might be able to work around this issue by taking a copy of
    the original callback and calling it within your own. For example:</p>
<p class="Pp"></p>
<pre>  my $prev_cb = $h-&gt;{Callbacks}{method_name};
  $h-&gt;{Callbacks}{method_name} = sub {
    if ($prev_cb) {
        my @result = $prev_cb-&gt;(@_);
        return @result if not $_; # $prev_cb vetoed call
    }
    ... your callback logic here ...
  };
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;private_your_module_name_*&quot;</i></span><i></i></p>
<p class="Pp">The DBI provides a way to store extra information in a DBI handle
    as &quot;private&quot; attributes. The DBI will allow you to store and
    retrieve any attribute which has a name starting with
    &quot;<span class="Li">&quot;private_&quot;</span>&quot;.</p>
<p class="Pp">It is <i>strongly</i> recommended that you use just <i>one</i>
    private attribute (e.g., use a hash ref) <i>and</i> give it a long and
    unambiguous name that includes the module or application name that the
    attribute relates to (e.g.,
    &quot;<span class="Li">&quot;private_YourFullModuleName_thingy&quot;</span>&quot;).</p>
<p class="Pp">Because of the way the Perl tie mechanism works you cannot
    reliably use the <span class="Li">&quot;||=&quot;</span> operator directly
    to initialise the attribute, like this:</p>
<p class="Pp"></p>
<pre>  my $foo = $dbh-&gt;{private_yourmodname_foo} ||= { ... }; # WRONG
</pre>
<p class="Pp">you should use a two step approach like this:</p>
<p class="Pp"></p>
<pre>  my $foo = $dbh-&gt;{private_yourmodname_foo};
  $foo ||= $dbh-&gt;{private_yourmodname_foo} = { ... };
</pre>
<p class="Pp">This attribute is primarily of interest to people sub-classing
    DBI, or for applications to piggy-back extra information onto DBI
  handles.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DBI_DATABASE_HANDLE_OBJECTS"><a class="permalink" href="#DBI_DATABASE_HANDLE_OBJECTS">DBI
  DATABASE HANDLE OBJECTS</a></h1>
<p class="Pp">This section covers the methods and attributes associated with
    database handles.</p>
<section class="Ss">
<h2 class="Ss" id="Database_Handle_Methods"><a class="permalink" href="#Database_Handle_Methods">Database
  Handle Methods</a></h2>
<p class="Pp">The following methods are specified for DBI database handles:</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;clone&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $new_dbh = $dbh-&gt;clone(\%attr);
</pre>
<p class="Pp">The <span class="Li">&quot;clone&quot;</span> method duplicates
    the <span class="Li">$dbh</span> connection by connecting with the same
    parameters ($dsn, <span class="Li">$user</span>,
    <span class="Li">$password</span>) as originally used.</p>
<p class="Pp">The attributes for the cloned connect are the same as those used
    for the <i>original</i> connect, with any other attributes in
    <span class="Li">&quot;\%attr&quot;</span> merged over them. Effectively the
    same as doing:</p>
<p class="Pp"></p>
<pre>  %attributes_used = ( %original_attributes, %attr );
</pre>
<p class="Pp">If \%attr is not given then it defaults to a hash containing all
    the attributes in the attribute cache of <span class="Li">$dbh</span>
    excluding any non-code references, plus the main boolean attributes
    (RaiseError, PrintError, AutoCommit, etc.). <i>This behaviour is unreliable
    and so use of clone without</i> <i>an argument is deprecated and may cause a
    warning in a future release.</i></p>
<p class="Pp">The clone method can be used even if the database handle is
    disconnected.</p>
<p class="Pp">The <span class="Li">&quot;clone&quot;</span> method was added in
    DBI 1.33.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;data_sources&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @ary = $dbh-&gt;data_sources();
  @ary = $dbh-&gt;data_sources(\%attr);
</pre>
<p class="Pp">Returns a list of data sources (databases) available via the
    <span class="Li">$dbh</span> driver's <b>data_sources()</b> method, plus any
    extra data sources that the driver can discover via the connected
    <span class="Li">$dbh</span>. Typically the extra data sources are other
    databases managed by the same server process that the
    <span class="Li">$dbh</span> is connected to.</p>
<p class="Pp">Data sources are returned in a form suitable for passing to the
    &quot;connect&quot; method (that is, they will include the
    &quot;<span class="Li">&quot;dbi:$driver:&quot;</span>&quot; prefix).</p>
<p class="Pp">The <b>data_sources()</b> method, for a
    <span class="Li">$dbh</span>, was added in DBI 1.38.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;do&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rows = $dbh-&gt;do($statement)           or die $dbh-&gt;errstr;
  $rows = $dbh-&gt;do($statement, \%attr)   or die $dbh-&gt;errstr;
  $rows = $dbh-&gt;do($statement, \%attr, @bind_values) or die ...
</pre>
<p class="Pp">Prepare and execute a single statement. Returns the number of rows
    affected or <span class="Li">&quot;undef&quot;</span> on error. A return
    value of <span class="Li">&quot;-1&quot;</span> means the number of rows is
    not known, not applicable, or not available.</p>
<p class="Pp">This method is typically most useful for
    <i>non</i>-<span class="Li">&quot;SELECT&quot;</span> statements that either
    cannot be prepared in advance (due to a limitation of the driver) or do not
    need to be executed repeatedly. It should not be used for
    <span class="Li">&quot;SELECT&quot;</span> statements because it does not
    return a statement handle (so you can't fetch any data).</p>
<p class="Pp">The default <span class="Li">&quot;do&quot;</span> method is
    logically similar to:</p>
<p class="Pp"></p>
<pre>  sub do {
      my($dbh, $statement, $attr, @bind_values) = @_;
      my $sth = $dbh-&gt;prepare($statement, $attr) or return undef;
      $sth-&gt;execute(@bind_values) or return undef;
      my $rows = $sth-&gt;rows;
      ($rows == 0) ? &quot;0E0&quot; : $rows; # always return true if no error
  }
</pre>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  my $rows_deleted = $dbh-&gt;do(q{
      DELETE FROM table
      WHERE status = ?
  }, undef, 'DONE') or die $dbh-&gt;errstr;
</pre>
<p class="Pp">Using placeholders and <span class="Li">@bind_values</span> with
    the <span class="Li">&quot;do&quot;</span> method can be useful because it
    avoids the need to correctly quote any variables in the
    <span class="Li">$statement</span>. But if you'll be executing the statement
    many times then it's more efficient to
    <span class="Li">&quot;prepare&quot;</span> it once and call
    <span class="Li">&quot;execute&quot;</span> many times instead.</p>
<p class="Pp">The <span class="Li">&quot;q{...}&quot;</span> style quoting used
    in this example avoids clashing with quotes that may be used in the SQL
    statement. Use the double-quote-like
    <span class="Li">&quot;qq{...}&quot;</span> operator if you want to
    interpolate variables into the string. See &quot;Quote and Quote-like
    Operators&quot; in perlop for more details.</p>
<p class="Pp">Note drivers are free to avoid the overhead of creating an DBI
    statement handle for <b>do()</b>, especially if there are no parameters. In
    this case error handlers, if invoked during <b>do()</b>, will be passed the
    database handle.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;last_insert_id&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rv = $dbh-&gt;last_insert_id();
  $rv = $dbh-&gt;last_insert_id($catalog, $schema, $table, $field);
  $rv = $dbh-&gt;last_insert_id($catalog, $schema, $table, $field, \%attr);
</pre>
<p class="Pp">Returns a value 'identifying' the row just inserted, if possible.
    Typically this would be a value assigned by the database server to a column
    with an <i>auto_increment</i> or <i>serial</i> type. Returns undef if the
    driver does not support the method or can't determine the value.</p>
<p class="Pp">The <span class="Li">$catalog</span>,
    <span class="Li">$schema</span>, <span class="Li">$table</span>, and
    <span class="Li">$field</span> parameters may be required for some drivers
    (see below). If you don't know the parameter values and your driver does not
    need them, then use <span class="Li">&quot;undef&quot;</span> for each.</p>
<p class="Pp">There are several caveats to be aware of with this method if you
    want to use it for portable applications:</p>
<p class="Pp"><b>*</b> For some drivers the value may only available immediately
    after the insert statement has executed (e.g., mysql, Informix).</p>
<p class="Pp"><b>*</b> For some drivers the <span class="Li">$catalog</span>,
    <span class="Li">$schema</span>, <span class="Li">$table</span>, and
    <span class="Li">$field</span> parameters are required, for others they are
    ignored (e.g., mysql).</p>
<p class="Pp"><b>*</b> Drivers may return an indeterminate value if no insert
    has been performed yet.</p>
<p class="Pp"><b>*</b> For some drivers the value may only be available if
    placeholders have <i>not</i> been used (e.g., Sybase, MS SQL). In this case
    the value returned would be from the last non-placeholder insert
  statement.</p>
<p class="Pp"><b>*</b> Some drivers may need driver-specific hints about how to
    get the value. For example, being told the name of the database 'sequence'
    object that holds the value. Any such hints are passed as driver-specific
    attributes in the \%attr parameter.</p>
<p class="Pp"><b>*</b> If the underlying database offers nothing better, then
    some drivers may attempt to implement this method by executing
    &quot;<span class="Li">&quot;select max($field) from
    $table&quot;</span>&quot;. Drivers using any approach like this should issue
    a warning if <span class="Li">&quot;AutoCommit&quot;</span> is true because
    it is generally unsafe - another process may have modified the table between
    your insert and the select. For situations where you know it is safe, such
    as when you have locked the table, you can silence the warning by passing
    <span class="Li">&quot;Warn&quot;</span> =&gt; 0 in \%attr.</p>
<p class="Pp"><b>*</b> If no insert has been performed yet, or the last insert
    failed, then the value is implementation defined.</p>
<p class="Pp">Given all the caveats above, it's clear that this method must be
    used with care.</p>
<p class="Pp">The <span class="Li">&quot;last_insert_id&quot;</span> method was
    added in DBI 1.38.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectrow_array&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @row_ary = $dbh-&gt;selectrow_array($statement);
  @row_ary = $dbh-&gt;selectrow_array($statement, \%attr);
  @row_ary = $dbh-&gt;selectrow_array($statement, \%attr, @bind_values);
</pre>
<p class="Pp">This utility method combines &quot;prepare&quot;,
    &quot;execute&quot; and &quot;fetchrow_array&quot; into a single call. If
    called in a list context, it returns the first row of data from the
    statement. The <span class="Li">$statement</span> parameter can be a
    previously prepared statement handle, in which case the
    <span class="Li">&quot;prepare&quot;</span> is skipped.</p>
<p class="Pp">If any method fails, and &quot;RaiseError&quot; is not set,
    <span class="Li">&quot;selectrow_array&quot;</span> will return an empty
    list.</p>
<p class="Pp">If called in a scalar context for a statement handle that has more
    than one column, it is undefined whether the driver will return the value of
    the first column or the last. So don't do that. Also, in a scalar context,
    an <span class="Li">&quot;undef&quot;</span> is returned if there are no
    more rows or if an error occurred. That
    <span class="Li">&quot;undef&quot;</span> can't be distinguished from an
    <span class="Li">&quot;undef&quot;</span> returned because the first field
    value was NULL. For these reasons you should exercise some caution if you
    use <span class="Li">&quot;selectrow_array&quot;</span> in a scalar context,
    or just don't do that.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectrow_arrayref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $ary_ref = $dbh-&gt;selectrow_arrayref($statement);
  $ary_ref = $dbh-&gt;selectrow_arrayref($statement, \%attr);
  $ary_ref = $dbh-&gt;selectrow_arrayref($statement, \%attr, @bind_values);
</pre>
<p class="Pp">This utility method combines &quot;prepare&quot;,
    &quot;execute&quot; and &quot;fetchrow_arrayref&quot; into a single call. It
    returns the first row of data from the statement. The
    <span class="Li">$statement</span> parameter can be a previously prepared
    statement handle, in which case the
    <span class="Li">&quot;prepare&quot;</span> is skipped.</p>
<p class="Pp">If any method fails, and &quot;RaiseError&quot; is not set,
    <span class="Li">&quot;selectrow_arrayref&quot;</span> will return
  undef.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectrow_hashref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $hash_ref = $dbh-&gt;selectrow_hashref($statement);
  $hash_ref = $dbh-&gt;selectrow_hashref($statement, \%attr);
  $hash_ref = $dbh-&gt;selectrow_hashref($statement, \%attr, @bind_values);
</pre>
<p class="Pp">This utility method combines &quot;prepare&quot;,
    &quot;execute&quot; and &quot;fetchrow_hashref&quot; into a single call. It
    returns the first row of data from the statement. The
    <span class="Li">$statement</span> parameter can be a previously prepared
    statement handle, in which case the
    <span class="Li">&quot;prepare&quot;</span> is skipped.</p>
<p class="Pp">If any method fails, and &quot;RaiseError&quot; is not set,
    <span class="Li">&quot;selectrow_hashref&quot;</span> will return undef.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectall_arrayref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $ary_ref = $dbh-&gt;selectall_arrayref($statement);
  $ary_ref = $dbh-&gt;selectall_arrayref($statement, \%attr);
  $ary_ref = $dbh-&gt;selectall_arrayref($statement, \%attr, @bind_values);
</pre>
<p class="Pp">This utility method combines &quot;prepare&quot;,
    &quot;execute&quot; and &quot;fetchall_arrayref&quot; into a single call. It
    returns a reference to an array containing a reference to an array (or hash,
    see below) for each row of data fetched.</p>
<p class="Pp">The <span class="Li">$statement</span> parameter can be a
    previously prepared statement handle, in which case the
    <span class="Li">&quot;prepare&quot;</span> is skipped. This is recommended
    if the statement is going to be executed many times.</p>
<p class="Pp">If &quot;RaiseError&quot; is not set and any method except
    <span class="Li">&quot;fetchall_arrayref&quot;</span> fails then
    <span class="Li">&quot;selectall_arrayref&quot;</span> will return
    <span class="Li">&quot;undef&quot;</span>; if
    <span class="Li">&quot;fetchall_arrayref&quot;</span> fails then it will
    return with whatever data has been fetched thus far. You should check
    <span class="Li">&quot;$dbh-&gt;err&quot;</span> afterwards (or use the
    <span class="Li">&quot;RaiseError&quot;</span> attribute) to discover if the
    data is complete or was truncated due to an error.</p>
<p class="Pp">The &quot;fetchall_arrayref&quot; method called by
    <span class="Li">&quot;selectall_arrayref&quot;</span> supports a
    <span class="Li">$max_rows</span> parameter. You can specify a value for
    <span class="Li">$max_rows</span> by including a
    '<span class="Li">&quot;MaxRows&quot;</span>' attribute in \%attr. In which
    case <b>finish()</b> is called for you after <b>fetchall_arrayref()</b>
    returns.</p>
<p class="Pp">The &quot;fetchall_arrayref&quot; method called by
    <span class="Li">&quot;selectall_arrayref&quot;</span> also supports a
    <span class="Li">$slice</span> parameter. You can specify a value for
    <span class="Li">$slice</span> by including a
    '<span class="Li">&quot;Slice&quot;</span>' or
    '<span class="Li">&quot;Columns&quot;</span>' attribute in \%attr. The only
    difference between the two is that if
    <span class="Li">&quot;Slice&quot;</span> is not defined and
    <span class="Li">&quot;Columns&quot;</span> is an array ref, then the array
    is assumed to contain column index values (which count from 1), rather than
    perl array index values. In which case the array is copied and each value
    decremented before passing to
    <span class="Li">&quot;/fetchall_arrayref&quot;</span>.</p>
<p class="Pp">You may often want to fetch an array of rows where each row is
    stored as a hash. That can be done simply using:</p>
<p class="Pp"></p>
<pre>  my $emps = $dbh-&gt;selectall_arrayref(
      &quot;SELECT ename FROM emp ORDER BY ename&quot;,
      { Slice =&gt; {} }
  );
  foreach my $emp ( @$emps ) {
      print &quot;Employee: $emp-&gt;{ename}\n&quot;;
  }
</pre>
<p class="Pp">Or, to fetch into an array instead of an array ref:</p>
<p class="Pp"></p>
<pre>  @result = @{ $dbh-&gt;selectall_arrayref($sql, { Slice =&gt; {} }) };
</pre>
<p class="Pp">See &quot;fetchall_arrayref&quot; method for more details.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectall_array&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @ary = $dbh-&gt;selectall_array($statement);
  @ary = $dbh-&gt;selectall_array($statement, \%attr);
  @ary = $dbh-&gt;selectall_array($statement, \%attr, @bind_values);
</pre>
<p class="Pp">This is a convenience wrapper around selectall_arrayref that
    returns the rows directly as a list, rather than a reference to an array of
    rows.</p>
<p class="Pp">Note that if &quot;RaiseError&quot; is not set then you can't tell
    the difference between returning no rows and an error. Using RaiseError is
    best practice.</p>
<p class="Pp">The <span class="Li">&quot;selectall_array&quot;</span> method was
    added in DBI 1.635.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectall_hashref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field);
  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field, \%attr);
  $hash_ref = $dbh-&gt;selectall_hashref($statement, $key_field, \%attr, @bind_values);
</pre>
<p class="Pp">This utility method combines &quot;prepare&quot;,
    &quot;execute&quot; and &quot;fetchall_hashref&quot; into a single call. It
    returns a reference to a hash containing one entry, at most, for each row,
    as returned by <b>fetchall_hashref()</b>.</p>
<p class="Pp">The <span class="Li">$statement</span> parameter can be a
    previously prepared statement handle, in which case the
    <span class="Li">&quot;prepare&quot;</span> is skipped. This is recommended
    if the statement is going to be executed many times.</p>
<p class="Pp">The <span class="Li">$key_field</span> parameter defines which
    column, or columns, are used as keys in the returned hash. It can either be
    the name of a single field, or a reference to an array containing multiple
    field names. Using multiple names yields a tree of nested hashes.</p>
<p class="Pp">If a row has the same key as an earlier row then it replaces the
    earlier row.</p>
<p class="Pp">If any method except
    <span class="Li">&quot;fetchall_hashref&quot;</span> fails, and
    &quot;RaiseError&quot; is not set,
    <span class="Li">&quot;selectall_hashref&quot;</span> will return
    <span class="Li">&quot;undef&quot;</span>. If
    <span class="Li">&quot;fetchall_hashref&quot;</span> fails and
    &quot;RaiseError&quot; is not set, then it will return with whatever data it
    has fetched thus far. <span class="Li">$DBI::err</span> should be checked to
    catch that.</p>
<p class="Pp">See <b>fetchall_hashref()</b> for more details.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;selectcol_arrayref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $ary_ref = $dbh-&gt;selectcol_arrayref($statement);
  $ary_ref = $dbh-&gt;selectcol_arrayref($statement, \%attr);
  $ary_ref = $dbh-&gt;selectcol_arrayref($statement, \%attr, @bind_values);
</pre>
<p class="Pp">This utility method combines &quot;prepare&quot;,
    &quot;execute&quot;, and fetching one column from all the rows, into a
    single call. It returns a reference to an array containing the values of the
    first column from each row.</p>
<p class="Pp">The <span class="Li">$statement</span> parameter can be a
    previously prepared statement handle, in which case the
    <span class="Li">&quot;prepare&quot;</span> is skipped. This is recommended
    if the statement is going to be executed many times.</p>
<p class="Pp">If any method except <span class="Li">&quot;fetch&quot;</span>
    fails, and &quot;RaiseError&quot; is not set,
    <span class="Li">&quot;selectcol_arrayref&quot;</span> will return
    <span class="Li">&quot;undef&quot;</span>. If
    <span class="Li">&quot;fetch&quot;</span> fails and &quot;RaiseError&quot;
    is not set, then it will return with whatever data it has fetched thus far.
    <span class="Li">$DBI::err</span> should be checked to catch that.</p>
<p class="Pp">The <span class="Li">&quot;selectcol_arrayref&quot;</span> method
    defaults to pushing a single column value (the first) from each row into the
    result array. However, it can also push another column, or even multiple
    columns per row, into the result array. This behaviour can be specified via
    a '<span class="Li">&quot;Columns&quot;</span>' attribute which must be a
    ref to an array containing the column number or numbers to use. For
  example:</p>
<p class="Pp"></p>
<pre>  # get array of id and name pairs:
  my $ary_ref = $dbh-&gt;selectcol_arrayref(&quot;select id, name from table&quot;, { Columns=&gt;[1,2] });
  my %hash = @$ary_ref; # build hash from key-value pairs so $hash{$id} =&gt; name
</pre>
<p class="Pp">You can specify a maximum number of rows to fetch by including a
    '<span class="Li">&quot;MaxRows&quot;</span>' attribute in \%attr.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;prepare&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare($statement)          or die $dbh-&gt;errstr;
  $sth = $dbh-&gt;prepare($statement, \%attr)  or die $dbh-&gt;errstr;
</pre>
<p class="Pp">Prepares a statement for later execution by the database engine
    and returns a reference to a statement handle object.</p>
<p class="Pp">The returned statement handle can be used to get attributes of the
    statement and invoke the &quot;execute&quot; method. See &quot;Statement
    Handle Methods&quot;.</p>
<p class="Pp">Drivers for engines without the concept of preparing a statement
    will typically just store the statement in the returned handle and process
    it when <span class="Li">&quot;$sth-&gt;execute&quot;</span> is called. Such
    drivers are unlikely to give much useful information about the statement,
    such as <span class="Li">&quot;$sth-&gt;{NUM_OF_FIELDS}&quot;</span>, until
    after <span class="Li">&quot;$sth-&gt;execute&quot;</span> has been called.
    Portable applications should take this into account.</p>
<p class="Pp">In general, DBI drivers do not parse the contents of the statement
    (other than simply counting any Placeholders). The statement is passed
    directly to the database engine, sometimes known as pass-thru mode. This has
    advantages and disadvantages. On the plus side, you can access all the
    functionality of the engine being used. On the downside, you're limited if
    you're using a simple engine, and you need to take extra care if writing
    applications intended to be portable between engines.</p>
<p class="Pp">Portable applications should not assume that a new statement can
    be prepared and/or executed while still fetching results from a previous
    statement.</p>
<p class="Pp">Some command-line SQL tools use statement terminators, like a
    semicolon, to indicate the end of a statement. Such terminators should not
    normally be used with the DBI.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;prepare_cached&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare_cached($statement)
  $sth = $dbh-&gt;prepare_cached($statement, \%attr)
  $sth = $dbh-&gt;prepare_cached($statement, \%attr, $if_active)
</pre>
<p class="Pp">Like &quot;prepare&quot; except that the statement handle returned
    will be stored in a hash associated with the <span class="Li">$dbh</span>.
    If another call is made to
    <span class="Li">&quot;prepare_cached&quot;</span> with the same
    <span class="Li">$statement</span> and <span class="Li">%attr</span>
    parameter values, then the corresponding cached <span class="Li">$sth</span>
    will be returned without contacting the database server. Be sure to
    understand the cautions and caveats noted below.</p>
<p class="Pp">The <span class="Li">$if_active</span> parameter lets you adjust
    the behaviour if an already cached statement handle is still Active. There
    are several alternatives:</p>
<dl class="Bl-tag">
  <dt><b>0</b>: A warning will be generated, and <b>finish()</b> will be called
    on the statement handle before it is returned. This is the default behaviour
    if $if_active is not passed.</dt>
  <dd></dd>
  <dt><b>1</b>: <b>finish()</b> will be called on the statement handle, but the
    warning is suppressed.</dt>
  <dd></dd>
  <dt><b>2</b>: Disables any checking.</dt>
  <dd></dd>
  <dt><b>3</b>: The existing active statement handle will be removed from the
    cache and a new statement handle prepared and cached in its place. This is
    the safest option because it doesn't affect the state of the old handle, it
    just removes it from the cache. [Added in DBI 1.40]</dt>
  <dd></dd>
</dl>
<p class="Pp">Here are some examples of
    <span class="Li">&quot;prepare_cached&quot;</span>:</p>
<p class="Pp"></p>
<pre>  sub insert_hash {
    my ($table, $field_values) = @_;
    # sort to keep field order, and thus sql, stable for prepare_cached
    my @fields = sort keys %$field_values;
    my @values = @{$field_values}{@fields};
    my $sql = sprintf &quot;insert into %s (%s) values (%s)&quot;,
        $table, join(&quot;,&quot;, @fields), join(&quot;,&quot;, (&quot;?&quot;)x@fields);
    my $sth = $dbh-&gt;prepare_cached($sql);
    return $sth-&gt;execute(@values);
  }
  sub search_hash {
    my ($table, $field_values) = @_;
    # sort to keep field order, and thus sql, stable for prepare_cached
    my @fields = sort keys %$field_values;
    my @values = @{$field_values}{@fields};
    my $qualifier = &quot;&quot;;
    $qualifier = &quot;where &quot;.join(&quot; and &quot;, map { &quot;$_=?&quot; } @fields) if @fields;
    $sth = $dbh-&gt;prepare_cached(&quot;SELECT * FROM $table $qualifier&quot;);
    return $dbh-&gt;selectall_arrayref($sth, {}, @values);
  }
</pre>
<p class="Pp"><i>Caveat emptor:</i> This caching can be useful in some
    applications, but it can also cause problems and should be used with care.
    Here is a contrived case where caching would cause a significant
  problem:</p>
<p class="Pp"></p>
<pre>  my $sth = $dbh-&gt;prepare_cached('SELECT * FROM foo WHERE bar=?');
  $sth-&gt;execute(...);
  while (my $data = $sth-&gt;fetchrow_hashref) {
    # later, in some other code called within the loop...
    my $sth2 = $dbh-&gt;prepare_cached('SELECT * FROM foo WHERE bar=?');
    $sth2-&gt;execute(...);
    while (my $data2 = $sth2-&gt;fetchrow_arrayref) {
      do_stuff(...);
    }
  }
</pre>
<p class="Pp">In this example, since both handles are preparing the exact same
    statement, <span class="Li">$sth2</span> will not be its own statement
    handle, but a duplicate of <span class="Li">$sth</span> returned from the
    cache. The results will certainly not be what you expect. Typically the
    inner fetch loop will work normally, fetching all the records and
    terminating when there are no more, but now that
    <span class="Li">$sth</span> is the same as <span class="Li">$sth2</span>
    the outer fetch loop will also terminate.</p>
<p class="Pp">You'll know if you run into this problem because
    <b>prepare_cached()</b> will generate a warning by default (when
    <span class="Li">$if_active</span> is false).</p>
<p class="Pp">The cache used by <b>prepare_cached()</b> is keyed by both the
    statement and any attributes so you can also avoid this issue by doing
    something like:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare_cached(&quot;...&quot;, { dbi_dummy =&gt; __FILE__.__LINE__ });
</pre>
<p class="Pp">which will ensure that prepare_cached only returns statements
    cached by that line of code in that source file.</p>
<p class="Pp">Also, to ensure the attributes passed are always the same, avoid
    passing references inline. For example, the Slice attribute is specified as
    a reference. Be sure to declare it external to the call to
    <b>prepare_cached()</b>, such that a new hash reference is not created on
    every call. See &quot;connect_cached&quot; for more details and
  examples.</p>
<p class="Pp">If you'd like the cache to managed intelligently, you can tie the
    hashref returned by <span class="Li">&quot;CachedKids&quot;</span> to an
    appropriate caching module, such as Tie::Cache::LRU:</p>
<p class="Pp"></p>
<pre>  my $cache;
  tie %$cache, 'Tie::Cache::LRU', 500;
  $dbh-&gt;{CachedKids} = $cache;
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;commit&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc  = $dbh-&gt;commit     or die $dbh-&gt;errstr;
</pre>
<p class="Pp">Commit (make permanent) the most recent series of database changes
    if the database supports transactions and AutoCommit is off.</p>
<p class="Pp">If <span class="Li">&quot;AutoCommit&quot;</span> is on, then
    calling <span class="Li">&quot;commit&quot;</span> will issue a &quot;commit
    ineffective with AutoCommit&quot; warning.</p>
<p class="Pp">See also &quot;Transactions&quot; in the &quot;FURTHER
    INFORMATION&quot; section below.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;rollback&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc  = $dbh-&gt;rollback   or die $dbh-&gt;errstr;
</pre>
<p class="Pp">Rollback (undo) the most recent series of uncommitted database
    changes if the database supports transactions and AutoCommit is off.</p>
<p class="Pp">If <span class="Li">&quot;AutoCommit&quot;</span> is on, then
    calling <span class="Li">&quot;rollback&quot;</span> will issue a
    &quot;rollback ineffective with AutoCommit&quot; warning.</p>
<p class="Pp">See also &quot;Transactions&quot; in the &quot;FURTHER
    INFORMATION&quot; section below.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;begin_work&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc  = $dbh-&gt;begin_work   or die $dbh-&gt;errstr;
</pre>
<p class="Pp">Enable transactions (by turning
    <span class="Li">&quot;AutoCommit&quot;</span> off) until the next call to
    <span class="Li">&quot;commit&quot;</span> or
    <span class="Li">&quot;rollback&quot;</span>. After the next
    <span class="Li">&quot;commit&quot;</span> or
    <span class="Li">&quot;rollback&quot;</span>,
    <span class="Li">&quot;AutoCommit&quot;</span> will automatically be turned
    on again.</p>
<p class="Pp">If <span class="Li">&quot;AutoCommit&quot;</span> is already off
    when <span class="Li">&quot;begin_work&quot;</span> is called then it does
    nothing except return an error. If the driver does not support transactions
    then when <span class="Li">&quot;begin_work&quot;</span> attempts to set
    <span class="Li">&quot;AutoCommit&quot;</span> off the driver will trigger a
    fatal error.</p>
<p class="Pp">See also &quot;Transactions&quot; in the &quot;FURTHER
    INFORMATION&quot; section below.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;disconnect&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $dbh-&gt;disconnect  or warn $dbh-&gt;errstr;
</pre>
<p class="Pp">Disconnects the database from the database handle.
    <span class="Li">&quot;disconnect&quot;</span> is typically only used before
    exiting the program. The handle is of little use after disconnecting.</p>
<p class="Pp">The transaction behaviour of the
    <span class="Li">&quot;disconnect&quot;</span> method is, sadly, undefined.
    Some database systems (such as Oracle and Ingres) will automatically commit
    any outstanding changes, but others (such as Informix) will rollback any
    outstanding changes. Applications not using
    <span class="Li">&quot;AutoCommit&quot;</span> should explicitly call
    <span class="Li">&quot;commit&quot;</span> or
    <span class="Li">&quot;rollback&quot;</span> before calling
    <span class="Li">&quot;disconnect&quot;</span>.</p>
<p class="Pp">The database is automatically disconnected by the
    <span class="Li">&quot;DESTROY&quot;</span> method if still connected when
    there are no longer any references to the handle. The
    <span class="Li">&quot;DESTROY&quot;</span> method for each driver should
    implicitly call <span class="Li">&quot;rollback&quot;</span> to undo any
    uncommitted changes. This is vital behaviour to ensure that incomplete
    transactions don't get committed simply because Perl calls
    <span class="Li">&quot;DESTROY&quot;</span> on every object before exiting.
    Also, do not rely on the order of object destruction during &quot;global
    destruction&quot;, as it is undefined.</p>
<p class="Pp">Generally, if you want your changes to be committed or rolled back
    when you disconnect, then you should explicitly call &quot;commit&quot; or
    &quot;rollback&quot; before disconnecting.</p>
<p class="Pp">If you disconnect from a database while you still have active
    statement handles (e.g., SELECT statement handles that may have more data to
    fetch), you will get a warning. The warning may indicate that a fetch loop
    terminated early, perhaps due to an uncaught error. To avoid the warning
    call the <span class="Li">&quot;finish&quot;</span> method on the active
    handles.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ping&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $dbh-&gt;ping;
</pre>
<p class="Pp">Attempts to determine, in a reasonably efficient way, if the
    database server is still running and the connection to it is still working.
    Individual drivers should implement this function in the most suitable
    manner for their database engine.</p>
<p class="Pp">The current <i>default</i> implementation always returns true
    without actually doing anything. Actually, it returns
    &quot;<span class="Li">&quot;0 but true&quot;</span>&quot; which is true but
    zero. That way you can tell if the return value is genuine or just the
    default. Drivers should override this method with one that does the right
    thing for their type of database.</p>
<p class="Pp">Few applications would have direct use for this method. See the
    specialized Apache::DBI module for one example usage.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;get_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $value = $dbh-&gt;get_info( $info_type );
</pre>
<p class="Pp">Returns information about the implementation, i.e. driver and data
    source capabilities, restrictions etc. It returns
    <span class="Li">&quot;undef&quot;</span> for unknown or unimplemented
    information types. For example:</p>
<p class="Pp"></p>
<pre>  $database_version  = $dbh-&gt;get_info(  18 ); # SQL_DBMS_VER
  $max_select_tables = $dbh-&gt;get_info( 106 ); # SQL_MAXIMUM_TABLES_IN_SELECT
</pre>
<p class="Pp">See &quot;Standards Reference Information&quot; for more detailed
    information about the information types and their meanings and possible
    return values.</p>
<p class="Pp">The DBI::Const::GetInfoType module exports a
    <span class="Li">%GetInfoType</span> hash that can be used to map info type
    names to numbers. For example:</p>
<p class="Pp"></p>
<pre>  $database_version = $dbh-&gt;get_info( $GetInfoType{SQL_DBMS_VER} );
</pre>
<p class="Pp">The names are a merging of the ANSI and ODBC standards (which
    differ in some cases). See DBI::Const::GetInfoType for more details.</p>
<p class="Pp">Because some DBI methods make use of <b>get_info()</b>, drivers
    are strongly encouraged to support <i>at least</i> the following very
    minimal set of information types to ensure the DBI itself works
  properly:</p>
<p class="Pp"></p>
<pre> Type  Name                        Example A     Example B
 ----  --------------------------  ------------  ----------------
   17  SQL_DBMS_NAME               'ACCESS'      'Oracle'
   18  SQL_DBMS_VER                '03.50.0000'  '08.01.0721 ...'
   29  SQL_IDENTIFIER_QUOTE_CHAR   '`'           '&quot;'
   41  SQL_CATALOG_NAME_SEPARATOR  '.'           '@'
  114  SQL_CATALOG_LOCATION        1             2
</pre>
<p class="Pp">Values from 9000 to 9999 for get_info are officially reserved for
    use by Perl DBI. Values in that range which have been assigned a meaning are
    defined here:</p>
<p class="Pp"><span class="Li">9000</span>: true if a backslash character
    (<span class="Li">&quot;\&quot;</span>) before placeholder-like text (e.g.
    <span class="Li">&quot;?&quot;</span>,
    <span class="Li">&quot;:foo&quot;</span>) will prevent it being treated as a
    placeholder by the driver. The backslash will be removed before the text is
    passed to the backend.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;table_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;table_info( $catalog, $schema, $table, $type );
  $sth = $dbh-&gt;table_info( $catalog, $schema, $table, $type, \%attr );
  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc
</pre>
<p class="Pp">Returns an active statement handle that can be used to fetch
    information about tables and views that exist in the database.</p>
<p class="Pp">The arguments <span class="Li">$catalog</span>,
    <span class="Li">$schema</span> and <span class="Li">$table</span> may
    accept search patterns according to the database/driver, for example:
    <span class="Li">$table</span> = '%FOO%'; Remember that the underscore
    character ('<span class="Li">&quot;_&quot;</span>') is a search pattern that
    means match any character, so 'FOO_%' is the same as 'FOO%' and 'FOO_BAR%'
    will match names like 'FOO1BAR'.</p>
<p class="Pp">The value of <span class="Li">$type</span> is a comma-separated
    list of one or more types of tables to be returned in the result set. Each
    value may optionally be quoted, e.g.:</p>
<p class="Pp"></p>
<pre>  $type = &quot;TABLE&quot;;
  $type = &quot;'TABLE','VIEW'&quot;;
</pre>
<p class="Pp">In addition the following special cases may also be supported by
    some drivers:</p>
<ul class="Bl-bullet">
  <li>If the value of <span class="Li">$catalog</span> is '%' and
      <span class="Li">$schema</span> and <span class="Li">$table</span> name
      are empty strings, the result set contains a list of catalog names. For
      example:
    <p class="Pp"></p>
    <pre>  $sth = $dbh-&gt;table_info('%', '', '');
    </pre>
  </li>
  <li>If the value of <span class="Li">$schema</span> is '%' and
      <span class="Li">$catalog</span> and <span class="Li">$table</span> are
      empty strings, the result set contains a list of schema names.</li>
  <li>If the value of <span class="Li">$type</span> is '%' and
      <span class="Li">$catalog</span>, <span class="Li">$schema</span>, and
      <span class="Li">$table</span> are all empty strings, the result set
      contains a list of table types.</li>
</ul>
<p class="Pp">If your driver doesn't support one or more of the selection filter
    parameters then you may get back more than you asked for and can do the
    filtering yourself.</p>
<p class="Pp">This method can be expensive, and can return a large amount of
    data. (For example, small Oracle installation returns over 2000 rows.) So
    it's a good idea to use the filters to limit the data as much as
  possible.</p>
<p class="Pp">The statement handle returned has at least the following fields in
    the order show below. Other fields, after these, may also be present.</p>
<p class="Pp"><b>TABLE_CAT</b>: Table catalog identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, which is usually the case. This field is empty if not applicable to
    the table.</p>
<p class="Pp"><b>TABLE_SCHEM</b>: The name of the schema containing the
    TABLE_NAME value. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to data
    source, and empty if not applicable to the table.</p>
<p class="Pp"><b>TABLE_NAME</b>: Name of the table (or view, synonym, etc).</p>
<p class="Pp"><b>TABLE_TYPE</b>: One of the following: &quot;TABLE&quot;,
    &quot;VIEW&quot;, &quot;SYSTEM TABLE&quot;, &quot;GLOBAL TEMPORARY&quot;,
    &quot;LOCAL TEMPORARY&quot;, &quot;ALIAS&quot;, &quot;SYNONYM&quot; or a
    type identifier that is specific to the data source.</p>
<p class="Pp"><b>REMARKS</b>: A description of the table. May be NULL
    (<span class="Li">&quot;undef&quot;</span>).</p>
<p class="Pp">Note that <span class="Li">&quot;table_info&quot;</span> might not
    return records for all tables. Applications can use any valid table
    regardless of whether it's returned by
    <span class="Li">&quot;table_info&quot;</span>.</p>
<p class="Pp">See also &quot;tables&quot;, &quot;Catalog Methods&quot; and
    &quot;Standards Reference Information&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;column_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;column_info( $catalog, $schema, $table, $column );
  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc
</pre>
<p class="Pp">Returns an active statement handle that can be used to fetch
    information about columns in specified tables.</p>
<p class="Pp">The arguments <span class="Li">$schema</span>,
    <span class="Li">$table</span> and <span class="Li">$column</span> may
    accept search patterns according to the database/driver, for example:
    <span class="Li">$table</span> = '%FOO%';</p>
<p class="Pp">Note: The support for the selection criteria is driver specific.
    If the driver doesn't support one or more of them then you may get back more
    than you asked for and can do the filtering yourself.</p>
<p class="Pp">Note: If your driver does not support column_info an undef is
    returned. This is distinct from asking for something which does not exist in
    a driver which supports column_info as a valid statement handle to an empty
    result-set will be returned in this case.</p>
<p class="Pp">If the arguments don't match any tables then you'll still get a
    statement handle, it'll just return no rows.</p>
<p class="Pp">The statement handle returned has at least the following fields in
    the order shown below. Other fields, after these, may also be present.</p>
<p class="Pp"><b>TABLE_CAT</b>: The catalog identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, which is often the case. This field is empty if not applicable to
    the table.</p>
<p class="Pp"><b>TABLE_SCHEM</b>: The schema identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, and empty if not applicable to the table.</p>
<p class="Pp"><b>TABLE_NAME</b>: The table identifier. Note: A driver may
    provide column metadata not only for base tables, but also for derived
    objects like SYNONYMS etc.</p>
<p class="Pp"><b>COLUMN_NAME</b>: The column identifier.</p>
<p class="Pp"><b>DATA_TYPE</b>: The concise data type code.</p>
<p class="Pp"><b>TYPE_NAME</b>: A data source dependent data type name.</p>
<p class="Pp"><b>COLUMN_SIZE</b>: The column size. This is the maximum length in
    characters for character data types, the number of digits or bits for
    numeric data types or the length in the representation of temporal types.
    See the relevant specifications for detailed information.</p>
<p class="Pp"><b>BUFFER_LENGTH</b>: The length in bytes of transferred data.</p>
<p class="Pp"><b>DECIMAL_DIGITS</b>: The total number of significant digits to
    the right of the decimal point.</p>
<p class="Pp"><b>NUM_PREC_RADIX</b>: The radix for numeric precision. The value
    is 10 or 2 for numeric data types and NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable.</p>
<p class="Pp"><b>NULLABLE</b>: Indicates if a column can accept NULLs. The
    following values are defined:</p>
<p class="Pp"></p>
<pre>  SQL_NO_NULLS          0
  SQL_NULLABLE          1
  SQL_NULLABLE_UNKNOWN  2
</pre>
<p class="Pp"><b>REMARKS</b>: A description of the column.</p>
<p class="Pp"><b>COLUMN_DEF</b>: The default value of the column, in a format
    that can be used directly in an SQL statement.</p>
<p class="Pp">Note that this may be an expression and not simply the text used
    for the default value in the original CREATE TABLE statement. For example,
    given:</p>
<p class="Pp"></p>
<pre>    col1 char(30) default current_user    -- a 'function'
    col2 char(30) default 'string'        -- a string literal
</pre>
<p class="Pp">where &quot;current_user&quot; is the name of a function, the
    corresponding <span class="Li">&quot;COLUMN_DEF&quot;</span> values would
    be:</p>
<p class="Pp"></p>
<pre>    Database        col1                     col2
    --------        ----                     ----
    Oracle:         current_user             'string'
    Postgres:       &quot;current_user&quot;()         'string'::text
    MS SQL:         (user_name())            ('string')
</pre>
<p class="Pp"><b>SQL_DATA_TYPE</b>: The SQL data type.</p>
<p class="Pp"><b>SQL_DATETIME_SUB</b>: The subtype code for datetime and
    interval data types.</p>
<p class="Pp"><b>CHAR_OCTET_LENGTH</b>: The maximum length in bytes of a
    character or binary data type column.</p>
<p class="Pp"><b>ORDINAL_POSITION</b>: The column sequence number (starting with
    1).</p>
<p class="Pp"><b>IS_NULLABLE</b>: Indicates if the column can accept NULLs.
    Possible values are: 'NO', 'YES' and ''.</p>
<p class="Pp">SQL/CLI defines the following additional columns:</p>
<p class="Pp"></p>
<pre>  CHAR_SET_CAT
  CHAR_SET_SCHEM
  CHAR_SET_NAME
  COLLATION_CAT
  COLLATION_SCHEM
  COLLATION_NAME
  UDT_CAT
  UDT_SCHEM
  UDT_NAME
  DOMAIN_CAT
  DOMAIN_SCHEM
  DOMAIN_NAME
  SCOPE_CAT
  SCOPE_SCHEM
  SCOPE_NAME
  MAX_CARDINALITY
  DTD_IDENTIFIER
  IS_SELF_REF
</pre>
<p class="Pp">Drivers capable of supplying any of those values should do so in
    the corresponding column and supply undef values for the others.</p>
<p class="Pp">Drivers wishing to provide extra database/driver specific
    information should do so in extra columns beyond all those listed above, and
    use lowercase field names with the driver-specific prefix (i.e., 'ora_...').
    Applications accessing such fields should do so by name and not by column
    number.</p>
<p class="Pp">The result set is ordered by TABLE_CAT, TABLE_SCHEM, TABLE_NAME
    and ORDINAL_POSITION.</p>
<p class="Pp">Note: There is some overlap with statement handle attributes (in
    perl) and SQLDescribeCol (in ODBC). However, SQLColumns provides more
    metadata.</p>
<p class="Pp">See also &quot;Catalog Methods&quot; and &quot;Standards Reference
    Information&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;primary_key_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;primary_key_info( $catalog, $schema, $table );
  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc
</pre>
<p class="Pp">Returns an active statement handle that can be used to fetch
    information about columns that make up the primary key for a table. The
    arguments don't accept search patterns (unlike <b>table_info()</b>).</p>
<p class="Pp">The statement handle will return one row per column, ordered by
    TABLE_CAT, TABLE_SCHEM, TABLE_NAME, and KEY_SEQ. If there is no primary key
    then the statement handle will fetch no rows.</p>
<p class="Pp">Note: The support for the selection criteria, such as
    <span class="Li">$catalog</span>, is driver specific. If the driver doesn't
    support catalogs and/or schemas, it may ignore these criteria.</p>
<p class="Pp">The statement handle returned has at least the following fields in
    the order shown below. Other fields, after these, may also be present.</p>
<p class="Pp"><b>TABLE_CAT</b>: The catalog identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, which is often the case. This field is empty if not applicable to
    the table.</p>
<p class="Pp"><b>TABLE_SCHEM</b>: The schema identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, and empty if not applicable to the table.</p>
<p class="Pp"><b>TABLE_NAME</b>: The table identifier.</p>
<p class="Pp"><b>COLUMN_NAME</b>: The column identifier.</p>
<p class="Pp"><b>KEY_SEQ</b>: The column sequence number (starting with 1).
    Note: This field is named <b>ORDINAL_POSITION</b> in SQL/CLI.</p>
<p class="Pp"><b>PK_NAME</b>: The primary key constraint identifier. This field
    is NULL (<span class="Li">&quot;undef&quot;</span>) if not applicable to the
    data source.</p>
<p class="Pp">See also &quot;Catalog Methods&quot; and &quot;Standards Reference
    Information&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;primary_key&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @key_column_names = $dbh-&gt;primary_key( $catalog, $schema, $table );
</pre>
<p class="Pp">Simple interface to the <b>primary_key_info()</b> method. Returns
    a list of the column names that comprise the primary key of the specified
    table. The list is in primary key column sequence order. If there is no
    primary key then an empty list is returned.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;foreign_key_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;foreign_key_info( $pk_catalog, $pk_schema, $pk_table
                               , $fk_catalog, $fk_schema, $fk_table );
  $sth = $dbh-&gt;foreign_key_info( $pk_catalog, $pk_schema, $pk_table
                               , $fk_catalog, $fk_schema, $fk_table
                               , \%attr );
  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc
</pre>
<p class="Pp">Returns an active statement handle that can be used to fetch
    information about foreign keys in and/or referencing the specified table(s).
    The arguments don't accept search patterns (unlike <b>table_info()</b>).</p>
<p class="Pp"><span class="Li">$pk_catalog</span>,
    <span class="Li">$pk_schema</span>, <span class="Li">$pk_table</span>
    identify the primary (unique) key table (<b>PKT</b>).</p>
<p class="Pp"><span class="Li">$fk_catalog</span>,
    <span class="Li">$fk_schema</span>, <span class="Li">$fk_table</span>
    identify the foreign key table (<b>FKT</b>).</p>
<p class="Pp">If both <b>PKT</b> and <b>FKT</b> are given, the function returns
    the foreign key, if any, in table <b>FKT</b> that refers to the primary
    (unique) key of table <b>PKT</b>. (Note: In SQL/CLI, the result is
    implementation-defined.)</p>
<p class="Pp">If only <b>PKT</b> is given, then the result set contains the
    primary key of that table and all foreign keys that refer to it.</p>
<p class="Pp">If only <b>FKT</b> is given, then the result set contains all
    foreign keys in that table and the primary keys to which they refer. (Note:
    In SQL/CLI, the result includes unique keys too.)</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;foreign_key_info( undef, $user, 'master');
  $sth = $dbh-&gt;foreign_key_info( undef, undef,   undef , undef, $user, 'detail');
  $sth = $dbh-&gt;foreign_key_info( undef, $user, 'master', undef, $user, 'detail');
  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc
</pre>
<p class="Pp">Note: The support for the selection criteria, such as
    <span class="Li">$catalog</span>, is driver specific. If the driver doesn't
    support catalogs and/or schemas, it may ignore these criteria.</p>
<p class="Pp">The statement handle returned has the following fields in the
    order shown below. Because ODBC never includes unique keys, they define
    different columns in the result set than SQL/CLI. SQL/CLI column names are
    shown in parentheses.</p>
<p class="Pp"><b>PKTABLE_CAT ( UK_TABLE_CAT )</b>: The primary (unique) key
    table catalog identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, which is often the case. This field is empty if not applicable to
    the table.</p>
<p class="Pp"><b>PKTABLE_SCHEM ( UK_TABLE_SCHEM )</b>: The primary (unique) key
    table schema identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, and empty if not applicable to the table.</p>
<p class="Pp"><b>PKTABLE_NAME ( UK_TABLE_NAME )</b>: The primary (unique) key
    table identifier.</p>
<p class="Pp"><b>PKCOLUMN_NAME (UK_COLUMN_NAME )</b>: The primary (unique) key
    column identifier.</p>
<p class="Pp"><b>FKTABLE_CAT ( FK_TABLE_CAT )</b>: The foreign key table catalog
    identifier. This field is NULL (<span class="Li">&quot;undef&quot;</span>)
    if not applicable to the data source, which is often the case. This field is
    empty if not applicable to the table.</p>
<p class="Pp"><b>FKTABLE_SCHEM ( FK_TABLE_SCHEM )</b>: The foreign key table
    schema identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, and empty if not applicable to the table.</p>
<p class="Pp"><b>FKTABLE_NAME ( FK_TABLE_NAME )</b>: The foreign key table
    identifier.</p>
<p class="Pp"><b>FKCOLUMN_NAME ( FK_COLUMN_NAME )</b>: The foreign key column
    identifier.</p>
<p class="Pp"><b>KEY_SEQ ( ORDINAL_POSITION )</b>: The column sequence number
    (starting with 1).</p>
<p class="Pp"><b>UPDATE_RULE ( UPDATE_RULE )</b>: The referential action for the
    UPDATE rule. The following codes are defined:</p>
<p class="Pp"></p>
<pre>  CASCADE              0
  RESTRICT             1
  SET NULL             2
  NO ACTION            3
  SET DEFAULT          4
</pre>
<p class="Pp"><b>DELETE_RULE ( DELETE_RULE )</b>: The referential action for the
    DELETE rule. The codes are the same as for UPDATE_RULE.</p>
<p class="Pp"><b>FK_NAME ( FK_NAME )</b>: The foreign key name.</p>
<p class="Pp"><b>PK_NAME ( UK_NAME )</b>: The primary (unique) key name.</p>
<p class="Pp"><b>DEFERRABILITY ( DEFERABILITY )</b>: The deferrability of the
    foreign key constraint. The following codes are defined:</p>
<p class="Pp"></p>
<pre>  INITIALLY DEFERRED   5
  INITIALLY IMMEDIATE  6
  NOT DEFERRABLE       7
</pre>
<p class="Pp"><b> ( UNIQUE_OR_PRIMARY )</b>: This column is necessary if a
    driver includes all candidate (i.e. primary and alternate) keys in the
    result set (as specified by SQL/CLI). The value of this column is UNIQUE if
    the foreign key references an alternate key and PRIMARY if the foreign key
    references a primary key, or it may be undefined if the driver doesn't have
    access to the information.</p>
<p class="Pp">See also &quot;Catalog Methods&quot; and &quot;Standards Reference
    Information&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;statistics_info&quot;</i></span><i></i></p>
<p class="Pp"><b>Warning:</b> This method is experimental and may change.</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;statistics_info( $catalog, $schema, $table, $unique_only, $quick );
  # then $sth-&gt;fetchall_arrayref or $sth-&gt;fetchall_hashref etc
</pre>
<p class="Pp">Returns an active statement handle that can be used to fetch
    statistical information about a table and its indexes.</p>
<p class="Pp">The arguments don't accept search patterns (unlike
    &quot;table_info&quot;).</p>
<p class="Pp">If the boolean argument <span class="Li">$unique_only</span> is
    true, only UNIQUE indexes will be returned in the result set, otherwise all
    indexes will be returned.</p>
<p class="Pp">If the boolean argument <span class="Li">$quick</span> is set, the
    actual statistical information columns (CARDINALITY and PAGES) will only be
    returned if they are readily available from the server, and might not be
    current. Some databases may return stale statistics or no statistics at all
    with this flag set.</p>
<p class="Pp">The statement handle will return at most one row per column name
    per index, plus at most one row for the entire table itself, ordered by
    NON_UNIQUE, TYPE, INDEX_QUALIFIER, INDEX_NAME, and ORDINAL_POSITION.</p>
<p class="Pp">Note: The support for the selection criteria, such as
    <span class="Li">$catalog</span>, is driver specific. If the driver doesn't
    support catalogs and/or schemas, it may ignore these criteria.</p>
<p class="Pp">The statement handle returned has at least the following fields in
    the order shown below. Other fields, after these, may also be present.</p>
<p class="Pp"><b>TABLE_CAT</b>: The catalog identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, which is often the case. This field is empty if not applicable to
    the table.</p>
<p class="Pp"><b>TABLE_SCHEM</b>: The schema identifier. This field is NULL
    (<span class="Li">&quot;undef&quot;</span>) if not applicable to the data
    source, and empty if not applicable to the table.</p>
<p class="Pp"><b>TABLE_NAME</b>: The table identifier.</p>
<p class="Pp"><b>NON_UNIQUE</b>: Unique index indicator. Returns 0 for unique
    indexes, 1 for non-unique indexes</p>
<p class="Pp"><b>INDEX_QUALIFIER</b>: Index qualifier identifier. The identifier
    that is used to qualify the index name when doing a
    <span class="Li">&quot;DROP INDEX&quot;</span>; NULL
    (<span class="Li">&quot;undef&quot;</span>) is returned if an index
    qualifier is not supported by the data source. If a non-NULL (defined) value
    is returned in this column, it must be used to qualify the index name on a
    <span class="Li">&quot;DROP INDEX&quot;</span> statement; otherwise, the
    TABLE_SCHEM should be used to qualify the index name.</p>
<p class="Pp"><b>INDEX_NAME</b>: The index identifier.</p>
<p class="Pp"><b>TYPE</b>: The type of information being returned. Can be any of
    the following values: 'table', 'btree', 'clustered', 'content', 'hashed', or
    'other'.</p>
<p class="Pp">In the case that this field is 'table', all fields other than
    TABLE_CAT, TABLE_SCHEM, TABLE_NAME, TYPE, CARDINALITY, and PAGES will be
    NULL (<span class="Li">&quot;undef&quot;</span>).</p>
<p class="Pp"><b>ORDINAL_POSITION</b>: Column sequence number (starting with
  1).</p>
<p class="Pp"><b>COLUMN_NAME</b>: The column identifier.</p>
<p class="Pp"><b>ASC_OR_DESC</b>: Column sort sequence.
    <span class="Li">&quot;A&quot;</span> for Ascending,
    <span class="Li">&quot;D&quot;</span> for Descending, or NULL
    (<span class="Li">&quot;undef&quot;</span>) if not supported for this
  index.</p>
<p class="Pp"><b>CARDINALITY</b>: Cardinality of the table or index. For
    indexes, this is the number of unique values in the index. For tables, this
    is the number of rows in the table. If not supported, the value will be NULL
    (<span class="Li">&quot;undef&quot;</span>).</p>
<p class="Pp"><b>PAGES</b>: Number of storage pages used by this table or index.
    If not supported, the value will be NULL
    (<span class="Li">&quot;undef&quot;</span>).</p>
<p class="Pp"><b>FILTER_CONDITION</b>: The index filter condition as a string.
    If the index is not a filtered index, or it cannot be determined whether the
    index is a filtered index, this value is NULL
    (<span class="Li">&quot;undef&quot;</span>). If the index is a filtered
    index, but the filter condition cannot be determined, this value is the
    empty string <span class="Li">''</span>. Otherwise it will be the literal
    filter condition as a string, such as <span class="Li">&quot;SALARY &lt;=
    4500&quot;</span>.</p>
<p class="Pp">See also &quot;Catalog Methods&quot; and &quot;Standards Reference
    Information&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;tables&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @names = $dbh-&gt;tables( $catalog, $schema, $table, $type );
  @names = $dbh-&gt;tables;        # deprecated
</pre>
<p class="Pp">Simple interface to <b>table_info()</b>. Returns a list of
    matching table names, possibly including a catalog/schema prefix.</p>
<p class="Pp">See &quot;table_info&quot; for a description of the
  parameters.</p>
<p class="Pp">If <span class="Li">&quot;$dbh-&gt;get_info(29)&quot;</span>
    returns true (29 is SQL_IDENTIFIER_QUOTE_CHAR) then the table names are
    constructed and quoted by &quot;quote_identifier&quot; to ensure they are
    usable even if they contain whitespace or reserved words etc. This means
    that the table names returned will include quote characters.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;type_info_all&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $type_info_all = $dbh-&gt;type_info_all;
</pre>
<p class="Pp">Returns a reference to an array which holds information about each
    data type variant supported by the database and driver. The array and its
    contents should be treated as read-only.</p>
<p class="Pp">The first item is a reference to an 'index' hash of
    <span class="Li">&quot;Name =&quot;</span>&gt;
    <span class="Li">&quot;Index&quot;</span> pairs. The items following that
    are references to arrays, one per supported data type variant. The leading
    index hash defines the names and order of the fields within the arrays that
    follow it. For example:</p>
<p class="Pp"></p>
<pre>  $type_info_all = [
    {   TYPE_NAME         =&gt; 0,
        DATA_TYPE         =&gt; 1,
        COLUMN_SIZE       =&gt; 2,     # was PRECISION originally
        LITERAL_PREFIX    =&gt; 3,
        LITERAL_SUFFIX    =&gt; 4,
        CREATE_PARAMS     =&gt; 5,
        NULLABLE          =&gt; 6,
        CASE_SENSITIVE    =&gt; 7,
        SEARCHABLE        =&gt; 8,
        UNSIGNED_ATTRIBUTE=&gt; 9,
        FIXED_PREC_SCALE  =&gt; 10,    # was MONEY originally
        AUTO_UNIQUE_VALUE =&gt; 11,    # was AUTO_INCREMENT originally
        LOCAL_TYPE_NAME   =&gt; 12,
        MINIMUM_SCALE     =&gt; 13,
        MAXIMUM_SCALE     =&gt; 14,
        SQL_DATA_TYPE     =&gt; 15,
        SQL_DATETIME_SUB  =&gt; 16,
        NUM_PREC_RADIX    =&gt; 17,
        INTERVAL_PRECISION=&gt; 18,
    },
    [ 'VARCHAR', SQL_VARCHAR,
        undef, &quot;'&quot;,&quot;'&quot;, undef,0, 1,1,0,0,0,undef,1,255, undef
    ],
    [ 'INTEGER', SQL_INTEGER,
        undef,  &quot;&quot;, &quot;&quot;, undef,0, 0,1,0,0,0,undef,0,  0, 10
    ],
  ];
</pre>
<p class="Pp">More than one row may have the same value in the
    <span class="Li">&quot;DATA_TYPE&quot;</span> field if there are different
    ways to spell the type name and/or there are variants of the type with
    different attributes (e.g., with and without
    <span class="Li">&quot;AUTO_UNIQUE_VALUE&quot;</span> set, with and without
    <span class="Li">&quot;UNSIGNED_ATTRIBUTE&quot;</span>, etc).</p>
<p class="Pp">The rows are ordered by
    <span class="Li">&quot;DATA_TYPE&quot;</span> first and then by how closely
    each type maps to the corresponding ODBC SQL data type, closest first.</p>
<p class="Pp">The meaning of the fields is described in the documentation for
    the &quot;type_info&quot; method.</p>
<p class="Pp">An 'index' hash is provided so you don't need to rely on index
    values defined above. However, using DBD::ODBC with some old ODBC drivers
    may return older names, shown as comments in the example above. Another
    issue with the index hash is that the lettercase of the keys is not defined.
    It is usually uppercase, as show here, but drivers may return names with any
    lettercase.</p>
<p class="Pp">Drivers are also free to return extra driver-specific columns of
    information - though it's recommended that they start at column index 50 to
    leave room for expansion of the DBI/ODBC specification.</p>
<p class="Pp">The <b>type_info_all()</b> method is not normally used directly.
    The &quot;type_info&quot; method provides a more usable and useful interface
    to the data.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;type_info&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  @type_info = $dbh-&gt;type_info($data_type);
</pre>
<p class="Pp">Returns a list of hash references holding information about one or
    more variants of <span class="Li">$data_type</span>. The list is ordered by
    <span class="Li">&quot;DATA_TYPE&quot;</span> first and then by how closely
    each type maps to the corresponding ODBC SQL data type, closest first. If
    called in a scalar context then only the first (best) element is
  returned.</p>
<p class="Pp">If <span class="Li">$data_type</span> is undefined or
    <span class="Li">&quot;SQL_ALL_TYPES&quot;</span>, then the list will
    contain hashes for all data type variants supported by the database and
    driver.</p>
<p class="Pp">If <span class="Li">$data_type</span> is an array reference then
    <span class="Li">&quot;type_info&quot;</span> returns the information for
    the <i>first</i> type in the array that has any matches.</p>
<p class="Pp">The keys of the hash follow the same letter case conventions as
    the rest of the DBI (see &quot;Naming Conventions and Name Space&quot;). The
    following uppercase items should always exist, though may be undef:</p>
<dl class="Bl-tag">
  <dt id="TYPE_NAME"><a class="permalink" href="#TYPE_NAME">TYPE_NAME
    (string)</a></dt>
  <dd>Data type name for use in CREATE TABLE statements etc.</dd>
  <dt id="DATA_TYPE"><a class="permalink" href="#DATA_TYPE">DATA_TYPE
    (integer)</a></dt>
  <dd>SQL data type number.</dd>
  <dt id="COLUMN_SIZE"><a class="permalink" href="#COLUMN_SIZE">COLUMN_SIZE
    (integer)</a></dt>
  <dd>For numeric types, this is either the total number of digits (if the
      NUM_PREC_RADIX value is 10) or the total number of bits allowed in the
      column (if NUM_PREC_RADIX is 2).
    <p class="Pp">For string types, this is the maximum size of the string in
        characters.</p>
    <p class="Pp">For date and interval types, this is the maximum number of
        characters needed to display the value.</p>
  </dd>
  <dt id="LITERAL_PREFIX"><a class="permalink" href="#LITERAL_PREFIX">LITERAL_PREFIX
    (string)</a></dt>
  <dd>Characters used to prefix a literal. A typical prefix is
      &quot;<span class="Li">&quot;'&quot;</span>&quot; for characters, or
      possibly &quot;<span class="Li">&quot;0x&quot;</span>&quot; for binary
      values passed as hexadecimal. NULL
      (<span class="Li">&quot;undef&quot;</span>) is returned for data types for
      which this is not applicable.</dd>
  <dt id="LITERAL_SUFFIX"><a class="permalink" href="#LITERAL_SUFFIX">LITERAL_SUFFIX
    (string)</a></dt>
  <dd>Characters used to suffix a literal. Typically
      &quot;<span class="Li">&quot;'&quot;</span>&quot; for characters. NULL
      (<span class="Li">&quot;undef&quot;</span>) is returned for data types
      where this is not applicable.</dd>
  <dt id="CREATE_PARAMS"><a class="permalink" href="#CREATE_PARAMS">CREATE_PARAMS
    (string)</a></dt>
  <dd>Parameter names for data type definition. For example,
      <span class="Li">&quot;CREATE_PARAMS&quot;</span> for a
      <span class="Li">&quot;DECIMAL&quot;</span> would be
      &quot;<span class="Li">&quot;precision,scale&quot;</span>&quot; if the
      DECIMAL type should be declared as
      <span class="Li">&quot;DECIMAL(&quot;</span><i>precision,scale</i><span class="Li">&quot;)&quot;</span>
      where <i>precision</i> and <i>scale</i> are integer values. For a
      <span class="Li">&quot;VARCHAR&quot;</span> it would be
      &quot;<span class="Li">&quot;max length&quot;</span>&quot;. NULL
      (<span class="Li">&quot;undef&quot;</span>) is returned for data types for
      which this is not applicable.</dd>
  <dt id="NULLABLE"><a class="permalink" href="#NULLABLE">NULLABLE
    (integer)</a></dt>
  <dd>Indicates whether the data type accepts a NULL value:
      <span class="Li">0</span> or an empty string = no,
      <span class="Li">1</span> = yes, <span class="Li">2</span> = unknown.</dd>
  <dt id="CASE_SENSITIVE"><a class="permalink" href="#CASE_SENSITIVE">CASE_SENSITIVE
    (boolean)</a></dt>
  <dd>Indicates whether the data type is case sensitive in collations and
      comparisons.</dd>
  <dt id="SEARCHABLE"><a class="permalink" href="#SEARCHABLE">SEARCHABLE
    (integer)</a></dt>
  <dd>Indicates how the data type can be used in a WHERE clause, as follows:
    <p class="Pp"></p>
    <pre>  0 - Cannot be used in a WHERE clause
  1 - Only with a LIKE predicate
  2 - All comparison operators except LIKE
  3 - Can be used in a WHERE clause with any comparison operator
    </pre>
  </dd>
  <dt id="UNSIGNED_ATTRIBUTE"><a class="permalink" href="#UNSIGNED_ATTRIBUTE">UNSIGNED_ATTRIBUTE
    (boolean)</a></dt>
  <dd>Indicates whether the data type is unsigned. NULL
      (<span class="Li">&quot;undef&quot;</span>) is returned for data types for
      which this is not applicable.</dd>
  <dt id="FIXED_PREC_SCALE"><a class="permalink" href="#FIXED_PREC_SCALE">FIXED_PREC_SCALE
    (boolean)</a></dt>
  <dd>Indicates whether the data type always has the same precision and scale
      (such as a money type). NULL (<span class="Li">&quot;undef&quot;</span>)
      is returned for data types for which this is not applicable.</dd>
  <dt id="AUTO_UNIQUE_VALUE"><a class="permalink" href="#AUTO_UNIQUE_VALUE">AUTO_UNIQUE_VALUE
    (boolean)</a></dt>
  <dd>Indicates whether a column of this data type is automatically set to a
      unique value whenever a new row is inserted. NULL
      (<span class="Li">&quot;undef&quot;</span>) is returned for data types for
      which this is not applicable.</dd>
  <dt id="LOCAL_TYPE_NAME"><a class="permalink" href="#LOCAL_TYPE_NAME">LOCAL_TYPE_NAME
    (string)</a></dt>
  <dd>Localized version of the <span class="Li">&quot;TYPE_NAME&quot;</span> for
      use in dialog with users. NULL (<span class="Li">&quot;undef&quot;</span>)
      is returned if a localized name is not available (in which case
      <span class="Li">&quot;TYPE_NAME&quot;</span> should be used).</dd>
  <dt id="MINIMUM_SCALE"><a class="permalink" href="#MINIMUM_SCALE">MINIMUM_SCALE
    (integer)</a></dt>
  <dd>The minimum scale of the data type. If a data type has a fixed scale, then
      <span class="Li">&quot;MAXIMUM_SCALE&quot;</span> holds the same value.
      NULL (<span class="Li">&quot;undef&quot;</span>) is returned for data
      types for which this is not applicable.</dd>
  <dt id="MAXIMUM_SCALE"><a class="permalink" href="#MAXIMUM_SCALE">MAXIMUM_SCALE
    (integer)</a></dt>
  <dd>The maximum scale of the data type. If a data type has a fixed scale, then
      <span class="Li">&quot;MINIMUM_SCALE&quot;</span> holds the same value.
      NULL (<span class="Li">&quot;undef&quot;</span>) is returned for data
      types for which this is not applicable.</dd>
  <dt id="SQL_DATA_TYPE"><a class="permalink" href="#SQL_DATA_TYPE">SQL_DATA_TYPE
    (integer)</a></dt>
  <dd>This column is the same as the
      <span class="Li">&quot;DATA_TYPE&quot;</span> column, except for interval
      and datetime data types. For interval and datetime data types, the
      <span class="Li">&quot;SQL_DATA_TYPE&quot;</span> field will return
      <span class="Li">&quot;SQL_INTERVAL&quot;</span> or
      <span class="Li">&quot;SQL_DATETIME&quot;</span>, and the
      <span class="Li">&quot;SQL_DATETIME_SUB&quot;</span> field below will
      return the subcode for the specific interval or datetime data type. If
      this field is NULL, then the driver does not support or report on interval
      or datetime subtypes.</dd>
  <dt id="SQL_DATETIME_SUB"><a class="permalink" href="#SQL_DATETIME_SUB">SQL_DATETIME_SUB
    (integer)</a></dt>
  <dd>For interval or datetime data types, where the
      <span class="Li">&quot;SQL_DATA_TYPE&quot;</span> field above is
      <span class="Li">&quot;SQL_INTERVAL&quot;</span> or
      <span class="Li">&quot;SQL_DATETIME&quot;</span>, this field will hold the
      <i>subcode</i> for the specific interval or datetime data type. Otherwise
      it will be NULL (<span class="Li">&quot;undef&quot;</span>).
    <p class="Pp">Although not mentioned explicitly in the standards, it seems
        there is a simple relationship between these values:</p>
    <p class="Pp"></p>
    <pre>  DATA_TYPE == (10 * SQL_DATA_TYPE) + SQL_DATETIME_SUB
    </pre>
  </dd>
  <dt id="NUM_PREC_RADIX"><a class="permalink" href="#NUM_PREC_RADIX">NUM_PREC_RADIX
    (integer)</a></dt>
  <dd>The radix value of the data type. For approximate numeric types,
      <span class="Li">&quot;NUM_PREC_RADIX&quot;</span> contains the value 2
      and <span class="Li">&quot;COLUMN_SIZE&quot;</span> holds the number of
      bits. For exact numeric types,
      <span class="Li">&quot;NUM_PREC_RADIX&quot;</span> contains the value 10
      and <span class="Li">&quot;COLUMN_SIZE&quot;</span> holds the number of
      decimal digits. NULL (<span class="Li">&quot;undef&quot;</span>) is
      returned either for data types for which this is not applicable or if the
      driver cannot report this information.</dd>
  <dt id="INTERVAL_PRECISION"><a class="permalink" href="#INTERVAL_PRECISION">INTERVAL_PRECISION
    (integer)</a></dt>
  <dd>The interval leading precision for interval types. NULL is returned either
      for data types for which this is not applicable or if the driver cannot
      report this information.</dd>
</dl>
<p class="Pp">For example, to find the type name for the fields in a select
    statement you can do:</p>
<p class="Pp"></p>
<pre>  @names = map { scalar $dbh-&gt;type_info($_)-&gt;{TYPE_NAME} } @{ $sth-&gt;{TYPE} }
</pre>
<p class="Pp">Since DBI and ODBC drivers vary in how they map their types into
    the ISO standard types you may need to search for more than one type. Here's
    an example looking for a usable type to store a date:</p>
<p class="Pp"></p>
<pre>  $my_date_type = $dbh-&gt;type_info( [ SQL_DATE, SQL_TIMESTAMP ] );
</pre>
<p class="Pp">Similarly, to more reliably find a type to store small integers,
    you could use a list starting with
    <span class="Li">&quot;SQL_SMALLINT&quot;</span>,
    <span class="Li">&quot;SQL_INTEGER&quot;</span>,
    <span class="Li">&quot;SQL_DECIMAL&quot;</span>, etc.</p>
<p class="Pp">See also &quot;Standards Reference Information&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;quote&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sql = $dbh-&gt;quote($value);
  $sql = $dbh-&gt;quote($value, $data_type);
</pre>
<p class="Pp">Quote a string literal for use as a literal value in an SQL
    statement, by escaping any special characters (such as quotation marks)
    contained within the string and adding the required type of outer quotation
    marks.</p>
<p class="Pp"></p>
<pre>  $sql = sprintf &quot;SELECT foo FROM bar WHERE baz = %s&quot;,
                $dbh-&gt;quote(&quot;Don't&quot;);
</pre>
<p class="Pp">For most database types, at least those that conform to SQL
    standards, quote would return <span class="Li">'Don''t'</span> (including
    the outer quotation marks). For others it may return something like
    <span class="Li">'Don\'t'</span></p>
<p class="Pp">An undefined <span class="Li">$value</span> value will be returned
    as the string <span class="Li">&quot;NULL&quot;</span> (without single
    quotation marks) to match how NULLs are represented in SQL.</p>
<p class="Pp">If <span class="Li">$data_type</span> is supplied, it is used to
    try to determine the required quoting behaviour by using the information
    returned by &quot;type_info&quot;. As a special case, the standard numeric
    types are optimized to return <span class="Li">$value</span> without calling
    <span class="Li">&quot;type_info&quot;</span>.</p>
<p class="Pp">Quote will probably <i>not</i> be able to deal with all possible
    input (such as binary data or data containing newlines), and is not related
    in any way with escaping or quoting shell meta-characters.</p>
<p class="Pp">It is valid for the <b>quote()</b> method to return an SQL
    expression that evaluates to the desired string. For example:</p>
<p class="Pp"></p>
<pre>  $quoted = $dbh-&gt;quote(&quot;one\ntwo\0three&quot;)
</pre>
<p class="Pp">may return something like:</p>
<p class="Pp"></p>
<pre>  CONCAT('one', CHAR(12), 'two', CHAR(0), 'three')
</pre>
<p class="Pp">The <b>quote()</b> method should <i>not</i> be used with
    &quot;Placeholders and Bind Values&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;quote_identifier&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sql = $dbh-&gt;quote_identifier( $name );
  $sql = $dbh-&gt;quote_identifier( $catalog, $schema, $table, \%attr );
</pre>
<p class="Pp">Quote an identifier (table name etc.) for use in an SQL statement,
    by escaping any special characters (such as double quotation marks) it
    contains and adding the required type of outer quotation marks.</p>
<p class="Pp">Undefined names are ignored and the remainder are quoted and then
    joined together, typically with a dot
    (<span class="Li">&quot;.&quot;</span>) character. For example:</p>
<p class="Pp"></p>
<pre>  $id = $dbh-&gt;quote_identifier( undef, 'Her schema', 'My table' );
</pre>
<p class="Pp">would, for most database types, return <span class="Li">&quot;Her
    schema&quot;.&quot;My table&quot;</span> (including all the double quotation
    marks).</p>
<p class="Pp">If three names are supplied then the first is assumed to be a
    catalog name and special rules may be applied based on what
    &quot;get_info&quot; returns for SQL_CATALOG_NAME_SEPARATOR (41) and
    SQL_CATALOG_LOCATION (114). For example, for Oracle:</p>
<p class="Pp"></p>
<pre>  $id = $dbh-&gt;quote_identifier( 'link', 'schema', 'table' );
</pre>
<p class="Pp">would return
    <span class="Li">&quot;schema&quot;.&quot;table&quot;@&quot;link&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;take_imp_data&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $imp_data = $dbh-&gt;take_imp_data;
</pre>
<p class="Pp">Leaves the <span class="Li">$dbh</span> in an almost dead,
    zombie-like, state and returns a binary string of raw implementation data
    from the driver which describes the current database connection. Effectively
    it detaches the underlying database API connection data from the DBI handle.
    After calling <b>take_imp_data()</b>, all other methods except
    <span class="Li">&quot;DESTROY&quot;</span> will generate a warning and
    return undef.</p>
<p class="Pp">Why would you want to do this? You don't, forget I even mentioned
    it. Unless, that is, you're implementing something advanced like a
    multi-threaded connection pool. See DBI::Pool.</p>
<p class="Pp">The returned <span class="Li">$imp_data</span> can be passed as a
    <span class="Li">&quot;dbi_imp_data&quot;</span> attribute to a later
    <b>connect()</b> call, even in a separate thread in the same process, where
    the driver can use it to 'adopt' the existing connection that the
    implementation data was taken from.</p>
<p class="Pp">Some things to keep in mind...</p>
<p class="Pp"><b>*</b> the <span class="Li">$imp_data</span> holds the only
    reference to the underlying database API connection data. That connection is
    still 'live' and won't be cleaned up properly unless the
    <span class="Li">$imp_data</span> is used to create a new
    <span class="Li">$dbh</span> which is then allowed to <b>disconnect()</b>
    normally.</p>
<p class="Pp"><b>*</b> using the same <span class="Li">$imp_data</span> to
    create more than one other new <span class="Li">$dbh</span> at a time may
    well lead to unpleasant problems. Don't do that.</p>
<p class="Pp">Any child statement handles are effectively destroyed when
    <b>take_imp_data()</b> is called.</p>
<p class="Pp">The <span class="Li">&quot;take_imp_data&quot;</span> method was
    added in DBI 1.36 but wasn't useful till 1.49.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Database_Handle_Attributes"><a class="permalink" href="#Database_Handle_Attributes">Database
  Handle Attributes</a></h2>
<p class="Pp">This section describes attributes specific to database
  handles.</p>
<p class="Pp">Changes to these database handle attributes do not affect any
    other existing or future database handles.</p>
<p class="Pp">Attempting to set or get the value of an unknown attribute
    generates a warning, except for private driver-specific attributes (which
    all have names starting with a lowercase letter).</p>
<p class="Pp">Example:</p>
<p class="Pp"></p>
<pre>  $h-&gt;{AutoCommit} = ...;       # set/write
  ... = $h-&gt;{AutoCommit};       # get/read
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;AutoCommit&quot;</i></span><i></i></p>
<p class="Pp">Type: boolean</p>
<p class="Pp">If true, then database changes cannot be rolled-back (undone). If
    false, then database changes automatically occur within a
    &quot;transaction&quot;, which must either be committed or rolled back using
    the <span class="Li">&quot;commit&quot;</span> or
    <span class="Li">&quot;rollback&quot;</span> methods.</p>
<p class="Pp">Drivers should always default to
    <span class="Li">&quot;AutoCommit&quot;</span> mode (an unfortunate choice
    largely forced on the DBI by ODBC and JDBC conventions.)</p>
<p class="Pp">Attempting to set <span class="Li">&quot;AutoCommit&quot;</span>
    to an unsupported value is a fatal error. This is an important feature of
    the DBI. Applications that need full transaction behaviour can set
    <span class="Li">&quot;$dbh-&gt;{AutoCommit} = 0&quot;</span> (or set
    <span class="Li">&quot;AutoCommit&quot;</span> to 0 via &quot;connect&quot;)
    without having to check that the value was assigned successfully.</p>
<p class="Pp">For the purposes of this description, we can divide databases into
    three categories:</p>
<p class="Pp"></p>
<pre>  Databases which don't support transactions at all.
  Databases in which a transaction is always active.
  Databases in which a transaction must be explicitly started (C&lt;'BEGIN WORK'&gt;).
</pre>
<p class="Pp"><b>* Databases which don't support transactions at all</b></p>
<p class="Pp">For these databases, attempting to turn
    <span class="Li">&quot;AutoCommit&quot;</span> off is a fatal error.
    <span class="Li">&quot;commit&quot;</span> and
    <span class="Li">&quot;rollback&quot;</span> both issue warnings about being
    ineffective while <span class="Li">&quot;AutoCommit&quot;</span> is in
    effect.</p>
<p class="Pp"><b>* Databases in which a transaction is always active</b></p>
<p class="Pp">These are typically mainstream commercial relational databases
    with &quot;ANSI standard&quot; transaction behaviour. If
    <span class="Li">&quot;AutoCommit&quot;</span> is off, then changes to the
    database won't have any lasting effect unless &quot;commit&quot; is called
    (but see also &quot;disconnect&quot;). If &quot;rollback&quot; is called
    then any changes since the last commit are undone.</p>
<p class="Pp">If <span class="Li">&quot;AutoCommit&quot;</span> is on, then the
    effect is the same as if the DBI called
    <span class="Li">&quot;commit&quot;</span> automatically after every
    successful database operation. So calling
    <span class="Li">&quot;commit&quot;</span> or
    <span class="Li">&quot;rollback&quot;</span> explicitly while
    <span class="Li">&quot;AutoCommit&quot;</span> is on would be ineffective
    because the changes would have already been committed.</p>
<p class="Pp">Changing <span class="Li">&quot;AutoCommit&quot;</span> from off
    to on will trigger a &quot;commit&quot;.</p>
<p class="Pp">For databases which don't support a specific auto-commit mode, the
    driver has to commit each statement automatically using an explicit
    <span class="Li">&quot;COMMIT&quot;</span> after it completes successfully
    (and roll it back using an explicit
    <span class="Li">&quot;ROLLBACK&quot;</span> if it fails). The error
    information reported to the application will correspond to the statement
    which was executed, unless it succeeded and the commit or rollback
  failed.</p>
<p class="Pp"><b>* Databases in which a transaction must be explicitly
    started</b></p>
<p class="Pp">For these databases, the intention is to have them act like
    databases in which a transaction is always active (as described above).</p>
<p class="Pp">To do this, the driver will automatically begin an explicit
    transaction when <span class="Li">&quot;AutoCommit&quot;</span> is turned
    off, or after a &quot;commit&quot; or &quot;rollback&quot; (or when the
    application issues the next database operation after one of those
  events).</p>
<p class="Pp">In this way, the application does not have to treat these
    databases as a special case.</p>
<p class="Pp">See &quot;commit&quot;, &quot;disconnect&quot; and
    &quot;Transactions&quot; for other important notes about transactions.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Driver&quot;</i></span><i></i></p>
<p class="Pp">Type: handle</p>
<p class="Pp">Holds the handle of the parent driver. The only recommended use
    for this is to find the name of the driver using:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{Driver}-&gt;{Name}
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;Name&quot;</i></span><i></i></p>
<p class="Pp">Type: string</p>
<p class="Pp">Holds the &quot;name&quot; of the database. Usually (and
    recommended to be) the same as the
    &quot;<span class="Li">&quot;dbi:DriverName:...&quot;</span>&quot; string
    used to connect to the database, but with the leading
    &quot;<span class="Li">&quot;dbi:DriverName:&quot;</span>&quot; removed.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Statement&quot;</i></span><i></i></p>
<p class="Pp">Type: string, read-only</p>
<p class="Pp">Returns the statement string passed to the most recent
    &quot;prepare&quot; or &quot;do&quot; method called in this database handle,
    even if that method failed. This is especially useful where
    <span class="Li">&quot;RaiseError&quot;</span> is enabled and the exception
    handler checks $@ and sees that a 'prepare' method call failed.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;RowCacheSize&quot;</i></span><i></i></p>
<p class="Pp">Type: integer</p>
<p class="Pp">A hint to the driver indicating the size of the local row cache
    that the application would like the driver to use for future
    <span class="Li">&quot;SELECT&quot;</span> statements. If a row cache is not
    implemented, then setting <span class="Li">&quot;RowCacheSize&quot;</span>
    is ignored and getting the value returns
    <span class="Li">&quot;undef&quot;</span>.</p>
<p class="Pp">Some <span class="Li">&quot;RowCacheSize&quot;</span> values have
    special meaning, as follows:</p>
<p class="Pp"></p>
<pre>  0 - Automatically determine a reasonable cache size for each C&lt;SELECT&gt;
  1 - Disable the local row cache
 &gt;1 - Cache this many rows
 &lt;0 - Cache as many rows that will fit into this much memory for each C&lt;SELECT&gt;.
</pre>
<p class="Pp">Note that large cache sizes may require a very large amount of
    memory (<i>cached rows * maximum size of row</i>). Also, a large cache will
    cause a longer delay not only for the first fetch, but also whenever the
    cache needs refilling.</p>
<p class="Pp">See also the &quot;RowsInCache&quot; statement handle
  attribute.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Username&quot;</i></span><i></i></p>
<p class="Pp">Type: string</p>
<p class="Pp">Returns the username used to connect to the database.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DBI_STATEMENT_HANDLE_OBJECTS"><a class="permalink" href="#DBI_STATEMENT_HANDLE_OBJECTS">DBI
  STATEMENT HANDLE OBJECTS</a></h1>
<p class="Pp">This section lists the methods and attributes associated with DBI
    statement handles.</p>
<section class="Ss">
<h2 class="Ss" id="Statement_Handle_Methods"><a class="permalink" href="#Statement_Handle_Methods">Statement
  Handle Methods</a></h2>
<p class="Pp">The DBI defines the following methods for use on DBI statement
    handles:</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;bind_param&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $sth-&gt;bind_param($p_num, $bind_value)
  $sth-&gt;bind_param($p_num, $bind_value, \%attr)
  $sth-&gt;bind_param($p_num, $bind_value, $bind_type)
</pre>
<p class="Pp">The <span class="Li">&quot;bind_param&quot;</span> method takes a
    copy of <span class="Li">$bind_value</span> and associates it (binds it)
    with a placeholder, identified by <span class="Li">$p_num</span>, embedded
    in the prepared statement. Placeholders are indicated with question mark
    character (<span class="Li">&quot;?&quot;</span>). For example:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{RaiseError} = 1;        # save having to check each method call
  $sth = $dbh-&gt;prepare(&quot;SELECT name, age FROM people WHERE name LIKE ?&quot;);
  $sth-&gt;bind_param(1, &quot;John%&quot;);  # placeholders are numbered from 1
  $sth-&gt;execute;
  DBI::dump_results($sth);
</pre>
<p class="Pp">See &quot;Placeholders and Bind Values&quot; for more
  information.</p>
<p class="Pp"><b>Data Types for Placeholders</b></p>
<p class="Pp">The <span class="Li">&quot;\%attr&quot;</span> parameter can be
    used to hint at the data type the placeholder should have. This is rarely
    needed. Typically, the driver is only interested in knowing if the
    placeholder should be bound as a number or a string.</p>
<p class="Pp"></p>
<pre>  $sth-&gt;bind_param(1, $value, { TYPE =&gt; SQL_INTEGER });
</pre>
<p class="Pp">As a short-cut for the common case, the data type can be passed
    directly, in place of the <span class="Li">&quot;\%attr&quot;</span> hash
    reference. This example is equivalent to the one above:</p>
<p class="Pp"></p>
<pre>  $sth-&gt;bind_param(1, $value, SQL_INTEGER);
</pre>
<p class="Pp">The <span class="Li">&quot;TYPE&quot;</span> value indicates the
    standard (non-driver-specific) type for this parameter. To specify the
    driver-specific type, the driver may support a driver-specific attribute,
    such as <span class="Li">&quot;{ ora_type =&gt; 97 }&quot;</span>.</p>
<p class="Pp">The SQL_INTEGER and other related constants can be imported
  using</p>
<p class="Pp"></p>
<pre>  use DBI qw(:sql_types);
</pre>
<p class="Pp">See &quot;DBI Constants&quot; for more information.</p>
<p class="Pp">The data type is 'sticky' in that bind values passed to
    <b>execute()</b> are bound with the data type specified by earlier
    <b>bind_param()</b> calls, if any. Portable applications should not rely on
    being able to change the data type after the first
    <span class="Li">&quot;bind_param&quot;</span> call.</p>
<p class="Pp">Perl only has string and number scalar data types. All database
    types that aren't numbers are bound as strings and must be in a format the
    database will understand except where the <b>bind_param()</b> TYPE attribute
    specifies a type that implies a particular format. For example, given:</p>
<p class="Pp"></p>
<pre>  $sth-&gt;bind_param(1, $value, SQL_DATETIME);
</pre>
<p class="Pp">the driver should expect <span class="Li">$value</span> to be in
    the ODBC standard SQL_DATETIME format, which is 'YYYY-MM-DD HH:MM:SS'.
    Similarly for SQL_DATE, SQL_TIME etc.</p>
<p class="Pp">As an alternative to specifying the data type in the
    <span class="Li">&quot;bind_param&quot;</span> call, you can let the driver
    pass the value as the default type
    (<span class="Li">&quot;VARCHAR&quot;</span>). You can then use an SQL
    function to convert the type within the statement. For example:</p>
<p class="Pp"></p>
<pre>  INSERT INTO price(code, price) VALUES (?, CONVERT(MONEY,?))
</pre>
<p class="Pp">The <span class="Li">&quot;CONVERT&quot;</span> function used here
    is just an example. The actual function and syntax will vary between
    different databases and is non-portable.</p>
<p class="Pp">See also &quot;Placeholders and Bind Values&quot; for more
    information.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;bind_param_inout&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $sth-&gt;bind_param_inout($p_num, \$bind_value, $max_len)  or die $sth-&gt;errstr;
  $rv = $sth-&gt;bind_param_inout($p_num, \$bind_value, $max_len, \%attr)     or ...
  $rv = $sth-&gt;bind_param_inout($p_num, \$bind_value, $max_len, $bind_type) or ...
</pre>
<p class="Pp">This method acts like &quot;bind_param&quot;, but also enables
    values to be updated by the statement. The statement is typically a call to
    a stored procedure. The <span class="Li">$bind_value</span> must be passed
    as a reference to the actual value to be used.</p>
<p class="Pp">Note that unlike &quot;bind_param&quot;, the
    <span class="Li">$bind_value</span> variable is not copied when
    <span class="Li">&quot;bind_param_inout&quot;</span> is called. Instead, the
    value in the variable is read at the time &quot;execute&quot; is called.</p>
<p class="Pp">The additional <span class="Li">$max_len</span> parameter
    specifies the minimum amount of memory to allocate to
    <span class="Li">$bind_value</span> for the new value. If the value returned
    from the database is too big to fit, then the execution should fail. If
    unsure what value to use, pick a generous length, i.e., a length larger than
    the longest value that would ever be returned. The only cost of using a
    larger value than needed is wasted memory.</p>
<p class="Pp">Undefined values or <span class="Li">&quot;undef&quot;</span> are
    used to indicate null values. See also &quot;Placeholders and Bind
    Values&quot; for more information.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;bind_param_array&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $sth-&gt;bind_param_array($p_num, $array_ref_or_value)
  $rc = $sth-&gt;bind_param_array($p_num, $array_ref_or_value, \%attr)
  $rc = $sth-&gt;bind_param_array($p_num, $array_ref_or_value, $bind_type)
</pre>
<p class="Pp">The <span class="Li">&quot;bind_param_array&quot;</span> method is
    used to bind an array of values to a placeholder embedded in the prepared
    statement which is to be executed with &quot;execute_array&quot;. For
    example:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{RaiseError} = 1;        # save having to check each method call
  $sth = $dbh-&gt;prepare(&quot;INSERT INTO staff (first_name, last_name, dept) VALUES(?, ?, ?)&quot;);
  $sth-&gt;bind_param_array(1, [ 'John', 'Mary', 'Tim' ]);
  $sth-&gt;bind_param_array(2, [ 'Booth', 'Todd', 'Robinson' ]);
  $sth-&gt;bind_param_array(3, &quot;SALES&quot;); # scalar will be reused for each row
  $sth-&gt;execute_array( { ArrayTupleStatus =&gt; \my @tuple_status } );
</pre>
<p class="Pp">The <span class="Li">%attr</span> ($bind_type) argument is the
    same as defined for &quot;bind_param&quot;. Refer to &quot;bind_param&quot;
    for general details on using placeholders.</p>
<p class="Pp">(Note that <b>bind_param_array()</b> can <i>not</i> be used to
    expand a placeholder into a list of values for a statement like &quot;SELECT
    foo WHERE bar IN (?)&quot;. A placeholder can only ever represent one value
    per execution.)</p>
<p class="Pp">Scalar values, including
    <span class="Li">&quot;undef&quot;</span>, may also be bound by
    <span class="Li">&quot;bind_param_array&quot;</span>. In which case the same
    value will be used for each &quot;execute&quot; call. Driver-specific
    implementations may behave differently, e.g., when binding to a stored
    procedure call, some databases may permit mixing scalars and arrays as
    arguments.</p>
<p class="Pp">The default implementation provided by DBI (for drivers that have
    not implemented array binding) is to iteratively call &quot;execute&quot;
    for each parameter tuple provided in the bound arrays. Drivers may provide
    more optimized implementations using whatever bulk operation support the
    database API provides. The default driver behaviour should match the default
    DBI behaviour, but always consult your driver documentation as there may be
    driver specific issues to consider.</p>
<p class="Pp">Note that the default implementation currently only supports
    non-data returning statements (INSERT, UPDATE, but not SELECT). Also,
    <span class="Li">&quot;bind_param_array&quot;</span> and
    &quot;bind_param&quot; cannot be mixed in the same statement execution, and
    <span class="Li">&quot;bind_param_array&quot;</span> must be used with
    &quot;execute_array&quot;; using
    <span class="Li">&quot;bind_param_array&quot;</span> will have no effect for
    &quot;execute&quot;.</p>
<p class="Pp">The <span class="Li">&quot;bind_param_array&quot;</span> method
    was added in DBI 1.22.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;execute&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rv = $sth-&gt;execute                or die $sth-&gt;errstr;
  $rv = $sth-&gt;execute(@bind_values)  or die $sth-&gt;errstr;
</pre>
<p class="Pp">Perform whatever processing is necessary to execute the prepared
    statement. An <span class="Li">&quot;undef&quot;</span> is returned if an
    error occurs. A successful <span class="Li">&quot;execute&quot;</span>
    always returns true regardless of the number of rows affected, even if it's
    zero (see below). It is always important to check the return status of
    <span class="Li">&quot;execute&quot;</span> (and most other DBI methods) for
    errors if you're not using &quot;RaiseError&quot;.</p>
<p class="Pp">For a <i>non</i>-<span class="Li">&quot;SELECT&quot;</span>
    statement, <span class="Li">&quot;execute&quot;</span> returns the number of
    rows affected, if known. If no rows were affected, then
    <span class="Li">&quot;execute&quot;</span> returns
    &quot;<span class="Li">0E0</span>&quot;, which Perl will treat as 0 but will
    regard as true. Note that it is <i>not</i> an error for no rows to be
    affected by a statement. If the number of rows affected is not known, then
    <span class="Li">&quot;execute&quot;</span> returns -1.</p>
<p class="Pp">For <span class="Li">&quot;SELECT&quot;</span> statements, execute
    simply &quot;starts&quot; the query within the database engine. Use one of
    the fetch methods to retrieve the data after calling
    <span class="Li">&quot;execute&quot;</span>. The
    <span class="Li">&quot;execute&quot;</span> method does <i>not</i> return
    the number of rows that will be returned by the query (because most
    databases can't tell in advance), it simply returns a true value.</p>
<p class="Pp">You can tell if the statement was a
    <span class="Li">&quot;SELECT&quot;</span> statement by checking if
    <span class="Li">&quot;$sth-&gt;{NUM_OF_FIELDS}&quot;</span> is greater than
    zero after calling <span class="Li">&quot;execute&quot;</span>.</p>
<p class="Pp">If any arguments are given, then
    <span class="Li">&quot;execute&quot;</span> will effectively call
    &quot;bind_param&quot; for each value before executing the statement. Values
    bound in this way are usually treated as
    <span class="Li">&quot;SQL_VARCHAR&quot;</span> types unless the driver can
    determine the correct type (which is rare), or unless
    <span class="Li">&quot;bind_param&quot;</span> (or
    <span class="Li">&quot;bind_param_inout&quot;</span>) has already been used
    to specify the type.</p>
<p class="Pp">Note that passing <span class="Li">&quot;execute&quot;</span> an
    empty array is the same as passing no arguments at all, which will execute
    the statement with previously bound values. That's probably not what you
    want.</p>
<p class="Pp">If <b>execute()</b> is called on a statement handle that's still
    active ($sth-&gt;{Active} is true) then it should effectively call
    <b>finish()</b> to tidy up the previous execution results before starting
    this new execution.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;execute_array&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $tuples = $sth-&gt;execute_array(\%attr) or die $sth-&gt;errstr;
  $tuples = $sth-&gt;execute_array(\%attr, @bind_values) or die $sth-&gt;errstr;
  ($tuples, $rows) = $sth-&gt;execute_array(\%attr) or die $sth-&gt;errstr;
  ($tuples, $rows) = $sth-&gt;execute_array(\%attr, @bind_values) or die $sth-&gt;errstr;
</pre>
<p class="Pp">Execute the prepared statement once for each parameter tuple
    (group of values) provided either in the
    <span class="Li">@bind_values</span>, or by prior calls to
    &quot;bind_param_array&quot;, or via a reference passed in \%attr.</p>
<p class="Pp">When called in scalar context the <b>execute_array()</b> method
    returns the number of tuples executed, or
    <span class="Li">&quot;undef&quot;</span> if an error occurred. Like
    <b>execute()</b>, a successful <b>execute_array()</b> always returns true
    regardless of the number of tuples executed, even if it's zero. If there
    were any errors the ArrayTupleStatus array can be used to discover which
    tuples failed and with what errors.</p>
<p class="Pp">When called in list context the <b>execute_array()</b> method
    returns two scalars; <span class="Li">$tuples</span> is the same as calling
    <b>execute_array()</b> in scalar context and <span class="Li">$rows</span>
    is the number of rows affected for each tuple, if available or -1 if the
    driver cannot determine this. NOTE, some drivers cannot determine the number
    of rows affected per tuple but can provide the number of rows affected for
    the batch. If you are doing an update operation the returned rows affected
    may not be what you expect if, for instance, one or more of the tuples
    affected the same row multiple times. Some drivers may not yet support list
    context, in which case <span class="Li">$rows</span> will be undef, or may
    not be able to provide the number of rows affected when performing this
    batch operation, in which case <span class="Li">$rows</span> will be -1.</p>
<p class="Pp">Bind values for the tuples to be executed may be supplied row-wise
    by an <span class="Li">&quot;ArrayTupleFetch&quot;</span> attribute, or else
    column-wise in the <span class="Li">@bind_values</span> argument, or else
    column-wise by prior calls to &quot;bind_param_array&quot;.</p>
<p class="Pp">Where column-wise binding is used (via the
    <span class="Li">@bind_values</span> argument or calls to
    <b>bind_param_array()</b>) the maximum number of elements in any one of the
    bound value arrays determines the number of tuples executed. Placeholders
    with fewer values in their parameter arrays are treated as if padded with
    undef (NULL) values.</p>
<p class="Pp">If a scalar value is bound, instead of an array reference, it is
    treated as a <i>variable</i> length array with all elements having the same
    value. It does not influence the number of tuples executed, so if all bound
    arrays have zero elements then zero tuples will be executed. If <i>all</i>
    bound values are scalars then one tuple will be executed, making
    <b>execute_array()</b> act just like <b>execute()</b>.</p>
<p class="Pp">The <span class="Li">&quot;ArrayTupleFetch&quot;</span> attribute
    can be used to specify a reference to a subroutine that will be called to
    provide the bind values for each tuple execution. The subroutine should
    return an reference to an array which contains the appropriate number of
    bind values, or return an undef if there is no more data to execute.</p>
<p class="Pp">As a convenience, the
    <span class="Li">&quot;ArrayTupleFetch&quot;</span> attribute can also be
    used to specify a statement handle. In which case the
    <b>fetchrow_arrayref()</b> method will be called on the given statement
    handle in order to provide the bind values for each tuple execution.</p>
<p class="Pp">The values specified via <b>bind_param_array()</b> or the
    <span class="Li">@bind_values</span> parameter may be either scalars, or
    arrayrefs. If any <span class="Li">@bind_values</span> are given, then
    <span class="Li">&quot;execute_array&quot;</span> will effectively call
    &quot;bind_param_array&quot; for each value before executing the statement.
    Values bound in this way are usually treated as
    <span class="Li">&quot;SQL_VARCHAR&quot;</span> types unless the driver can
    determine the correct type (which is rare), or unless
    <span class="Li">&quot;bind_param&quot;</span>,
    <span class="Li">&quot;bind_param_inout&quot;</span>,
    <span class="Li">&quot;bind_param_array&quot;</span>, or
    <span class="Li">&quot;bind_param_inout_array&quot;</span> has already been
    used to specify the type. See &quot;bind_param_array&quot; for details.</p>
<p class="Pp">The <span class="Li">&quot;ArrayTupleStatus&quot;</span> attribute
    can be used to specify a reference to an array which will receive the
    execute status of each executed parameter tuple. Note the
    <span class="Li">&quot;ArrayTupleStatus&quot;</span> attribute was mandatory
    until DBI 1.38.</p>
<p class="Pp">For tuples which are successfully executed, the element at the
    same ordinal position in the status array is the resulting rowcount (or -1
    if unknown). If the execution of a tuple causes an error, then the
    corresponding status array element will be set to a reference to an array
    containing &quot;err&quot;, &quot;errstr&quot; and &quot;state&quot; set by
    the failed execution.</p>
<p class="Pp">If <b>any</b> tuple execution returns an error,
    <span class="Li">&quot;execute_array&quot;</span> will return
    <span class="Li">&quot;undef&quot;</span>. In that case, the application
    should inspect the status array to determine which parameter tuples failed.
    Some databases may not continue executing tuples beyond the first failure.
    In this case the status array will either hold fewer elements, or the
    elements beyond the failure will be undef.</p>
<p class="Pp">If all parameter tuples are successfully executed,
    <span class="Li">&quot;execute_array&quot;</span> returns the number tuples
    executed. If no tuples were executed, then <b>execute_array()</b> returns
    &quot;<span class="Li">0E0</span>&quot;, just like <b>execute()</b> does,
    which Perl will treat as 0 but will regard as true.</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(&quot;INSERT INTO staff (first_name, last_name) VALUES (?, ?)&quot;);
  my $tuples = $sth-&gt;execute_array(
      { ArrayTupleStatus =&gt; \my @tuple_status },
      \@first_names,
      \@last_names,
  );
  if ($tuples) {
      print &quot;Successfully inserted $tuples records\n&quot;;
  }
  else {
      for my $tuple (0..@last_names-1) {
          my $status = $tuple_status[$tuple];
          $status = [0, &quot;Skipped&quot;] unless defined $status;
          next unless ref $status;
          printf &quot;Failed to insert (%s, %s): %s\n&quot;,
              $first_names[$tuple], $last_names[$tuple], $status-&gt;[1];
      }
  }
</pre>
<p class="Pp">Support for data returning statements such as SELECT is
    driver-specific and subject to change. At present, the default
    implementation provided by DBI only supports non-data returning
  statements.</p>
<p class="Pp">Transaction semantics when using array binding are driver and
    database specific. If <span class="Li">&quot;AutoCommit&quot;</span> is on,
    the default DBI implementation will cause each parameter tuple to be
    individually committed (or rolled back in the event of an error). If
    <span class="Li">&quot;AutoCommit&quot;</span> is off, the application is
    responsible for explicitly committing the entire set of bound parameter
    tuples. Note that different drivers and databases may have different
    behaviours when some parameter tuples cause failures. In some cases, the
    driver or database may automatically rollback the effect of all prior
    parameter tuples that succeeded in the transaction; other drivers or
    databases may retain the effect of prior successfully executed parameter
    tuples. Be sure to check your driver and database for its specific
    behaviour.</p>
<p class="Pp">Note that, in general, performance will usually be better with
    <span class="Li">&quot;AutoCommit&quot;</span> turned off, and using
    explicit <span class="Li">&quot;commit&quot;</span> after each
    <span class="Li">&quot;execute_array&quot;</span> call.</p>
<p class="Pp">The <span class="Li">&quot;execute_array&quot;</span> method was
    added in DBI 1.22, and ArrayTupleFetch was added in 1.36.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;execute_for_fetch&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $tuples = $sth-&gt;execute_for_fetch($fetch_tuple_sub);
  $tuples = $sth-&gt;execute_for_fetch($fetch_tuple_sub, \@tuple_status);
  ($tuples, $rows) = $sth-&gt;execute_for_fetch($fetch_tuple_sub);
  ($tuples, $rows) = $sth-&gt;execute_for_fetch($fetch_tuple_sub, \@tuple_status);
</pre>
<p class="Pp">The <b>execute_for_fetch()</b> method is used to perform bulk
    operations and although it is most often used via the <b>execute_array()</b>
    method you can use it directly. The main difference between execute_array
    and execute_for_fetch is the former does column or row-wise binding and the
    latter uses row-wise binding.</p>
<p class="Pp">The fetch subroutine, referenced by
    <span class="Li">$fetch_tuple_sub</span>, is expected to return a reference
    to an array (known as a 'tuple') or undef.</p>
<p class="Pp">The <b>execute_for_fetch()</b> method calls
    <span class="Li">$fetch_tuple_sub</span>, without any parameters, until it
    returns a false value. Each tuple returned is used to provide bind values
    for an <span class="Li">$sth</span>-&gt;execute(@$tuple) call.</p>
<p class="Pp">In scalar context <b>execute_for_fetch()</b> returns
    <span class="Li">&quot;undef&quot;</span> if there were any errors and the
    number of tuples executed otherwise. Like <b>execute()</b> and
    <b>execute_array()</b> a zero is returned as &quot;0E0&quot; so
    <b>execute_for_fetch()</b> is only false on error. If there were any errors
    the <span class="Li">@tuple_status</span> array can be used to discover
    which tuples failed and with what errors.</p>
<p class="Pp">When called in list context <b>execute_for_fetch()</b> returns two
    scalars; <span class="Li">$tuples</span> is the same as calling
    <b>execute_for_fetch()</b> in scalar context and
    <span class="Li">$rows</span> is the sum of the number of rows affected for
    each tuple, if available or -1 if the driver cannot determine this. If you
    are doing an update operation the returned rows affected may not be what you
    expect if, for instance, one or more of the tuples affected the same row
    multiple times. Some drivers may not yet support list context, in which case
    <span class="Li">$rows</span> will be undef, or may not be able to provide
    the number of rows affected when performing this batch operation, in which
    case <span class="Li">$rows</span> will be -1.</p>
<p class="Pp">If \@tuple_status is passed then the execute_for_fetch method uses
    it to return status information. The tuple_status array holds one element
    per tuple. If the corresponding <b>execute()</b> did not fail then the
    element holds the return value from <b>execute()</b>, which is typically a
    row count. If the <b>execute()</b> did fail then the element holds a
    reference to an array containing ($sth-&gt;err,
    <span class="Li">$sth</span>-&gt;errstr,
    <span class="Li">$sth</span>-&gt;state).</p>
<p class="Pp">If the driver detects an error that it knows means no further
    tuples can be executed then it may return, with an error status, even though
    <span class="Li">$fetch_tuple_sub</span> may still have more tuples to be
    executed.</p>
<p class="Pp">Although each tuple returned by
    <span class="Li">$fetch_tuple_sub</span> is effectively used to call
    <span class="Li">$sth</span>-&gt;execute(@$tuple_array_ref) the exact timing
    may vary. Drivers are free to accumulate sets of tuples to pass to the
    database server in bulk group operations for more efficient execution.
    However, the <span class="Li">$fetch_tuple_sub</span> is specifically
    allowed to return the same array reference each time (which is what
    <b>fetchrow_arrayref()</b> usually does).</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  my $sel = $dbh1-&gt;prepare(&quot;select foo, bar from table1&quot;);
  $sel-&gt;execute;
  my $ins = $dbh2-&gt;prepare(&quot;insert into table2 (foo, bar) values (?,?)&quot;);
  my $fetch_tuple_sub = sub { $sel-&gt;fetchrow_arrayref };
  my @tuple_status;
  $rc = $ins-&gt;execute_for_fetch($fetch_tuple_sub, \@tuple_status);
  my @errors = grep { ref $_ } @tuple_status;
</pre>
<p class="Pp">Similarly, if you already have an array containing the data rows
    to be processed you'd use a subroutine to shift off and return each array
    ref in turn:</p>
<p class="Pp"></p>
<pre>  $ins-&gt;execute_for_fetch( sub { shift @array_of_arrays }, \@tuple_status);
</pre>
<p class="Pp">The <span class="Li">&quot;execute_for_fetch&quot;</span> method
    was added in DBI 1.38.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;last_insert_id&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rv = $sth-&gt;last_insert_id();
  $rv = $sth-&gt;last_insert_id($catalog, $schema, $table, $field);
  $rv = $sth-&gt;last_insert_id($catalog, $schema, $table, $field, \%attr);
</pre>
<p class="Pp">Returns a value 'identifying' the row inserted by last execution
    of the statement <span class="Li">$sth</span>, if possible.</p>
<p class="Pp">For some drivers the value may be 'identifying' the row inserted
    by the last executed statement, not by <span class="Li">$sth</span>.</p>
<p class="Pp">See database handle method last_insert_id for all details.</p>
<p class="Pp">The <span class="Li">&quot;last_insert_id&quot;</span> statement
    method was added in DBI 1.642.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;fetchrow_arrayref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $ary_ref = $sth-&gt;fetchrow_arrayref;
  $ary_ref = $sth-&gt;fetch;    # alias
</pre>
<p class="Pp">Fetches the next row of data and returns a reference to an array
    holding the field values. Null fields are returned as
    <span class="Li">&quot;undef&quot;</span> values in the array. This is the
    fastest way to fetch data, particularly if used with
    <span class="Li">&quot;$sth-&gt;bind_columns&quot;</span>.</p>
<p class="Pp">If there are no more rows or if an error occurs, then
    <span class="Li">&quot;fetchrow_arrayref&quot;</span> returns an
    <span class="Li">&quot;undef&quot;</span>. You should check
    <span class="Li">&quot;$sth-&gt;err&quot;</span> afterwards (or use the
    <span class="Li">&quot;RaiseError&quot;</span> attribute) to discover if the
    <span class="Li">&quot;undef&quot;</span> returned was due to an error.</p>
<p class="Pp">Note that the same array reference is returned for each fetch, so
    don't store the reference and then use it after a later fetch. Also, the
    elements of the array are also reused for each row, so take care if you want
    to take a reference to an element. See also &quot;bind_columns&quot;.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;fetchrow_array&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre> @ary = $sth-&gt;fetchrow_array;
</pre>
<p class="Pp">An alternative to
    <span class="Li">&quot;fetchrow_arrayref&quot;</span>. Fetches the next row
    of data and returns it as a list containing the field values. Null fields
    are returned as <span class="Li">&quot;undef&quot;</span> values in the
    list.</p>
<p class="Pp">If there are no more rows or if an error occurs, then
    <span class="Li">&quot;fetchrow_array&quot;</span> returns an empty list.
    You should check <span class="Li">&quot;$sth-&gt;err&quot;</span> afterwards
    (or use the <span class="Li">&quot;RaiseError&quot;</span> attribute) to
    discover if the empty list returned was due to an error.</p>
<p class="Pp">If called in a scalar context for a statement handle that has more
    than one column, it is undefined whether the driver will return the value of
    the first column or the last. So don't do that. Also, in a scalar context,
    an <span class="Li">&quot;undef&quot;</span> is returned if there are no
    more rows or if an error occurred. That
    <span class="Li">&quot;undef&quot;</span> can't be distinguished from an
    <span class="Li">&quot;undef&quot;</span> returned because the first field
    value was NULL. For these reasons you should exercise some caution if you
    use <span class="Li">&quot;fetchrow_array&quot;</span> in a scalar
  context.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;fetchrow_hashref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre> $hash_ref = $sth-&gt;fetchrow_hashref;
 $hash_ref = $sth-&gt;fetchrow_hashref($name);
</pre>
<p class="Pp">An alternative to
    <span class="Li">&quot;fetchrow_arrayref&quot;</span>. Fetches the next row
    of data and returns it as a reference to a hash containing field name and
    field value pairs. Null fields are returned as
    <span class="Li">&quot;undef&quot;</span> values in the hash.</p>
<p class="Pp">If there are no more rows or if an error occurs, then
    <span class="Li">&quot;fetchrow_hashref&quot;</span> returns an
    <span class="Li">&quot;undef&quot;</span>. You should check
    <span class="Li">&quot;$sth-&gt;err&quot;</span> afterwards (or use the
    <span class="Li">&quot;RaiseError&quot;</span> attribute) to discover if the
    <span class="Li">&quot;undef&quot;</span> returned was due to an error.</p>
<p class="Pp">The optional <span class="Li">$name</span> parameter specifies the
    name of the statement handle attribute. For historical reasons it defaults
    to &quot;<span class="Li">&quot;NAME&quot;</span>&quot;, however using
    either &quot;<span class="Li">&quot;NAME_lc&quot;</span>&quot; or
    &quot;<span class="Li">&quot;NAME_uc&quot;</span>&quot; is recommended for
    portability.</p>
<p class="Pp">The keys of the hash are the same names returned by
    <span class="Li">&quot;$sth-&gt;{$name}&quot;</span>. If more than one field
    has the same name, there will only be one entry in the returned hash for
    those fields, so statements like &quot;<span class="Li">&quot;select foo,
    foo from bar&quot;</span>&quot; will return only a single key from
    <span class="Li">&quot;fetchrow_hashref&quot;</span>. In these cases use
    column aliases or <span class="Li">&quot;fetchrow_arrayref&quot;</span>.
    Note that it is the database server (and not the DBD implementation) which
    provides the <i>name</i> for fields containing functions like
    &quot;<span class="Li">count(*)</span>&quot; or
    &quot;<span class="Li">&quot;max(c_foo)&quot;</span>&quot; and they may
    clash with existing column names (most databases don't care about duplicate
    column names in a result-set). If you want these to return as unique names
    that are the same across databases, use <i>aliases</i>, as in
    &quot;<span class="Li">&quot;select count(*) as cnt&quot;</span>&quot; or
    &quot;<span class="Li">&quot;select max(c_foo) mx_foo,
    ...&quot;</span>&quot; depending on the syntax your database supports.</p>
<p class="Pp">Because of the extra work
    <span class="Li">&quot;fetchrow_hashref&quot;</span> and Perl have to
    perform, it is not as efficient as
    <span class="Li">&quot;fetchrow_arrayref&quot;</span> or
    <span class="Li">&quot;fetchrow_array&quot;</span>.</p>
<p class="Pp">By default a reference to a new hash is returned for each row. It
    is likely that a future version of the DBI will support an attribute which
    will enable the same hash to be reused for each row. This will give a
    significant performance boost, but it won't be enabled by default because of
    the risk of breaking old code.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;fetchall_arrayref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $tbl_ary_ref = $sth-&gt;fetchall_arrayref;
  $tbl_ary_ref = $sth-&gt;fetchall_arrayref( $slice );
  $tbl_ary_ref = $sth-&gt;fetchall_arrayref( $slice, $max_rows  );
</pre>
<p class="Pp">The <span class="Li">&quot;fetchall_arrayref&quot;</span> method
    can be used to fetch all the data to be returned from a prepared and
    executed statement handle. It returns a reference to an array that contains
    one reference per row.</p>
<p class="Pp">If called on an <i>inactive</i> statement handle,
    <span class="Li">&quot;fetchall_arrayref&quot;</span> returns undef.</p>
<p class="Pp">If there are no rows left to return from an <i>active</i>
    statement handle, <span class="Li">&quot;fetchall_arrayref&quot;</span>
    returns a reference to an empty array. If an error occurs,
    <span class="Li">&quot;fetchall_arrayref&quot;</span> returns the data
    fetched thus far, which may be none. You should check
    <span class="Li">&quot;$sth-&gt;err&quot;</span> afterwards (or use the
    <span class="Li">&quot;RaiseError&quot;</span> attribute) to discover if the
    data is complete or was truncated due to an error.</p>
<p class="Pp">If <span class="Li">$slice</span> is an array reference,
    <span class="Li">&quot;fetchall_arrayref&quot;</span> uses
    &quot;fetchrow_arrayref&quot; to fetch each row as an array ref. If the
    <span class="Li">$slice</span> array is not empty then it is used as a slice
    to select individual columns by perl array index number (starting at 0,
    unlike column and parameter numbers which start at 1).</p>
<p class="Pp">With no parameters, or if <span class="Li">$slice</span> is
    undefined, <span class="Li">&quot;fetchall_arrayref&quot;</span> acts as if
    passed an empty array ref.</p>
<p class="Pp">For example, to fetch just the first column of every row:</p>
<p class="Pp"></p>
<pre>  $tbl_ary_ref = $sth-&gt;fetchall_arrayref([0]);
</pre>
<p class="Pp">To fetch the second to last and last column of every row:</p>
<p class="Pp"></p>
<pre>  $tbl_ary_ref = $sth-&gt;fetchall_arrayref([-2,-1]);
</pre>
<p class="Pp">Those two examples both return a reference to an array of array
    refs.</p>
<p class="Pp">If <span class="Li">$slice</span> is a hash reference,
    <span class="Li">&quot;fetchall_arrayref&quot;</span> fetches each row as a
    hash reference. If the <span class="Li">$slice</span> hash is empty then the
    keys in the hashes have whatever name lettercase is returned by default.
    (See &quot;FetchHashKeyName&quot; attribute.) If the
    <span class="Li">$slice</span> hash is <i>not</i> empty, then it is used as
    a slice to select individual columns by name. The values of the hash should
    be set to 1. The key names of the returned hashes match the letter case of
    the names in the parameter hash, regardless of the
    &quot;FetchHashKeyName&quot; attribute.</p>
<p class="Pp">For example, to fetch all fields of every row as a hash ref:</p>
<p class="Pp"></p>
<pre>  $tbl_ary_ref = $sth-&gt;fetchall_arrayref({});
</pre>
<p class="Pp">To fetch only the fields called &quot;foo&quot; and
    &quot;bar&quot; of every row as a hash ref (with keys named &quot;foo&quot;
    and &quot;BAR&quot;, regardless of the original capitalization):</p>
<p class="Pp"></p>
<pre>  $tbl_ary_ref = $sth-&gt;fetchall_arrayref({ foo=&gt;1, BAR=&gt;1 });
</pre>
<p class="Pp">Those two examples both return a reference to an array of hash
    refs.</p>
<p class="Pp">If <span class="Li">$slice</span> is a <i>reference to a hash
    reference</i>, that hash is used to select and rename columns. The keys are
    0-based column index numbers and the values are the corresponding keys for
    the returned row hashes.</p>
<p class="Pp">For example, to fetch only the first and second columns of every
    row as a hash ref (with keys named &quot;k&quot; and &quot;v&quot;
    regardless of their original names):</p>
<p class="Pp"></p>
<pre>  $tbl_ary_ref = $sth-&gt;fetchall_arrayref( \{ 0 =&gt; 'k', 1 =&gt; 'v' } );
</pre>
<p class="Pp">If <span class="Li">$max_rows</span> is defined and greater than
    or equal to zero then it is used to limit the number of rows fetched before
    returning. <b>fetchall_arrayref()</b> can then be called again to fetch more
    rows. This is especially useful when you need the better performance of
    <b>fetchall_arrayref()</b> but don't have enough memory to fetch and return
    all the rows in one go.</p>
<p class="Pp">Here's an example (assumes RaiseError is enabled):</p>
<p class="Pp"></p>
<pre>  my $rows = []; # cache for batches of rows
  while( my $row = ( shift(@$rows) || # get row from cache, or reload cache:
                     shift(@{$rows=$sth-&gt;fetchall_arrayref(undef,10_000)||[]}) )
  ) {
    ...
  }
</pre>
<p class="Pp">That <i>might</i> be the fastest way to fetch and process lots of
    rows using the DBI, but it depends on the relative cost of method calls vs
    memory allocation.</p>
<p class="Pp">A standard <span class="Li">&quot;while&quot;</span> loop with
    column binding is often faster because the cost of allocating memory for the
    batch of rows is greater than the saving by reducing method calls. It's
    possible that the DBI may provide a way to reuse the memory of a previous
    batch in future, which would then shift the balance back towards
    <b>fetchall_arrayref()</b>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;fetchall_hashref&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $hash_ref = $sth-&gt;fetchall_hashref($key_field);
</pre>
<p class="Pp">The <span class="Li">&quot;fetchall_hashref&quot;</span> method
    can be used to fetch all the data to be returned from a prepared and
    executed statement handle. It returns a reference to a hash containing a key
    for each distinct value of the <span class="Li">$key_field</span> column
    that was fetched. For each key the corresponding value is a reference to a
    hash containing all the selected columns and their values, as returned by
    <span class="Li">&quot;fetchrow_hashref()&quot;</span>.</p>
<p class="Pp">If there are no rows to return,
    <span class="Li">&quot;fetchall_hashref&quot;</span> returns a reference to
    an empty hash. If an error occurs,
    <span class="Li">&quot;fetchall_hashref&quot;</span> returns the data
    fetched thus far, which may be none. You should check
    <span class="Li">&quot;$sth-&gt;err&quot;</span> afterwards (or use the
    <span class="Li">&quot;RaiseError&quot;</span> attribute) to discover if the
    data is complete or was truncated due to an error.</p>
<p class="Pp">The <span class="Li">$key_field</span> parameter provides the name
    of the field that holds the value to be used for the key for the returned
    hash. For example:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{FetchHashKeyName} = 'NAME_lc';
  $sth = $dbh-&gt;prepare(&quot;SELECT FOO, BAR, ID, NAME, BAZ FROM TABLE&quot;);
  $sth-&gt;execute;
  $hash_ref = $sth-&gt;fetchall_hashref('id');
  print &quot;Name for id 42 is $hash_ref-&gt;{42}-&gt;{name}\n&quot;;
</pre>
<p class="Pp">The <span class="Li">$key_field</span> parameter can also be
    specified as an integer column number (counting from 1). If
    <span class="Li">$key_field</span> doesn't match any column in the
    statement, as a name first then as a number, then an error is returned.</p>
<p class="Pp">For queries returning more than one 'key' column, you can specify
    multiple column names by passing <span class="Li">$key_field</span> as a
    reference to an array containing one or more key column names (or index
    numbers). For example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(&quot;SELECT foo, bar, baz FROM table&quot;);
  $sth-&gt;execute;
  $hash_ref = $sth-&gt;fetchall_hashref( [ qw(foo bar) ] );
  print &quot;For foo 42 and bar 38, baz is $hash_ref-&gt;{42}-&gt;{38}-&gt;{baz}\n&quot;;
</pre>
<p class="Pp">The <b>fetchall_hashref()</b> method is normally used only where
    the key fields values for each row are unique. If multiple rows are returned
    with the same values for the key fields then later rows overwrite earlier
    ones.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;finish&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc  = $sth-&gt;finish;
</pre>
<p class="Pp">Indicate that no more data will be fetched from this statement
    handle before it is either executed again or destroyed. You almost certainly
    do <i>not</i> need to call this method.</p>
<p class="Pp">Adding calls to <span class="Li">&quot;finish&quot;</span> after
    loop that fetches all rows is a common mistake, don't do it, it can mask
    genuine problems like uncaught fetch errors.</p>
<p class="Pp">When all the data has been fetched from a
    <span class="Li">&quot;SELECT&quot;</span> statement, the driver will
    automatically call <span class="Li">&quot;finish&quot;</span> for you. So
    you should <i>not</i> call it explicitly <i>except</i> when you know that
    you've not fetched all the data from a statement handle <i>and</i> the
    handle won't be destroyed soon.</p>
<p class="Pp">The most common example is when you only want to fetch just one
    row, but in that case the <span class="Li">&quot;selectrow_*&quot;</span>
    methods are usually better anyway.</p>
<p class="Pp">Consider a query like:</p>
<p class="Pp"></p>
<pre>  SELECT foo FROM table WHERE bar=? ORDER BY baz
</pre>
<p class="Pp">on a very large table. When executed, the database server will
    have to use temporary buffer space to store the sorted rows. If, after
    executing the handle and selecting just a few rows, the handle won't be
    re-executed for some time and won't be destroyed, the
    <span class="Li">&quot;finish&quot;</span> method can be used to tell the
    server that the buffer space can be freed.</p>
<p class="Pp">Calling <span class="Li">&quot;finish&quot;</span> resets the
    &quot;Active&quot; attribute for the statement. It may also make some
    statement handle attributes (such as
    <span class="Li">&quot;NAME&quot;</span> and
    <span class="Li">&quot;TYPE&quot;</span>) unavailable if they have not
    already been accessed (and thus cached).</p>
<p class="Pp">The <span class="Li">&quot;finish&quot;</span> method does not
    affect the transaction status of the database connection. It has nothing to
    do with transactions. It's mostly an internal &quot;housekeeping&quot;
    method that is rarely needed. See also &quot;disconnect&quot; and the
    &quot;Active&quot; attribute.</p>
<p class="Pp">The <span class="Li">&quot;finish&quot;</span> method should have
    been called <span class="Li">&quot;discard_pending_rows&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;rows&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rv = $sth-&gt;rows;
</pre>
<p class="Pp">Returns the number of rows affected by the last row affecting
    command, or -1 if the number of rows is not known or not available.</p>
<p class="Pp">Generally, you can only rely on a row count after a
    <i>non</i>-<span class="Li">&quot;SELECT&quot;</span>
    <span class="Li">&quot;execute&quot;</span> (for some specific operations
    like <span class="Li">&quot;UPDATE&quot;</span> and
    <span class="Li">&quot;DELETE&quot;</span>), or after fetching all the rows
    of a <span class="Li">&quot;SELECT&quot;</span> statement.</p>
<p class="Pp">For <span class="Li">&quot;SELECT&quot;</span> statements, it is
    generally not possible to know how many rows will be returned except by
    fetching them all. Some drivers will return the number of rows the
    application has fetched so far, but others may return -1 until all rows have
    been fetched. So use of the <span class="Li">&quot;rows&quot;</span> method
    or <span class="Li">$DBI::rows</span> with
    <span class="Li">&quot;SELECT&quot;</span> statements is not
  recommended.</p>
<p class="Pp">One alternative method to get a row count for a
    <span class="Li">&quot;SELECT&quot;</span> is to execute a &quot;SELECT
    COUNT(*) FROM ...&quot; SQL statement with the same &quot;...&quot; as your
    query and then fetch the row count from that.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;bind_col&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $sth-&gt;bind_col($column_number, \$var_to_bind);
  $rc = $sth-&gt;bind_col($column_number, \$var_to_bind, \%attr );
  $rc = $sth-&gt;bind_col($column_number, \$var_to_bind, $bind_type );
</pre>
<p class="Pp">Binds a Perl variable and/or some attributes to an output column
    (field) of a <span class="Li">&quot;SELECT&quot;</span> statement. Column
    numbers count up from 1. You do not need to bind output columns in order to
    fetch data. For maximum portability between drivers, <b>bind_col()</b>
    should be called after <b>execute()</b> and not before. See also
    &quot;bind_columns&quot; for an example.</p>
<p class="Pp">The binding is performed at a low level using Perl aliasing.
    Whenever a row is fetched from the database
    <span class="Li">$var_to_bind</span> appears to be automatically updated
    simply because it now refers to the same memory location as the
    corresponding column value. This makes using bound variables very efficient.
    Binding a tied variable doesn't work, currently.</p>
<p class="Pp">The &quot;bind_param&quot; method performs a similar, but
    opposite, function for input variables.</p>
<p class="Pp"><b>Data Types for Column Binding</b></p>
<p class="Pp">The <span class="Li">&quot;\%attr&quot;</span> parameter can be
    used to hint at the data type formatting the column should have. For
    example, you can use:</p>
<p class="Pp"></p>
<pre>  $sth-&gt;bind_col(1, undef, { TYPE =&gt; SQL_DATETIME });
</pre>
<p class="Pp">to specify that you'd like the column (which presumably is some
    kind of datetime type) to be returned in the standard format for
    SQL_DATETIME, which is 'YYYY-MM-DD HH:MM:SS', rather than the native
    formatting the database would normally use.</p>
<p class="Pp">There's no <span class="Li">$var_to_bind</span> in that example to
    emphasize the point that <b>bind_col()</b> works on the underlying column
    and not just a particular bound variable.</p>
<p class="Pp">As a short-cut for the common case, the data type can be passed
    directly, in place of the <span class="Li">&quot;\%attr&quot;</span> hash
    reference. This example is equivalent to the one above:</p>
<p class="Pp"></p>
<pre>  $sth-&gt;bind_col(1, undef, SQL_DATETIME);
</pre>
<p class="Pp">The <span class="Li">&quot;TYPE&quot;</span> value indicates the
    standard (non-driver-specific) type for this parameter. To specify the
    driver-specific type, the driver may support a driver-specific attribute,
    such as <span class="Li">&quot;{ ora_type =&gt; 97 }&quot;</span>.</p>
<p class="Pp">The SQL_DATETIME and other related constants can be imported
  using</p>
<p class="Pp"></p>
<pre>  use DBI qw(:sql_types);
</pre>
<p class="Pp">See &quot;DBI Constants&quot; for more information.</p>
<p class="Pp">Few drivers support specifying a data type via a
    <span class="Li">&quot;bind_col&quot;</span> call (most will simply ignore
    the data type). Fewer still allow the data type to be altered once set. If
    you do set a column type the type should remain sticky through further calls
    to bind_col for the same column if the type is not overridden (this is
    important for instance when you are using a slice in fetchall_arrayref).</p>
<p class="Pp">The TYPE attribute for <b>bind_col()</b> was first specified in
    DBI 1.41.</p>
<p class="Pp">From DBI 1.611, drivers can use the
    <span class="Li">&quot;TYPE&quot;</span> attribute to attempt to cast the
    bound scalar to a perl type which more closely matches
    <span class="Li">&quot;TYPE&quot;</span>. At present DBI supports
    <span class="Li">&quot;SQL_INTEGER&quot;</span>,
    <span class="Li">&quot;SQL_DOUBLE&quot;</span> and
    <span class="Li">&quot;SQL_NUMERIC&quot;</span>. See
    &quot;sql_type_cast&quot; for details of how types are cast.</p>
<p class="Pp"><b>Other attributes for Column Binding</b></p>
<p class="Pp">The <span class="Li">&quot;\%attr&quot;</span> parameter may also
    contain the following attributes:</p>
<dl class="Bl-tag">
  <dt>&quot;StrictlyTyped&quot;</dt>
  <dd>If a <span class="Li">&quot;TYPE&quot;</span> attribute is passed to
      bind_col, then the driver will attempt to change the bound perl scalar to
      match the type more closely. If the bound value cannot be cast to the
      requested <span class="Li">&quot;TYPE&quot;</span> then by default it is
      left untouched and no error is generated. If you specify
      <span class="Li">&quot;StrictlyTyped&quot;</span> as 1 and the cast fails,
      this will generate an error.
    <p class="Pp">This attribute was first added in DBI 1.611. When 1.611 was
        released few drivers actually supported this attribute but DBD::Oracle
        and DBD::ODBC should from versions 1.24.</p>
  </dd>
  <dt>&quot;DiscardString&quot;</dt>
  <dd>When the <span class="Li">&quot;TYPE&quot;</span> attribute is passed to
      &quot;bind_col&quot; and the driver successfully casts the bound perl
      scalar to a non-string type then if
      <span class="Li">&quot;DiscardString&quot;</span> is set to 1, the string
      portion of the scalar will be discarded. By default,
      <span class="Li">&quot;DiscardString&quot;</span> is not set.
    <p class="Pp">This attribute was first added in DBI 1.611. When 1.611 was
        released few drivers actually supported this attribute but DBD::Oracle
        and DBD::ODBC should from versions 1.24.</p>
  </dd>
</dl>
<p class="Pp"><i></i><span class="Li"><i>&quot;bind_columns&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rc = $sth-&gt;bind_columns(@list_of_refs_to_vars_to_bind);
</pre>
<p class="Pp">Calls &quot;bind_col&quot; for each column of the
    <span class="Li">&quot;SELECT&quot;</span> statement.</p>
<p class="Pp">The list of references should have the same number of elements as
    the number of columns in the <span class="Li">&quot;SELECT&quot;</span>
    statement. If it doesn't then
    <span class="Li">&quot;bind_columns&quot;</span> will bind the elements
    given, up to the number of columns, and then return an error.</p>
<p class="Pp">For maximum portability between drivers, <b>bind_columns()</b>
    should be called after <b>execute()</b> and not before.</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;{RaiseError} = 1; # do this, or check every call for errors
  $sth = $dbh-&gt;prepare(q{ SELECT region, sales FROM sales_by_region });
  $sth-&gt;execute;
  my ($region, $sales);
  # Bind Perl variables to columns:
  $rv = $sth-&gt;bind_columns(\$region, \$sales);
  # you can also use Perl's \(...) syntax (see perlref docs):
  #     $sth-&gt;bind_columns(\($region, $sales));
  # Column binding is the most efficient way to fetch data
  while ($sth-&gt;fetch) {
      print &quot;$region: $sales\n&quot;;
  }
</pre>
<p class="Pp">For compatibility with old scripts, the first parameter will be
    ignored if it is <span class="Li">&quot;undef&quot;</span> or a hash
    reference.</p>
<p class="Pp">Here's a more fancy example that binds columns to the values
    <i>inside</i> a hash (thanks to H.Merijn Brand):</p>
<p class="Pp"></p>
<pre>  $sth-&gt;execute;
  my %row;
  $sth-&gt;bind_columns( \( @row{ @{$sth-&gt;{NAME_lc} } } ));
  while ($sth-&gt;fetch) {
      print &quot;$row{region}: $row{sales}\n&quot;;
  }
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;dump_results&quot;</i></span><i></i></p>
<p class="Pp"></p>
<pre>  $rows = $sth-&gt;dump_results($maxlen, $lsep, $fsep, $fh);
</pre>
<p class="Pp">Fetches all the rows from <span class="Li">$sth</span>, calls
    <span class="Li">&quot;DBI::neat_list&quot;</span> for each row, and prints
    the results to <span class="Li">$fh</span> (defaults to
    <span class="Li">&quot;STDOUT&quot;</span>) separated by
    <span class="Li">$lsep</span> (default
    <span class="Li">&quot;\n&quot;</span>). <span class="Li">$fsep</span>
    defaults to <span class="Li">&quot;, &quot;</span> and
    <span class="Li">$maxlen</span> defaults to 35.</p>
<p class="Pp">This method is designed as a handy utility for prototyping and
    testing queries. Since it uses &quot;neat_list&quot; to format and edit the
    string for reading by humans, it is not recommended for data transfer
    applications.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Statement_Handle_Attributes"><a class="permalink" href="#Statement_Handle_Attributes">Statement
  Handle Attributes</a></h2>
<p class="Pp">This section describes attributes specific to statement handles.
    Most of these attributes are read-only.</p>
<p class="Pp">Changes to these statement handle attributes do not affect any
    other existing or future statement handles.</p>
<p class="Pp">Attempting to set or get the value of an unknown attribute
    generates a warning, except for private driver specific attributes (which
    all have names starting with a lowercase letter).</p>
<p class="Pp">Example:</p>
<p class="Pp"></p>
<pre>  ... = $h-&gt;{NUM_OF_FIELDS};    # get/read
</pre>
<p class="Pp">Some drivers cannot provide valid values for some or all of these
    attributes until after <span class="Li">&quot;$sth-&gt;execute&quot;</span>
    has been successfully called. Typically the attribute will be
    <span class="Li">&quot;undef&quot;</span> in these situations.</p>
<p class="Pp">Some attributes, like NAME, are not appropriate to some types of
    statement, like SELECT. Typically the attribute will be
    <span class="Li">&quot;undef&quot;</span> in these situations.</p>
<p class="Pp">For drivers which support stored procedures and multiple result
    sets (see &quot;more_results&quot;) these attributes relate to the
    <i>current</i> result set.</p>
<p class="Pp">See also &quot;finish&quot; to learn more about the effect it may
    have on some attributes.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NUM_OF_FIELDS&quot;</i></span><i></i></p>
<p class="Pp">Type: integer, read-only</p>
<p class="Pp">Number of fields (columns) in the data the prepared statement may
    return. Statements that don't return rows of data, like
    <span class="Li">&quot;DELETE&quot;</span> and
    <span class="Li">&quot;CREATE&quot;</span> set
    <span class="Li">&quot;NUM_OF_FIELDS&quot;</span> to 0 (though it may be
    undef in some drivers).</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NUM_OF_PARAMS&quot;</i></span><i></i></p>
<p class="Pp">Type: integer, read-only</p>
<p class="Pp">The number of parameters (placeholders) in the prepared statement.
    See SUBSTITUTION VARIABLES below for more details.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NAME&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Returns a reference to an array of field names for each column.
    The names may contain spaces but should not be truncated or have any
    trailing space. Note that the names have the letter case (upper, lower or
    mixed) as returned by the driver being used. Portable applications should
    use &quot;NAME_lc&quot; or &quot;NAME_uc&quot;.</p>
<p class="Pp"></p>
<pre>  print &quot;First column name: $sth-&gt;{NAME}-&gt;[0]\n&quot;;
</pre>
<p class="Pp">Also note that the name returned for (aggregate) functions like
    <span class="Li">count(*)</span> or
    <span class="Li">&quot;max(c_foo)&quot;</span> is determined by the database
    server and not by <span class="Li">&quot;DBI&quot;</span> or the
    <span class="Li">&quot;DBD&quot;</span> backend.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NAME_lc&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Like <span class="Li">&quot;/NAME&quot;</span> but always returns
    lowercase names.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NAME_uc&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Like <span class="Li">&quot;/NAME&quot;</span> but always returns
    uppercase names.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NAME_hash&quot;</i></span><i></i></p>
<p class="Pp">Type: hash-ref, read-only</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NAME_lc_hash&quot;</i></span><i></i></p>
<p class="Pp">Type: hash-ref, read-only</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NAME_uc_hash&quot;</i></span><i></i></p>
<p class="Pp">Type: hash-ref, read-only</p>
<p class="Pp">The <span class="Li">&quot;NAME_hash&quot;</span>,
    <span class="Li">&quot;NAME_lc_hash&quot;</span>, and
    <span class="Li">&quot;NAME_uc_hash&quot;</span> attributes return column
    name information as a reference to a hash.</p>
<p class="Pp">The keys of the hash are the names of the columns. The letter case
    of the keys corresponds to the letter case returned by the
    <span class="Li">&quot;NAME&quot;</span>,
    <span class="Li">&quot;NAME_lc&quot;</span>, and
    <span class="Li">&quot;NAME_uc&quot;</span> attributes respectively (as
    described above).</p>
<p class="Pp">The value of each hash entry is the perl index number of the
    corresponding column (counting from 0). For example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(&quot;select Id, Name from table&quot;);
  $sth-&gt;execute;
  @row = $sth-&gt;fetchrow_array;
  print &quot;Name $row[ $sth-&gt;{NAME_lc_hash}{name} ]\n&quot;;
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;TYPE&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Returns a reference to an array of integer values for each column.
    The value indicates the data type of the corresponding column.</p>
<p class="Pp">The values correspond to the international standards (ANSI X3.135
    and ISO/IEC 9075) which, in general terms, means ODBC. Driver-specific types
    that don't exactly match standard types should generally return the same
    values as an ODBC driver supplied by the makers of the database. That might
    include private type numbers in ranges the vendor has officially registered
    with the ISO working group:</p>
<p class="Pp"></p>
<pre>  ftp://sqlstandards.org/SC32/SQL_Registry/
</pre>
<p class="Pp">Where there's no vendor-supplied ODBC driver to be compatible
    with, the DBI driver can use type numbers in the range that is now
    officially reserved for use by the DBI: -9999 to -9000.</p>
<p class="Pp">All possible values for <span class="Li">&quot;TYPE&quot;</span>
    should have at least one entry in the output of the
    <span class="Li">&quot;type_info_all&quot;</span> method (see
    &quot;type_info_all&quot;).</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;PRECISION&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Returns a reference to an array of integer values for each
  column.</p>
<p class="Pp">For numeric columns, the value is the maximum number of digits
    (without considering a sign character or decimal point). Note that the
    &quot;display size&quot; for floating point types (REAL, FLOAT, DOUBLE) can
    be up to 7 characters greater than the precision (for the sign + decimal
    point + the letter E + a sign + 2 or 3 digits).</p>
<p class="Pp">For any character type column the value is the OCTET_LENGTH, in
    other words the number of bytes, not characters.</p>
<p class="Pp">(More recent standards refer to this as COLUMN_SIZE but we stick
    with PRECISION for backwards compatibility.)</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;SCALE&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Returns a reference to an array of integer values for each column.
    NULL (<span class="Li">&quot;undef&quot;</span>) values indicate columns
    where scale is not applicable.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;NULLABLE&quot;</i></span><i></i></p>
<p class="Pp">Type: array-ref, read-only</p>
<p class="Pp">Returns a reference to an array indicating the possibility of each
    column returning a null. Possible values are <span class="Li">0</span> (or
    an empty string) = no, <span class="Li">1</span> = yes,
    <span class="Li">2</span> = unknown.</p>
<p class="Pp"></p>
<pre>  print &quot;First column may return NULL\n&quot; if $sth-&gt;{NULLABLE}-&gt;[0];
</pre>
<p class="Pp"><i></i><span class="Li"><i>&quot;CursorName&quot;</i></span><i></i></p>
<p class="Pp">Type: string, read-only</p>
<p class="Pp">Returns the name of the cursor associated with the statement
    handle, if available. If not available or if the database driver does not
    support the <span class="Li">&quot;where current of ...&quot;</span> SQL
    syntax, then it returns <span class="Li">&quot;undef&quot;</span>.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Database&quot;</i></span><i></i></p>
<p class="Pp">Type: dbh, read-only</p>
<p class="Pp">Returns the parent <span class="Li">$dbh</span> of the statement
    handle.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;Statement&quot;</i></span><i></i></p>
<p class="Pp">Type: string, read-only</p>
<p class="Pp">Returns the statement string passed to the &quot;prepare&quot;
    method.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ParamValues&quot;</i></span><i></i></p>
<p class="Pp">Type: hash ref, read-only</p>
<p class="Pp">Returns a reference to a hash containing the values currently
    bound to placeholders. The keys of the hash are the 'names' of the
    placeholders, typically integers starting at 1. Returns undef if not
    supported by the driver.</p>
<p class="Pp">See &quot;ShowErrorStatement&quot; for an example of how this is
    used.</p>
<p class="Pp">* Keys:</p>
<p class="Pp">If the driver supports
    <span class="Li">&quot;ParamValues&quot;</span> but no values have been
    bound yet then the driver should return a hash with placeholders names in
    the keys but all the values undef, but some drivers may return a ref to an
    empty hash because they can't pre-determine the names.</p>
<p class="Pp">It is possible that the keys in the hash returned by
    <span class="Li">&quot;ParamValues&quot;</span> are not exactly the same as
    those implied by the prepared statement. For example, DBD::Oracle translates
    '<span class="Li">&quot;?&quot;</span>' placeholders into
    '<span class="Li">&quot;:pN&quot;</span>' where N is a sequence number
    starting at 1.</p>
<p class="Pp">* Values:</p>
<p class="Pp">It is possible that the values in the hash returned by
    <span class="Li">&quot;ParamValues&quot;</span> are not <i>exactly</i> the
    same as those passed to <b>bind_param()</b> or <b>execute()</b>. The driver
    may have slightly modified values in some way based on the TYPE the value
    was bound with. For example a floating point value bound as an SQL_INTEGER
    type may be returned as an integer. The values returned by
    <span class="Li">&quot;ParamValues&quot;</span> can be passed to another
    <b>bind_param()</b> method with the same TYPE and will be seen by the
    database as the same value. See also &quot;ParamTypes&quot; below.</p>
<p class="Pp">The <span class="Li">&quot;ParamValues&quot;</span> attribute was
    added in DBI 1.28.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ParamTypes&quot;</i></span><i></i></p>
<p class="Pp">Type: hash ref, read-only</p>
<p class="Pp">Returns a reference to a hash containing the type information
    currently bound to placeholders. Returns undef if not supported by the
    driver.</p>
<p class="Pp">* Keys:</p>
<p class="Pp">See &quot;ParamValues&quot; above.</p>
<p class="Pp">* Values:</p>
<p class="Pp">The hash values are hashrefs of type information in the same form
    as that passed to the various <b>bind_param()</b> methods (See
    &quot;bind_param&quot; for the format and values).</p>
<p class="Pp">It is possible that the values in the hash returned by
    <span class="Li">&quot;ParamTypes&quot;</span> are not exactly the same as
    those passed to <b>bind_param()</b> or <b>execute()</b>. Param attributes
    specified using the abbreviated form, like this:</p>
<p class="Pp"></p>
<pre>    $sth-&gt;bind_param(1, SQL_INTEGER);
</pre>
<p class="Pp">are returned in the expanded form, as if called like this:</p>
<p class="Pp"></p>
<pre>    $sth-&gt;bind_param(1, { TYPE =&gt; SQL_INTEGER });
</pre>
<p class="Pp">The driver may have modified the type information in some way
    based on the bound values, other hints provided by the <b>prepare()</b>'d
    SQL statement, or alternate type mappings required by the driver or target
    database system. The driver may also add private keys (with names beginning
    with the drivers reserved prefix, e.g., odbc_xxx).</p>
<p class="Pp">* Example:</p>
<p class="Pp">The keys and values in the returned hash can be passed to the
    various <b>bind_param()</b> methods to effectively reproduce a previous
    param binding. For example:</p>
<p class="Pp"></p>
<pre>  # assuming $sth1 is a previously prepared statement handle
  my $sth2 = $dbh-&gt;prepare( $sth1-&gt;{Statement} );
  my $ParamValues = $sth1-&gt;{ParamValues} || {};
  my $ParamTypes  = $sth1-&gt;{ParamTypes}  || {};
  $sth2-&gt;bind_param($_, $ParamValues-&gt;{$_}, $ParamTypes-&gt;{$_})
    for keys %{ {%$ParamValues, %$ParamTypes} };
  $sth2-&gt;execute();
</pre>
<p class="Pp">The <span class="Li">&quot;ParamTypes&quot;</span> attribute was
    added in DBI 1.49. Implementation is the responsibility of individual
    drivers; the DBI layer default implementation simply returns undef.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;ParamArrays&quot;</i></span><i></i></p>
<p class="Pp">Type: hash ref, read-only</p>
<p class="Pp">Returns a reference to a hash containing the values currently
    bound to placeholders with &quot;execute_array&quot; or
    &quot;bind_param_array&quot;. The keys of the hash are the 'names' of the
    placeholders, typically integers starting at 1. Returns undef if not
    supported by the driver or no arrays of parameters are bound.</p>
<p class="Pp">Each key value is an array reference containing a list of the
    bound parameters for that column.</p>
<p class="Pp">For example:</p>
<p class="Pp"></p>
<pre>  $sth = $dbh-&gt;prepare(&quot;INSERT INTO staff (id, name) values (?,?)&quot;);
  $sth-&gt;execute_array({},[1,2], ['fred','dave']);
  if ($sth-&gt;{ParamArrays}) {
      foreach $param (keys %{$sth-&gt;{ParamArrays}}) {
          printf &quot;Parameters for %s : %s\n&quot;, $param,
          join(&quot;,&quot;, @{$sth-&gt;{ParamArrays}-&gt;{$param}});
      }
  }
</pre>
<p class="Pp">It is possible that the values in the hash returned by
    <span class="Li">&quot;ParamArrays&quot;</span> are not <i>exactly</i> the
    same as those passed to &quot;bind_param_array&quot; or
    &quot;execute_array&quot;. The driver may have slightly modified values in
    some way based on the TYPE the value was bound with. For example a floating
    point value bound as an SQL_INTEGER type may be returned as an integer.</p>
<p class="Pp">It is also possible that the keys in the hash returned by
    <span class="Li">&quot;ParamArrays&quot;</span> are not exactly the same as
    those implied by the prepared statement. For example, DBD::Oracle translates
    '<span class="Li">&quot;?&quot;</span>' placeholders into
    '<span class="Li">&quot;:pN&quot;</span>' where N is a sequence number
    starting at 1.</p>
<p class="Pp"><i></i><span class="Li"><i>&quot;RowsInCache&quot;</i></span><i></i></p>
<p class="Pp">Type: integer, read-only</p>
<p class="Pp">If the driver supports a local row cache for
    <span class="Li">&quot;SELECT&quot;</span> statements, then this attribute
    holds the number of un-fetched rows in the cache. If the driver doesn't,
    then it returns <span class="Li">&quot;undef&quot;</span>. Note that some
    drivers pre-fetch rows on execute, whereas others wait till the first
  fetch.</p>
<p class="Pp">See also the &quot;RowCacheSize&quot; database handle
  attribute.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="FURTHER_INFORMATION"><a class="permalink" href="#FURTHER_INFORMATION">FURTHER
  INFORMATION</a></h1>
<section class="Ss">
<h2 class="Ss" id="Catalog_Methods"><a class="permalink" href="#Catalog_Methods">Catalog
  Methods</a></h2>
<p class="Pp">An application can retrieve metadata information from the DBMS by
    issuing appropriate queries on the views of the Information Schema.
    Unfortunately, <span class="Li">&quot;INFORMATION_SCHEMA&quot;</span> views
    are seldom supported by the DBMS. Special methods (catalog methods) are
    available to return result sets for a small but important portion of that
    metadata:</p>
<p class="Pp"></p>
<pre>  column_info
  foreign_key_info
  primary_key_info
  table_info
  statistics_info
</pre>
<p class="Pp">All catalog methods accept arguments in order to restrict the
    result sets. Passing <span class="Li">&quot;undef&quot;</span> to an
    optional argument does not constrain the search for that argument. However,
    an empty string ('') is treated as a regular search criteria and will only
    match an empty value.</p>
<p class="Pp"><b>Note</b>: SQL/CLI and ODBC differ in the handling of empty
    strings. An empty string will not restrict the result set in SQL/CLI.</p>
<p class="Pp">Most arguments in the catalog methods accept only <i>ordinary
    values</i>, e.g. the arguments of
    <span class="Li">&quot;primary_key_info()&quot;</span>. Such arguments are
    treated as a literal string, i.e. the case is significant and quote
    characters are taken literally.</p>
<p class="Pp">Some arguments in the catalog methods accept <i>search
    patterns</i> (strings containing '_' and/or '%'), e.g. the
    <span class="Li">$table</span> argument of
    <span class="Li">&quot;column_info()&quot;</span>. Passing '%' is equivalent
    to leaving the argument <span class="Li">&quot;undef&quot;</span>.</p>
<p class="Pp"><b>Caveat</b>: The underscore ('_') is valid and often used in SQL
    identifiers. Passing such a value to a search pattern argument may return
    more rows than expected! To include pattern characters as literals, they
    must be preceded by an escape character which can be achieved with</p>
<p class="Pp"></p>
<pre>  $esc = $dbh-&gt;get_info( 14 );  # SQL_SEARCH_PATTERN_ESCAPE
  $search_pattern =~ s/([_%])/$esc$1/g;
</pre>
<p class="Pp">The ODBC and SQL/CLI specifications define a way to change the
    default behaviour described above: All arguments (except <i>list value
    arguments</i>) are treated as <i>identifier</i> if the
    <span class="Li">&quot;SQL_ATTR_METADATA_ID&quot;</span> attribute is set to
    <span class="Li">&quot;SQL_TRUE&quot;</span>. <i>Quoted identifiers</i> are
    very similar to <i>ordinary values</i>, i.e. their body (the string within
    the quotes) is interpreted literally. <i>Unquoted identifiers</i> are
    compared in UPPERCASE.</p>
<p class="Pp">The DBI (currently) does not support the
    <span class="Li">&quot;SQL_ATTR_METADATA_ID&quot;</span> attribute, i.e. it
    behaves like an ODBC driver where
    <span class="Li">&quot;SQL_ATTR_METADATA_ID&quot;</span> is set to
    <span class="Li">&quot;SQL_FALSE&quot;</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Transactions"><a class="permalink" href="#Transactions">Transactions</a></h2>
<p class="Pp">Transactions are a fundamental part of any robust database system.
    They protect against errors and database corruption by ensuring that sets of
    related changes to the database take place in atomic (indivisible,
    all-or-nothing) units.</p>
<p class="Pp">This section applies to databases that support transactions and
    where <span class="Li">&quot;AutoCommit&quot;</span> is off. See
    &quot;AutoCommit&quot; for details of using
    <span class="Li">&quot;AutoCommit&quot;</span> with various types of
    databases.</p>
<p class="Pp">The recommended way to implement robust transactions in Perl
    applications is to enable &quot;RaiseError&quot; and catch the error that's
    'thrown' as an exception. For example, using Try::Tiny:</p>
<p class="Pp"></p>
<pre>  use Try::Tiny;
  $dbh-&gt;{AutoCommit} = 0;  # enable transactions, if possible
  $dbh-&gt;{RaiseError} = 1;
  try {
      foo(...)        # do lots of work here
      bar(...)        # including inserts
      baz(...)        # and updates
      $dbh-&gt;commit;   # commit the changes if we get this far
  } catch {
      warn &quot;Transaction aborted because $_&quot;; # Try::Tiny copies $@ into $_
      # now rollback to undo the incomplete changes
      # but do it in an eval{} as it may also fail
      eval { $dbh-&gt;rollback };
      # add other application on-error-clean-up code here
  };
</pre>
<p class="Pp">If the <span class="Li">&quot;RaiseError&quot;</span> attribute is
    not set, then DBI calls would need to be manually checked for errors,
    typically like this:</p>
<p class="Pp"></p>
<pre>  $h-&gt;method(@args) or die $h-&gt;errstr;
</pre>
<p class="Pp">With <span class="Li">&quot;RaiseError&quot;</span> set, the DBI
    will automatically <span class="Li">&quot;die&quot;</span> if any DBI method
    call on that handle (or a child handle) fails, so you don't have to test the
    return value of each method call. See &quot;RaiseError&quot; for more
    details.</p>
<p class="Pp">A major advantage of the <span class="Li">&quot;eval&quot;</span>
    approach is that the transaction will be properly rolled back if <i>any</i>
    code (not just DBI calls) in the inner application dies for any reason. The
    major advantage of using the
    <span class="Li">&quot;$h-&gt;{RaiseError}&quot;</span> attribute is that
    all DBI calls will be checked automatically. Both techniques are strongly
    recommended.</p>
<p class="Pp">After calling <span class="Li">&quot;commit&quot;</span> or
    <span class="Li">&quot;rollback&quot;</span> many drivers will not let you
    fetch from a previously active <span class="Li">&quot;SELECT&quot;</span>
    statement handle that's a child of the same database handle. A typical way
    round this is to connect the the database twice and use one connection for
    <span class="Li">&quot;SELECT&quot;</span> statements.</p>
<p class="Pp">See &quot;AutoCommit&quot; and &quot;disconnect&quot; for other
    important information about transactions.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Handling_"><a class="permalink" href="#Handling_">Handling
  BLOB / LONG / Memo Fields</a></h2>
<p class="Pp">Many databases support &quot;blob&quot; (binary large objects),
    &quot;long&quot;, or similar datatypes for holding very long strings or
    large amounts of binary data in a single field. Some databases support
    variable length long values over 2,000,000,000 bytes in length.</p>
<p class="Pp">Since values of that size can't usually be held in memory, and
    because databases can't usually know in advance the length of the longest
    long that will be returned from a <span class="Li">&quot;SELECT&quot;</span>
    statement (unlike other data types), some special handling is required.</p>
<p class="Pp">In this situation, the value of the
    <span class="Li">&quot;$h-&gt;{LongReadLen}&quot;</span> attribute is used
    to determine how much buffer space to allocate when fetching such fields.
    The <span class="Li">&quot;$h-&gt;{LongTruncOk}&quot;</span> attribute is
    used to determine how to behave if a fetched value can't fit into the
    buffer.</p>
<p class="Pp">See the description of &quot;LongReadLen&quot; for more
    information.</p>
<p class="Pp">When trying to insert long or binary values, placeholders should
    be used since there are often limits on the maximum size of an
    <span class="Li">&quot;INSERT&quot;</span> statement and the
    &quot;quote&quot; method generally can't cope with binary data. See
    &quot;Placeholders and Bind Values&quot;.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Simple_Examples"><a class="permalink" href="#Simple_Examples">Simple
  Examples</a></h2>
<p class="Pp">Here's a complete example program to select and fetch some
  data:</p>
<p class="Pp"></p>
<pre>  my $data_source = &quot;dbi::DriverName:db_name&quot;;
  my $dbh = DBI-&gt;connect($data_source, $user, $password)
      or die &quot;Can't connect to $data_source: $DBI::errstr&quot;;
  my $sth = $dbh-&gt;prepare( q{
          SELECT name, phone
          FROM mytelbook
  }) or die &quot;Can't prepare statement: $DBI::errstr&quot;;
  my $rc = $sth-&gt;execute
      or die &quot;Can't execute statement: $DBI::errstr&quot;;
  print &quot;Query will return $sth-&gt;{NUM_OF_FIELDS} fields.\n\n&quot;;
  print &quot;Field names: @{ $sth-&gt;{NAME} }\n&quot;;
  while (($name, $phone) = $sth-&gt;fetchrow_array) {
      print &quot;$name: $phone\n&quot;;
  }
  # check for problems which may have terminated the fetch early
  die $sth-&gt;errstr if $sth-&gt;err;
  $dbh-&gt;disconnect;
</pre>
<p class="Pp">Here's a complete example program to insert some data from a file.
    (This example uses <span class="Li">&quot;RaiseError&quot;</span> to avoid
    needing to check each call).</p>
<p class="Pp"></p>
<pre>  my $dbh = DBI-&gt;connect(&quot;dbi:DriverName:db_name&quot;, $user, $password, {
      RaiseError =&gt; 1, AutoCommit =&gt; 0
  });
  my $sth = $dbh-&gt;prepare( q{
      INSERT INTO table (name, phone) VALUES (?, ?)
  });
  open FH, &quot;&lt;phone.csv&quot; or die &quot;Unable to open phone.csv: $!&quot;;
  while (&lt;FH&gt;) {
      chomp;
      my ($name, $phone) = split /,/;
      $sth-&gt;execute($name, $phone);
  }
  close FH;
  $dbh-&gt;commit;
  $dbh-&gt;disconnect;
</pre>
<p class="Pp">Here's how to convert fetched NULLs (undefined values) into empty
    strings:</p>
<p class="Pp"></p>
<pre>  while($row = $sth-&gt;fetchrow_arrayref) {
    # this is a fast and simple way to deal with nulls:
    foreach (@$row) { $_ = '' unless defined }
    print &quot;@$row\n&quot;;
  }
</pre>
<p class="Pp">The <span class="Li">&quot;q{...}&quot;</span> style quoting used
    in these examples avoids clashing with quotes that may be used in the SQL
    statement. Use the double-quote like
    <span class="Li">&quot;qq{...}&quot;</span> operator if you want to
    interpolate variables into the string. See &quot;Quote and Quote-like
    Operators&quot; in perlop for more details.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Threads_and_Thread_Safety"><a class="permalink" href="#Threads_and_Thread_Safety">Threads
  and Thread Safety</a></h2>
<p class="Pp">Perl 5.7 and later support a new threading model called iThreads.
    (The old &quot;5.005 style&quot; threads are not supported by the DBI.)</p>
<p class="Pp">In the iThreads model each thread has its own copy of the perl
    interpreter. When a new thread is created the original perl interpreter is
    'cloned' to create a new copy for the new thread.</p>
<p class="Pp">If the DBI and drivers are loaded and handles created before the
    thread is created then it will get a cloned copy of the DBI, the drivers and
    the handles.</p>
<p class="Pp">However, the internal pointer data within the handles will refer
    to the DBI and drivers in the original interpreter. Using those handles in
    the new interpreter thread is not safe, so the DBI detects this and croaks
    on any method call using handles that don't belong to the current thread
    (except for DESTROY).</p>
<p class="Pp">Because of this (possibly temporary) restriction, newly created
    threads must make their own connections to the database. Handles can't be
    shared across threads.</p>
<p class="Pp">But BEWARE, some underlying database APIs (the code the DBD driver
    uses to talk to the database, often supplied by the database vendor) are not
    thread safe. If it's not thread safe, then allowing more than one thread to
    enter the code at the same time may cause subtle/serious problems. In some
    cases allowing more than one thread to enter the code, even if <i>not</i> at
    the same time, can cause problems. You have been warned.</p>
<p class="Pp">Using DBI with perl threads is not yet recommended for production
    environments. For more information see
    &lt;http://www.perlmonks.org/index.pl?node_id=288022&gt;</p>
<p class="Pp">Note: There is a bug in perl 5.8.2 when configured with threads
    and debugging enabled (bug #24463) which causes a DBI test to fail.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Signal_Handling_and_Canceling_Operations"><a class="permalink" href="#Signal_Handling_and_Canceling_Operations">Signal
  Handling and Canceling Operations</a></h2>
<p class="Pp">[The following only applies to systems with unix-like signal
    handling. I'd welcome additions for other systems, especially Windows.]</p>
<p class="Pp">The first thing to say is that signal handling in Perl versions
    less than 5.8 is <i>not</i> safe. There is always a small risk of Perl
    crashing and/or core dumping when, or after, handling a signal because the
    signal could arrive and be handled while internal data structures are being
    changed. If the signal handling code used those same internal data
    structures it could cause all manner of subtle and not-so-subtle problems.
    The risk was reduced with 5.4.4 but was still present in all perls up
    through 5.8.0.</p>
<p class="Pp">Beginning in perl 5.8.0 perl implements 'safe' signal handling if
    your system has the POSIX <b>sigaction()</b> routine. Now when a signal is
    delivered perl just makes a note of it but does <i>not</i> run the
    <span class="Li">%SIG</span> handler. The handling is 'deferred' until a
    'safe' moment.</p>
<p class="Pp">Although this change made signal handling safe, it also lead to a
    problem with signals being deferred for longer than you'd like. If a signal
    arrived while executing a system call, such as waiting for data on a network
    connection, the signal is noted and then the system call that was executing
    returns with an EINTR error code to indicate that it was interrupted. All
    fine so far.</p>
<p class="Pp">The problem comes when the code that made the system call sees the
    EINTR code and decides it's going to call it again. Perl doesn't do that,
    but database code sometimes does. If that happens then the signal handler
    doesn't get called until later. Maybe much later.</p>
<p class="Pp">Fortunately there are ways around this which we'll discuss below.
    Unfortunately they make signals unsafe again.</p>
<p class="Pp">The two most common uses of signals in relation to the DBI are for
    canceling operations when the user types Ctrl-C (interrupt), and for
    implementing a timeout using <span class="Li">&quot;alarm()&quot;</span> and
    <span class="Li">$SIG{ALRM}</span>.</p>
<dl class="Bl-tag">
  <dt id="Cancel"><a class="permalink" href="#Cancel">Cancel</a></dt>
  <dd>The DBI provides a <span class="Li">&quot;cancel&quot;</span> method for
      statement handles. The <span class="Li">&quot;cancel&quot;</span> method
      should abort the current operation and is designed to be called from a
      signal handler. For example:
    <p class="Pp"></p>
    <pre>  $SIG{INT} = sub { $sth-&gt;cancel };
    </pre>
    <p class="Pp">However, few drivers implement this (the DBI provides a
        default method that just returns
        <span class="Li">&quot;undef&quot;</span>) and, even if implemented,
        there is still a possibility that the statement handle, and even the
        parent database handle, will not be usable afterwards.</p>
    <p class="Pp">If <span class="Li">&quot;cancel&quot;</span> returns true,
        then it has successfully invoked the database engine's own cancel
        function. If it returns false, then
        <span class="Li">&quot;cancel&quot;</span> failed. If it returns
        <span class="Li">&quot;undef&quot;</span>, then the database driver does
        not have cancel implemented - very few do.</p>
  </dd>
  <dt id="Timeout"><a class="permalink" href="#Timeout">Timeout</a></dt>
  <dd>The traditional way to implement a timeout is to set
      <span class="Li">$SIG{ALRM}</span> to refer to some code that will be
      executed when an ALRM signal arrives and then to call alarm($seconds) to
      schedule an ALRM signal to be delivered <span class="Li">$seconds</span>
      in the future. For example:
    <p class="Pp"></p>
    <pre>  my $failed;
  eval {
    local $SIG{ALRM} = sub { die &quot;TIMEOUT\n&quot; }; # N.B. \n required
    eval {
      alarm($seconds);
      ... code to execute with timeout here (which may die) ...
      1;
    } or $failed = 1;
    # outer eval catches alarm that might fire JUST before this alarm(0)
    alarm(0);  # cancel alarm (if code ran fast)
    die &quot;$@&quot; if $failed;
    1;
  } or $failed = 1;
  if ( $failed ) {
    if ( defined $@ and $@ eq &quot;TIMEOUT\n&quot; ) { ... }
    else { ... } # some other error
  }
    </pre>
    <p class="Pp">The first (outer) eval is used to avoid the unlikely but
        possible chance that the &quot;code to execute&quot; dies and the alarm
        fires before it is cancelled. Without the outer eval, if this happened
        your program will die if you have no ALRM handler or a non-local alarm
        handler will be called.</p>
    <p class="Pp">Unfortunately, as described above, this won't always work as
        expected, depending on your perl version and the underlying database
        code.</p>
    <p class="Pp">With Oracle for instance (DBD::Oracle), if the system which
        hosts the database is down the DBI-&gt;<b>connect()</b> call will hang
        for several minutes before returning an error.</p>
  </dd>
</dl>
<p class="Pp">The solution on these systems is to use the
    <span class="Li">&quot;POSIX::sigaction()&quot;</span> routine to gain low
    level access to how the signal handler is installed.</p>
<p class="Pp">The code would look something like this (for the DBD-Oracle
    <b>connect()</b>):</p>
<p class="Pp"></p>
<pre>   use POSIX qw(:signal_h);
   my $mask = POSIX::SigSet-&gt;new( SIGALRM ); # signals to mask in the handler
   my $action = POSIX::SigAction-&gt;new(
       sub { die &quot;connect timeout\n&quot; },        # the handler code ref
       $mask,
       # not using (perl 5.8.2 and later) 'safe' switch or sa_flags
   );
   my $oldaction = POSIX::SigAction-&gt;new();
   sigaction( SIGALRM, $action, $oldaction );
   my $dbh;
   my $failed;
   eval {
      eval {
        alarm(5); # seconds before time out
        $dbh = DBI-&gt;connect(&quot;dbi:Oracle:$dsn&quot; ... );
        1;
      } or $failed = 1;
      alarm(0); # cancel alarm (if connect worked fast)
      die &quot;$@\n&quot; if $failed; # connect died
      1;
   } or $failed = 1;
   sigaction( SIGALRM, $oldaction );  # restore original signal handler
   if ( $failed ) {
     if ( defined $@ and $@ eq &quot;connect timeout\n&quot; ) {...}
     else { # connect died }
   }
</pre>
<p class="Pp">See previous example for the reasoning around the double eval.</p>
<p class="Pp">Similar techniques can be used for canceling statement
  execution.</p>
<p class="Pp">Unfortunately, this solution is somewhat messy, and it does
    <i>not</i> work with perl versions less than perl 5.8 where
    <span class="Li">&quot;POSIX::sigaction()&quot;</span> appears to be
  broken.</p>
<p class="Pp">For a cleaner implementation that works across perl versions, see
    Lincoln Baxter's Sys::SigAction module at Sys::SigAction. The documentation
    for Sys::SigAction includes an longer discussion of this problem, and a
    DBD::Oracle test script.</p>
<p class="Pp">Be sure to read all the signal handling sections of the perlipc
    manual.</p>
<p class="Pp">And finally, two more points to keep firmly in mind. Firstly,
    remember that what we've done here is essentially revert to old style
    <i>unsafe</i> handling of these signals. So do as little as possible in the
    handler. Ideally just <b>die()</b>. Secondly, the handles in use at the time
    the signal is handled may not be safe to use afterwards.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Subclassing_the_"><a class="permalink" href="#Subclassing_the_">Subclassing
  the DBI</a></h2>
<p class="Pp">DBI can be subclassed and extended just like any other object
    oriented module. Before we talk about how to do that, it's important to be
    clear about the various DBI classes and how they work together.</p>
<p class="Pp">By default <span class="Li">&quot;$dbh =
    DBI-&gt;connect(...)&quot;</span> returns a <span class="Li">$dbh</span>
    blessed into the <span class="Li">&quot;DBI::db&quot;</span> class. And the
    <span class="Li">&quot;$dbh-&gt;prepare&quot;</span> method returns an
    <span class="Li">$sth</span> blessed into the
    <span class="Li">&quot;DBI::st&quot;</span> class (actually it simply
    changes the last four characters of the calling handle class to be
    <span class="Li">&quot;::st&quot;</span>).</p>
<p class="Pp">The leading '<span class="Li">&quot;DBI&quot;</span>' is known as
    the 'root class' and the extra '<span class="Li">&quot;::db&quot;</span>' or
    '<span class="Li">&quot;::st&quot;</span>' are the 'handle type suffixes'.
    If you want to subclass the DBI you'll need to put your overriding methods
    into the appropriate classes. For example, if you want to use a root class
    of <span class="Li">&quot;MySubDBI&quot;</span> and override the
    <b>do()</b>, <b>prepare()</b> and <b>execute()</b> methods, then your
    <b>do()</b> and <b>prepare()</b> methods should be in the
    <span class="Li">&quot;MySubDBI::db&quot;</span> class and the
    <b>execute()</b> method should be in the
    <span class="Li">&quot;MySubDBI::st&quot;</span> class.</p>
<p class="Pp">To setup the inheritance hierarchy the
    <span class="Li">@ISA</span> variable in
    <span class="Li">&quot;MySubDBI::db&quot;</span> should include
    <span class="Li">&quot;DBI::db&quot;</span> and the
    <span class="Li">@ISA</span> variable in
    <span class="Li">&quot;MySubDBI::st&quot;</span> should include
    <span class="Li">&quot;DBI::st&quot;</span>. The
    <span class="Li">&quot;MySubDBI&quot;</span> root class itself isn't
    currently used for anything visible and so, apart from setting
    <span class="Li">@ISA</span> to include
    <span class="Li">&quot;DBI&quot;</span>, it can be left empty.</p>
<p class="Pp">So, having put your overriding methods into the right classes, and
    setup the inheritance hierarchy, how do you get the DBI to use them? You
    have two choices, either a static method call using the name of your
    subclass:</p>
<p class="Pp"></p>
<pre>  $dbh = MySubDBI-&gt;connect(...);
</pre>
<p class="Pp">or specifying a <span class="Li">&quot;RootClass&quot;</span>
    attribute:</p>
<p class="Pp"></p>
<pre>  $dbh = DBI-&gt;connect(..., { RootClass =&gt; 'MySubDBI' });
</pre>
<p class="Pp">If both forms are used then the attribute takes precedence.</p>
<p class="Pp">The only differences between the two are that using an explicit
    RootClass attribute will a) make the DBI automatically attempt to load a
    module by that name if the class doesn't exist, and b) won't call your
    <b>MySubDBI::connect()</b> method, if you have one.</p>
<p class="Pp">When subclassing is being used then, after a successful new
    connect, the DBI-&gt;connect method automatically calls:</p>
<p class="Pp"></p>
<pre>  $dbh-&gt;connected($dsn, $user, $pass, \%attr);
</pre>
<p class="Pp">The default method does nothing. The call is made just to simplify
    any post-connection setup that your subclass may want to perform. The
    parameters are the same as passed to DBI-&gt;connect. If your subclass
    supplies a connected method, it should be part of the MySubDBI::db
  package.</p>
<p class="Pp">One more thing to note: you must let the DBI do the handle
    creation. If you want to override the <b>connect()</b> method in your *::dr
    class then it must still call SUPER::connect to get a
    <span class="Li">$dbh</span> to work with. Similarly, an overridden
    <b>prepare()</b> method in *::db must still call SUPER::prepare to get a
    <span class="Li">$sth</span>. If you try to create your own handles using
    <b>bless()</b> then you'll find the DBI will reject them with an &quot;is
    not a DBI handle (has no magic)&quot; error.</p>
<p class="Pp">Here's a brief example of a DBI subclass. A more thorough example
    can be found in <i>t/subclass.t</i> in the DBI distribution.</p>
<p class="Pp"></p>
<pre>  package MySubDBI;
  use strict;
  use DBI;
  use vars qw(@ISA);
  @ISA = qw(DBI);
  package MySubDBI::db;
  use vars qw(@ISA);
  @ISA = qw(DBI::db);
  sub prepare {
    my ($dbh, @args) = @_;
    my $sth = $dbh-&gt;SUPER::prepare(@args)
        or return;
    $sth-&gt;{private_mysubdbi_info} = { foo =&gt; 'bar' };
    return $sth;
  }
  package MySubDBI::st;
  use vars qw(@ISA);
  @ISA = qw(DBI::st);
  sub fetch {
    my ($sth, @args) = @_;
    my $row = $sth-&gt;SUPER::fetch(@args)
        or return;
    do_something_magical_with_row_data($row)
        or return $sth-&gt;set_err(1234, &quot;The magic failed&quot;, undef, &quot;fetch&quot;);
    return $row;
  }
</pre>
<p class="Pp">When calling a SUPER::method that returns a handle, be careful to
    check the return value before trying to do other things with it in your
    overridden method. This is especially important if you want to set a hash
    attribute on the handle, as Perl's autovivification will bite you by
    (in)conveniently creating an unblessed hashref, which your method will then
    return with usually baffling results later on like the error
    &quot;dbih_getcom handle HASH(0xa4451a8) is not a DBI handle (has no
    magic&quot;. It's best to check right after the call and return undef
    immediately on error, just like DBI would and just like the example
  above.</p>
<p class="Pp">If your method needs to record an error it should call the
    <b>set_err()</b> method with the error code and error string, as shown in
    the example above. The error code and error string will be recorded in the
    handle and available via <span class="Li">&quot;$h-&gt;err&quot;</span> and
    <span class="Li">$DBI::errstr</span> etc. The <b>set_err()</b> method always
    returns an undef or empty list as appropriate. Since your method should
    nearly always return an undef or empty list as soon as an error is detected
    it's handy to simply return what <b>set_err()</b> returns, as shown in the
    example above.</p>
<p class="Pp">If the handle has <span class="Li">&quot;RaiseError&quot;</span>,
    <span class="Li">&quot;PrintError&quot;</span>, or
    <span class="Li">&quot;HandleError&quot;</span> etc. set then the
    <b>set_err()</b> method will honour them. This means that if
    <span class="Li">&quot;RaiseError&quot;</span> is set then <b>set_err()</b>
    won't return in the normal way but will 'throw an exception' that can be
    caught with an <span class="Li">&quot;eval&quot;</span> block.</p>
<p class="Pp">You can stash private data into DBI handles via
    <span class="Li">&quot;$h-&gt;{private_..._*}&quot;</span>. See the entry
    under &quot;ATTRIBUTES COMMON TO ALL HANDLES&quot; for info and important
    caveats.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Memory_Leaks"><a class="permalink" href="#Memory_Leaks">Memory
  Leaks</a></h2>
<p class="Pp">When tracking down memory leaks using tools like Devel::Leak
    you'll find that some DBI internals are reported as 'leaking' memory. This
    is very unlikely to be a real leak. The DBI has various caches to improve
    performance and the apparrent leaks are simply the normal operation of these
    caches.</p>
<p class="Pp">The most frequent sources of the apparrent leaks are
    &quot;ChildHandles&quot;, &quot;prepare_cached&quot; and
    &quot;connect_cached&quot;.</p>
<p class="Pp">For example
    http://stackoverflow.com/questions/13338308/perl-dbi-memory-leak</p>
<p class="Pp">Given how widely the DBI is used, you can rest assured that if a
    new release of the DBI did have a real leak it would be discovered,
    reported, and fixed immediately. The leak you're looking for is probably
    elsewhere. Good luck!</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="TRACING"><a class="permalink" href="#TRACING">TRACING</a></h1>
<p class="Pp">The DBI has a powerful tracing mechanism built in. It enables you
    to see what's going on 'behind the scenes', both within the DBI and the
    drivers you're using.</p>
<section class="Ss">
<h2 class="Ss" id="Trace_Settings"><a class="permalink" href="#Trace_Settings">Trace
  Settings</a></h2>
<p class="Pp">Which details are written to the trace output is controlled by a
    combination of a <i>trace level</i>, an integer from 0 to 15, and a set of
    <i>trace flags</i> that are either on or off. Together these are known as
    the <i>trace settings</i> and are stored together in a single integer. For
    normal use you only need to set the trace level, and generally only to a
    value between 1 and 4.</p>
<p class="Pp">Each handle has its own trace settings, and so does the DBI. When
    you call a method the DBI merges the handles settings into its own for the
    duration of the call: the trace flags of the handle are OR'd into the trace
    flags of the DBI, and if the handle has a higher trace level then the DBI
    trace level is raised to match it. The previous DBI trace settings are
    restored when the called method returns.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Trace_Levels"><a class="permalink" href="#Trace_Levels">Trace
  Levels</a></h2>
<p class="Pp">Trace <i>levels</i> are as follows:</p>
<p class="Pp"></p>
<pre>  0 - Trace disabled.
  1 - Trace top-level DBI method calls returning with results or errors.
  2 - As above, adding tracing of top-level method entry with parameters.
  3 - As above, adding some high-level information from the driver
      and some internal information from the DBI.
  4 - As above, adding more detailed information from the driver.
      This is the first level to trace all the rows being fetched.
  5 to 15 - As above but with more and more internal information.
</pre>
<p class="Pp">Trace level 1 is best for a simple overview of what's happening.
    Trace levels 2 thru 4 a good choice for general purpose tracing. Levels 5
    and above are best reserved for investigating a specific problem, when you
    need to see &quot;inside&quot; the driver and DBI.</p>
<p class="Pp">The trace output is detailed and typically very useful. Much of
    the trace output is formatted using the &quot;neat&quot; function, so
    strings in the trace output may be edited and truncated by that
  function.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Trace_Flags"><a class="permalink" href="#Trace_Flags">Trace
  Flags</a></h2>
<p class="Pp">Trace <i>flags</i> are used to enable tracing of specific
    activities within the DBI and drivers. The DBI defines some trace flags and
    drivers can define others. DBI trace flag names begin with a capital letter
    and driver specific names begin with a lowercase letter, as usual.</p>
<p class="Pp">Currently the DBI defines these trace flags:</p>
<p class="Pp"></p>
<pre>  ALL - turn on all DBI and driver flags (not recommended)
  SQL - trace SQL statements executed
        (not yet implemented in DBI but implemented in some DBDs)
  CON - trace connection process
  ENC - trace encoding (unicode translations etc)
        (not yet implemented in DBI but implemented in some DBDs)
  DBD - trace only DBD messages
        (not implemented by all DBDs yet)
  TXN - trace transactions
        (not implemented in all DBDs yet)
</pre>
<p class="Pp">The &quot;parse_trace_flags&quot; and &quot;parse_trace_flag&quot;
    methods are used to convert trace flag names into the corresponding integer
    bit flags.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Enabling_Trace"><a class="permalink" href="#Enabling_Trace">Enabling
  Trace</a></h2>
<p class="Pp">The <span class="Li">&quot;$h-&gt;trace&quot;</span> method sets
    the trace settings for a handle and
    <span class="Li">&quot;DBI-&gt;trace&quot;</span> does the same for the
  DBI.</p>
<p class="Pp">In addition to the &quot;trace&quot; method, you can enable the
    same trace information, and direct the output to a file, by setting the
    <span class="Li">&quot;DBI_TRACE&quot;</span> environment variable before
    starting Perl. See &quot;DBI_TRACE&quot; for more information.</p>
<p class="Pp">Finally, you can set, or get, the trace settings for a handle
    using the <span class="Li">&quot;TraceLevel&quot;</span> attribute.</p>
<p class="Pp">All of those methods use <b>parse_trace_flags()</b> and so allow
    you set both the trace level and multiple trace flags by using a string
    containing the trace level and/or flag names separated by vertical bar
    (&quot;<span class="Li">&quot;|&quot;</span>&quot;) or comma
    (&quot;<span class="Li">&quot;,&quot;</span>&quot;) characters. For
  example:</p>
<p class="Pp"></p>
<pre>  local $h-&gt;{TraceLevel} = &quot;3|SQL|foo&quot;;
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Trace_Output"><a class="permalink" href="#Trace_Output">Trace
  Output</a></h2>
<p class="Pp">Initially trace output is written to
    <span class="Li">&quot;STDERR&quot;</span>. Both the
    <span class="Li">&quot;$h-&gt;trace&quot;</span> and
    <span class="Li">&quot;DBI-&gt;trace&quot;</span> methods take an optional
    <span class="Li">$trace_file</span> parameter, which may be either the name
    of a file to be opened by DBI in append mode, or a reference to an existing
    writable (possibly layered) filehandle. If
    <span class="Li">$trace_file</span> is a filename, and can be opened in
    append mode, or <span class="Li">$trace_file</span> is a writable
    filehandle, then <i>all</i> trace output (currently including that from
    other handles) is redirected to that file. A warning is generated if
    <span class="Li">$trace_file</span> can't be opened or is not writable.</p>
<p class="Pp">Further calls to <b>trace()</b> without
    <span class="Li">$trace_file</span> do not alter where the trace output is
    sent. If <span class="Li">$trace_file</span> is undefined, then trace output
    is sent to <span class="Li">&quot;STDERR&quot;</span> and, if the prior
    trace was opened with <span class="Li">$trace_file</span> as a filename, the
    previous trace file is closed; if <span class="Li">$trace_file</span> was a
    filehandle, the filehandle is <b>not</b> closed.</p>
<p class="Pp"><b>NOTE</b>: If <span class="Li">$trace_file</span> is specified
    as a filehandle, the filehandle should not be closed until all DBI
    operations are completed, or the application has reset the trace file via
    another call to <span class="Li">&quot;trace()&quot;</span> that changes the
    trace file.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Tracing_to_Layered_Filehandles"><a class="permalink" href="#Tracing_to_Layered_Filehandles">Tracing
  to Layered Filehandles</a></h2>
<p class="Pp"><b>NOTE</b>:</p>
<ul class="Bl-bullet">
  <li>Tied filehandles are not currently supported, as tie operations are not
      available to the PerlIO methods used by the DBI.</li>
  <li>PerlIO layer support requires Perl version 5.8 or higher.</li>
</ul>
<p class="Pp">As of version 5.8, Perl provides the ability to layer various
    &quot;disciplines&quot; on an open filehandle via the PerlIO module.</p>
<p class="Pp">A simple example of using PerlIO layers is to use a scalar as the
    output:</p>
<p class="Pp"></p>
<pre>    my $scalar = '';
    open( my $fh, &quot;+&gt;:scalar&quot;, \$scalar );
    $dbh-&gt;trace( 2, $fh );
</pre>
<p class="Pp">Now all trace output is simply appended to
    <span class="Li">$scalar</span>.</p>
<p class="Pp">A more complex application of tracing to a layered filehandle is
    the use of a custom layer (<i>Refer to </i>Perlio::via <i>for details</i>
    <i>on creating custom PerlIO layers.</i>). Consider an application with the
    following logger module:</p>
<p class="Pp"></p>
<pre>    package MyFancyLogger;
    sub new
    {
        my $self = {};
        my $fh;
        open $fh, '&gt;', 'fancylog.log';
        $self-&gt;{_fh} = $fh;
        $self-&gt;{_buf} = '';
        return bless $self, shift;
    }
    sub log
    {
        my $self = shift;
        return unless exists $self-&gt;{_fh};
        my $fh = $self-&gt;{_fh};
        $self-&gt;{_buf} .= shift;
    #
    # DBI feeds us pieces at a time, so accumulate a complete line
    # before outputing
    #
        print $fh &quot;At &quot;, scalar localtime(), ':', $self-&gt;{_buf}, &quot;\n&quot; and
        $self-&gt;{_buf} = ''
            if $self-&gt;{_buf}=~tr/\n//;
    }
    sub close {
        my $self = shift;
        return unless exists $self-&gt;{_fh};
        my $fh = $self-&gt;{_fh};
        print $fh &quot;At &quot;, scalar localtime(), ':', $self-&gt;{_buf}, &quot;\n&quot; and
        $self-&gt;{_buf} = ''
            if $self-&gt;{_buf};
        close $fh;
        delete $self-&gt;{_fh};
    }
    1;
</pre>
<p class="Pp">To redirect DBI traces to this logger requires creating a package
    for the layer:</p>
<p class="Pp"></p>
<pre>    package PerlIO::via::MyFancyLogLayer;
    sub PUSHED
    {
        my ($class,$mode,$fh) = @_;
        my $logger;
        return bless \$logger,$class;
    }
    sub OPEN {
        my ($self, $path, $mode, $fh) = @_;
        #
        # $path is actually our logger object
        #
        $$self = $path;
        return 1;
    }
    sub WRITE
    {
        my ($self, $buf, $fh) = @_;
        $$self-&gt;log($buf);
        return length($buf);
    }
    sub CLOSE {
        my $self = shift;
        $$self-&gt;close();
        return 0;
    }
    1;
</pre>
<p class="Pp">The application can then cause DBI traces to be routed to the
    logger using</p>
<p class="Pp"></p>
<pre>    use PerlIO::via::MyFancyLogLayer;
    open my $fh, '&gt;:via(MyFancyLogLayer)', MyFancyLogger-&gt;new();
    $dbh-&gt;trace('SQL', $fh);
</pre>
<p class="Pp">Now all trace output will be processed by MyFancyLogger's
    <b>log()</b> method.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Trace_Content"><a class="permalink" href="#Trace_Content">Trace
  Content</a></h2>
<p class="Pp">Many of the values embedded in trace output are formatted using
    the <b>neat()</b> utility function. This means they may be quoted,
    sanitized, and possibly truncated if longer than
    <span class="Li">$DBI::neat_maxlen</span>. See &quot;neat&quot; for more
    details.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Tracing_Tips"><a class="permalink" href="#Tracing_Tips">Tracing
  Tips</a></h2>
<p class="Pp">You can add tracing to your own application code using the
    &quot;trace_msg&quot; method.</p>
<p class="Pp">It can sometimes be handy to compare trace files from two
    different runs of the same script. However using a tool like
    <span class="Li">&quot;diff&quot;</span> on the original log output doesn't
    work well because the trace file is full of object addresses that may differ
    on each run.</p>
<p class="Pp">The DBI includes a handy utility called dbilogstrip that can be
    used to 'normalize' the log content. It can be used as a filter like
  this:</p>
<p class="Pp"></p>
<pre>    DBI_TRACE=2 perl yourscript.pl ...args1... 2&gt;&amp;1 | dbilogstrip &gt; dbitrace1.log
    DBI_TRACE=2 perl yourscript.pl ...args2... 2&gt;&amp;1 | dbilogstrip &gt; dbitrace2.log
    diff -u dbitrace1.log dbitrace2.log
</pre>
<p class="Pp">See dbilogstrip for more information.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DBI_ENVIRONMENT_VARIABLES"><a class="permalink" href="#DBI_ENVIRONMENT_VARIABLES">DBI
  ENVIRONMENT VARIABLES</a></h1>
<p class="Pp">The DBI module recognizes a number of environment variables, but
    most of them should not be used most of the time. It is better to be
    explicit about what you are doing to avoid the need for environment
    variables, especially in a web serving system where web servers are stingy
    about which environment variables are available.</p>
<section class="Ss">
<h2 class="Ss">DBI_DSN</h2>
<p class="Pp">The DBI_DSN environment variable is used by DBI-&gt;connect if you
    do not specify a data source when you issue the connect. It should have a
    format such as &quot;dbi:Driver:databasename&quot;.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_DRIVER</h2>
<p class="Pp">The DBI_DRIVER environment variable is used to fill in the
    database driver name in DBI-&gt;connect if the data source string starts
    &quot;dbi::&quot; (thereby omitting the driver). If DBI_DSN omits the driver
    name, DBI_DRIVER can fill the gap.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_AUTOPROXY</h2>
<p class="Pp">The DBI_AUTOPROXY environment variable takes a string value that
    starts &quot;dbi:Proxy:&quot; and is typically followed by
    &quot;hostname=...;port=...&quot;. It is used to alter the behaviour of
    DBI-&gt;connect. For full details, see DBI::Proxy documentation.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_USER</h2>
<p class="Pp">The DBI_USER environment variable takes a string value that is
    used as the user name if the DBI-&gt;connect call is given undef (as
    distinct from an empty string) as the username argument. Be wary of the
    security implications of using this.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_PASS</h2>
<p class="Pp">The DBI_PASS environment variable takes a string value that is
    used as the password if the DBI-&gt;connect call is given undef (as distinct
    from an empty string) as the password argument. Be extra wary of the
    security implications of using this.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_DBNAME (obsolete)</h2>
<p class="Pp">The DBI_DBNAME environment variable takes a string value that is
    used only when the obsolescent style of DBI-&gt;connect (with driver name as
    fourth parameter) is used, and when no value is provided for the first
    (database name) argument.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_TRACE</h2>
<p class="Pp">The DBI_TRACE environment variable specifies the global default
    trace settings for the DBI at startup. Can also be used to direct trace
    output to a file. When the DBI is loaded it does:</p>
<p class="Pp"></p>
<pre>  DBI-&gt;trace(split /=/, $ENV{DBI_TRACE}, 2) if $ENV{DBI_TRACE};
</pre>
<p class="Pp">So if <span class="Li">&quot;DBI_TRACE&quot;</span> contains an
    &quot;<span class="Li">&quot;=&quot;</span>&quot; character then what
    follows it is used as the name of the file to append the trace to.</p>
<p class="Pp">output appended to that file. If the name begins with a number
    followed by an equal sign (<span class="Li">&quot;=&quot;</span>), then the
    number and the equal sign are stripped off from the name, and the number is
    used to set the trace level. For example:</p>
<p class="Pp"></p>
<pre>  DBI_TRACE=1=dbitrace.log perl your_test_script.pl
</pre>
<p class="Pp">On Unix-like systems using a Bourne-like shell, you can do this
    easily on the command line:</p>
<p class="Pp"></p>
<pre>  DBI_TRACE=2 perl your_test_script.pl
</pre>
<p class="Pp">See &quot;TRACING&quot; for more information.</p>
</section>
<section class="Ss">
<h2 class="Ss">PERL_DBI_DEBUG (obsolete)</h2>
<p class="Pp">An old variable that should no longer be used; equivalent to
    DBI_TRACE.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_PROFILE</h2>
<p class="Pp">The DBI_PROFILE environment variable can be used to enable
    profiling of DBI method calls. See DBI::Profile for more information.</p>
</section>
<section class="Ss">
<h2 class="Ss">DBI_PUREPERL</h2>
<p class="Pp">The DBI_PUREPERL environment variable can be used to enable the
    use of DBI::PurePerl. See DBI::PurePerl for more information.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="WARNING_AND_ERROR_MESSAGES"><a class="permalink" href="#WARNING_AND_ERROR_MESSAGES">WARNING
  AND ERROR MESSAGES</a></h1>
<section class="Ss">
<h2 class="Ss" id="Fatal_Errors"><a class="permalink" href="#Fatal_Errors">Fatal
  Errors</a></h2>
<dl class="Bl-tag">
  <dt id="Can't"><a class="permalink" href="#Can't">Can't call method
    &quot;prepare&quot; without a package or object reference</a></dt>
  <dd>The <span class="Li">$dbh</span> handle you're using to call
      <span class="Li">&quot;prepare&quot;</span> is probably undefined because
      the preceding <span class="Li">&quot;connect&quot;</span> failed. You
      should always check the return status of DBI methods, or use the
      &quot;RaiseError&quot; attribute.</dd>
  <dt id="Can't~2"><a class="permalink" href="#Can't~2">Can't call method
    &quot;execute&quot; without a package or object reference</a></dt>
  <dd>The <span class="Li">$sth</span> handle you're using to call
      <span class="Li">&quot;execute&quot;</span> is probably undefined because
      the preceding <span class="Li">&quot;prepare&quot;</span> failed. You
      should always check the return status of DBI methods, or use the
      &quot;RaiseError&quot; attribute.</dd>
  <dt id="DBI/DBD"><a class="permalink" href="#DBI/DBD">DBI/DBD internal version
    mismatch</a></dt>
  <dd>The DBD driver module was built with a different version of DBI than the
      one currently being used. You should rebuild the DBD module under the
      current version of DBI.
    <p class="Pp">(Some rare platforms require &quot;static linking&quot;. On
        those platforms, there may be an old DBI or DBD driver version actually
        embedded in the Perl executable being used.)</p>
  </dd>
  <dt id="DBD"><a class="permalink" href="#DBD">DBD driver has not implemented
    the AutoCommit attribute</a></dt>
  <dd>The DBD driver implementation is incomplete. Consult the author.</dd>
  <dt id="Can't~3"><a class="permalink" href="#Can't~3">Can't [sg]et
    %s-&gt;{%s}: unrecognised attribute</a></dt>
  <dd>You attempted to set or get an unknown attribute of a handle. Make sure
      you have spelled the attribute name correctly; case is significant (e.g.,
      &quot;Autocommit&quot; is not the same as &quot;AutoCommit&quot;).</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="Pure-Perl_DBI"><a class="permalink" href="#Pure-Perl_DBI">Pure-Perl
  DBI</a></h1>
<p class="Pp">A pure-perl emulation of the DBI is included in the distribution
    for people using pure-perl drivers who, for whatever reason, can't install
    the compiled DBI. See DBI::PurePerl.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<section class="Ss">
<h2 class="Ss" id="Driver_and_Database_Documentation"><a class="permalink" href="#Driver_and_Database_Documentation">Driver
  and Database Documentation</a></h2>
<p class="Pp">Refer to the documentation for the DBD driver that you are
  using.</p>
<p class="Pp">Refer to the SQL Language Reference Manual for the database engine
    that you are using.</p>
</section>
<section class="Ss">
<h2 class="Ss">ODBC and SQL/CLI Standards Reference Information</h2>
<p class="Pp">More detailed information about the semantics of certain DBI
    methods that are based on ODBC and SQL/CLI standards is available on-line
    via microsoft.com, for ODBC, and www.jtc1sc32.org for the SQL/CLI
  standard:</p>
<p class="Pp"></p>
<pre> DBI method        ODBC function     SQL/CLI Working Draft
 ----------        -------------     ---------------------
 column_info       SQLColumns        Page 124
 foreign_key_info  SQLForeignKeys    Page 163
 get_info          SQLGetInfo        Page 214
 primary_key_info  SQLPrimaryKeys    Page 254
 table_info        SQLTables         Page 294
 type_info         SQLGetTypeInfo    Page 239
 statistics_info   SQLStatistics
</pre>
<p class="Pp">To find documentation on the ODBC function you can use the MSDN
    search facility at:</p>
<p class="Pp"></p>
<pre>    http://msdn.microsoft.com/Search
</pre>
<p class="Pp">and search for something like <span class="Li">&quot;SQLColumns
    returns&quot;</span>.</p>
<p class="Pp">And for SQL/CLI standard information on SQLColumns you'd read page
    124 of the (very large) SQL/CLI Working Draft available from:</p>
<p class="Pp"></p>
<pre>  http://jtc1sc32.org/doc/N0701-0750/32N0744T.pdf
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Standards_Reference_Information"><a class="permalink" href="#Standards_Reference_Information">Standards
  Reference Information</a></h2>
<p class="Pp">A hyperlinked, browsable version of the BNF syntax for SQL92 (plus
    Oracle 7 SQL and PL/SQL) is available here:</p>
<p class="Pp"></p>
<pre>  http://cui.unige.ch/db-research/Enseignement/analyseinfo/SQL92/BNFindex.html
</pre>
<p class="Pp">You can find more information about SQL standards online by
    searching for the appropriate standard names and numbers. For example,
    searching for &quot;ANSI/ISO/IEC International Standard (IS) Database
    Language SQL - Part 1: SQL/Framework&quot; you'll find a copy at:</p>
<p class="Pp"></p>
<pre>  ftp://ftp.iks-jena.de/mitarb/lutz/standards/sql/ansi-iso-9075-1-1999.pdf
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Books_and_Articles"><a class="permalink" href="#Books_and_Articles">Books
  and Articles</a></h2>
<p class="Pp">Programming the Perl DBI, by Alligator Descartes and Tim Bunce.
    &lt;http://books.perl.org/book/154&gt;</p>
<p class="Pp">Programming Perl 3rd Ed. by Larry Wall, Tom Christiansen &amp; Jon
    Orwant. &lt;http://books.perl.org/book/134&gt;</p>
<p class="Pp">Learning Perl by Randal Schwartz.
    &lt;http://books.perl.org/book/101&gt;</p>
<p class="Pp">Details of many other books related to perl can be found at
    &lt;http://books.perl.org&gt;</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Perl_Modules"><a class="permalink" href="#Perl_Modules">Perl
  Modules</a></h2>
<p class="Pp">Index of DBI related modules available from CPAN:</p>
<p class="Pp"></p>
<pre> L&lt;https://metacpan.org/search?q=DBD%3A%3A&gt;
 L&lt;https://metacpan.org/search?q=DBIx%3A%3A&gt;
 L&lt;https://metacpan.org/search?q=DBI&gt;
</pre>
<p class="Pp">For a good comparison of RDBMS-OO mappers and some OO-RDBMS
    mappers (including Class::DBI, Alzabo, and DBIx::RecordSet in the former
    category and Tangram and SPOPS in the latter) see the Perl Object-Oriented
    Persistence project pages at:</p>
<p class="Pp"></p>
<pre> http://poop.sourceforge.net
</pre>
<p class="Pp">A similar page for Java toolkits can be found at:</p>
<p class="Pp"></p>
<pre> http://c2.com/cgi-bin/wiki?ObjectRelationalToolComparison
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Mailing_List"><a class="permalink" href="#Mailing_List">Mailing
  List</a></h2>
<p class="Pp">The <i>dbi-users</i> mailing list is the primary means of
    communication among users of the DBI and its related modules. For details
    send email to:</p>
<p class="Pp"></p>
<pre> L&lt;dbi-users-help@perl.org&gt;
</pre>
<p class="Pp">There are typically between 700 and 900 messages per month. You
    have to subscribe in order to be able to post. However you can opt for a
    'post-only' subscription.</p>
<p class="Pp">Mailing list archives (of variable quality) are held at:</p>
<p class="Pp"></p>
<pre> http://groups.google.com/groups?group=perl.dbi.users
 http://www.xray.mpe.mpg.de/mailing-lists/dbi/
 http://www.mail-archive.com/dbi-users%40perl.org/
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Assorted_Related_Links"><a class="permalink" href="#Assorted_Related_Links">Assorted
  Related Links</a></h2>
<p class="Pp">The DBI &quot;Home Page&quot;:</p>
<p class="Pp"></p>
<pre> http://dbi.perl.org/
</pre>
<p class="Pp">Other DBI related links:</p>
<p class="Pp"></p>
<pre> http://www.perlmonks.org/?node=DBI%20recipes
 http://www.perlmonks.org/?node=Speeding%20up%20the%20DBI
</pre>
<p class="Pp">Other database related links:</p>
<p class="Pp"></p>
<pre> http://www.connectionstrings.com/
</pre>
<p class="Pp">Security, especially the &quot;SQL Injection&quot; attack:</p>
<p class="Pp"></p>
<pre> http://bobby-tables.com/
 http://online.securityfocus.com/infocus/1644
</pre>
</section>
<section class="Ss">
<h2 class="Ss">FAQ</h2>
<p class="Pp">See &lt;http://faq.dbi-support.com/&gt;</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">DBI by Tim Bunce, &lt;http://www.tim.bunce.name&gt;</p>
<p class="Pp">This pod text by Tim Bunce, J. Douglas Dunlop, Jonathan Leffler
    and others. Perl by Larry Wall and the
    <span class="Li">&quot;perl5-porters&quot;</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">The DBI module is Copyright (c) 1994-2012 Tim Bunce. Ireland. All
    rights reserved.</p>
<p class="Pp">You may distribute under the terms of either the GNU General
    Public License or the Artistic License, as specified in the Perl 5.10.0
    README file.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT_/_WARRANTY"><a class="permalink" href="#SUPPORT_/_WARRANTY">SUPPORT
  / WARRANTY</a></h1>
<p class="Pp">The DBI is free Open Source software. IT COMES WITHOUT WARRANTY OF
    ANY KIND.</p>
<section class="Ss">
<h2 class="Ss" id="Support"><a class="permalink" href="#Support">Support</a></h2>
<p class="Pp">My consulting company, Data Plan Services, offers annual and
    multi-annual support contracts for the DBI. These provide sustained support
    for DBI development, and sustained value for you in return. Contact me for
    details.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Sponsor_Enhancements"><a class="permalink" href="#Sponsor_Enhancements">Sponsor
  Enhancements</a></h2>
<p class="Pp">If your company would benefit from a specific new DBI feature,
    please consider sponsoring its development. Work is performed rapidly, and
    usually on a fixed-price payment-on-delivery basis. Contact me for
  details.</p>
<p class="Pp">Using such targeted financing allows you to contribute to DBI
    development, and rapidly get something specific and valuable in return.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ACKNOWLEDGEMENTS"><a class="permalink" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>
<p class="Pp">I would like to acknowledge the valuable contributions of the many
    people I have worked with on the DBI project, especially in the early years
    (1992-1994). In no particular order: Kevin Stock, Buzz Moschetti, Kurt
    Andersen, Ted Lemon, William Hails, Garth Kennedy, Michael Peppler, Neil S.
    Briscoe, Jeff Urlwin, David J. Hughes, Jeff Stander, Forrest D Whitcher,
    Larry Wall, Jeff Fried, Roy Johnson, Paul Hudson, Georg Rehfeld, Steve
    Sizemore, Ron Pool, Jon Meek, Tom Christiansen, Steve Baumgarten, Randal
    Schwartz, and a whole lot more.</p>
<p class="Pp">Then, of course, there are the poor souls who have struggled
    through untold and undocumented obstacles to actually implement DBI drivers.
    Among their ranks are Jochen Wiedmann, Alligator Descartes, Jonathan
    Leffler, Jeff Urlwin, Michael Peppler, Henrik Tougaard, Edwin Pratomo,
    Davide Migliavacca, Jan Pazdziora, Peter Haworth, Edmund Mergl, Steve
    Williams, Thomas Lowery, and Phlip Plumlee. Without them, the DBI would not
    be the practical reality it is today. I'm also especially grateful to
    Alligator Descartes for starting work on the first edition of the
    &quot;Programming the Perl DBI&quot; book and letting me jump on board.</p>
<p class="Pp">The DBI and DBD::Oracle were originally developed while I was
    Technical Director (CTO) of the Paul Ingram Group in the UK. So I'd
    especially like to thank Paul for his generosity and vision in supporting
    this work for many years.</p>
<p class="Pp">A couple of specific DBI features have been sponsored by
    enlightened companies:</p>
<p class="Pp">The development of the <b>swap_inner_handle()</b> method was
    sponsored by BizRate.com (&lt;http://BizRate.com&gt;)</p>
<p class="Pp">The development of DBD::Gofer and related modules was sponsored by
    Shopzilla.com (&lt;http://Shopzilla.com&gt;), where I currently work.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CONTRIBUTING"><a class="permalink" href="#CONTRIBUTING">CONTRIBUTING</a></h1>
<p class="Pp">As you can see above, many people have contributed to the DBI and
    drivers in many ways over many years.</p>
<p class="Pp">If you'd like to help then see
    &lt;http://dbi.perl.org/contributing&gt;.</p>
<p class="Pp">If you'd like the DBI to do something new or different then a good
    way to make that happen is to do it yourself and send me a patch to the
    source code that shows the changes. (But read &quot;Speak before you
    patch&quot; below.)</p>
<section class="Ss">
<h2 class="Ss" id="Browsing_the_source_code_repository"><a class="permalink" href="#Browsing_the_source_code_repository">Browsing
  the source code repository</a></h2>
<p class="Pp">Use https://github.com/perl5-dbi/dbi</p>
</section>
<section class="Ss">
<h2 class="Ss" id="How_to_create_a_patch_using_Git"><a class="permalink" href="#How_to_create_a_patch_using_Git">How
  to create a patch using Git</a></h2>
<p class="Pp">The DBI source code is maintained using Git. To access the source
    you'll need to install a Git client. Then, to get the source code, do:</p>
<p class="Pp"></p>
<pre>  git clone https://github.com/perl5-dbi/dbi.git DBI-git
</pre>
<p class="Pp">The source code will now be available in the new subdirectory
    <span class="Li">&quot;DBI-git&quot;</span>.</p>
<p class="Pp">When you want to synchronize later, issue the command</p>
<p class="Pp"></p>
<pre>  git pull --all
</pre>
<p class="Pp">Make your changes, test them, test them again until everything
    passes. If there are no tests for the new feature you added or a behaviour
    change, the change should include a new test. Then commit the changes.
    Either use</p>
<p class="Pp"></p>
<pre>  git gui
</pre>
<p class="Pp">or</p>
<p class="Pp"></p>
<pre>  git commit -a -m 'Message to my changes'
</pre>
<p class="Pp">If you get any conflicts reported you'll need to fix them
  first.</p>
<p class="Pp">Then generate the patch file to be mailed:</p>
<p class="Pp"></p>
<pre>  git format-patch -1 --attach
</pre>
<p class="Pp">which will create a file 0001-*.patch (where * relates to the
    commit message). Read the patch file, as a sanity check, and then email it
    to dbi-dev@perl.org.</p>
<p class="Pp">If you have a github &lt;https://github.com&gt; account, you can
    also fork the repository, commit your changes to the forked repository and
    then do a pull request.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="How_to_create_a_patch_without_Git"><a class="permalink" href="#How_to_create_a_patch_without_Git">How
  to create a patch without Git</a></h2>
<p class="Pp">Unpack a fresh copy of the distribution:</p>
<p class="Pp"></p>
<pre>  wget http://cpan.metacpan.org/authors/id/T/TI/TIMB/DBI-1.627.tar.gz
  tar xfz DBI-1.627.tar.gz
</pre>
<p class="Pp">Rename the newly created top level directory:</p>
<p class="Pp"></p>
<pre>  mv DBI-1.627 DBI-1.627.your_foo
</pre>
<p class="Pp">Edit the contents of DBI-1.627.your_foo/* till it does what you
    want.</p>
<p class="Pp">Test your changes and then remove all temporary files:</p>
<p class="Pp"></p>
<pre>  make test &amp;&amp; make distclean
</pre>
<p class="Pp">Go back to the directory you originally unpacked the
  distribution:</p>
<p class="Pp"></p>
<pre>  cd ..
</pre>
<p class="Pp">Unpack <i>another</i> copy of the original distribution you
    started with:</p>
<p class="Pp"></p>
<pre>  tar xfz DBI-1.627.tar.gz
</pre>
<p class="Pp">Then create a patch file by performing a recursive
    <span class="Li">&quot;diff&quot;</span> on the two top level
  directories:</p>
<p class="Pp"></p>
<pre>  diff -purd DBI-1.627 DBI-1.627.your_foo &gt; DBI-1.627.your_foo.patch
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Speak_before_you_patch"><a class="permalink" href="#Speak_before_you_patch">Speak
  before you patch</a></h2>
<p class="Pp">For anything non-trivial or possibly controversial it's a good
    idea to discuss (on dbi-dev@perl.org) the changes you propose before
    actually spending time working on them. Otherwise you run the risk of them
    being rejected because they don't fit into some larger plans you may not be
    aware of.</p>
<p class="Pp">You can also reach the developers on IRC (chat). If they are
    on-line, the most likely place to talk to them is the #dbi channel on
    irc.perl.org</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="TRANSLATIONS"><a class="permalink" href="#TRANSLATIONS">TRANSLATIONS</a></h1>
<p class="Pp">A German translation of this manual (possibly slightly out of
    date) is available, thanks to O'Reilly, at:</p>
<p class="Pp"></p>
<pre>  http://www.oreilly.de/catalog/perldbiger/
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="OTHER_RELATED_WORK_AND_PERL_MODULES"><a class="permalink" href="#OTHER_RELATED_WORK_AND_PERL_MODULES">OTHER
  RELATED WORK AND PERL MODULES</a></h1>
<dl class="Bl-tag">
  <dt id="Apache::DBI"><a class="permalink" href="#Apache::DBI">Apache::DBI</a></dt>
  <dd>To be used with the Apache daemon together with an embedded Perl
      interpreter like <span class="Li">&quot;mod_perl&quot;</span>. Establishes
      a database connection which remains open for the lifetime of the HTTP
      daemon. This way the CGI connect and disconnect for every database access
      becomes superfluous.</dd>
  <dt id="SQL"><a class="permalink" href="#SQL">SQL Parser</a></dt>
  <dd>See also the SQL::Statement module, SQL parser and engine.</dd>
</dl>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-01-31</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
