<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>DBIx::Class::Manual::Troubleshooting(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBIx::Class::Manual::Troubleshooting(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBIx::Class::Manual::Troubleshooting(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">DBIx::Class::Manual::Troubleshooting - Got a problem? Shoot
  it.</p>
<section class="Ss">
<h2 class="Ss" id="_Can't_locate_storage_blabla_"><a class="permalink" href="#_Can't_locate_storage_blabla_">&quot;Can't
  locate storage blabla&quot;</a></h2>
<p class="Pp">You're trying to make a query on a non-connected schema. Make sure
    you got the current resultset from
    <span class="Li">$schema</span>-&gt;resultset('Artist') on a schema object
    you got back from <b>connect()</b>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Tracing_"><a class="permalink" href="#Tracing_">Tracing
  SQL</a></h2>
<p class="Pp">The <span class="Li">&quot;DBIC_TRACE&quot;</span> environment
    variable controls SQL tracing, so to see what is happening try</p>
<p class="Pp"></p>
<pre>  export DBIC_TRACE=1
</pre>
<p class="Pp">Alternatively use the
    <span class="Li">&quot;storage-&gt;debug&quot;</span> class method:-</p>
<p class="Pp"></p>
<pre>  $schema-&gt;storage-&gt;debug(1);
</pre>
<p class="Pp">To send the output somewhere else set debugfh:-</p>
<p class="Pp"></p>
<pre>  $schema-&gt;storage-&gt;debugfh(IO::File-&gt;new('/tmp/trace.out', 'w'));
</pre>
<p class="Pp">Alternatively you can do this with the environment variable,
  too:-</p>
<p class="Pp"></p>
<pre>  export DBIC_TRACE=&quot;1=/tmp/trace.out&quot;
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Can't_locate_method_result_source_instance"><a class="permalink" href="#Can't_locate_method_result_source_instance">Can't
  locate method result_source_instance</a></h2>
<p class="Pp">For some reason the table class in question didn't load fully, so
    the ResultSource object for it hasn't been created. Debug this class in
    isolation, then try loading the full schema again.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Can't_get_last_insert_"><a class="permalink" href="#Can't_get_last_insert_">Can't
  get last insert ID under Postgres with serial primary keys</a></h2>
<p class="Pp">Older DBI and DBD::Pg versions do not handle
    <span class="Li">&quot;last_insert_id&quot;</span> correctly, causing code
    that uses auto-incrementing primary key columns to fail with a message such
    as:</p>
<p class="Pp"></p>
<pre>  Can't get last insert id at /.../DBIx/Class/Row.pm line 95
</pre>
<p class="Pp">In particular the RHEL 4 and FC3 Linux distributions both ship
    with combinations of DBI and DBD::Pg modules that do not work correctly.</p>
<p class="Pp">DBI version 1.50 and DBD::Pg 1.43 are known to work.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Can't_locate_object_method__source_name__via_package"><a class="permalink" href="#Can't_locate_object_method__source_name__via_package">Can't
  locate object method &quot;source_name&quot; via package</a></h2>
<p class="Pp">There's likely a syntax error in the table class referred to
    elsewhere in this error message. In particular make sure that the package
    declaration is correct. For example, for a schema <span class="Li">&quot;
    MySchema &quot;</span> you need to specify a fully qualified namespace:
    <span class="Li">&quot; package MySchema::MyTable; &quot;</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="syntax_error_at_or_near___something___..."><a class="permalink" href="#syntax_error_at_or_near___something___...">syntax
  error at or near &quot;&lt;something&gt;&quot; ...</a></h2>
<p class="Pp">This can happen if you have a relation whose name is a word
    reserved by your database, e.g. &quot;user&quot;:</p>
<p class="Pp"></p>
<pre>  package My::Schema::User;
  ...
  __PACKAGE__-&gt;table('users');
  __PACKAGE__-&gt;add_columns(qw/ id name /);
  __PACKAGE__-&gt;set_primary_key('id');
  ...
  1;
  package My::Schema::ACL;
  ...
  __PACKAGE__-&gt;table('acl');
  __PACKAGE__-&gt;add_columns(qw/ user_id /);
  __PACKAGE__-&gt;belongs_to( 'user' =&gt; 'My::Schema::User', 'user_id' );
  ...
  1;
  $schema-&gt;resultset('ACL')-&gt;search(
    {},
    {
      join =&gt; [qw/ user /],
      '+select' =&gt; [ 'user.name' ]
    }
  );
</pre>
<p class="Pp">The SQL generated would resemble something like:</p>
<p class="Pp"></p>
<pre>  SELECT me.user_id, user.name FROM acl me
  JOIN users user ON me.user_id = user.id
</pre>
<p class="Pp">If, as is likely, your database treats &quot;user&quot; as a
    reserved word, you'd end up with the following errors:</p>
<p class="Pp">1) syntax error at or near &quot;.&quot; - due to
    &quot;user.name&quot; in the SELECT clause</p>
<p class="Pp">2) syntax error at or near &quot;user&quot; - due to
    &quot;user&quot; in the JOIN clause</p>
<p class="Pp">The solution is to enable quoting - see &quot;Setting quoting for
    the generated SQL&quot; in DBIx::Class::Manual::Cookbook for details.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="column__foo_"><a class="permalink" href="#column__foo_">column
  &quot;foo DESC&quot; does not exist ...</a></h2>
<p class="Pp">This can happen if you are still using the obsolete order hack,
    and also happen to turn on SQL-quoting.</p>
<p class="Pp"></p>
<pre>  $rs-&gt;search( {}, { order_by =&gt; [ 'name DESC' ] } );
</pre>
<p class="Pp">Since DBIx::Class &gt;= 0.08100 and SQL::Abstract &gt;= 1.50 the
    above should be written as:</p>
<p class="Pp"></p>
<pre>  $rs-&gt;search( {}, { order_by =&gt; { -desc =&gt; 'name' } } );
</pre>
<p class="Pp">For more ways to express order clauses refer to &quot;ORDER BY
    CLAUSES&quot; in SQL::Abstract</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Perl_Performance_Issues_on_Red_Hat_Systems"><a class="permalink" href="#Perl_Performance_Issues_on_Red_Hat_Systems">Perl
  Performance Issues on Red Hat Systems</a></h2>
<p class="Pp">There is a problem with slow performance of certain DBIx::Class
    operations using the system perl on some Fedora and Red Hat Enterprise Linux
    system (as well as their derivative distributions such as Centos, White Box
    and Scientific Linux).</p>
<p class="Pp">Distributions affected include Fedora 5 through to Fedora 8 and
    RHEL5 up to and including RHEL5 Update 2. Fedora 9 (which uses perl 5.10)
    has never been affected - this is purely a perl 5.8.8 issue.</p>
<p class="Pp">As of September 2008 the following packages are known to be fixed
    and so free of this performance issue (this means all Fedora and RHEL5
    systems with full current updates will not be subject to this problem):-</p>
<p class="Pp"></p>
<pre>  Fedora 8     - perl-5.8.8-41.fc8
  RHEL5        - perl-5.8.8-15.el5_2.1
</pre>
<p class="Pp">This issue is due to perl doing an exhaustive search of blessed
    objects under certain circumstances. The problem shows up as performance
    degradation exponential to the number of DBIx::Class result objects in
    memory, so can be unnoticeable with certain data sets, but with huge
    performance impacts on other datasets.</p>
<p class="Pp">A pair of tests for susceptibility to the issue and performance
    effects of the bless/overload problem can be found in the DBIx::Class test
    suite, in the <span class="Li">&quot;t/99rh_perl_perf_bug.t&quot;</span>
    file.</p>
<p class="Pp">Further information on this issue can be found in
    &lt;https://bugzilla.redhat.com/show_bug.cgi?id=379791&gt;,
    &lt;https://bugzilla.redhat.com/show_bug.cgi?id=460308&gt; and
    &lt;http://rhn.redhat.com/errata/RHBA-2008-0876.html&gt;</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Excessive_Memory_Allocation_with_TEXT/BLOB/etc._Columns_and_Large_LongReadLen"><a class="permalink" href="#Excessive_Memory_Allocation_with_TEXT/BLOB/etc._Columns_and_Large_LongReadLen">Excessive
  Memory Allocation with TEXT/BLOB/etc. Columns and Large LongReadLen</a></h2>
<p class="Pp">It has been observed, using DBD::ODBC, that creating a
    DBIx::Class::Row object which includes a column of data type TEXT/BLOB/etc.
    will allocate LongReadLen bytes. This allocation does not leak, but if
    LongReadLen is large in size, and many such result objects are created, e.g.
    as the output of a ResultSet query, the memory footprint of the Perl
    interpreter can grow very large.</p>
<p class="Pp">The solution is to use the smallest practical value for
    LongReadLen.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="FURTHER_QUESTIONS?"><a class="permalink" href="#FURTHER_QUESTIONS?">FURTHER
  QUESTIONS?</a></h1>
<p class="Pp">Check the list of additional DBIC resources.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">This module is free software copyright by the DBIx::Class (DBIC)
    authors. You can redistribute it and/or modify it under the same terms as
    the DBIx::Class library.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2017-12-08</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
