<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>DBIx::Class::InflateColumn::DateTime(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBIx::Class::InflateColumn::DateTime(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBIx::Class::InflateColumn::DateTime(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">DBIx::Class::InflateColumn::DateTime - Auto-create DateTime
    objects from date and datetime columns.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">Load this component and then declare one or more columns to be of
    the datetime, timestamp or date datatype.</p>
<p class="Pp"></p>
<pre>  package Event;
  use base 'DBIx::Class::Core';
  __PACKAGE__-&gt;load_components(qw/InflateColumn::DateTime/);
  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'datetime' }
    create_date =&gt; { data_type =&gt; 'date' }
  );
</pre>
<p class="Pp">Then you can treat the specified column as a DateTime object.</p>
<p class="Pp"></p>
<pre>  print &quot;This event starts the month of &quot;.
    $event-&gt;starts_when-&gt;month_name();
</pre>
<p class="Pp">If you want to set a specific timezone and locale for that field,
    use:</p>
<p class="Pp"></p>
<pre>  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'datetime', timezone =&gt; &quot;America/Chicago&quot;, locale =&gt; &quot;de_DE&quot; }
  );
</pre>
<p class="Pp">If you want to inflate no matter what data_type your column is,
    use inflate_datetime or inflate_date:</p>
<p class="Pp"></p>
<pre>  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'varchar', inflate_datetime =&gt; 1 }
  );
  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'varchar', inflate_date =&gt; 1 }
  );
</pre>
<p class="Pp">It's also possible to explicitly skip inflation:</p>
<p class="Pp"></p>
<pre>  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'datetime', inflate_datetime =&gt; 0 }
  );
</pre>
<p class="Pp">NOTE: Don't rely on
    <span class="Li">&quot;InflateColumn::DateTime&quot;</span> to parse date
    strings for you. The column is set directly for any non-references and
    <span class="Li">&quot;InflateColumn::DateTime&quot;</span> is completely
    bypassed. Instead, use an input parser to create a DateTime object. For
    instance, if your user input comes as a 'YYYY-MM-DD' string, you can use
    <span class="Li">&quot;DateTime::Format::ISO8601&quot;</span> thusly:</p>
<p class="Pp"></p>
<pre>  use DateTime::Format::ISO8601;
  my $dt = DateTime::Format::ISO8601-&gt;parse_datetime('YYYY-MM-DD');
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module figures out the type of DateTime::Format::* class to
    inflate/deflate with based on the type of DBIx::Class::Storage::DBI::* that
    you are using. If you switch from one database to a different one your code
    should continue to work without modification (though note that this feature
    is new as of 0.07, so it may not be perfect yet - bug reports to the list
    very much welcome).</p>
<p class="Pp">If the data_type of a field is
    <span class="Li">&quot;date&quot;</span>,
    <span class="Li">&quot;datetime&quot;</span> or
    <span class="Li">&quot;timestamp&quot;</span> (or a derivative of these
    datatypes, e.g. <span class="Li">&quot;timestamp with
    timezone&quot;</span>), this module will automatically call the appropriate
    parse/format method for deflation/inflation as defined in the storage class.
    For instance, for a <span class="Li">&quot;datetime&quot;</span> field the
    methods <span class="Li">&quot;parse_datetime&quot;</span> and
    <span class="Li">&quot;format_datetime&quot;</span> would be called on
    deflation/inflation. If the storage class does not provide a specialized
    inflator/deflator,
    <span class="Li">&quot;[parse|format]_datetime&quot;</span> will be used as
    a fallback. See &quot;Formatters And Stringification&quot; in DateTime for
    more information on date formatting.</p>
<p class="Pp">For more help with using components, see &quot;USING&quot; in
    DBIx::Class::Manual::Component.</p>
<section class="Ss">
<h2 class="Ss" id="register_column"><a class="permalink" href="#register_column">register_column</a></h2>
<p class="Pp">Chains with the &quot;register_column&quot; in DBIx::Class::Row
    method, and sets up datetime columns appropriately. This would not normally
    be directly called by end users.</p>
<p class="Pp">In the case of an invalid date, DateTime will throw an exception.
    To bypass these exceptions and just have the inflation return undef, use the
    <span class="Li">&quot;datetime_undef_if_invalid&quot;</span> option in the
    column info:</p>
<p class="Pp"></p>
<pre>    &quot;broken_date&quot;,
    {
        data_type =&gt; &quot;datetime&quot;,
        default_value =&gt; '0000-00-00',
        is_nullable =&gt; 1,
        datetime_undef_if_invalid =&gt; 1
    }
</pre>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="USAGE_NOTES"><a class="permalink" href="#USAGE_NOTES">USAGE
  NOTES</a></h1>
<p class="Pp">If you have a datetime column with an associated
    <span class="Li">&quot;timezone&quot;</span>, and subsequently create/update
    this column with a DateTime object in the DateTime::TimeZone::Floating
    timezone, you will get a warning (as there is a very good chance this will
    not have the result you expect). For example:</p>
<p class="Pp"></p>
<pre>  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'datetime', timezone =&gt; &quot;America/Chicago&quot; }
  );
  my $event = $schema-&gt;resultset('EventTZ')-&gt;create({
    starts_at =&gt; DateTime-&gt;new(year=&gt;2007, month=&gt;12, day=&gt;31, ),
  });
</pre>
<p class="Pp">The warning can be avoided in several ways:</p>
<dl class="Bl-tag">
  <dt id="Fix"><a class="permalink" href="#Fix">Fix your broken code</a></dt>
  <dd>When calling <span class="Li">&quot;set_time_zone&quot;</span> on a
      Floating DateTime object, the timezone is simply set to the requested
      value, and <b>no time conversion takes place</b>. It is always a good idea
      to be supply explicit times to the database:
    <p class="Pp"></p>
    <pre>  my $event = $schema-&gt;resultset('EventTZ')-&gt;create({
    starts_at =&gt; DateTime-&gt;new(year=&gt;2007, month=&gt;12, day=&gt;31, time_zone =&gt; &quot;America/Chicago&quot; ),
  });
    </pre>
  </dd>
  <dt id="Suppress"><a class="permalink" href="#Suppress">Suppress the check on
    per-column basis</a></dt>
  <dd>
    <pre>  __PACKAGE__-&gt;add_columns(
    starts_when =&gt; { data_type =&gt; 'datetime', timezone =&gt; &quot;America/Chicago&quot;, floating_tz_ok =&gt; 1 }
  );
    </pre>
  </dd>
  <dt id="Suppress~2"><a class="permalink" href="#Suppress~2">Suppress the check
    globally</a></dt>
  <dd>Set the environment variable DBIC_FLOATING_TZ_OK to some true value.</dd>
</dl>
<p class="Pp">Putting extra attributes like timezone, locale or floating_tz_ok
    into extra =&gt; {} has been <b>DEPRECATED</b> because this gets you into
    trouble using DBIx::Class::Schema::Versioned. Instead put it directly into
    the columns definition like in the examples above. If you still use the old
    way you'll see a warning - please fix your code then!</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<dl class="Bl-tag">
  <dt id="More"><a class="permalink" href="#More">More information about the
    add_columns method, and column metadata, can be found in the documentation
    for DBIx::Class::ResultSource.</a></dt>
  <dd></dd>
  <dt id="Further"><a class="permalink" href="#Further">Further discussion of
    problems inherent to the Floating timezone: Floating DateTimes and
    $dt-&gt;set_time_zone</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="FURTHER_QUESTIONS?"><a class="permalink" href="#FURTHER_QUESTIONS?">FURTHER
  QUESTIONS?</a></h1>
<p class="Pp">Check the list of additional DBIC resources.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">This module is free software copyright by the DBIx::Class (DBIC)
    authors. You can redistribute it and/or modify it under the same terms as
    the DBIx::Class library.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2018-01-29</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
