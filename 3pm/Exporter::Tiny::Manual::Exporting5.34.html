<!DOCTYPE html>
<html lang="en">
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>Exporter::Tiny::Manual::Exporting(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Exporter::Tiny::Manual::Exporting(3)</td>
    <td class="head-vol"><a href=".">User Contributed Perl Documentation</a></td>
    <td class="head-rtitle">Exporter::Tiny::Manual::Exporting(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Exporter::Tiny::Manual::Exporting - creating an exporter using
    Exporter::Tiny</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp"><b>Read Exporter::Tiny::Manual::QuickStart first!</b></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Simple configuration works the same as Exporter; inherit from
    Exporter::Tiny, and use the <span class="Li">@EXPORT</span>,
    <span class="Li">@EXPORT_OK</span>, and <span class="Li">%EXPORT_TAGS</span>
    package variables to list subs to export.</p>
<p class="Pp">Unlike Exporter, Exporter::Tiny performs most of its internal
    duties (including resolution of tag names to sub names, resolution of sub
    names to coderefs, and installation of coderefs into the target package) as
    <b>method calls</b>, which means that your module (which is a subclass of
    Exporter::Tiny) can override them to provide interesting behaviour.</p>
<section class="Ss">
<h2 class="Ss" id="Advanced_Tag_Stuff"><a class="permalink" href="#Advanced_Tag_Stuff">Advanced
  Tag Stuff</a></h2>
<p class="Pp">You can define tags using other tags:</p>
<p class="Pp"></p>
<pre>   use Exporter::Shiny qw(
      black white red green blue cyan magenta yellow
   );
   
   our %EXPORT_TAGS = (
      rgb        =&gt; [qw( red green blue )],
      cym        =&gt; [qw( cyan magenta yellow )],
      cymk       =&gt; [qw( black :cym )],
      monochrome =&gt; [qw( black white )],
      all        =&gt; [qw( :rgb :cymk :monochrome )],
   );
</pre>
<p class="Pp"><b>CAVEAT:</b> If you create a cycle in the tags, this could put
    Exporter::Tiny into an infinite loop expanding the tags. Don't do that.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="More_on_Generators"><a class="permalink" href="#More_on_Generators">More
  on Generators</a></h2>
<p class="Pp">Exporter::Tiny has always allowed exported subs to be generated
    (like Sub::Exporter), but until version 0.025 did not have an especially
    nice API for it.</p>
<p class="Pp">Now, it's easy. If you want to generate a sub
    <span class="Li">&quot;foo&quot;</span> to export, list it in
    <span class="Li">@EXPORT</span> or <span class="Li">@EXPORT_OK</span> as
    usual, and then simply give your exporter module a class method called
    <span class="Li">&quot;_generate_foo&quot;</span>.</p>
<p class="Pp"></p>
<pre>   push @EXPORT_OK, 'foo';
   
   sub _generate_foo {
      my $class = shift;
      my ($name, $args, $globals) = @_;
      
      return sub {
         ...;
      }
   }
</pre>
<p class="Pp">We showed how to do that in Exporter::Tiny::Manual::QuickStart,
    but one thing we didn't show was that <span class="Li">$globals</span> gets
    passed in there. This is the global options hash, as described in
    Exporter::Tiny::Manual::Importing. It can often be useful. In particular it
    will tell you what package the generated sub is destined to be installed
    into.</p>
<p class="Pp">To generate non-code symbols, name your generators like this:</p>
<p class="Pp"></p>
<pre>  sub _generateScalar_Foo { ... }  # generate a symbol $Foo
  sub _generateArray_Bar  { ... }  # generate a symbol @Bar
  sub _generateHash_Baz   { ... }  # generate a symbol %Baz
</pre>
<p class="Pp">You can also generate tags:</p>
<p class="Pp"></p>
<pre>   my %constants;
   BEGIN {
      %constants = (FOO =&gt; 1, BAR =&gt; 2);
   }
   use constant \%constants;
   
   $EXPORT_TAGS{constants} = sub {
      my $class = shift;
      my ($name, $args, $globals) = @_;
      
      return keys(%constants);
   };
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Hooks"><a class="permalink" href="#Hooks">Hooks</a></h2>
<p class="Pp">Sometimes as well as exporting stuff, you want to do some setup or
    something.</p>
<p class="Pp">You can define a couple of class methods in your package, and
    they'll get called at the appropriate time:</p>
<p class="Pp"></p>
<pre>   package MyUtils;
   
   ...;
   
   sub _exporter_validate_opts {
      my $class = shift;
      my ($globals) = @_;
      
      ...;   # do stuff here
      
      $class-&gt;SUPER::_exporter_validate_opts(@_);
   }
   
   sub _exporter_validate_unimport_opts {
      my $class = shift;
      my ($globals) = @_;
      
      ...;   # do stuff here
      
      $class-&gt;SUPER::_exporter_validate_unimport_opts(@_);
   }
</pre>
<p class="Pp">The <span class="Li">$globals</span> variable is that famous
    global options hash. In particular,
    <span class="Li">&quot;$globals-&gt;{into}&quot;</span> is useful because it
    tells you what package has imported you.</p>
<p class="Pp">As you might have guessed, these methods were originally intended
    to validate the global options hash, but can be used to perform any general
    duties before the real exporting work is done.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Overriding_Internals"><a class="permalink" href="#Overriding_Internals">Overriding
  Internals</a></h2>
<p class="Pp">An important difference between Exporter and Exporter::Tiny is
    that the latter calls all its internal functions as <i>class methods</i>.
    This means that your subclass can <i>override them</i> to alter their
    behaviour.</p>
<p class="Pp">The following methods are available to be overridden. Despite
    being named with a leading underscore, they are considered public methods.
    (The underscore is there to avoid accidentally colliding with any of your
    own function names.)</p>
<dl class="Bl-tag">
  <dt>&quot;_exporter_validate_opts($globals)&quot;</dt>
  <dd>Documented above.</dd>
  <dt>&quot;_exporter_validate_unimport_opts($globals)&quot;</dt>
  <dd>Documented above.</dd>
  <dt>&quot;_exporter_merge_opts($tag_opts, $globals, @exports)&quot;</dt>
  <dd>Called to merge options which have been provided for a tag into the
      options provided for the exports that the tag expanded to.</dd>
  <dt>&quot;_exporter_expand_tag($name, $args, $globals)&quot;</dt>
  <dd>This method is called to expand an import tag (e.g.
      <span class="Li">&quot;:constants&quot;</span>). It is passed the tag name
      (minus the leading &quot;:&quot;), an optional hashref of options (like
      <span class="Li">&quot;{ -prefix =&gt; &quot;foo_&quot; }&quot;</span>),
      and the global options hashref.
    <p class="Pp">It is expected to return a list of ($name,
        <span class="Li">$args</span>) arrayref pairs. These names can be sub
        names to export, or further tag names (which must have their
        &quot;:&quot;). If returning tag names, be careful to avoid creating a
        tag expansion loop!</p>
    <p class="Pp">The default implementation uses
        <span class="Li">%EXPORT_TAGS</span> to expand tags, and provides
        fallbacks for the <span class="Li">&quot;:default&quot;</span> and
        <span class="Li">&quot;:all&quot;</span> tags.</p>
  </dd>
  <dt>&quot;_exporter_expand_regexp($regexp, $args, $globals)&quot;</dt>
  <dd>Like <span class="Li">&quot;_exporter_expand_regexp&quot;</span>, but
      given a regexp-like string instead of a tag name.
    <p class="Pp">The default implementation greps through
        <span class="Li">@EXPORT_OK</span> for imports, and the list of
        already-imported functions for exports.</p>
  </dd>
  <dt>&quot;_exporter_expand_sub($name, $args, $globals)&quot;</dt>
  <dd>This method is called to translate a sub name to a hash of name =&gt;
      coderef pairs for exporting to the caller. In general, this would just be
      a hash with one key and one value, but, for example, Type::Library
      overrides this method so that <span class="Li">&quot;+Foo&quot;</span>
      gets expanded to:
    <p class="Pp"></p>
    <pre>   (
      Foo         =&gt; sub { $type },
      is_Foo      =&gt; sub { $type-&gt;check(@_) },
      to_Foo      =&gt; sub { $type-&gt;assert_coerce(@_) },
      assert_Foo  =&gt; sub { $type-&gt;assert_return(@_) },
   )
    </pre>
    <p class="Pp">The default implementation checks that the name is allowed to
        be exported (using the
        <span class="Li">&quot;_exporter_permitted_regexp&quot;</span> method),
        gets the coderef using the generator if there is one (or by calling
        <span class="Li">&quot;can&quot;</span> on your exporter otherwise) and
        calls <span class="Li">&quot;_exporter_fail&quot;</span> if it's unable
        to generate or retrieve a coderef.</p>
    <p class="Pp">Despite the name, is also called for non-code symbols.</p>
  </dd>
  <dt>&quot;_exporter_permitted_regexp($globals)&quot;</dt>
  <dd>This method is called to retrieve a regexp for validating the names of
      exportable subs. If a sub doesn't match the regexp, then the default
      implementation of <span class="Li">&quot;_exporter_expand_sub&quot;</span>
      will refuse to export it. (Of course, you may override the default
      <span class="Li">&quot;_exporter_expand_sub&quot;</span>.)
    <p class="Pp">The default implementation of this method assembles the regexp
        from <span class="Li">@EXPORT</span> and
        <span class="Li">@EXPORT_OK</span>.</p>
  </dd>
  <dt>&quot;_exporter_fail($name, $args, $globals)&quot;</dt>
  <dd>Called by <span class="Li">&quot;_exporter_expand_sub&quot;</span> if it
      can't find a coderef to export.
    <p class="Pp">The default implementation just throws an exception. But you
        could emit a warning instead, or just ignore the failed export.</p>
    <p class="Pp">If you don't throw an exception then you should be aware that
        this method is called in list context, and any list it returns will be
        treated as an
        <span class="Li">&quot;_exporter_expand_sub&quot;</span>-style hash of
        names and coderefs for export.</p>
  </dd>
  <dt>&quot;_exporter_install_sub($name, $args, $globals, $coderef)&quot;</dt>
  <dd>This method actually installs the exported sub into its new destination.
      Its return value is ignored.
    <p class="Pp">The default implementation handles sub renaming (i.e. the
        <span class="Li">&quot;-as&quot;</span>,
        <span class="Li">&quot;-prefix&quot;</span> and
        <span class="Li">&quot;-suffix&quot;</span> functions. This method does
        a lot of stuff; if you need to override it, it's probably a good idea to
        just pre-process the arguments and then call the super method rather
        than trying to handle all of it yourself.</p>
    <p class="Pp">Despite the name, is also called for non-code symbols.</p>
  </dd>
  <dt>&quot;_exporter_uninstall_sub($name, $args, $globals)&quot;</dt>
  <dd>The opposite of
    <span class="Li">&quot;_exporter_install_sub&quot;</span>.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">Exporter::Shiny, Exporter::Tiny.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Toby Inkster &lt;tobyink@cpan.org&gt;.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENCE"><a class="permalink" href="#COPYRIGHT_AND_LICENCE">COPYRIGHT
  AND LICENCE</a></h1>
<p class="Pp">This software is copyright (c) 2013-2014, 2017 by Toby
  Inkster.</p>
<p class="Pp">This is free software; you can redistribute it and/or modify it
    under the same terms as the Perl 5 programming language system itself.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DISCLAIMER_OF_WARRANTIES"><a class="permalink" href="#DISCLAIMER_OF_WARRANTIES">DISCLAIMER
  OF WARRANTIES</a></h1>
<p class="Pp">THIS PACKAGE IS PROVIDED &quot;AS IS&quot; AND WITHOUT ANY EXPRESS
    OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES
    OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-04-24</td>
    <td class="foot-os"><a href="..">perl v5.34.0</a></td>
  </tr>
</table>
</body>
</html>
