<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>DBD::File::HowTo(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBD::File::HowTo(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBD::File::HowTo(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">DBD::File::HowTo - Guide to create DBD::File based driver</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
  perldoc DBD::File::HowTo
  perldoc DBI
  perldoc DBI::DBD
  perldoc DBD::File::Developers
  perldoc DBI::DBD::SqlEngine::Developers
  perldoc DBI::DBD::SqlEngine
  perldoc SQL::Eval
  perldoc DBI::DBD::SqlEngine::HowTo
  perldoc SQL::Statement::Embed
  perldoc DBD::File
  perldoc DBD::File::HowTo
  perldoc DBD::File::Developers
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This document provides a step-by-step guide, how to create a new
    <span class="Li">&quot;DBD::File&quot;</span> based DBD. It expects that you
    carefully read the DBI documentation and that you're familiar with DBI::DBD
    and had read and understood DBD::ExampleP.</p>
<p class="Pp">This document addresses experienced developers who are really sure
    that they need to invest time when writing a new DBI Driver. Writing a DBI
    Driver is neither a weekend project nor an easy job for hobby coders after
    work. Expect one or two man-month of time for the first start.</p>
<p class="Pp">Those who are still reading, should be able to sing the rules of
    &quot;CREATING A NEW DRIVER&quot; in DBI::DBD.</p>
<p class="Pp">Of course, DBD::File is a DBI::DBD::SqlEngine and you surely read
    DBI::DBD::SqlEngine::HowTo before continuing here.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CREATING_DRIVER_CLASSES"><a class="permalink" href="#CREATING_DRIVER_CLASSES">CREATING
  DRIVER CLASSES</a></h1>
<p class="Pp">Do you have an entry in DBI's DBD registry? For this guide, a
    prefix of <span class="Li">&quot;foo_&quot;</span> is assumed.</p>
<section class="Ss">
<h2 class="Ss" id="Sample_Skeleton"><a class="permalink" href="#Sample_Skeleton">Sample
  Skeleton</a></h2>
<pre>
    package DBD::Foo;

    use strict;
    use warnings;
    use vars qw(@ISA $VERSION);
    use base qw(DBD::File);

    use DBI ();

    $VERSION = &quot;0.001&quot;;

    package DBD::Foo::dr;

    use vars qw(@ISA $imp_data_size);

    @ISA = qw(DBD::File::dr);
    $imp_data_size = 0;

    package DBD::Foo::db;

    use vars qw(@ISA $imp_data_size);

    @ISA = qw(DBD::File::db);
    $imp_data_size = 0;

    package DBD::Foo::st;

    use vars qw(@ISA $imp_data_size);

    @ISA = qw(DBD::File::st);
    $imp_data_size = 0;

    package DBD::Foo::Statement;

    use vars qw(@ISA);

    @ISA = qw(DBD::File::Statement);

    package DBD::Foo::Table;

    use vars qw(@ISA);

    @ISA = qw(DBD::File::Table);

    1;
</pre>
<p class="Pp">Tiny, eh? And all you have now is a DBD named foo which will is
    able to deal with temporary tables, as long as you use SQL::Statement. In
    DBI::SQL::Nano environments, this DBD can do nothing.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Start_over"><a class="permalink" href="#Start_over">Start
  over</a></h2>
<p class="Pp">Based on DBI::DBD::SqlEngine::HowTo, we're now having a driver
    which could do basic things. Of course, it should now derive from DBD::File
    instead of DBI::DBD::SqlEngine, shouldn't it?</p>
<p class="Pp">DBD::File extends DBI::DBD::SqlEngine to deal with any kind of
    files. In principle, the only extensions required are to the table
  class:</p>
<p class="Pp"></p>
<pre>
    package DBD::Foo::Table;

    sub bootstrap_table_meta
    {
        my ( $self, $dbh, $meta, $table ) = @_;

        # initialize all $meta attributes which might be relevant for
        # file2table

        return $self-&gt;SUPER::bootstrap_table_meta($dbh, $meta, $table);
    }

    sub init_table_meta
    {
        my ( $self, $dbh, $meta, $table ) = @_;

        # called after $meta contains the results from file2table
        # initialize all missing $meta attributes

        $self-&gt;SUPER::init_table_meta( $dbh, $meta, $table );
    }
</pre>
<p class="Pp">In case
    <span class="Li">&quot;DBD::File::Table::open_file&quot;</span> doesn't open
    the files as the driver needs that, override it!</p>
<p class="Pp"></p>
<pre>
    sub open_file
    {
        my ( $self, $meta, $attrs, $flags ) = @_;
        # ensure that $meta-&gt;{f_dontopen} is set
        $self-&gt;SUPER::open_file( $meta, $attrs, $flags );
        # now do what ever needs to be done
    }
</pre>
<p class="Pp">Combined with the methods implemented using the
    SQL::Statement::Embed guide, the table is full working and you could try a
    start over.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="User_comfort"><a class="permalink" href="#User_comfort">User
  comfort</a></h2>
<p class="Pp"><span class="Li">&quot;DBD::File&quot;</span> since
    <span class="Li">0.39</span> consolidates all persistent meta data of a
    table into a single structure stored in
    <span class="Li">&quot;$dbh-&gt;{f_meta}&quot;</span>. With
    <span class="Li">&quot;DBD::File&quot;</span> version
    <span class="Li">0.41</span> and
    <span class="Li">&quot;DBI::DBD::SqlEngine&quot;</span> version
    <span class="Li">0.05</span>, this consolidation moves to
    DBI::DBD::SqlEngine. It's still the
    <span class="Li">&quot;$dbh-&gt;{$drv_prefix .
    &quot;_meta&quot;}&quot;</span> attribute which cares, so what you learned
    at this place before, is still valid.</p>
<p class="Pp"></p>
<pre>
    sub init_valid_attributes
    {
        my $dbh = $_[0];

        $dbh-&gt;SUPER::init_valid_attributes ();

        $dbh-&gt;{foo_valid_attrs} = { ... };
        $dbh-&gt;{foo_readonly_attrs} = { ...  };

        $dbh-&gt;{foo_meta} = &quot;foo_tables&quot;;

        return $dbh;
    }
</pre>
<p class="Pp">See updates at &quot;User comfort&quot; in
    DBI::DBD::SqlEngine::HowTo.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Testing"><a class="permalink" href="#Testing">Testing</a></h2>
<p class="Pp">Now you should have your own DBD::File based driver. Was easy,
    wasn't it? But does it work well? Prove it by writing tests and remember to
    use dbd_edit_mm_attribs from DBI::DBD to ensure testing even rare cases.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">This guide is written by Jens Rehsack. DBD::File is written by
    Jochen Wiedmann and Jeff Zucker.</p>
<p class="Pp">The module DBD::File is currently maintained by</p>
<p class="Pp">H.Merijn Brand &lt; h.m.brand at xs4all.nl &gt; and Jens Rehsack
    &lt; rehsack at googlemail.com &gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">Copyright (C) 2010 by H.Merijn Brand &amp; Jens Rehsack</p>
<p class="Pp">All rights reserved.</p>
<p class="Pp">You may freely distribute and/or modify this module under the
    terms of either the GNU General Public License (GPL) or the Artistic
    License, as specified in the Perl README file.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2013-04-04</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
