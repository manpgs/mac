<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>SQL::Abstract::Test(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SQL::Abstract::Test(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">SQL::Abstract::Test(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">SQL::Abstract::Test - Helper function for testing
  SQL::Abstract</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
  use SQL::Abstract;
  use Test::More;
  use SQL::Abstract::Test import =&gt; [qw/
    is_same_sql_bind is_same_sql is_same_bind
    eq_sql_bind eq_sql eq_bind
  /];

  my ($sql, @bind) = SQL::Abstract-&gt;new-&gt;select(%args);

  is_same_sql_bind($given_sql,    \@given_bind,
                   $expected_sql, \@expected_bind, $test_msg);

  is_same_sql($given_sql, $expected_sql, $test_msg);
  is_same_bind(\@given_bind, \@expected_bind, $test_msg);

  my $is_same = eq_sql_bind($given_sql,    \@given_bind,
                            $expected_sql, \@expected_bind);

  my $sql_same = eq_sql($given_sql, $expected_sql);
  my $bind_same = eq_bind(\@given_bind, \@expected_bind);
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module is only intended for authors of tests on SQL::Abstract
    and related modules; it exports functions for comparing two SQL statements
    and their bound values.</p>
<p class="Pp">The SQL comparison is performed on <i>abstract syntax</i>,
    ignoring differences in spaces or in levels of parentheses. Therefore the
    tests will pass as long as the semantics is preserved, even if the surface
    syntax has changed.</p>
<p class="Pp"><b>Disclaimer</b> : the semantic equivalence handling is pretty
    limited. A lot of effort goes into distinguishing significant from
    non-significant parenthesis, including AND/OR operator associativity.
    Currently this module does not support commutativity and more intelligent
    transformations like De Morgan's laws
  <br/>
   &lt;http://en.wikipedia.org/wiki/De_Morgan's_laws&gt;, etc.</p>
<p class="Pp">For a good overview of what this test framework is currently
    capable of refer to <span class="Li">&quot;t/10test.t&quot;</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<section class="Ss">
<h2 class="Ss" id="is_same_sql_bind"><a class="permalink" href="#is_same_sql_bind">is_same_sql_bind</a></h2>
<pre>
  is_same_sql_bind(
    $given_sql, \@given_bind,
    $expected_sql, \@expected_bind,
    $test_msg
  );

  is_same_sql_bind(
    \[$given_sql, @given_bind],
    \[$expected_sql, @expected_bind],
    $test_msg
  );

  is_same_sql_bind(
    $dbic_rs-&gt;as_query
    $expected_sql, \@expected_bind,
    $test_msg
  );
</pre>
<p class="Pp">Compares given and expected pairs of <span class="Li">&quot;($sql,
    \@bind)&quot;</span> by unpacking <span class="Li">@_</span> as shown in the
    examples above and passing the arguments to &quot;eq_sql&quot; and
    &quot;eq_bind&quot;. Calls &quot;ok&quot; in Test::Builder with the combined
    result, with <span class="Li">$test_msg</span> as message. If the test
    fails, a detailed diagnostic is printed.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="is_same_sql"><a class="permalink" href="#is_same_sql">is_same_sql</a></h2>
<pre>
  is_same_sql(
    $given_sql,
    $expected_sql,
    $test_msg
  );
</pre>
<p class="Pp">Compares given and expected SQL statements via &quot;eq_sql&quot;,
    and calls &quot;ok&quot; in Test::Builder on the result, with
    <span class="Li">$test_msg</span> as message. If the test fails, a detailed
    diagnostic is printed.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="is_same_bind"><a class="permalink" href="#is_same_bind">is_same_bind</a></h2>
<pre>
  is_same_bind(
    \@given_bind,
    \@expected_bind,
    $test_msg
  );
</pre>
<p class="Pp">Compares given and expected bind values via &quot;eq_bind&quot;,
    and calls &quot;ok&quot; in Test::Builder on the result, with
    <span class="Li">$test_msg</span> as message. If the test fails, a detailed
    diagnostic is printed.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="eq_sql_bind"><a class="permalink" href="#eq_sql_bind">eq_sql_bind</a></h2>
<pre>
  my $is_same = eq_sql_bind(
    $given_sql, \@given_bind,
    $expected_sql, \@expected_bind,
  );

  my $is_same = eq_sql_bind(
    \[$given_sql, @given_bind],
    \[$expected_sql, @expected_bind],
  );

  my $is_same = eq_sql_bind(
    $dbic_rs-&gt;as_query
    $expected_sql, \@expected_bind,
  );
</pre>
<p class="Pp">Unpacks <span class="Li">@_</span> depending on the given
    arguments and calls &quot;eq_sql&quot; and &quot;eq_bind&quot;, returning
    their combined result.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="eq_sql"><a class="permalink" href="#eq_sql">eq_sql</a></h2>
<pre>
  my $is_same = eq_sql($given_sql, $expected_sql);
</pre>
<p class="Pp">Compares the abstract syntax of two SQL statements. Similar to
    &quot;is_same_sql&quot;, but it just returns a boolean value and does not
    print diagnostics or talk to Test::Builder. If the result is false, the
    global variable &quot;$sql_differ&quot; will contain the SQL portion where a
    difference was encountered; this is useful for printing diagnostics.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="eq_bind"><a class="permalink" href="#eq_bind">eq_bind</a></h2>
<pre>
  my $is_same = eq_sql(\@given_bind, \@expected_bind);
</pre>
<p class="Pp">Compares two lists of bind values, taking into account the fact
    that some of the values may be arrayrefs (see &quot;bindtype&quot; in
    SQL::Abstract). Similar to &quot;is_same_bind&quot;, but it just returns a
    boolean value and does not print diagnostics or talk to Test::Builder.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="GLOBAL_VARIABLES"><a class="permalink" href="#GLOBAL_VARIABLES">GLOBAL
  VARIABLES</a></h1>
<section class="Ss">
<h2 class="Ss" id="$case_sensitive"><a class="permalink" href="#$case_sensitive">$case_sensitive</a></h2>
<p class="Pp">If true, SQL comparisons will be case-sensitive. Default is
  false;</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$parenthesis_significant"><a class="permalink" href="#$parenthesis_significant">$parenthesis_significant</a></h2>
<p class="Pp">If true, SQL comparison will preserve and report difference in
    nested parenthesis. Useful while testing <span class="Li">&quot;IN (( x
    ))&quot;</span> vs <span class="Li">&quot;IN ( x )&quot;</span>. Defaults to
    false;</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$order_by_asc_significant"><a class="permalink" href="#$order_by_asc_significant">$order_by_asc_significant</a></h2>
<p class="Pp">If true SQL comparison will consider <span class="Li">&quot;ORDER
    BY foo ASC&quot;</span> and <span class="Li">&quot;ORDER BY foo&quot;</span>
    to be different. Default is false;</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$sql_differ"><a class="permalink" href="#$sql_differ">$sql_differ</a></h2>
<p class="Pp">When &quot;eq_sql&quot; returns false, the global variable
    <span class="Li">$sql_differ</span> contains the SQL portion where a
    difference was encountered.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">SQL::Abstract, Test::More, Test::Builder.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">Laurent Dami &lt;laurent.dami AT etat geneve ch&gt;</p>
<p class="Pp">Norbert Buchmuller &lt;norbi@nix.hu&gt;</p>
<p class="Pp">Peter Rabbitson &lt;ribasushi@cpan.org&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">Copyright 2008 by Laurent Dami.</p>
<p class="Pp">This library is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2018-06-11</td>
    <td class="foot-os">perl v5.30.2</td>
  </tr>
</table>
</body>
</html>
