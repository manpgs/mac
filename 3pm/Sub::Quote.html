<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>Sub::Quote(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Sub::Quote(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Sub::Quote(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Sub::Quote - Efficient generation of subroutines via string
  eval</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre> package Silly;
 use Sub::Quote qw(quote_sub unquote_sub quoted_from_sub);
 quote_sub 'Silly::kitty', q{ print &quot;meow&quot; };
 quote_sub 'Silly::doggy', q{ print &quot;woof&quot; };
 my $sound = 0;
 quote_sub 'Silly::dagron',
   q{ print ++$sound % 2 ? 'burninate' : 'roar' },
   { '$sound' =&gt; \$sound };
</pre>
<p class="Pp">And elsewhere:</p>
<p class="Pp"></p>
<pre> Silly-&gt;kitty;  # meow
 Silly-&gt;doggy;  # woof
 Silly-&gt;dagron; # burninate
 Silly-&gt;dagron; # roar
 Silly-&gt;dagron; # burninate
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This package provides performant ways to generate subroutines from
    strings.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SUBROUTINES"><a class="permalink" href="#SUBROUTINES">SUBROUTINES</a></h1>
<section class="Ss">
<h2 class="Ss" id="quote_sub"><a class="permalink" href="#quote_sub">quote_sub</a></h2>
<pre> my $coderef = quote_sub 'Foo::bar', q{ print $x++ . &quot;\n&quot; }, { '$x' =&gt; \0 };
</pre>
<p class="Pp">Arguments: ?$name, <span class="Li">$code</span>, ?\%captures,
    ?\%options</p>
<p class="Pp"><span class="Li">$name</span> is the subroutine where the coderef
    will be installed.</p>
<p class="Pp"><span class="Li">$code</span> is a string that will be turned into
    code.</p>
<p class="Pp"><span class="Li">&quot;\%captures&quot;</span> is a hashref of
    variables that will be made available to the code. The keys should be the
    full name of the variable to be made available, including the sigil. The
    values should be references to the values. The variables will contain copies
    of the values. See the &quot;SYNOPSIS&quot;'s
    <span class="Li">&quot;Silly::dagron&quot;</span> for an example using
    captures.</p>
<p class="Pp">Exported by default.</p>
<p class="Pp"><i>options</i></p>
<dl class="Bl-tag">
  <dt>&quot;no_install&quot;</dt>
  <dd><b>Boolean</b>. Set this option to not install the generated coderef into
      the passed subroutine name on undefer.</dd>
  <dt>&quot;no_defer&quot;</dt>
  <dd><b>Boolean</b>. Prevents a Sub::Defer wrapper from being generated for the
      quoted sub. If the sub will most likely be called at some point, setting
      this is a good idea. For a sub that will most likely be inlined, it is not
      recommended.</dd>
  <dt>&quot;package&quot;</dt>
  <dd>The package that the quoted sub will be evaluated in. If not specified,
      the package from sub calling <span class="Li">&quot;quote_sub&quot;</span>
      will be used.</dd>
  <dt>&quot;hints&quot;</dt>
  <dd>The value of <span class="Li">$^H</span> to use for the code being
      evaluated. This captures the settings of the strict pragma. If not
      specified, the value from the calling code will be used.</dd>
  <dt>&quot;warning_bits&quot;</dt>
  <dd>The value of <span class="Li">&quot;${^WARNING_BITS}&quot;</span> to use
      for the code being evaluated. This captures the warnings set. If not
      specified, the warnings from the calling code will be used.</dd>
  <dt>&quot;%^H&quot;</dt>
  <dd>The value of <span class="Li">&quot;%^H&quot;</span> to use for the code
      being evaluated. This captures additional pragma settings. If not
      specified, the value from the calling code will be used if possible (on
      perl 5.10+).</dd>
  <dt>&quot;attributes&quot;</dt>
  <dd>The &quot;Subroutine Attributes&quot; in perlsub to apply to the sub
      generated. Should be specified as an array reference. The attributes will
      be applied to both the generated sub and the deferred wrapper, if one is
      used.</dd>
  <dt>&quot;file&quot;</dt>
  <dd>The apparent filename to use for the code being evaluated.</dd>
  <dt>&quot;line&quot;</dt>
  <dd>The apparent line number to use for the code being evaluated.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="unquote_sub"><a class="permalink" href="#unquote_sub">unquote_sub</a></h2>
<pre> my $coderef = unquote_sub $sub;
</pre>
<p class="Pp">Forcibly replace subroutine with actual code.</p>
<p class="Pp">If <span class="Li">$sub</span> is not a quoted sub, this is a
    no-op.</p>
<p class="Pp">Exported by default.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="quoted_from_sub"><a class="permalink" href="#quoted_from_sub">quoted_from_sub</a></h2>
<pre> my $data = quoted_from_sub $sub;
 my ($name, $code, $captures, $compiled_sub) = @$data;
</pre>
<p class="Pp">Returns original arguments to quote_sub, plus the compiled version
    if this sub has already been unquoted.</p>
<p class="Pp">Note that <span class="Li">$sub</span> can be either the original
    quoted version or the compiled version for convenience.</p>
<p class="Pp">Exported by default.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="inlinify"><a class="permalink" href="#inlinify">inlinify</a></h2>
<pre> my $prelude = capture_unroll '$captures', {
   '$x' =&gt; 1,
   '$y' =&gt; 2,
 }, 4;
 my $inlined_code = inlinify q{
   my ($x, $y) = @_;
   print $x + $y . &quot;\n&quot;;
 }, '$x, $y', $prelude;
</pre>
<p class="Pp">Takes a string of code, a string of arguments, a string of code
    which acts as a &quot;prelude&quot;, and a <b>Boolean</b> representing
    whether or not to localize the arguments.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="quotify"><a class="permalink" href="#quotify">quotify</a></h2>
<pre> my $quoted_value = quotify $value;
</pre>
<p class="Pp">Quotes a single (non-reference) scalar value for use in a code
    string. The result should reproduce the original value, including strings,
    undef, integers, and floating point numbers. The resulting floating point
    numbers (including infinites and not a number) should be precisely equal to
    the original, if possible. The exact format of the resulting number should
    not be relied on, as it may include hex floats or math expressions.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="capture_unroll"><a class="permalink" href="#capture_unroll">capture_unroll</a></h2>
<pre> my $prelude = capture_unroll '$captures', {
   '$x' =&gt; 1,
   '$y' =&gt; 2,
 }, 4;
</pre>
<p class="Pp">Arguments: <span class="Li">$from</span>, \%captures,
    <span class="Li">$indent</span></p>
<p class="Pp">Generates a snippet of code which is suitable to be used as a
    prelude for &quot;inlinify&quot;. <span class="Li">$from</span> is a string
    will be used as a hashref in the resulting code. The keys of
    <span class="Li">%captures</span> are the names of the variables and the
    values are ignored. <span class="Li">$indent</span> is the number of spaces
    to indent the result by.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="qsub"><a class="permalink" href="#qsub">qsub</a></h2>
<pre> my $hash = {
  coderef =&gt; qsub q{ print &quot;hello&quot;; },
  other   =&gt; 5,
 };
</pre>
<p class="Pp">Arguments: <span class="Li">$code</span></p>
<p class="Pp">Works exactly like &quot;quote_sub&quot;, but includes a prototype
    to only accept a single parameter. This makes it easier to include in hash
    structures or lists.</p>
<p class="Pp">Exported by default.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="sanitize_identifier"><a class="permalink" href="#sanitize_identifier">sanitize_identifier</a></h2>
<pre> my $var_name = '$variable_for_' . sanitize_identifier('@name');
 quote_sub qq{ print \$${var_name} }, { $var_name =&gt; \$value };
</pre>
<p class="Pp">Arguments: <span class="Li">$identifier</span></p>
<p class="Pp">Sanitizes a value so that it can be used in an identifier.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<section class="Ss">
<h2 class="Ss">SUB_QUOTE_DEBUG</h2>
<p class="Pp">Causes code to be output to
    <span class="Li">&quot;STDERR&quot;</span> before being evaled. Several
    forms are supported:</p>
<dl class="Bl-tag">
  <dt>1</dt>
  <dd>All subs will be output.</dd>
  <dt>&quot;/foo/&quot;</dt>
  <dd>Subs will be output if their code matches the given regular
    expression.</dd>
  <dt>&quot;simple_identifier&quot;</dt>
  <dd>Any sub with the given name will be output.</dd>
  <dt>&quot;Full::identifier&quot;</dt>
  <dd>A sub matching the full name will be output.</dd>
  <dt>&quot;Package::Name::&quot;</dt>
  <dd>Any sub in the given package (including anonymous subs) will be
    output.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp">Much of this is just string-based code-generation, and as a
    result, a few caveats apply.</p>
<section class="Ss">
<h2 class="Ss" id="return"><a class="permalink" href="#return">return</a></h2>
<p class="Pp">Calling <span class="Li">&quot;return&quot;</span> from a
    quote_sub'ed sub will not likely do what you intend. Instead of returning
    from the code you defined in <span class="Li">&quot;quote_sub&quot;</span>,
    it will return from the overall function it is composited into.</p>
<p class="Pp">So when you pass in:</p>
<p class="Pp"></p>
<pre>   quote_sub q{  return 1 if $condition; $morecode }
</pre>
<p class="Pp">It might turn up in the intended context as follows:</p>
<p class="Pp"></p>
<pre>  sub foo {
    &lt;important code a&gt;
    do {
      return 1 if $condition;
      $morecode
    };
    &lt;important code b&gt;
  }
</pre>
<p class="Pp">Which will obviously return from foo, when all you meant to do was
    return from the code context in quote_sub and proceed with running important
    code b.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="pragmas"><a class="permalink" href="#pragmas">pragmas</a></h2>
<p class="Pp"><span class="Li">&quot;Sub::Quote&quot;</span> preserves the
    environment of the code creating the quoted subs. This includes the package,
    strict, warnings, and any other lexical pragmas. This is done by prefixing
    the code with a block that sets up a matching environment. When inlining
    <span class="Li">&quot;Sub::Quote&quot;</span> subs, care should be taken
    that user pragmas won't effect the rest of the code.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
<p class="Pp">Users' IRC: #moose on irc.perl.org</p>
<p class="Pp">Development and contribution IRC: #web-simple on irc.perl.org</p>
<p class="Pp">Bugtracker:
    &lt;https://rt.cpan.org/Public/Dist/Display.html?Name=Sub-Quote&gt;</p>
<p class="Pp">Git repository: &lt;git://github.com/moose/Sub-Quote.git&gt;</p>
<p class="Pp">Git browser: &lt;https://github.com/moose/Sub-Quote&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">mst - Matt S. Trout (cpan:MSTROUT) &lt;mst@shadowcat.co.uk&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CONTRIBUTORS"><a class="permalink" href="#CONTRIBUTORS">CONTRIBUTORS</a></h1>
<p class="Pp">frew - Arthur Axel &quot;fREW&quot; Schmidt (cpan:FREW)
    &lt;frioux@gmail.com&gt;</p>
<p class="Pp">ribasushi - Peter Rabbitson (cpan:RIBASUSHI)
    &lt;ribasushi@cpan.org&gt;</p>
<p class="Pp">Mithaldu - Christian Walde (cpan:MITHALDU)
    &lt;walde.christian@googlemail.com&gt;</p>
<p class="Pp">tobyink - Toby Inkster (cpan:TOBYINK) &lt;tobyink@cpan.org&gt;</p>
<p class="Pp">haarg - Graham Knop (cpan:HAARG) &lt;haarg@cpan.org&gt;</p>
<p class="Pp">bluefeet - Aran Deltac (cpan:BLUEFEET)
  &lt;bluefeet@gmail.com&gt;</p>
<p class="Pp">ether - Karen Etheridge (cpan:ETHER) &lt;ether@cpan.org&gt;</p>
<p class="Pp">dolmen - Olivier Mengu&#x00E9; (cpan:DOLMEN)
    &lt;dolmen@cpan.org&gt;</p>
<p class="Pp">alexbio - Alessandro Ghedini (cpan:ALEXBIO)
    &lt;alexbio@cpan.org&gt;</p>
<p class="Pp">getty - Torsten Raudssus (cpan:GETTY)
  &lt;torsten@raudss.us&gt;</p>
<p class="Pp">arcanez - Justin Hunter (cpan:ARCANEZ)
    &lt;justin.d.hunter@gmail.com&gt;</p>
<p class="Pp">kanashiro - Lucas Kanashiro (cpan:KANASHIRO)
    &lt;kanashiro.duarte@gmail.com&gt;</p>
<p class="Pp">djerius - Diab Jerius (cpan:DJERIUS)
    &lt;djerius@cfa.harvard.edu&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">Copyright (c) 2010-2016 the Sub::Quote &quot;AUTHOR&quot; and
    &quot;CONTRIBUTORS&quot; as listed above.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="LICENSE"><a class="permalink" href="#LICENSE">LICENSE</a></h1>
<p class="Pp">This library is free software and may be distributed under the
    same terms as perl itself. See &lt;http://dev.perl.org/licenses/&gt;.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-10-01</td>
    <td class="foot-os">perl v5.34.0</td>
  </tr>
</table>
</body>
</html>
