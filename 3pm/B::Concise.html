<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>B::Concise(3pm)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">B::Concise(3pm)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">B::Concise(3pm)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">B::Concise - Walk Perl syntax tree, printing concise info about
    ops</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
    perl -MO=Concise[,OPTIONS] foo.pl

    use B::Concise qw(set_style add_callback);
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This compiler backend prints the internal OPs of a Perl program's
    syntax tree in one of several space-efficient text formats suitable for
    debugging the inner workings of perl or other compiler backends. It can
    print OPs in the order they appear in the OP tree, in the order they will
    execute, or in a text approximation to their tree structure, and the format
    of the information displayed is customizable. Its function is similar to
    that of perl's <b>-Dx</b> debugging flag or the <b>B::Terse</b> module, but
    it is more sophisticated and flexible.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLE"><a class="permalink" href="#EXAMPLE">EXAMPLE</a></h1>
<p class="Pp">Here's two outputs (or 'renderings'), using the -exec and -basic
    (i.e. default) formatting conventions on the same code snippet.</p>
<p class="Pp"></p>
<pre>
    % perl -MO=Concise,-exec -e '$a = $b + 42'
    1  &lt;0&gt; enter
    2  &lt;;&gt; nextstate(main 1 -e:1) v
    3  &lt;#&gt; gvsv[*b] s
    4  &lt;$&gt; const[IV 42] s
 *  5  &lt;2&gt; add[t3] sK/2
    6  &lt;#&gt; gvsv[*a] s
    7  &lt;2&gt; sassign vKS/2
    8  &lt;@&gt; leave[1 ref] vKP/REFC
</pre>
<p class="Pp">In this -exec rendering, each opcode is executed in the order
    shown. The add opcode, marked with '*', is discussed in more detail.</p>
<p class="Pp">The 1st column is the op's sequence number, starting at 1, and is
    displayed in base 36 by default. Here they're purely linear; the sequences
    are very helpful when looking at code with loops and branches.</p>
<p class="Pp">The symbol between angle brackets indicates the op's type, for
    example; &lt;2&gt; is a BINOP, &lt;@&gt; a LISTOP, and &lt;#&gt; is a PADOP,
    which is used in threaded perls. (see &quot;OP class
  abbreviations&quot;).</p>
<p class="Pp">The opname, as in <b>'add[t1]'</b>, may be followed by op-specific
    information in parentheses or brackets (ex <b>'[t1]'</b>).</p>
<p class="Pp">The op-flags (ex <b>'sK/2'</b>) are described in (&quot;OP flags
    abbreviations&quot;).</p>
<p class="Pp"></p>
<pre>
    % perl -MO=Concise -e '$a = $b + 42'
    8  &lt;@&gt; leave[1 ref] vKP/REFC -&gt;(end)
    1     &lt;0&gt; enter -&gt;2
    2     &lt;;&gt; nextstate(main 1 -e:1) v -&gt;3
    7     &lt;2&gt; sassign vKS/2 -&gt;8
 *  5        &lt;2&gt; add[t1] sK/2 -&gt;6
    -           &lt;1&gt; ex-rv2sv sK/1 -&gt;4
    3              &lt;$&gt; gvsv(*b) s -&gt;4
    4           &lt;$&gt; const(IV 42) s -&gt;5
    -        &lt;1&gt; ex-rv2sv sKRM*/1 -&gt;7
    6           &lt;$&gt; gvsv(*a) s -&gt;7
</pre>
<p class="Pp">The default rendering is top-down, so they're not in execution
    order. This form reflects the way the stack is used to parse and evaluate
    expressions; the add operates on the two terms below it in the tree.</p>
<p class="Pp">Nullops appear as <span class="Li">&quot;ex-opname&quot;</span>,
    where <i>opname</i> is an op that has been optimized away by perl. They're
    displayed with a sequence-number of '-', because they are not executed (they
    don't appear in previous example), they're printed here because they reflect
    the parse.</p>
<p class="Pp">The arrow points to the sequence number of the next op; they're
    not displayed in -exec mode, for obvious reasons.</p>
<p class="Pp">Note that because this rendering was done on a non-threaded perl,
    the PADOPs in the previous examples are now SVOPs, and some (but not all) of
    the square brackets have been replaced by round ones. This is a subtle
    feature to provide some visual distinction between renderings on threaded
    and un-threaded perls.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="OPTIONS"><a class="permalink" href="#OPTIONS">OPTIONS</a></h1>
<p class="Pp">Arguments that don't start with a hyphen are taken to be the names
    of subroutines or formats to render; if no such functions are specified, the
    main body of the program (outside any subroutines, and not including use'd
    or require'd files) is rendered. Passing
    <span class="Li">&quot;BEGIN&quot;</span>,
    <span class="Li">&quot;UNITCHECK&quot;</span>,
    <span class="Li">&quot;CHECK&quot;</span>,
    <span class="Li">&quot;INIT&quot;</span>, or
    <span class="Li">&quot;END&quot;</span> will cause all of the corresponding
    special blocks to be printed. Arguments must follow options.</p>
<p class="Pp">Options affect how things are rendered (ie printed). They're
    presented here by their visual effect, 1st being strongest. They're grouped
    according to how they interrelate; within each group the options are
    mutually exclusive (unless otherwise stated).</p>
<section class="Ss">
<h2 class="Ss" id="Options_for_Opcode_Ordering"><a class="permalink" href="#Options_for_Opcode_Ordering">Options
  for Opcode Ordering</a></h2>
<p class="Pp">These options control the 'vertical display' of opcodes. The
    display 'order' is also called 'mode' elsewhere in this document.</p>
<dl class="Bl-tag">
  <dt id="basic"><a class="permalink" href="#basic"><b>-basic</b></a></dt>
  <dd>Print OPs in the order they appear in the OP tree (a preorder traversal,
      starting at the root). The indentation of each OP shows its level in the
      tree, and the '-&gt;' at the end of the line indicates the next opcode in
      execution order. This mode is the default, so the flag is included simply
      for completeness.</dd>
  <dt id="exec"><a class="permalink" href="#exec"><b>-exec</b></a></dt>
  <dd>Print OPs in the order they would normally execute (for the majority of
      constructs this is a postorder traversal of the tree, ending at the root).
      In most cases the OP that usually follows a given OP will appear directly
      below it; alternate paths are shown by indentation. In cases like loops
      when control jumps out of a linear path, a 'goto' line is generated.</dd>
  <dt id="tree"><a class="permalink" href="#tree"><b>-tree</b></a></dt>
  <dd>Print OPs in a text approximation of a tree, with the root of the tree at
      the left and 'left-to-right' order of children transformed into
      'top-to-bottom'. Because this mode grows both to the right and down, it
      isn't suitable for large programs (unless you have a very wide
    terminal).</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Options_for_Line-Style"><a class="permalink" href="#Options_for_Line-Style">Options
  for Line-Style</a></h2>
<p class="Pp">These options select the line-style (or just style) used to render
    each opcode, and dictates what info is actually printed into each line.</p>
<dl class="Bl-tag">
  <dt id="concise"><a class="permalink" href="#concise"><b>-concise</b></a></dt>
  <dd>Use the author's favorite set of formatting conventions. This is the
      default, of course.</dd>
  <dt id="terse"><a class="permalink" href="#terse"><b>-terse</b></a></dt>
  <dd>Use formatting conventions that emulate the output of <b>B::Terse</b>. The
      basic mode is almost indistinguishable from the real <b>B::Terse</b>, and
      the exec mode looks very similar, but is in a more logical order and lacks
      curly brackets. <b>B::Terse</b> doesn't have a tree mode, so the tree mode
      is only vaguely reminiscent of <b>B::Terse</b>.</dd>
  <dt id="linenoise"><a class="permalink" href="#linenoise"><b>-linenoise</b></a></dt>
  <dd>Use formatting conventions in which the name of each OP, rather than being
      written out in full, is represented by a one- or two-character
      abbreviation. This is mainly a joke.</dd>
  <dt id="debug"><a class="permalink" href="#debug"><b>-debug</b></a></dt>
  <dd>Use formatting conventions reminiscent of CPAN module <b>B::Debug</b>;
      these aren't very concise at all.</dd>
  <dt id="env"><a class="permalink" href="#env"><b>-env</b></a></dt>
  <dd>Use formatting conventions read from the environment variables
      <span class="Li">&quot;B_CONCISE_FORMAT&quot;</span>,
      <span class="Li">&quot;B_CONCISE_GOTO_FORMAT&quot;</span>, and
      <span class="Li">&quot;B_CONCISE_TREE_FORMAT&quot;</span>.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Options_for_tree-specific_formatting"><a class="permalink" href="#Options_for_tree-specific_formatting">Options
  for tree-specific formatting</a></h2>
<dl class="Bl-tag">
  <dt id="compact"><a class="permalink" href="#compact"><b>-compact</b></a></dt>
  <dd>Use a tree format in which the minimum amount of space is used for the
      lines connecting nodes (one character in most cases). This squeezes out a
      few precious columns of screen real estate.</dd>
  <dt id="loose"><a class="permalink" href="#loose"><b>-loose</b></a></dt>
  <dd>Use a tree format that uses longer edges to separate OP nodes. This format
      tends to look better than the compact one, especially in ASCII, and is the
      default.</dd>
  <dt id="vt"><a class="permalink" href="#vt"><b>-vt</b></a></dt>
  <dd>Use tree connecting characters drawn from the VT100 line-drawing set. This
      looks better if your terminal supports it.</dd>
  <dt id="ascii"><a class="permalink" href="#ascii"><b>-ascii</b></a></dt>
  <dd>Draw the tree with standard ASCII characters like
      <span class="Li">&quot;+&quot;</span> and
      <span class="Li">&quot;|&quot;</span>. These don't look as clean as the
      VT100 characters, but they'll work with almost any terminal (or the
      horizontal scrolling mode of <b>less</b>(1)) and are suitable for text
      documentation or email. This is the default.</dd>
</dl>
<p class="Pp">These are pairwise exclusive, i.e. compact or loose, vt or
  ascii.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Options_controlling_sequence_numbering"><a class="permalink" href="#Options_controlling_sequence_numbering">Options
  controlling sequence numbering</a></h2>
<dl class="Bl-tag">
  <dt id="base"><a class="permalink" href="#base"><b>-base</b><i>n</i></a></dt>
  <dd>Print OP sequence numbers in base <i>n</i>. If <i>n</i> is greater than
      10, the digit for 11 will be 'a', and so on. If <i>n</i> is greater than
      36, the digit for 37 will be 'A', and so on until 62. Values greater than
      62 are not currently supported. The default is 36.</dd>
  <dt id="bigendian"><a class="permalink" href="#bigendian"><b>-bigendian</b></a></dt>
  <dd>Print sequence numbers with the most significant digit first. This is the
      usual convention for Arabic numerals, and the default.</dd>
  <dt id="littleendian"><a class="permalink" href="#littleendian"><b>-littleendian</b></a></dt>
  <dd>Print sequence numbers with the least significant digit first. This is
      obviously mutually exclusive with bigendian.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Other_options"><a class="permalink" href="#Other_options">Other
  options</a></h2>
<dl class="Bl-tag">
  <dt id="src"><a class="permalink" href="#src"><b>-src</b></a></dt>
  <dd>With this option, the rendering of each statement (starting with the
      nextstate OP) will be preceded by the 1st line of source code that
      generates it. For example:
    <p class="Pp"></p>
    <pre>
    1  &lt;0&gt; enter
    # 1: my $i;
    2  &lt;;&gt; nextstate(main 1 junk.pl:1) v:{
    3  &lt;0&gt; padsv[$i:1,10] vM/LVINTRO
    # 3: for $i (0..9) {
    4  &lt;;&gt; nextstate(main 3 junk.pl:3) v:{
    5  &lt;0&gt; pushmark s
    6  &lt;$&gt; const[IV 0] s
    7  &lt;$&gt; const[IV 9] s
    8  &lt;{&gt; enteriter(next-&gt;j last-&gt;m redo-&gt;9)[$i:1,10] lKS
    k  &lt;0&gt; iter s
    l  &lt;|&gt; and(other-&gt;9) vK/1
    # 4:     print &quot;line &quot;;
    9      &lt;;&gt; nextstate(main 2 junk.pl:4) v
    a      &lt;0&gt; pushmark s
    b      &lt;$&gt; const[PV &quot;line &quot;] s
    c      &lt;@&gt; print vK
    # 5:     print &quot;$i\n&quot;;
    ...
    </pre>
  </dd>
  <dt id="stash=_somepackage_"><a class="permalink" href="#stash=_somepackage_"><b>-stash=&quot;somepackage&quot;</b></a></dt>
  <dd>With this, &quot;somepackage&quot; will be required, then the stash is
      inspected, and each function is rendered.</dd>
</dl>
<p class="Pp">The following options are pairwise exclusive.</p>
<dl class="Bl-tag">
  <dt id="main"><a class="permalink" href="#main"><b>-main</b></a></dt>
  <dd>Include the main program in the output, even if subroutines were also
      specified. This rendering is normally suppressed when a subroutine name or
      reference is given.</dd>
  <dt id="nomain"><a class="permalink" href="#nomain"><b>-nomain</b></a></dt>
  <dd>This restores the default behavior after you've changed it with '-main'
      (it's not normally needed). If no subroutine name/ref is given, main is
      rendered, regardless of this flag.</dd>
  <dt id="nobanner"><a class="permalink" href="#nobanner"><b>-nobanner</b></a></dt>
  <dd>Renderings usually include a banner line identifying the function name or
      stringified subref. This suppresses the printing of the banner.
    <p class="Pp">TBC: Remove the stringified coderef; while it provides a
        'cookie' for each function rendered, the cookies used should be 1,2,3..
        not a random hex-address. It also complicates string comparison of two
        different trees.</p>
  </dd>
  <dt id="banner"><a class="permalink" href="#banner"><b>-banner</b></a></dt>
  <dd>restores default banner behavior.</dd>
  <dt id="banneris"><a class="permalink" href="#banneris"><b>-banneris</b> =&gt;
    subref</a></dt>
  <dd>TBC: a hookpoint (and an option to set it) for a user-supplied function to
      produce a banner appropriate for users needs. It's not ideal, because the
      rendering-state variables, which are a natural candidate for use in
      concise.t, are unavailable to the user.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="Option_Stickiness"><a class="permalink" href="#Option_Stickiness">Option
  Stickiness</a></h2>
<p class="Pp">If you invoke Concise more than once in a program, you should know
    that the options are 'sticky'. This means that the options you provide in
    the first call will be remembered for the 2nd call, unless you re-specify or
    change them.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ABBREVIATIONS"><a class="permalink" href="#ABBREVIATIONS">ABBREVIATIONS</a></h1>
<p class="Pp">The concise style uses symbols to convey maximum info with minimal
    clutter (like hex addresses). With just a little practice, you can start to
    see the flowers, not just the branches, in the trees.</p>
<section class="Ss">
<h2 class="Ss">OP class abbreviations</h2>
<p class="Pp">These symbols appear before the op-name, and indicate the B::
    namespace that represents the ops in your Perl code.</p>
<p class="Pp"></p>
<pre>
    0      OP (aka BASEOP)  An OP with no children
    1      UNOP             An OP with one child
    +      UNOP_AUX         A UNOP with auxillary fields
    2      BINOP            An OP with two children
    |      LOGOP            A control branch OP
    @      LISTOP           An OP that could have lots of children
    /      PMOP             An OP with a regular expression
    $      SVOP             An OP with an SV
    &quot;      PVOP             An OP with a string
    {      LOOP             An OP that holds pointers for a loop
    ;      COP              An OP that marks the start of a statement
    #      PADOP            An OP with a GV on the pad
    .      METHOP           An OP with method call info
</pre>
</section>
<section class="Ss">
<h2 class="Ss">OP flags abbreviations</h2>
<p class="Pp">OP flags are either public or private. The public flags alter the
    behavior of each opcode in consistent ways, and are represented by 0 or more
    single characters.</p>
<p class="Pp"></p>
<pre>
    v      OPf_WANT_VOID    Want nothing (void context)
    s      OPf_WANT_SCALAR  Want single value (scalar context)
    l      OPf_WANT_LIST    Want list of any length (list context)
                            Want is unknown
    K      OPf_KIDS         There is a firstborn child.
    P      OPf_PARENS       This operator was parenthesized.
                             (Or block needs explicit scope entry.)
    R      OPf_REF          Certified reference.
                             (Return container, not containee).
    M      OPf_MOD          Will modify (lvalue).
    S      OPf_STACKED      Some arg is arriving on the stack.
    *      OPf_SPECIAL      Do something weird for this op (see op.h)
</pre>
<p class="Pp">Private flags, if any are set for an opcode, are displayed after a
    '/'</p>
<p class="Pp"></p>
<pre>
    8  &lt;@&gt; leave[1 ref] vKP/REFC -&gt;(end)
    7     &lt;2&gt; sassign vKS/2 -&gt;8
</pre>
<p class="Pp">They're opcode specific, and occur less often than the public
    ones, so they're represented by short mnemonics instead of single-chars; see
    B::Op_private and <i>regen/op_private</i> for more details.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="FORMATTING_SPECIFICATIONS"><a class="permalink" href="#FORMATTING_SPECIFICATIONS">FORMATTING
  SPECIFICATIONS</a></h1>
<p class="Pp">For each line-style ('concise', 'terse', 'linenoise', etc.) there
    are 3 format-specs which control how OPs are rendered.</p>
<p class="Pp">The first is the 'default' format, which is used in both basic and
    exec modes to print all opcodes. The 2nd, goto-format, is used in exec mode
    when branches are encountered. They're not real opcodes, and are inserted to
    look like a closing curly brace. The tree-format is tree specific.</p>
<p class="Pp">When a line is rendered, the correct format-spec is copied and
    scanned for the following items; data is substituted in, and other
    manipulations like basic indenting are done, for each opcode rendered.</p>
<p class="Pp">There are 3 kinds of items that may be populated; special
    patterns, #vars, and literal text, which is copied verbatim. (Yes, it's a
    set of s///g steps.)</p>
<section class="Ss">
<h2 class="Ss" id="Special_Patterns"><a class="permalink" href="#Special_Patterns">Special
  Patterns</a></h2>
<p class="Pp">These items are the primitives used to perform indenting, and to
    select text from amongst alternatives.</p>
<dl class="Bl-tag">
  <dt><b>(x(</b><i>exec_text</i><b>;</b><i>basic_text</i><b>)x)</b></dt>
  <dd>Generates <i>exec_text</i> in exec mode, or <i>basic_text</i> in basic
      mode.</dd>
  <dt><b>(*(</b><i>text</i><b>)*)</b></dt>
  <dd>Generates one copy of <i>text</i> for each indentation level.</dd>
  <dt><b>(*(</b><i>text1</i><b>;</b><i>text2</i><b>)*)</b></dt>
  <dd>Generates one fewer copies of <i>text1</i> than the indentation level,
      followed by one copy of <i>text2</i> if the indentation level is more than
      0.</dd>
  <dt><b>(?(</b><i>text1</i><b>#</b><i>var</i><i>Text2</i><b>)?)</b></dt>
  <dd>If the value of <i>var</i> is true (not empty or zero), generates the
      value of <i>var</i> surrounded by <i>text1</i> and <i>Text2</i>, otherwise
      nothing.</dd>
  <dt><b>~</b></dt>
  <dd>Any number of tildes and surrounding whitespace will be collapsed to a
      single space.</dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss" id="__Variables"><a class="permalink" href="#__Variables">#
  Variables</a></h2>
<p class="Pp">These #vars represent opcode properties that you may want as part
    of your rendering. The '#' is intended as a private sigil; a #var's value is
    interpolated into the style-line, much like &quot;read
    <span class="Li">$this</span>&quot;.</p>
<p class="Pp">These vars take 3 forms:</p>
<dl class="Bl-tag">
  <dt><b>#</b><i>var</i></dt>
  <dd>A property named 'var' is assumed to exist for the opcodes, and is
      interpolated into the rendering.</dd>
  <dt><b>#</b><i>var</i><i>N</i></dt>
  <dd>Generates the value of <i>var</i>, left justified to fill <i>N</i> spaces.
      Note that this means while you can have properties 'foo' and 'foo2', you
      cannot render 'foo2', but you could with 'foo2a'. You would be wise not to
      rely on this behavior going forward ;-)</dd>
  <dt><b>#</b><i>Var</i></dt>
  <dd>This ucfirst form of #var generates a tag-value form of itself for
      display; it converts '#Var' into a 'Var =&gt; #var' style, which is then
      handled as described above. (Imp-note: #Vars cannot be used for
      conditional-fills, because the =&gt; #var transform is done after the
      check for #Var's value).</dd>
</dl>
<p class="Pp">The following variables are 'defined' by B::Concise; when they are
    used in a style, their respective values are plugged into the rendering of
    each opcode.</p>
<p class="Pp">Only some of these are used by the standard styles, the others are
    provided for you to delve into optree mechanics, should you wish to add a
    new style (see &quot;add_style&quot; below) that uses them. You can also add
    new ones using &quot;add_callback&quot;.</p>
<dl class="Bl-tag">
  <dt><b>#addr</b></dt>
  <dd>The address of the OP, in hexadecimal.</dd>
  <dt><b>#arg</b></dt>
  <dd>The OP-specific information of the OP (such as the SV for an SVOP, the
      non-local exit pointers for a LOOP, etc.) enclosed in parentheses.</dd>
  <dt><b>#class</b></dt>
  <dd>The B-determined class of the OP, in all caps.</dd>
  <dt><b>#classsym</b></dt>
  <dd>A single symbol abbreviating the class of the OP.</dd>
  <dt><b>#coplabel</b></dt>
  <dd>The label of the statement or block the OP is the start of, if any.</dd>
  <dt><b>#exname</b></dt>
  <dd>The name of the OP, or 'ex-foo' if the OP is a null that used to be a
    foo.</dd>
  <dt><b>#extarg</b></dt>
  <dd>The target of the OP, or nothing for a nulled OP.</dd>
  <dt><b>#firstaddr</b></dt>
  <dd>The address of the OP's first child, in hexadecimal.</dd>
  <dt><b>#flags</b></dt>
  <dd>The OP's flags, abbreviated as a series of symbols.</dd>
  <dt><b>#flagval</b></dt>
  <dd>The numeric value of the OP's flags.</dd>
  <dt><b>#hints</b></dt>
  <dd>The COP's hint flags, rendered with abbreviated names if possible. An
      empty string if this is not a COP. Here are the symbols used:
    <p class="Pp"></p>
    <pre>
    $ strict refs
    &amp; strict subs
    * strict vars
   x$ explicit use/no strict refs
   x&amp; explicit use/no strict subs
   x* explicit use/no strict vars
    i integers
    l locale
    b bytes
    { block scope
    % localise %^H
    &lt; open in
    &gt; open out
    I overload int
    F overload float
    B overload binary
    S overload string
    R overload re
    T taint
    E eval
    X filetest access
    U utf-8

    us      use feature 'unicode_strings'
    fea=NNN feature bundle number
    </pre>
  </dd>
  <dt><b>#hintsval</b></dt>
  <dd>The numeric value of the COP's hint flags, or an empty string if this is
      not a COP.</dd>
  <dt><b>#hyphseq</b></dt>
  <dd>The sequence number of the OP, or a hyphen if it doesn't have one.</dd>
  <dt><b>#label</b></dt>
  <dd>'NEXT', 'LAST', or 'REDO' if the OP is a target of one of those in exec
      mode, or empty otherwise.</dd>
  <dt><b>#lastaddr</b></dt>
  <dd>The address of the OP's last child, in hexadecimal.</dd>
  <dt><b>#name</b></dt>
  <dd>The OP's name.</dd>
  <dt><b>#NAME</b></dt>
  <dd>The OP's name, in all caps.</dd>
  <dt><b>#next</b></dt>
  <dd>The sequence number of the OP's next OP.</dd>
  <dt><b>#nextaddr</b></dt>
  <dd>The address of the OP's next OP, in hexadecimal.</dd>
  <dt><b>#noise</b></dt>
  <dd>A one- or two-character abbreviation for the OP's name.</dd>
  <dt><b>#private</b></dt>
  <dd>The OP's private flags, rendered with abbreviated names if possible.</dd>
  <dt><b>#privval</b></dt>
  <dd>The numeric value of the OP's private flags.</dd>
  <dt><b>#seq</b></dt>
  <dd>The sequence number of the OP. Note that this is a sequence number
      generated by B::Concise.</dd>
  <dt><b>#opt</b></dt>
  <dd>Whether or not the op has been optimized by the peephole optimizer.</dd>
  <dt><b>#sibaddr</b></dt>
  <dd>The address of the OP's next youngest sibling, in hexadecimal.</dd>
  <dt><b>#svaddr</b></dt>
  <dd>The address of the OP's SV, if it has an SV, in hexadecimal.</dd>
  <dt><b>#svclass</b></dt>
  <dd>The class of the OP's SV, if it has one, in all caps (e.g., 'IV').</dd>
  <dt><b>#svval</b></dt>
  <dd>The value of the OP's SV, if it has one, in a short human-readable
    format.</dd>
  <dt><b>#targ</b></dt>
  <dd>The numeric value of the OP's targ.</dd>
  <dt><b>#targarg</b></dt>
  <dd>The name of the variable the OP's targ refers to, if any, otherwise the
      letter t followed by the OP's targ in decimal.</dd>
  <dt><b>#targarglife</b></dt>
  <dd>Same as <b>#targarg</b>, but followed by the COP sequence numbers that
      delimit the variable's lifetime (or 'end' for a variable in an open scope)
      for a variable.</dd>
  <dt><b>#typenum</b></dt>
  <dd>The numeric value of the OP's type, in decimal.</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="One-Liner_Command_tips"><a class="permalink" href="#One-Liner_Command_tips">One-Liner
  Command tips</a></h1>
<dl class="Bl-tag">
  <dt id="perl"><a class="permalink" href="#perl">perl -MO=Concise,bar
    foo.pl</a></dt>
  <dd>Renders only <b>bar()</b> from foo.pl. To see main, drop the ',bar'. To
      see both, add ',-main'</dd>
  <dt id="perl~2"><a class="permalink" href="#perl~2">perl -MDigest::MD5=md5
    -MO=Concise,md5 -e1</a></dt>
  <dd>Identifies md5 as an XS function. The export is needed so that BC can find
      it in main.</dd>
  <dt id="perl~3"><a class="permalink" href="#perl~3">perl -MPOSIX
    -MO=Concise,_POSIX_ARG_MAX -e1</a></dt>
  <dd>Identifies _POSIX_ARG_MAX as a constant sub, optimized to an IV. Although
      POSIX isn't entirely consistent across platforms, this is likely to be
      present in virtually all of them.</dd>
  <dt id="perl~4"><a class="permalink" href="#perl~4">perl -MPOSIX -MO=Concise,a
    -e 'print _POSIX_SAVED_IDS'</a></dt>
  <dd>This renders a print statement, which includes a call to the function.
      It's identical to rendering a file with a use call and that single
      statement, except for the filename which appears in the nextstate
    ops.</dd>
  <dt id="perl~5"><a class="permalink" href="#perl~5">perl -MPOSIX -MO=Concise,a
    -e 'sub a{_POSIX_SAVED_IDS}'</a></dt>
  <dd>This is <b>very</b> similar to previous, only the first two ops differ.
      This subroutine rendering is more representative, insofar as a single main
      program will have many subs.</dd>
  <dt id="perl~6"><a class="permalink" href="#perl~6">perl -MB::Concise -e
    'B::Concise::compile(&quot;-exec&quot;,&quot;-src&quot;,
    \%B::Concise::)-&gt;()'</a></dt>
  <dd>This renders all functions in the B::Concise package with the source
      lines. It eschews the O framework so that the stashref can be passed
      directly to <b>B::Concise::compile()</b>. See -stash option for a more
      convenient way to render a package.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="Using_B::Concise_outside_of_the_O_framework"><a class="permalink" href="#Using_B::Concise_outside_of_the_O_framework">Using
  B::Concise outside of the O framework</a></h1>
<p class="Pp">The common (and original) usage of B::Concise was for command-line
    renderings of simple code, as given in EXAMPLE. But you can also use
    <b>B::Concise</b> from your code, and call <b>compile()</b> directly, and
    repeatedly. By doing so, you can avoid the compile-time only operation of
    O.pm, and even use the debugger to step through <b>B::Concise::compile()</b>
    itself.</p>
<p class="Pp">Once you're doing this, you may alter Concise output by adding new
    rendering styles, and by optionally adding callback routines which populate
    new variables, if such were referenced from those (just added) styles.</p>
<section class="Ss">
<h2 class="Ss" id="Example:_Altering_Concise_Renderings"><a class="permalink" href="#Example:_Altering_Concise_Renderings">Example:
  Altering Concise Renderings</a></h2>
<pre>
    use B::Concise qw(set_style add_callback);
    add_style($yourStyleName =&gt; $defaultfmt, $gotofmt, $treefmt);
    add_callback
      ( sub {
            my ($h, $op, $format, $level, $stylename) = @_;
            $h-&gt;{variable} = some_func($op);
        });
    $walker = B::Concise::compile(@options,@subnames,@subrefs);
    $walker-&gt;();
</pre>
</section>
<section class="Ss">
<h2 class="Ss"><b>set_style()</b></h2>
<p class="Pp"><b>set_style</b> accepts 3 arguments, and updates the three
    format-specs comprising a line-style (basic-exec, goto, tree). It has one
    minor drawback though; it doesn't register the style under a new name. This
    can become an issue if you render more than once and switch styles. Thus you
    may prefer to use <b>add_style()</b> and/or <b>set_style_standard()</b>
    instead.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="set_style_standard($name)"><a class="permalink" href="#set_style_standard($name)">set_style_standard($name)</a></h2>
<p class="Pp">This restores one of the standard line-styles:
    <span class="Li">&quot;terse&quot;</span>,
    <span class="Li">&quot;concise&quot;</span>,
    <span class="Li">&quot;linenoise&quot;</span>,
    <span class="Li">&quot;debug&quot;</span>,
    <span class="Li">&quot;env&quot;</span>, into effect. It also accepts style
    names previously defined with <b>add_style()</b>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="add_style_()"><a class="permalink" href="#add_style_()">add_style
  ()</a></h2>
<p class="Pp">This subroutine accepts a new style name and three style arguments
    as above, and creates, registers, and selects the newly named style. It is
    an error to re-add a style; call <b>set_style_standard()</b> to switch
    between several styles.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="add_callback_()"><a class="permalink" href="#add_callback_()">add_callback
  ()</a></h2>
<p class="Pp">If your newly minted styles refer to any new #variables, you'll
    need to define a callback subroutine that will populate (or modify) those
    variables. They are then available for use in the style you've chosen.</p>
<p class="Pp">The callbacks are called for each opcode visited by Concise, in
    the same order as they are added. Each subroutine is passed five
  parameters.</p>
<p class="Pp"></p>
<pre>
  1. A hashref, containing the variable names and values which are
     populated into the report-line for the op
  2. the op, as a B&lt;B::OP&gt; object
  3. a reference to the format string
  4. the formatting (indent) level
  5. the selected stylename
</pre>
<p class="Pp">To define your own variables, simply add them to the hash, or
    change existing values if you need to. The level and format are passed in as
    references to scalars, but it is unlikely that they will need to be changed
    or even used.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Running_"><a class="permalink" href="#Running_">Running
  <b>B::Concise::compile()</b></a></h2>
<p class="Pp"><b>compile</b> accepts options as described above in
    &quot;OPTIONS&quot;, and arguments, which are either coderefs, or subroutine
    names.</p>
<p class="Pp">It constructs and returns a <span class="Li">$treewalker</span>
    coderef, which when invoked, traverses, or walks, and renders the optrees of
    the given arguments to STDOUT. You can reuse this, and can change the
    rendering style used each time; thereafter the coderef renders in the new
    style.</p>
<p class="Pp"><b>walk_output</b> lets you change the print destination from
    STDOUT to another open filehandle, or into a string passed as a ref (unless
    you've built perl with -Uuseperlio).</p>
<p class="Pp"></p>
<pre>
  my $walker = B::Concise::compile('-terse','aFuncName', \&amp;aSubRef); # 1
  walk_output(\my $buf);
  $walker-&gt;();                          # 1 renders -terse
  set_style_standard('concise');        # 2
  $walker-&gt;();                          # 2 renders -concise
  $walker-&gt;(@new);                      # 3 renders whatever
  print &quot;3 different renderings: terse, concise, and @new: $buf\n&quot;;
</pre>
<p class="Pp">When <span class="Li">$walker</span> is called, it traverses the
    subroutines supplied when it was created, and renders them using the current
    style. You can change the style afterwards in several different ways:</p>
<p class="Pp"></p>
<pre>
  1. call C&lt;compile&gt;, altering style or mode/order
  2. call C&lt;set_style_standard&gt;
  3. call $walker, passing @new options
</pre>
<p class="Pp">Passing new options to the <span class="Li">$walker</span> is the
    easiest way to change amongst any pre-defined styles (the ones you add are
    automatically recognized as options), and is the only way to alter rendering
    order without calling compile again. Note however that rendering state is
    still shared amongst multiple <span class="Li">$walker</span> objects, so
    they must still be used in a coordinated manner.</p>
</section>
<section class="Ss">
<h2 class="Ss"><b>B::Concise::reset_sequence()</b></h2>
<p class="Pp">This function (not exported) lets you reset the sequence numbers
    (note that they're numbered arbitrarily, their goal being to be human
    readable). Its purpose is mostly to support testing, i.e. to compare the
    concise output from two identical anonymous subroutines (but different
    instances). Without the reset, B::Concise, seeing that they're separate
    optrees, generates different sequence numbers in the output.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Errors"><a class="permalink" href="#Errors">Errors</a></h2>
<p class="Pp">Errors in rendering (non-existent function-name, non-existent
    coderef) are written to the STDOUT, or wherever you've set it via
    <b>walk_output()</b>.</p>
<p class="Pp">Errors using the various *style* calls, and bad args to
    <b>walk_output()</b>, result in <b>die()</b>. Use an eval if you wish to
    catch these errors and continue processing.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Stephen McCamant, &lt;smcc@CSUA.Berkeley.EDU&gt;.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-10-21</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
