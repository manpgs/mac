<!DOCTYPE html>
<html lang="en">
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>IO::Socket::SSL::Utils(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">IO::Socket::SSL::Utils(3)</td>
    <td class="head-vol"><a href=".">User Contributed Perl Documentation</a></td>
    <td class="head-rtitle">IO::Socket::SSL::Utils(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">IO::Socket::SSL::Utils -- loading, storing, creating certificates
    and keys</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>    use IO::Socket::SSL::Utils;
    my $cert = PEM_file2cert('cert.pem');  # load certificate from file
    my $string = PEM_cert2string($cert);   # convert certificate to PEM string
    CERT_free($cert);                      # free memory within OpenSSL
    my $key = KEY_create_rsa(2048);        # create new 2048-bit RSA key
    PEM_string2file($key,&quot;key.pem&quot;);       # and write it to file
    KEY_free($key);                        # free memory within OpenSSL
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module provides various utility functions to work with
    certificates and private keys, shielding some of the complexity of the
    underlying Net::SSLeay and OpenSSL.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Functions converting between string or file and certificates and keys.
      They croak if the operation cannot be completed.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="PEM_file2cert(file)"><a class="permalink" href="#PEM_file2cert(file)">PEM_file2cert(file)
    -&gt; cert</a></dt>
  <dd></dd>
  <dt id="PEM_cert2file(cert,file)"><a class="permalink" href="#PEM_cert2file(cert,file)">PEM_cert2file(cert,file)</a></dt>
  <dd></dd>
  <dt id="PEM_string2cert(string)"><a class="permalink" href="#PEM_string2cert(string)">PEM_string2cert(string)
    -&gt; cert</a></dt>
  <dd></dd>
  <dt id="PEM_cert2string(cert)"><a class="permalink" href="#PEM_cert2string(cert)">PEM_cert2string(cert)
    -&gt; string</a></dt>
  <dd></dd>
  <dt id="PEM_file2key(file)"><a class="permalink" href="#PEM_file2key(file)">PEM_file2key(file)
    -&gt; key</a></dt>
  <dd></dd>
  <dt id="PEM_key2file(key,file)"><a class="permalink" href="#PEM_key2file(key,file)">PEM_key2file(key,file)</a></dt>
  <dd></dd>
  <dt id="PEM_string2key(string)"><a class="permalink" href="#PEM_string2key(string)">PEM_string2key(string)
    -&gt; key</a></dt>
  <dd></dd>
  <dt id="PEM_key2string(key)"><a class="permalink" href="#PEM_key2string(key)">PEM_key2string(key)
    -&gt; string</a></dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>Functions for cleaning up. Each loaded or created cert and key must be
      freed to not leak memory.</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="CERT_free(cert)"><a class="permalink" href="#CERT_free(cert)">CERT_free(cert)</a></dt>
  <dd></dd>
  <dt id="KEY_free(key)"><a class="permalink" href="#KEY_free(key)">KEY_free(key)</a></dt>
  <dd></dd>
</dl>
</div>
<div class="Bd-indent"></div>
<ul class="Bl-bullet">
  <li>KEY_create_rsa(bits) -&gt; key
    <p class="Pp">Creates an RSA key pair, bits defaults to 2048.</p>
  </li>
  <li>KEY_create_ec(curve) -&gt; key
    <p class="Pp">Creates an EC key, curve defaults to
        <span class="Li">&quot;prime256v1&quot;</span>.</p>
  </li>
  <li>CERT_asHash(cert,[digest_algo]) -&gt; hash
    <p class="Pp">Extracts the information from the certificate into a hash and
        uses the given digest_algo (default: SHA-256) to determine digest of
        pubkey and cert. The resulting hash contains:</p>
  </li>
</ul>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="subject"><a class="permalink" href="#subject">subject</a></dt>
  <dd>Hash with the parts of the subject, e.g. commonName, countryName,
      organizationName, stateOrProvinceName, localityName.</dd>
  <dt id="subjectAltNames"><a class="permalink" href="#subjectAltNames">subjectAltNames</a></dt>
  <dd>Array with list of alternative names. Each entry in the list is of
      <span class="Li">&quot;[type,value]&quot;</span>, where
      <span class="Li">&quot;type&quot;</span> can be OTHERNAME, EMAIL, DNS,
      X400, DIRNAME, EDIPARTY, URI, IP or RID.</dd>
  <dt id="issuer"><a class="permalink" href="#issuer">issuer</a></dt>
  <dd>Hash with the parts of the issuer, e.g. commonName, countryName,
      organizationName, stateOrProvinceName, localityName.</dd>
  <dt id="not_before,"><a class="permalink" href="#not_before,">not_before,
    not_after</a></dt>
  <dd>The time frame, where the certificate is valid, as time_t, e.g. can be
      converted with localtime or similar functions.</dd>
  <dt id="serial"><a class="permalink" href="#serial">serial</a></dt>
  <dd>The serial number</dd>
  <dt id="crl_uri"><a class="permalink" href="#crl_uri">crl_uri</a></dt>
  <dd>List of URIs for CRL distribution.</dd>
  <dt id="ocsp_uri"><a class="permalink" href="#ocsp_uri">ocsp_uri</a></dt>
  <dd>List of URIs for revocation checking using OCSP.</dd>
  <dt id="keyusage"><a class="permalink" href="#keyusage">keyusage</a></dt>
  <dd>List of keyUsage information in the certificate.</dd>
  <dt id="extkeyusage"><a class="permalink" href="#extkeyusage">extkeyusage</a></dt>
  <dd>List of extended key usage information from the certificate. Each entry in
      this list consists of a hash with oid, nid, ln and sn.</dd>
  <dt id="pubkey_digest_xxx"><a class="permalink" href="#pubkey_digest_xxx">pubkey_digest_xxx</a></dt>
  <dd>Binary digest of the pubkey using the given digest algorithm, e.g.
      pubkey_digest_sha256 if (the default) SHA-256 was used.</dd>
  <dt id="x509_digest_xxx"><a class="permalink" href="#x509_digest_xxx">x509_digest_xxx</a></dt>
  <dd>Binary digest of the X.509 certificate using the given digest algorithm,
      e.g. x509_digest_sha256 if (the default) SHA-256 was used.</dd>
  <dt id="fingerprint_xxx"><a class="permalink" href="#fingerprint_xxx">fingerprint_xxx</a></dt>
  <dd>Fingerprint of the certificate using the given digest algorithm, e.g.
      fingerprint_sha256 if (the default) SHA-256 was used. Contrary to digest_*
      this is an ASCII string with a list if hexadecimal numbers, e.g.
      &quot;73:59:75:5C:6D...&quot;.</dd>
  <dt id="signature_alg"><a class="permalink" href="#signature_alg">signature_alg</a></dt>
  <dd>Algorithm used to sign certificate, e.g.
      <span class="Li">&quot;sha256WithRSAEncryption&quot;</span>.</dd>
  <dt id="ext"><a class="permalink" href="#ext">ext</a></dt>
  <dd>List of extensions. Each entry in the list is a hash with oid, nid, sn,
      critical flag (boolean) and data (string representation given by
      X509V3_EXT_print).</dd>
  <dt id="version"><a class="permalink" href="#version">version</a></dt>
  <dd>Certificate version, usually 2 (x509v3)</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt>&#x2022;</dt>
  <dd>CERT_create(hash) -&gt; (cert,key)
    <p class="Pp">Creates a certificate based on the given hash. If the issuer
        is not specified the certificate will be self-signed. The following keys
        can be given:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="subject~2"><a class="permalink" href="#subject~2">subject</a></dt>
  <dd>Hash with the parts of the subject, e.g. commonName, countryName, ... as
      described in <span class="Li">&quot;CERT_asHash&quot;</span>. Default
      points to IO::Socket::SSL.</dd>
  <dt id="not_before"><a class="permalink" href="#not_before">not_before</a></dt>
  <dd>A time_t value when the certificate starts to be valid. Defaults to
      current time.</dd>
  <dt id="not_after"><a class="permalink" href="#not_after">not_after</a></dt>
  <dd>A time_t value when the certificate ends to be valid. Defaults to current
      time plus one 365 days.</dd>
  <dt id="serial~2"><a class="permalink" href="#serial~2">serial</a></dt>
  <dd>The serial number. If not given a random number will be used.</dd>
  <dt id="version~2"><a class="permalink" href="#version~2">version</a></dt>
  <dd>The version of the certificate, default 2 (x509v3).</dd>
  <dt id="CA"><a class="permalink" href="#CA">CA true|false</a></dt>
  <dd>If true declare certificate as CA, defaults to false.</dd>
  <dt id="purpose"><a class="permalink" href="#purpose">purpose
    string|array|hash</a></dt>
  <dd>Set the purpose of the certificate. The different purposes can be given as
      a string separated by non-word character, as array or hash. With string or
      array each purpose can be prefixed with '+' (enable) or '-' (disable) and
      same can be done with the value when given as a hash. By default enabling
      the purpose is assumed.
    <p class="Pp">If the CA option is given and true the defaults
        &quot;ca,sslca,emailca,objca&quot; are assumed, but can be overridden
        with explicit purpose. If the CA option is given and false the defaults
        &quot;server,client&quot; are assumed. If no CA option and no purpose is
        given it defaults to &quot;server,client&quot;.</p>
    <p class="Pp">Purpose affects basicConstraints, keyUsage, extKeyUsage and
        netscapeCertType. The following purposes are defined (case is not
        important):</p>
    <p class="Pp"></p>
    <pre>    client
    server
    email
    objsign
    CA
    sslCA
    emailCA
    objCA
    emailProtection
    codeSigning
    timeStamping
    digitalSignature
    nonRepudiation
    keyEncipherment
    dataEncipherment
    keyAgreement
    keyCertSign
    cRLSign
    encipherOnly
    decipherOnly
    </pre>
    <p class="Pp">Examples:</p>
    <p class="Pp"></p>
    <pre>     # root-CA for SSL certificates
     purpose =&gt; 'sslCA'   # or CA =&gt; 1
     # server certificate and CA (typically self-signed)
     purpose =&gt; 'sslCA,server'
     # client certificate
     purpose =&gt; 'client',
    </pre>
  </dd>
  <dt>ext [{ sn =&gt; .., data =&gt; ... }, ... ]</dt>
  <dd>List of extensions. The type of the extension can be specified as name
      with <span class="Li">&quot;sn&quot;</span> or as NID with
      <span class="Li">&quot;nid&quot;</span> and the data with
      <span class="Li">&quot;data&quot;</span>. These data must be in the same
      syntax as expected within openssl.cnf, e.g. something like
      <span class="Li">&quot;OCSP;URI=http://...&quot;</span>. Additionally the
      critical flag can be set with <span class="Li">&quot;critical
      =&quot;</span> 1&gt;.</dd>
  <dt id="key"><a class="permalink" href="#key">key key</a></dt>
  <dd>use given key as key for certificate, otherwise a new one will be
      generated and returned</dd>
  <dt id="issuer_cert"><a class="permalink" href="#issuer_cert">issuer_cert
    cert</a></dt>
  <dd>set issuer for new certificate</dd>
  <dt id="issuer_key"><a class="permalink" href="#issuer_key">issuer_key
    key</a></dt>
  <dd>sign new certificate with given key</dd>
  <dt>issuer [ cert, key ]</dt>
  <dd>Instead of giving issuer_key and issuer_cert as separate arguments they
      can be given both together.</dd>
  <dt id="digest"><a class="permalink" href="#digest">digest algorithm</a></dt>
  <dd>specify the algorithm used to sign the certificate, default SHA-256.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Steffen Ullrich</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-02-14</td>
    <td class="foot-os"><a href="..">perl v5.34.0</a></td>
  </tr>
</table>
</body>
</html>
