<!DOCTYPE html>
<html lang="en">
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>indirect(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">indirect(3)</td>
    <td class="head-vol"><a href=".">User Contributed Perl Documentation</a></td>
    <td class="head-rtitle">indirect(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">indirect - Lexically warn about using the indirect method call
    syntax.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="VERSION"><a class="permalink" href="#VERSION">VERSION</a></h1>
<p class="Pp">Version 0.39</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">In a script :</p>
<p class="Pp"></p>
<pre>    no indirect;               # lexically enables the pragma
    my $x = new Apple 1, 2, 3; # warns
    {
     use indirect;     # lexically disables the pragma
     my $y = new Pear; # legit, does not warn
     {
      # lexically specify an hook called for each indirect construct
      no indirect hook =&gt; sub {
       die &quot;You really wanted $_[0]\-&gt;$_[1] at $_[2]:$_[3]&quot;
      };
      my $z = new Pineapple 'fresh'; # croaks 'You really wanted...'
     }
    }
    try { ... }; # warns if try() hasn't been declared in this package
    no indirect 'fatal';     # or ':fatal', 'FATAL', ':Fatal' ...
    if (defied $foo) { ... } # croaks, note the typo
</pre>
<p class="Pp">Global uses :</p>
<p class="Pp"></p>
<pre>    # Globally enable the pragma from the command-line
    perl -M-indirect=global -e 'my $x = new Banana;' # warns
    # Globally enforce the pragma each time perl is executed
    export PERL5OPT=&quot;-M-indirect=global,fatal&quot;
    perl -e 'my $y = new Coconut;' # croaks
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">When enabled, this pragma warns about indirect method calls that
    are present in your code.</p>
<p class="Pp">The indirect syntax is now considered harmful, since its parsing
    has many quirks and its use is error prone : when the subroutine
    <span class="Li">&quot;foo&quot;</span> has not been declared in the current
    package, <span class="Li">&quot;foo $x&quot;</span> actually compiles to
    <span class="Li">&quot;$x-&gt;foo&quot;</span>, and
    <span class="Li">&quot;foo { key =&gt; 1 }&quot;</span> to
    <span class="Li">&quot;'key'-&gt;foo(1)&quot;</span>. Please refer to the
    &quot;REFERENCES&quot; section for a more complete list of reasons for
    avoiding this construct.</p>
<p class="Pp">This pragma currently does not warn for core functions
    (<span class="Li">&quot;print&quot;</span>,
    <span class="Li">&quot;say&quot;</span>,
    <span class="Li">&quot;exec&quot;</span> or
    <span class="Li">&quot;system&quot;</span>). This may change in the future,
    or may be added as optional features that would be enabled by passing
    options to <span class="Li">&quot;unimport&quot;</span>.</p>
<p class="Pp">This module is <b>not</b> a source filter.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS"><a class="permalink" href="#METHODS">METHODS</a></h1>
<section class="Ss">
<h2 class="Ss" id="_unimport_"><a class="permalink" href="#_unimport_">&quot;unimport&quot;</a></h2>
<pre>    no indirect;
    no indirect 'fatal';
    no indirect hook =&gt; sub { my ($obj, $name, $file, $line) = @_; ... };
    no indirect 'global';
    no indirect 'global, 'fatal';
    no indirect 'global', hook =&gt; sub { ... };
</pre>
<p class="Pp">Magically called when <span class="Li">&quot;no indirect
    @opts&quot;</span> is encountered. Turns the module on. The policy to apply
    depends on what is first found in <span class="Li">@opts</span> :</p>
<ul class="Bl-bullet">
  <li>If it is a string that matches
      <span class="Li">&quot;/^:?fatal$/i&quot;</span>, the compilation will
      croak when the first indirect method call is found.
    <p class="Pp">This option is mutually exclusive with the
        <span class="Li">'hook'</span> option.</p>
  </li>
  <li>If the key/value pair <span class="Li">&quot;hook =&gt; $hook&quot;</span>
      comes first, <span class="Li">$hook</span> will be called for each error
      with a string representation of the object as
      <span class="Li">$_[0]</span>, the method name as
      <span class="Li">$_[1]</span>, the current file as
      <span class="Li">$_[2]</span> and the line number as
      <span class="Li">$_[3]</span>. If and only if the object is actually a
      block, <span class="Li">$_[0]</span> is assured to start by
      <span class="Li">'{'</span>.
    <p class="Pp">This option is mutually exclusive with the
        <span class="Li">'fatal'</span> option.</p>
  </li>
  <li>If none of <span class="Li">&quot;fatal&quot;</span> and
      <span class="Li">&quot;hook&quot;</span> are specified, a warning will be
      emitted for each indirect method call.</li>
  <li>If <span class="Li">@opts</span> contains a string that matches
      <span class="Li">&quot;/^:?global$/i&quot;</span>, the pragma will be
      globally enabled for <b>all</b> code compiled after the current
      <span class="Li">&quot;no indirect&quot;</span> statement, except for code
      that is in the lexical scope of <span class="Li">&quot;use
      indirect&quot;</span>. This option may come indifferently before or after
      the <span class="Li">&quot;fatal&quot;</span> or
      <span class="Li">&quot;hook&quot;</span> options, in the case they are
      also passed to &quot;unimport&quot;.
    <p class="Pp">The global policy applied is the one resulting of the
        <span class="Li">&quot;fatal&quot;</span> or
        <span class="Li">&quot;hook&quot;</span> options, thus defaults to a
        warning when none of those are specified :</p>
    <p class="Pp"></p>
    <pre>    no indirect 'global';                # warn for any indirect call
    no indirect qw&lt;global fatal&gt;;        # die on any indirect call
    no indirect 'global', hook =&gt; \&amp;hook # custom global action
    </pre>
    <p class="Pp">Note that if another policy is installed by a
        <span class="Li">&quot;no indirect&quot;</span> statement further in the
        code, it will overrule the global policy :</p>
    <p class="Pp"></p>
    <pre>    no indirect 'global';  # warn globally
    {
     no indirect 'fatal';  # throw exceptions for this lexical scope
     ...
     require Some::Module; # the global policy will apply for the
                           # compilation phase of this module
    }
    </pre>
  </li>
</ul>
</section>
<section class="Ss">
<h2 class="Ss" id="_import_"><a class="permalink" href="#_import_">&quot;import&quot;</a></h2>
<pre>    use indirect;
</pre>
<p class="Pp">Magically called at each <span class="Li">&quot;use
    indirect&quot;</span>. Turns the module off.</p>
<p class="Pp">As explained in &quot;unimport&quot;'s description, an
    <span class="Li">&quot;use indirect&quot;</span> statement will lexically
    override a global policy previously installed by <span class="Li">&quot;no
    indirect 'global', ...&quot;</span> (if there's one).</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="FUNCTIONS"><a class="permalink" href="#FUNCTIONS">FUNCTIONS</a></h1>
<section class="Ss">
<h2 class="Ss" id="_msg_"><a class="permalink" href="#_msg_">&quot;msg&quot;</a></h2>
<pre>    my $msg = msg($object, $method, $file, $line);
</pre>
<p class="Pp">Returns the default error message that
    <span class="Li">&quot;indirect&quot;</span> generates when an indirect
    method call is reported.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CONSTANTS"><a class="permalink" href="#CONSTANTS">CONSTANTS</a></h1>
<section class="Ss">
<h2 class="Ss" id="_I_THREADSAFE_"><a class="permalink" href="#_I_THREADSAFE_">&quot;I_THREADSAFE&quot;</a></h2>
<p class="Pp">True iff the module could have been built with thread-safety
    features enabled.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_I_FORKSAFE_"><a class="permalink" href="#_I_FORKSAFE_">&quot;I_FORKSAFE&quot;</a></h2>
<p class="Pp">True iff this module could have been built with fork-safety
    features enabled. This will always be true except on Windows where it's
    false for perl 5.10.0 and below .</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="DIAGNOSTICS"><a class="permalink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
<section class="Ss">
<h2 class="Ss" id="_Indirect_call_of_method___s__on_object___s__at__s_line__d._"><a class="permalink" href="#_Indirect_call_of_method___s__on_object___s__at__s_line__d._">&quot;Indirect
  call of method &quot;%s&quot; on object &quot;%s&quot; at %s line
  %d.&quot;</a></h2>
<p class="Pp">The default warning/exception message thrown when an indirect
    method call on an object is found.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_Indirect_call_of_method___s__on_a_block_at__s_line__d._"><a class="permalink" href="#_Indirect_call_of_method___s__on_a_block_at__s_line__d._">&quot;Indirect
  call of method &quot;%s&quot; on a block at %s line %d.&quot;</a></h2>
<p class="Pp">The default warning/exception message thrown when an indirect
    method call on a block is found.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ENVIRONMENT"><a class="permalink" href="#ENVIRONMENT">ENVIRONMENT</a></h1>
<section class="Ss">
<h2 class="Ss" id="_PERL_INDIRECT_PM_DISABLE_"><a class="permalink" href="#_PERL_INDIRECT_PM_DISABLE_">&quot;PERL_INDIRECT_PM_DISABLE&quot;</a></h2>
<p class="Pp">If this environment variable is set to true when the pragma is
    used for the first time, the XS code won't be loaded and, although the
    <span class="Li">'indirect'</span> lexical hint will be set to true in the
    scope of use, the pragma itself won't do anything. In this case, the pragma
    will always be considered to be thread-safe, and as such
    &quot;I_THREADSAFE&quot; will be true. This is useful for disabling
    <span class="Li">&quot;indirect&quot;</span> in production environments.</p>
<p class="Pp">Note that clearing this variable after
    <span class="Li">&quot;indirect&quot;</span> was loaded has no effect. If
    you want to re-enable the pragma later, you also need to reload it by
    deleting the <span class="Li">'indirect.pm'</span> entry from
    <span class="Li">%INC</span>.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp">The implementation was tweaked to work around several limitations
    of vanilla <span class="Li">&quot;perl&quot;</span> pragmas : it's thread
    safe, and does not suffer from a <span class="Li">&quot;perl
    5.8.x-5.10.0&quot;</span> bug that causes all pragmas to propagate into
    <span class="Li">&quot;require&quot;</span>d scopes.</p>
<p class="Pp">Before <span class="Li">&quot;perl&quot;</span> 5.12,
    <span class="Li">&quot;meth $obj&quot;</span> (no semicolon) at the end of a
    file is not seen as an indirect method call, although it is as soon as there
    is another token before the end (as in <span class="Li">&quot;meth
    $obj;&quot;</span> or <span class="Li">&quot;meth $obj 1&quot;</span>). If
    you use <span class="Li">&quot;perl&quot;</span> 5.12 or greater, those
    constructs are correctly reported.</p>
<p class="Pp">With 5.8 perls, the pragma does not propagate into
    <span class="Li">&quot;eval STRING&quot;</span>. This is due to a
    shortcoming in the way perl handles the hints hash, which is addressed in
    perl 5.10.</p>
<p class="Pp">The search for indirect method calls happens before constant
    folding. Hence <span class="Li">&quot;my $x = new Class if 0&quot;</span>
    will be caught.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="REFERENCES"><a class="permalink" href="#REFERENCES">REFERENCES</a></h1>
<p class="Pp">Numerous articles have been written about the quirks of the
    indirect object construct :</p>
<ul class="Bl-bullet">
  <li>&lt;http://markmail.org/message/o7d5sxnydya7bwvv&gt; : <b>Far More Than
      Everything You've Ever Wanted to Know about the Indirect Object
      syntax</b>, Tom Christiansen, 1998-01-28.
    <p class="Pp">This historical post to the
        <span class="Li">&quot;perl5-porters&quot;</span> mailing list raised
        awareness about the perils of this syntax.</p>
  </li>
  <li>&lt;http://www.shadowcat.co.uk/blog/matt-s-trout/indirect-but-still-fatal&gt;
      : <b>Indirect but still fatal</b>, Matt S. Trout, 2009-07-29.
    <p class="Pp">In this blog post, the author gives an example of an
        undesirable indirect method call on a block that causes a particularly
        bewildering error.</p>
  </li>
</ul>
</section>
<section class="Sh">
<h1 class="Sh" id="DEPENDENCIES"><a class="permalink" href="#DEPENDENCIES">DEPENDENCIES</a></h1>
<p class="Pp">perl 5.8.1.</p>
<p class="Pp">A C compiler. This module may happen to build with a C++ compiler
    as well, but don't rely on it, as no guarantee is made in this regard.</p>
<p class="Pp">Carp (standard since perl 5), XSLoader (since perl 5.6.0).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Vincent Pit
    <span class="Li">&quot;&lt;vpit@cpan.org&gt;&quot;</span>.</p>
<p class="Pp">You can contact me by mail or on
    <span class="Li">&quot;irc.perl.org&quot;</span> (vincent).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">Please report any bugs or feature requests to
    <span class="Li">&quot;bug-indirect at rt.cpan.org&quot;</span>, or through
    the web interface at
    &lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=indirect&gt;. I will be
    notified, and then you'll automatically be notified of progress on your bug
    as I make changes.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
<p class="Pp">You can find documentation for this module with the perldoc
    command.</p>
<p class="Pp"></p>
<pre>    perldoc indirect
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="ACKNOWLEDGEMENTS"><a class="permalink" href="#ACKNOWLEDGEMENTS">ACKNOWLEDGEMENTS</a></h1>
<p class="Pp">Bram, for motivation and advices.</p>
<p class="Pp">Andrew Main and Florian Ragwitz, for testing on real-life code and
    reporting issues.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_&amp;_LICENSE"><a class="permalink" href="#COPYRIGHT_&amp;_LICENSE">COPYRIGHT
  &amp; LICENSE</a></h1>
<p class="Pp">Copyright 2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2019
    Vincent Pit, all rights reserved.</p>
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-07-08</td>
    <td class="foot-os"><a href="..">perl v5.34.0</a></td>
  </tr>
</table>
</body>
</html>
