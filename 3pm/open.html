<!DOCTYPE html>
<html lang="en">
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>open(3pm)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">open(3pm)</td>
    <td class="head-vol"><a href=".">Perl Programmers Reference Guide</a></td>
    <td class="head-rtitle">open(3pm)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">open - perl pragma to set default PerlIO layers for input and
    output</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>    use open IN  =&gt; ':crlf', OUT =&gt; ':raw';
    open my $in, '&lt;', 'foo.txt' or die &quot;open failed: $!&quot;;
    my $line = &lt;$in&gt;; # CRLF translated
    close $in;
    open my $out, '&gt;', 'bar.txt' or die &quot;open failed: $!&quot;;
    print $out $line; # no translation of bytes
    close $out;
    use open OUT =&gt; ':encoding(UTF-8)';
    use open IN  =&gt; ':encoding(iso-8859-7)';
    use open IO  =&gt; ':locale';
    # IO implicit only for :utf8, :encoding, :locale
    use open ':encoding(UTF-8)';
    use open ':encoding(iso-8859-7)';
    use open ':locale';
    # with :std, also affect global standard handles
    use open ':std', ':encoding(UTF-8)';
    use open ':std', OUT =&gt; ':encoding(cp1252)';
    use open ':std', IO =&gt; ':raw :encoding(UTF-16LE)';
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">Full-fledged support for I/O layers is now implemented provided
    Perl is configured to use PerlIO as its IO system (which has been the
    default since 5.8, and the only supported configuration since 5.16).</p>
<p class="Pp">The <span class="Li">&quot;open&quot;</span> pragma serves as one
    of the interfaces to declare default &quot;layers&quot; (previously known as
    &quot;disciplines&quot;) for all I/O. Any <b>open()</b>, <b>readpipe()</b>
    (aka qx//) and similar operators found within the lexical scope of this
    pragma will use the declared defaults via the
    <span class="Li">&quot;${^OPEN}&quot;</span> variable.</p>
<p class="Pp">Layers are specified with a leading colon by convention. You can
    specify a stack of multiple layers as a space-separated string. See PerlIO
    for more information on the available layers.</p>
<p class="Pp">With the <span class="Li">&quot;IN&quot;</span> subpragma you can
    declare the default layers of input streams, and with the
    <span class="Li">&quot;OUT&quot;</span> subpragma you can declare the
    default layers of output streams. With the
    <span class="Li">&quot;IO&quot;</span> subpragma (may be omitted for
    <span class="Li">&quot;:utf8&quot;</span>,
    <span class="Li">&quot;:locale&quot;</span>, or
    <span class="Li">&quot;:encoding&quot;</span>) you can control both input
    and output streams simultaneously.</p>
<p class="Pp">When <b>open()</b> is given an explicit list of layers (with the
    three-arg syntax), they override the list declared using this pragma.
    <b>open()</b> can also be given a single colon (:) for a layer name, to
    override this pragma and use the default as detailed in &quot;Defaults and
    how to override them&quot; in PerlIO.</p>
<p class="Pp">To translate from and to an arbitrary text encoding, use the
    <span class="Li">&quot;:encoding&quot;</span> layer. The matching of
    encoding names in <span class="Li">&quot;:encoding&quot;</span> is loose:
    case does not matter, and many encodings have several aliases. See
    Encode::Supported for details and the list of supported locales.</p>
<p class="Pp">If you want to set your encoding layers based on your locale
    environment variables, you can use the
    <span class="Li">&quot;:locale&quot;</span> pseudo-layer. For example:</p>
<p class="Pp"></p>
<pre>    $ENV{LANG} = 'ru_RU.KOI8-R';
    # the :locale will probe the locale environment variables like LANG
    use open OUT =&gt; ':locale';
    open(my $out, '&gt;', 'koi8') or die &quot;open failed: $!&quot;;
    print $out chr(0x430); # CYRILLIC SMALL LETTER A = KOI8-R 0xc1
    close $out;
    open(my $in, '&lt;', 'koi8') or die &quot;open failed: $!&quot;;
    printf &quot;%#x\n&quot;, ord(&lt;$in&gt;); # this should print 0xc1
    close $in;
</pre>
<p class="Pp">The logic of <span class="Li">&quot;:locale&quot;</span> is
    described in full in &quot;The <span class="Li">&quot;:locale&quot;</span>
    sub-pragma&quot; in encoding, but in short it is first trying
    nl_langinfo(CODESET) and then guessing from the LC_ALL and LANG locale
    environment variables. <span class="Li">&quot;:locale&quot;</span> also
    implicitly turns on <span class="Li">&quot;:std&quot;</span>.</p>
<p class="Pp"><span class="Li">&quot;:std&quot;</span> is not a layer but an
    additional subpragma. When specified in the import list, it activates an
    additional functionality of pushing the layers selected for input/output
    handles to the standard filehandles (STDIN, STDOUT, STDERR). If the new
    layers and existing layer stack both end with an
    <span class="Li">&quot;:encoding&quot;</span> layer, the existing
    <span class="Li">&quot;:encoding&quot;</span> layer will also be
  removed.</p>
<p class="Pp">For example, if both input and out are chosen to be
    <span class="Li">&quot;:encoding(UTF-8)&quot;</span>, a
    <span class="Li">&quot;:std&quot;</span> will mean that STDIN, STDOUT, and
    STDERR will also have <span class="Li">&quot;:encoding(UTF-8)&quot;</span>
    set. On the other hand, if only output is chosen to be in
    <span class="Li">&quot;:encoding(koi8r)&quot;</span>, a
    <span class="Li">&quot;:std&quot;</span> will cause only the STDOUT and
    STDERR to be in <span class="Li">&quot;koi8r&quot;</span>.</p>
<p class="Pp">The effect of <span class="Li">&quot;:std&quot;</span> is not
    lexical as it modifies the layer stack of the global handles. If you wish to
    apply only this global effect and not the effect on handles that are opened
    in that scope, you can isolate the call to this pragma in its own lexical
    scope.</p>
<p class="Pp"></p>
<pre>    { use open ':std', IO =&gt; ':encoding(UTF-8)' }
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="IMPLEMENTATION_DETAILS"><a class="permalink" href="#IMPLEMENTATION_DETAILS">IMPLEMENTATION
  DETAILS</a></h1>
<p class="Pp">There is a class method in
    <span class="Li">&quot;PerlIO::Layer&quot;</span>
    <span class="Li">&quot;find&quot;</span> which is implemented as XS code. It
    is called by <span class="Li">&quot;import&quot;</span> to validate the
    layers:</p>
<p class="Pp"></p>
<pre>   PerlIO::Layer::-&gt;find(&quot;perlio&quot;)
</pre>
<p class="Pp">The return value (if defined) is a Perl object, of class
    <span class="Li">&quot;PerlIO::Layer&quot;</span> which is created by the C
    code in <i>perlio.c</i>. As yet there is nothing useful you can do with the
    object at the perl level.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">&quot;binmode&quot; in perlfunc, &quot;open&quot; in perlfunc,
    perlunicode, PerlIO, encoding</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2022-02-19</td>
    <td class="foot-os"><a href="..">perl v5.34.1</a></td>
  </tr>
</table>
</body>
</html>
