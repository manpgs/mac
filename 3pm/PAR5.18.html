<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>PAR(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">PAR(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">PAR(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">PAR - Perl Archive Toolkit</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">(If you want to make an executable that contains all module,
    scripts and data files, please consult the pp utility instead. pp used to be
    part of the PAR distribution but is now shipped as part of the PAR::Packer
    distribution instead.)</p>
<p class="Pp">Following examples assume a <i>foo.par</i> file in Zip format.</p>
<p class="Pp">To use <i>Hello.pm</i> from <i>./foo.par</i>:</p>
<p class="Pp"></p>
<pre>
    % perl -MPAR=./foo.par -MHello
    % perl -MPAR=./foo -MHello          # the .par part is optional
</pre>
<p class="Pp">Same thing, but search <i>foo.par</i> in the
    <span class="Li">@INC</span>;</p>
<p class="Pp"></p>
<pre>
    % perl -MPAR -Ifoo.par -MHello
    % perl -MPAR -Ifoo -MHello          # ditto
</pre>
<p class="Pp">Following paths inside the PAR file are searched:</p>
<p class="Pp"></p>
<pre>
    /lib/
    /arch/
    /i386-freebsd/              # i.e. $Config{archname}
    /5.8.0/                     # i.e. $Config{version}
    /5.8.0/i386-freebsd/        # both of the above
    /
</pre>
<p class="Pp">PAR files may also (recursively) contain other PAR files. All
    files under following paths will be considered as PAR files and searched as
    well:</p>
<p class="Pp"></p>
<pre>
    /par/i386-freebsd/          # i.e. $Config{archname}
    /par/5.8.0/                 # i.e. $Config{version}
    /par/5.8.0/i386-freebsd/    # both of the above
    /par/
</pre>
<p class="Pp">Run <i>script/test.pl</i> or <i>test.pl</i> from
  <i>foo.par</i>:</p>
<p class="Pp"></p>
<pre>
    % perl -MPAR foo.par test.pl        # only when $0 ends in '.par'
</pre>
<p class="Pp">However, if the <i>.par</i> archive contains either
    <i>script/main.pl</i> or <i>main.pl</i>, then it is used instead:</p>
<p class="Pp"></p>
<pre>
    % perl -MPAR foo.par test.pl        # runs main.pl; @ARGV is 'test.pl'
</pre>
<p class="Pp">Use in a program:</p>
<p class="Pp"></p>
<pre>
    use PAR 'foo.par';
    use Hello; # reads within foo.par

    # PAR::read_file() returns a file inside any loaded PARs
    my $conf = PAR::read_file('data/MyConfig.yaml');

    # PAR::par_handle() returns an Archive::Zip handle
    my $zip = PAR::par_handle('foo.par')
    my $src = $zip-&gt;memberNamed('lib/Hello.pm')-&gt;contents;
</pre>
<p class="Pp">You can also use wildcard characters:</p>
<p class="Pp"></p>
<pre>
    use PAR '/home/foo/*.par';  # loads all PAR files in that directory
</pre>
<p class="Pp">Since version 0.950, you can also use a different syntax for
    loading <i>.par</i> archives:</p>
<p class="Pp"></p>
<pre>
    use PAR { file =&gt; 'foo.par' }, { file =&gt; 'otherfile.par' };
</pre>
<p class="Pp">Why? Because you can also do this:</p>
<p class="Pp"></p>
<pre>
    use PAR { file =&gt; 'foo.par, fallback =&gt; 1 };
    use Foo::Bar;
</pre>
<p class="Pp">Foo::Bar will be searched in the system libs first and loaded from
    <i>foo.par</i> if it wasn't found!</p>
<p class="Pp"></p>
<pre>
    use PAR { file =&gt; 'foo.par', run =&gt; 'myscript' };
</pre>
<p class="Pp">This will load <i>foo.par</i> as usual and then execute the
    <i>script/myscript</i> file from the archive. Note that your program will
    not regain control. When <i>script/myscript</i> exits, so does your main
    program. To make this more useful, you can defer this to runtime: (otherwise
    equivalent)</p>
<p class="Pp"></p>
<pre>
    require PAR;
    PAR-&gt;import( { file =&gt; 'foo.par', run =&gt; 'myscript' } );
</pre>
<p class="Pp">If you have PAR::Repository::Client installed, you can do
  this:</p>
<p class="Pp"></p>
<pre>
    use PAR { repository =&gt; 'http://foo/bar/' };
    use Module; # not locally installed!
</pre>
<p class="Pp">And PAR will fetch any modules you don't have from the specified
    PAR repository. For details on how this works, have a look at the SEE ALSO
    section below. Instead of an URL or local path, you can construct an
    PAR::Repository::Client object manually and pass that to PAR. If you specify
    the <span class="Li">&quot;install =&gt; 1&quot;</span> option in the
    <span class="Li">&quot;use PAR&quot;</span> line above, the distribution
    containing <span class="Li">&quot;Module&quot;</span> will be permanently
    installed on your system. (<span class="Li">&quot;use PAR { repository =&gt;
    'http://foo/bar', install =&gt; 1 };&quot;</span>)</p>
<p class="Pp">Furthermore, there is an <span class="Li">&quot;upgrade =&gt;
    1&quot;</span> option that checks for upgrades in the repository in addition
    to installing. Please note that an upgraded version of a module is only
    loaded on the next run of your application.</p>
<p class="Pp">Adding the <span class="Li">&quot;dependencies =&gt;
    1&quot;</span> option will enable PAR::Repository::Client's static
    dependency resolution (PAR::Repository::Client 0.23 and up).</p>
<p class="Pp">Finally, you can combine the
    <span class="Li">&quot;run&quot;</span> and
    <span class="Li">&quot;repository&quot;</span> options to run an application
    directly from a repository! (And you can add the
    <span class="Li">&quot;install&quot;</span> option, too.)</p>
<p class="Pp"></p>
<pre>
  use PAR { repository =&gt; 'http://foo/bar/', run =&gt; 'my_app' };
  # Will not reach this point as we executed my_app,
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module lets you use special zip files, called <b>P</b>erl
    <b>Ar</b>chives, as libraries from which Perl modules can be loaded.</p>
<p class="Pp">It supports loading XS modules by overriding <b>DynaLoader</b>
    bootstrapping methods; it writes shared object file to a temporary file at
    the time it is needed.</p>
<p class="Pp">A <i>.par</i> file is mostly a zip of the <i>blib/</i> directory
    after the build process of a CPAN distribution. To generate a <i>.par</i>
    file yourself, all you have to do is compress the modules under <i>arch/</i>
    and <i>lib/</i>, e.g.:</p>
<p class="Pp"></p>
<pre>
    % perl Makefile.PL
    % make
    % cd blib
    % zip -r mymodule.par arch/ lib/
</pre>
<p class="Pp">Afterward, you can just use <i>mymodule.par</i> anywhere in your
    <span class="Li">@INC</span>, use <b>PAR</b>, and it will Just Work. Support
    for generating <i>.par</i> files is going to be in the next (beyond 0.2805)
    release of Module::Build.</p>
<p class="Pp">For convenience, you can set the
    <span class="Li">&quot;PERL5OPT&quot;</span> environment variable to
    <span class="Li">&quot;-MPAR&quot;</span> to enable
    <span class="Li">&quot;PAR&quot;</span> processing globally (the overhead is
    small if not used); setting it to
    <span class="Li">&quot;-MPAR=/path/to/mylib.par&quot;</span> will load a
    specific PAR file. Alternatively, consider using the <i>par.pl</i> utility
    bundled with the PAR::Packer distribution, or using the self-contained
    <i>parl</i> utility which is also distributed with PAR::Packer on machines
    without PAR.pm installed.</p>
<p class="Pp">Note that self-containing scripts and executables created with
    <i>par.pl</i> and <i>pp</i> may also be used as <i>.par</i> archives:</p>
<p class="Pp"></p>
<pre>
    % pp -o packed.exe source.pl        # generate packed.exe (see PAR::Packer)
    % perl -MPAR=packed.exe other.pl    # this also works
    % perl -MPAR -Ipacked.exe other.pl  # ditto
</pre>
<p class="Pp">Please see &quot;SYNOPSIS&quot; for most typical use cases.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h1>
<p class="Pp">Settings in <i>META.yml</i> packed inside the PAR file may affect
    PAR's operation. For example, <i>pp</i> provides the
    <span class="Li">&quot;-C&quot;</span>
    (<span class="Li">&quot;--clean&quot;</span>) option to control the default
    behavior of temporary file creation.</p>
<p class="Pp">Currently, <i>pp</i>-generated PAR files may attach four
    PAR-specific attributes in <i>META.yml</i>:</p>
<p class="Pp"></p>
<pre>
    par:
      clean: 0          # default value of PAR_CLEAN
      signature: ''     # key ID of the SIGNATURE file
      verbatim: 0       # was packed prerequisite's PODs preserved?
      version: x.xx     # PAR.pm version that generated this PAR
</pre>
<p class="Pp">User-defined environment variables, like <i>PAR_GLOBAL_CLEAN</i>,
    always overrides the ones set in <i>META.yml</i>. The algorithm for
    generating caching/temporary directory is as follows:</p>
<ul class="Bl-bullet">
  <li>If <i>PAR_GLOBAL_TEMP</i> is specified, use it as the cache directory for
      extracted libraries, and do not clean it up after execution.</li>
  <li>If <i>PAR_GLOBAL_TEMP</i> is not set, but <i>PAR_CLEAN</i> is specified,
      set <i>PAR_GLOBAL_TEMP</i> to
      <span class="Li">&quot;</span><i>TEMP</i><span class="Li">/par-</span><i>USER</i><span class="Li">/temp-</span><i>PID</i><span class="Li">/&quot;</span>,
      cleaning it after execution.</li>
  <li>If both are not set, use
      <span class="Li">&quot;</span><i>TEMP</i><span class="Li">/par-</span><i>USER</i><span class="Li">/cache-</span><i>HASH</i><span class="Li">/&quot;</span>
      as the <i>PAR_GLOBAL_TEMP</i>, reusing any existing files inside.</li>
</ul>
<p class="Pp">Here is a description of the variables the previous paths.</p>
<ul class="Bl-bullet">
  <li><i>TEMP</i> is a temporary directory, which can be set via
      <span class="Li">$ENV{PAR_GLOBAL_TMPDIR}</span>,
      <span class="Li">$ENV{TMPDIR}</span>,
      <span class="Li">$ENV{TEMPDIR}</span>, <span class="Li">$ENV{TEMP}</span>
      or <span class="Li">$ENV{TMP}</span>, in that order of priority. If none
      of those are set, <i>C:\TEMP</i>, <i>/tmp</i> are checked. If neither of
      them exists, <i>.</i> is used.</li>
  <li><i>USER</i> is the user name, or SYSTEM if none can be found. On Win32,
      this is <span class="Li">$Win32::LoginName</span>. On Unix, this is
      <span class="Li">$ENV{USERNAME}</span> or
      <span class="Li">$ENV{USER}</span>.</li>
  <li><i>PID</i> is the process ID. Forked children use the parent's PID.</li>
  <li><i>HASH</i> is a crypto-hash of the entire par file or executable,
      calculated at creation time. This value can be overloaded with
      <span class="Li">&quot;pp&quot;</span>'s --tempdir parameter.</li>
</ul>
<p class="Pp">By default, PAR strips POD sections from bundled modules. In case
    that causes trouble, you can turn this off by setting the environment
    variable <span class="Li">&quot;PAR_VERBATIM&quot;</span> to
    <span class="Li">1</span>.</p>
<section class="Ss">
<h2 class="Ss" id="import_options"><a class="permalink" href="#import_options">import
  options</a></h2>
<p class="Pp">When you &quot;use PAR {...}&quot; or call PAR-&gt;import({...}),
    the following options are available.</p>
<p class="Pp"></p>
<pre>
  PAR-&gt;import({ file =&gt; 'foo.par' });
  # or
  PAR-&gt;import({ repository =&gt; 'http://foo/bar/' });
</pre>
<dl class="Bl-tag">
  <dt id="file"><a class="permalink" href="#file">file</a></dt>
  <dd>The par filename.
    <p class="Pp">You must pass <i>one</i> option of either 'file' or
        'repository'.</p>
  </dd>
  <dt id="repository"><a class="permalink" href="#repository">repository</a></dt>
  <dd>A par repository (exclusive of file)</dd>
  <dt id="fallback"><a class="permalink" href="#fallback">fallback</a></dt>
  <dd>Search the system <span class="Li">@INC</span> before the par.
    <p class="Pp">Off by default for loading <i>.par</i> files via
        <span class="Li">&quot;file =&quot;</span> ...&gt;. On by default for
        PAR repositories.</p>
    <p class="Pp">To prefer loading modules from a repository over the locally
        installed modules, you can load the repository as follows:</p>
    <p class="Pp"></p>
    <pre>
  use PAR { repository =&gt; 'http://foo/bar/', fallback =&gt; 0 };
    </pre>
  </dd>
  <dt id="run"><a class="permalink" href="#run">run</a></dt>
  <dd>The name of a script to run in the par. Exits when done.</dd>
  <dt id="no_shlib_unpack"><a class="permalink" href="#no_shlib_unpack">no_shlib_unpack</a></dt>
  <dd>Skip unpacking bundled dynamic libraries from shlib/$archname. The client
      may have them installed, or you may wish to cache them yourself. In either
      case, they must end up in the standard install location (such as
      /usr/local/lib/) or in <span class="Li">$ENV</span>{PAR_TEMP}
      <i>before</i> you require the module which needs them. If they are not
      accessible before you require the dependent module, perl will die with a
      message such as &quot;cannot open shared object file...&quot;</dd>
</dl>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">The PAR homepage at &lt;http://par.perl.org&gt;.</p>
<p class="Pp">PAR::Tutorial, PAR::FAQ (For a more current FAQ, refer to the
    homepage.)</p>
<p class="Pp">The PAR::Packer distribution which contains the packaging
    utilities: par.pl, parl, pp.</p>
<p class="Pp">PAR::Dist for details on PAR distributions.</p>
<p class="Pp">PAR::Repository::Client for details on accessing PAR repositories.
    PAR::Repository for details on how to set up such a repository.</p>
<p class="Pp">Archive::Zip, &quot;require&quot; in perlfunc</p>
<p class="Pp">ex::lib::zip, Acme::use::strict::with::pride</p>
<p class="Pp">Steffen Mueller has detailed slides on using PAR for application
    deployment at &lt;http://steffen-mueller.net/talks/appdeployment/&gt;.</p>
<p class="Pp">PAR supports the prefork module. It declares various run-time
    dependencies so you can use the prefork module to get streamlined processes
    in a forking environment.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="ACKNOWLEDGMENTS"><a class="permalink" href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a></h1>
<p class="Pp">Nicholas Clark for pointing out the mad source filter hook within
    the (also mad) coderef <span class="Li">@INC</span> hook, as well as (even
    madder) tricks one can play with PerlIO to avoid source filtering.</p>
<p class="Pp">Ton Hospel for convincing me to ditch the
    <span class="Li">&quot;Filter::Simple&quot;</span> implementation.</p>
<p class="Pp">Uri Guttman for suggesting
    <span class="Li">&quot;read_file&quot;</span> and
    <span class="Li">&quot;par_handle&quot;</span> interfaces.</p>
<p class="Pp">Antti Lankila for making me implement the self-contained
    executable options via <span class="Li">&quot;par.pl -O&quot;</span>.</p>
<p class="Pp">See the <i>AUTHORS</i> file in the distribution for a list of
    people who have sent helpful patches, ideas or comments.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">Audrey Tang &lt;cpan@audreyt.org&gt;</p>
<p class="Pp">Steffen Mueller &lt;smueller@cpan.org&gt;</p>
<p class="Pp">&lt;http://par.perl.org/&gt; is the official PAR website. You can
    write to the mailing list at &lt;par@perl.org&gt;, or send an empty mail to
    &lt;par-subscribe@perl.org&gt; to participate in the discussion.</p>
<p class="Pp">Please submit bug reports to &lt;bug-par@rt.cpan.org&gt;. If you
    need support, however, joining the &lt;par@perl.org&gt; mailing list is
    preferred.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">Copyright 2002-2010 by Audrey Tang &lt;cpan@audreyt.org&gt;.
    Copyright 2005-2010 by Steffen Mueller &lt;smueller@cpan.org&gt;</p>
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
<p class="Pp">See &lt;http://www.perl.com/perl/misc/Artistic.html&gt;</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2012-10-22</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
