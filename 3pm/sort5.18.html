<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>sort(3pm)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">sort(3pm)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">sort(3pm)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">sort - perl pragma to control sort() behaviour</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
    use sort 'stable';          # guarantee stability
    use sort '_quicksort';      # use a quicksort algorithm
    use sort '_mergesort';      # use a mergesort algorithm
    use sort 'defaults';        # revert to default behavior
    no  sort 'stable';          # stability not important

    use sort '_qsort';          # alias for quicksort

    my $current;
    BEGIN {
        $current = sort::current();     # identify prevailing algorithm
    }
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">With the <span class="Li">&quot;sort&quot;</span> pragma you can
    control the behaviour of the builtin
    <span class="Li">&quot;sort()&quot;</span> function.</p>
<p class="Pp">In Perl versions 5.6 and earlier the quicksort algorithm was used
    to implement <span class="Li">&quot;sort()&quot;</span>, but in Perl 5.8 a
    mergesort algorithm was also made available, mainly to guarantee worst case
    O(N log N) behaviour: the worst case of quicksort is O(N**2). In Perl 5.8
    and later, quicksort defends against quadratic behaviour by shuffling large
    arrays before sorting.</p>
<p class="Pp">A stable sort means that for records that compare equal, the
    original input ordering is preserved. Mergesort is stable, quicksort is not.
    Stability will matter only if elements that compare equal can be
    distinguished in some other way. That means that simple numerical and
    lexical sorts do not profit from stability, since equal elements are
    indistinguishable. However, with a comparison such as</p>
<p class="Pp"></p>
<pre>
   { substr($a, 0, 3) cmp substr($b, 0, 3) }
</pre>
<p class="Pp">stability might matter because elements that compare equal on the
    first 3 characters may be distinguished based on subsequent characters. In
    Perl 5.8 and later, quicksort can be stabilized, but doing so will add
    overhead, so it should only be done if it matters.</p>
<p class="Pp">The best algorithm depends on many things. On average, mergesort
    does fewer comparisons than quicksort, so it may be better when complicated
    comparison routines are used. Mergesort also takes advantage of pre-existing
    order, so it would be favored for using
    <span class="Li">&quot;sort()&quot;</span> to merge several sorted arrays.
    On the other hand, quicksort is often faster for small arrays, and on arrays
    of a few distinct values, repeated many times. You can force the choice of
    algorithm with this pragma, but this feels heavy-handed, so the subpragmas
    beginning with a <span class="Li">&quot;_&quot;</span> may not persist
    beyond Perl 5.8. The default algorithm is mergesort, which will be stable
    even if you do not explicitly demand it. But the stability of the default
    sort is a side-effect that could change in later versions. If stability is
    important, be sure to say so with a</p>
<p class="Pp"></p>
<pre>
  use sort 'stable';
</pre>
<p class="Pp">The <span class="Li">&quot;no sort&quot;</span> pragma doesn't
    <i>forbid</i> what follows, it just leaves the choice open. Thus, after</p>
<p class="Pp"></p>
<pre>
  no sort qw(_mergesort stable);
</pre>
<p class="Pp">a mergesort, which happens to be stable, will be employed anyway.
    Note that</p>
<p class="Pp"></p>
<pre>
  no sort &quot;_quicksort&quot;;
  no sort &quot;_mergesort&quot;;
</pre>
<p class="Pp">have exactly the same effect, leaving the choice of sort algorithm
    open.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp">As of Perl 5.10, this pragma is lexically scoped and takes effect
    at compile time. In earlier versions its effect was global and took effect
    at run-time; the documentation suggested using
    <span class="Li">&quot;eval()&quot;</span> to change the behaviour:</p>
<p class="Pp"></p>
<pre>
  { eval 'use sort qw(defaults _quicksort)'; # force quicksort
    eval 'no sort &quot;stable&quot;';      # stability not wanted
    print sort::current . &quot;\n&quot;;
    @a = sort @b;
    eval 'use sort &quot;defaults&quot;';   # clean up, for others
  }
  { eval 'use sort qw(defaults stable)';     # force stability
    print sort::current . &quot;\n&quot;;
    @c = sort @d;
    eval 'use sort &quot;defaults&quot;';   # clean up, for others
  }
</pre>
<p class="Pp">Such code no longer has the desired effect, for two reasons.
    Firstly, the use of <span class="Li">&quot;eval()&quot;</span> means that
    the sorting algorithm is not changed until runtime, by which time it's too
    late to have any effect. Secondly,
    <span class="Li">&quot;sort::current&quot;</span> is also called at
    run-time, when in fact the compile-time value of
    <span class="Li">&quot;sort::current&quot;</span> is the one that
  matters.</p>
<p class="Pp">So now this code would be written:</p>
<p class="Pp"></p>
<pre>
  { use sort qw(defaults _quicksort); # force quicksort
    no sort &quot;stable&quot;;      # stability not wanted
    my $current;
    BEGIN { $current = sort::current; }
    print &quot;$current\n&quot;;
    @a = sort @b;
    # Pragmas go out of scope at the end of the block
  }
  { use sort qw(defaults stable);     # force stability
    my $current;
    BEGIN { $current = sort::current; }
    print &quot;$current\n&quot;;
    @c = sort @d;
  }
</pre>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2014-01-31</td>
    <td class="foot-os">perl v5.18.4</td>
  </tr>
</table>
</body>
</html>
