<!DOCTYPE html>
<html lang="en">
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>YAML::PP::Schema::Perl(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">YAML::PP::Schema::Perl(3)</td>
    <td class="head-vol"><a href=".">User Contributed Perl Documentation</a></td>
    <td class="head-rtitle">YAML::PP::Schema::Perl(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">YAML::PP::Schema::Perl - Schema for serializing perl objects and
    special types</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>    use YAML::PP;
    # This can be dangerous when loading untrusted YAML!
    my $yp = YAML::PP-&gt;new( schema =&gt; [qw/ + Perl /] );
    # or
    my $yp = YAML::PP-&gt;new( schema =&gt; [qw/ Core Perl /] );
    my $yaml = $yp-&gt;dump_string(sub { return 23 });
    # loading code references
    # This is very dangerous when loading untrusted YAML!!
    my $yp = YAML::PP-&gt;new( schema =&gt; [qw/ + Perl +loadcode /] );
    my $code = $yp-&gt;load_string(&lt;&lt;'EOM');
    --- !perl/code |
        {
            use 5.010;
            my ($name) = @_;
            say &quot;Hello $name!&quot;;
        }
    EOM
    $code-&gt;(&quot;Ingy&quot;);
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This schema allows you to load and dump perl objects and special
    types.</p>
<p class="Pp">Please note that loading objects of arbitrary classes can be
    dangerous in Perl. You have to load the modules yourself, but if an
    exploitable module is loaded and an object is created, its
    <span class="Li">&quot;DESTROY&quot;</span> method will be called when the
    object falls out of scope. File::Temp is an example that can be exploitable
    and might remove arbitrary files.</p>
<p class="Pp">Dumping code references is on by default, but not loading (because
    that is easily exploitable since it's using string
    <span class="Li">&quot;eval&quot;</span>).</p>
<section class="Ss">
<h2 class="Ss" id="Tag_Styles"><a class="permalink" href="#Tag_Styles">Tag
  Styles</a></h2>
<p class="Pp">You can define the style of tags you want to support:</p>
<p class="Pp"></p>
<pre>    my $yp_perl_two_one = YAML::PP-&gt;new(
        schema =&gt; [qw/ + Perl tags=!!perl+!perl /],
    );
</pre>
<dl class="Bl-tag">
  <dt>&quot;!perl&quot; (default)</dt>
  <dd>Only <span class="Li">&quot;!perl/type&quot;</span> tags are
    supported.</dd>
  <dt>&quot;!!perl&quot;</dt>
  <dd>Only <span class="Li">&quot;!!perl/type&quot;</span> tags are
    supported.</dd>
  <dt>&quot;!perl+!!perl&quot;</dt>
  <dd>Both <span class="Li">&quot;!perl/type&quot;</span> and
      <span class="Li">&quot;!!perl/tag&quot;</span> are supported when loading.
      When dumping, <span class="Li">&quot;!perl/type&quot;</span> is used.</dd>
  <dt>&quot;!!perl+!perl&quot;</dt>
  <dd>Both <span class="Li">&quot;!perl/type&quot;</span> and
      <span class="Li">&quot;!!perl/tag&quot;</span> are supported when loading.
      When dumping, <span class="Li">&quot;!!perl/type&quot;</span> is
    used.</dd>
</dl>
<p class="Pp">YAML.pm, YAML::Syck and YAML::XS are using
    <span class="Li">&quot;!!perl/type&quot;</span> when dumping.</p>
<p class="Pp">YAML.pm and YAML::Syck are supporting both
    <span class="Li">&quot;!perl/type&quot;</span> and
    <span class="Li">&quot;!!perl/type&quot;</span> when loading. YAML::XS
    currently only supports the latter.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Allow_only_certain_classes"><a class="permalink" href="#Allow_only_certain_classes">Allow
  only certain classes</a></h2>
<p class="Pp">Since v0.017</p>
<p class="Pp">Blessing arbitrary objects can be dangerous. Maybe you want to
    allow blessing only specific classes and ignore others. For this you have to
    instantiate a Perl Schema object first and use the
    <span class="Li">&quot;classes&quot;</span> option.</p>
<p class="Pp">Currently it only allows a list of strings:</p>
<p class="Pp"></p>
<pre>    my $perl = YAML::PP::Schema::Perl-&gt;new(
        classes =&gt; ['Foo', 'Bar'],
    );
    my $yp = YAML::PP::Perl-&gt;new(
        schema =&gt; [qw/ + /, $perl],
    );
</pre>
<p class="Pp">Allowed classes will be loaded and dumped as usual. The others
    will be ignored.</p>
<p class="Pp">If you want to allow no objects at all, pass an empty array
  ref.</p>
</section>
<section class="Ss">
<h2 class="Ss">EXAMPLES</h2>
<p class="Pp">This is a list of the currently supported types and how they are
    dumped into YAML:</p>
<dl class="Bl-tag">
  <dt id="array"><a class="permalink" href="#array">array</a></dt>
  <dd>
    <pre>        # Code
        [
            qw/ one two three four /
        ]
        # YAML
        ---
        - one
        - two
        - three
        - four
    </pre>
  </dd>
  <dt id="array_blessed"><a class="permalink" href="#array_blessed">array_blessed</a></dt>
  <dd>
    <pre>        # Code
        bless [
            qw/ one two three four /
        ], &quot;Just::An::Arrayref&quot;
        # YAML
        --- !perl/array:Just::An::Arrayref
        - one
        - two
        - three
        - four
    </pre>
  </dd>
  <dt id="circular"><a class="permalink" href="#circular">circular</a></dt>
  <dd>
    <pre>        # Code
        my $circle = bless [ 1, 2 ], 'Circle';
        push @$circle, $circle;
        $circle;
        # YAML
        --- &amp;1 !perl/array:Circle
        - 1
        - 2
        - *1
    </pre>
  </dd>
  <dt id="coderef"><a class="permalink" href="#coderef">coderef</a></dt>
  <dd>
    <pre>        # Code
        sub {
            my (%args) = @_;
            return $args{x} + $args{y};
        }
        # YAML
        --- !perl/code |-
          {
              use warnings;
              use strict;
              (my(%args) = @_);
              (return ($args{'x'} + $args{'y'}));
          }
    </pre>
  </dd>
  <dt id="coderef_blessed"><a class="permalink" href="#coderef_blessed">coderef_blessed</a></dt>
  <dd>
    <pre>        # Code
        bless sub {
            my (%args) = @_;
            return $args{x} - $args{y};
        }, &quot;I::Am::Code&quot;
        # YAML
        --- !perl/code:I::Am::Code |-
          {
              use warnings;
              use strict;
              (my(%args) = @_);
              (return ($args{'x'} - $args{'y'}));
          }
    </pre>
  </dd>
  <dt id="hash"><a class="permalink" href="#hash">hash</a></dt>
  <dd>
    <pre>        # Code
        {
            U =&gt; 2,
            B =&gt; 52,
        }
        # YAML
        ---
        B: 52
        U: 2
    </pre>
  </dd>
  <dt id="hash_blessed"><a class="permalink" href="#hash_blessed">hash_blessed</a></dt>
  <dd>
    <pre>        # Code
        bless {
            U =&gt; 2,
            B =&gt; 52,
        }, 'A::Very::Exclusive::Class'
        # YAML
        --- !perl/hash:A::Very::Exclusive::Class
        B: 52
        U: 2
    </pre>
  </dd>
  <dt id="refref"><a class="permalink" href="#refref">refref</a></dt>
  <dd>
    <pre>        # Code
        my $ref = { a =&gt; 'hash' };
        my $refref = \$ref;
        $refref;
        # YAML
        --- !perl/ref
        =:
          a: hash
    </pre>
  </dd>
  <dt id="refref_blessed"><a class="permalink" href="#refref_blessed">refref_blessed</a></dt>
  <dd>
    <pre>        # Code
        my $ref = { a =&gt; 'hash' };
        my $refref = bless \$ref, 'Foo';
        $refref;
        # YAML
        --- !perl/ref:Foo
        =:
          a: hash
    </pre>
  </dd>
  <dt id="regexp"><a class="permalink" href="#regexp">regexp</a></dt>
  <dd>
    <pre>        # Code
        my $string = 'unblessed';
        qr{$string}
        # YAML
        --- !perl/regexp unblessed
    </pre>
  </dd>
  <dt id="regexp_blessed"><a class="permalink" href="#regexp_blessed">regexp_blessed</a></dt>
  <dd>
    <pre>        # Code
        my $string = 'blessed';
        bless qr{$string}, &quot;Foo&quot;
        # YAML
        --- !perl/regexp:Foo blessed
    </pre>
  </dd>
  <dt id="scalarref"><a class="permalink" href="#scalarref">scalarref</a></dt>
  <dd>
    <pre>        # Code
        my $scalar = &quot;some string&quot;;
        my $scalarref = \$scalar;
        $scalarref;
        # YAML
        --- !perl/scalar
        =: some string
    </pre>
  </dd>
  <dt id="scalarref_blessed"><a class="permalink" href="#scalarref_blessed">scalarref_blessed</a></dt>
  <dd>
    <pre>        # Code
        my $scalar = &quot;some other string&quot;;
        my $scalarref = bless \$scalar, 'Foo';
        $scalarref;
        # YAML
        --- !perl/scalar:Foo
        =: some other string
    </pre>
  </dd>
</dl>
</section>
<section class="Ss">
<h2 class="Ss">METHODS</h2>
<dl class="Bl-tag">
  <dt id="new"><a class="permalink" href="#new">new</a></dt>
  <dd>
    <pre>    my $perl = YAML::PP::Schema::Perl-&gt;new(
        tags =&gt; &quot;!perl&quot;,
        classes =&gt; ['MyClass'],
        loadcode =&gt; 1,
    );
    </pre>
    <p class="Pp">The constructor recognizes the following options:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="tags"><a class="permalink" href="#tags">tags</a></dt>
  <dd>Default: '<span class="Li">&quot;!perl&quot;</span>'
    <p class="Pp">See &quot;Tag Styles&quot;</p>
  </dd>
  <dt id="classes"><a class="permalink" href="#classes">classes</a></dt>
  <dd>Default: <span class="Li">&quot;undef&quot;</span>
    <p class="Pp">Since: v0.017</p>
    <p class="Pp">Accepts an array ref of class names</p>
  </dd>
  <dt id="loadcode"><a class="permalink" href="#loadcode">loadcode</a></dt>
  <dd>Default: 0</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt id="register"><a class="permalink" href="#register">register</a></dt>
  <dd>A class method called by YAML::PP::Schema</dd>
  <dt id="construct_ref,"><a class="permalink" href="#construct_ref,">construct_ref,
    represent_ref</a></dt>
  <dd>Perl variables of the type <span class="Li">&quot;REF&quot;</span> are
      represented in yaml like this:
    <p class="Pp"></p>
    <pre>    --- !perl/ref
    =:
      a: 1
    </pre>
    <p class="Pp"><span class="Li">&quot;construct_ref&quot;</span> returns the
        perl data:</p>
    <p class="Pp"></p>
    <pre>    my $data = YAML::PP::Schema::Perl-&gt;construct_ref([ '=', { some =&gt; 'data' } );
    my $data = \{ a =&gt; 1 };
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_ref&quot;</span> turns a
        <span class="Li">&quot;REF&quot;</span> variable into a YAML
      mapping:</p>
    <p class="Pp"></p>
    <pre>    my $data = YAML::PP::Schema::Perl-&gt;represent_ref(\{ a =&gt; 1 });
    my $data = { '=' =&gt; { a =&gt; 1 } };
    </pre>
  </dd>
  <dt id="construct_scalar,"><a class="permalink" href="#construct_scalar,">construct_scalar,
    represent_scalar</a></dt>
  <dd>Perl variables of the type <span class="Li">&quot;SCALAR&quot;</span> are
      represented in yaml like this:
    <p class="Pp"></p>
    <pre>    --- !perl/scalar
    =: string
    </pre>
    <p class="Pp"><span class="Li">&quot;construct_scalar&quot;</span> returns
        the perl data:</p>
    <p class="Pp"></p>
    <pre>    my $data = YAML::PP::Schema::Perl-&gt;construct_ref([ '=', 'string' );
    my $data = \'string';
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_scalar&quot;</span> turns a
        <span class="Li">&quot;SCALAR&quot;</span> variable into a YAML
      mapping:</p>
    <p class="Pp"></p>
    <pre>    my $data = YAML::PP::Schema::Perl-&gt;represent_scalar(\'string');
    my $data = { '=' =&gt; 'string' };
    </pre>
  </dd>
  <dt id="construct_regex,"><a class="permalink" href="#construct_regex,">construct_regex,
    represent_regex</a></dt>
  <dd><span class="Li">&quot;construct_regex&quot;</span> returns a
      <span class="Li">&quot;qr{}&quot;</span> object from the YAML string:
    <p class="Pp"></p>
    <pre>    my $qr = YAML::PP::Schema::Perl-&gt;construct_regex('foo.*');
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_regex&quot;</span> returns a
        string representing the regex object:</p>
    <p class="Pp"></p>
    <pre>    my $string = YAML::PP::Schema::Perl-&gt;represent_regex(qr{...});
    </pre>
  </dd>
  <dt id="evaluate_code,"><a class="permalink" href="#evaluate_code,">evaluate_code,
    represent_code</a></dt>
  <dd><span class="Li">&quot;evaluate_code&quot;</span> returns a code reference
      from a string. The string must start with a
      <span class="Li">&quot;{&quot;</span> and end with a
      <span class="Li">&quot;}&quot;</span>.
    <p class="Pp"></p>
    <pre>    my $code = YAML::PP::Schema::Perl-&gt;evaluate_code('{ return 23 }');
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_code&quot;</span> returns a
        string representation of the code reference with the help of
      B::Deparse:</p>
    <p class="Pp"></p>
    <pre>    my $string = YAML::PP::Schema::Perl-&gt;represent_code(sub { return 23 });
    </pre>
  </dd>
  <dt id="construct_glob,"><a class="permalink" href="#construct_glob,">construct_glob,
    represent_glob</a></dt>
  <dd><span class="Li">&quot;construct_glob&quot;</span> returns a glob from a
      hash.
    <p class="Pp"></p>
    <pre>    my $glob = YAML::PP::Schema::Perl-&gt;construct_glob($hash);
    </pre>
    <p class="Pp"><span class="Li">&quot;represent_glob&quot;</span> returns a
        hash representation of the glob.</p>
    <p class="Pp"></p>
    <pre>    my $hash = YAML::PP::Schema::Perl-&gt;represent_glob($glob);
    </pre>
  </dd>
  <dt id="object"><a class="permalink" href="#object">object</a></dt>
  <dd>Does the same as <span class="Li">&quot;bless&quot;</span>:
    <p class="Pp"></p>
    <pre>    my $object = YAML::PP::Schema::Perl-&gt;object($data, $class);
    </pre>
  </dd>
</dl>
</section>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-09-10</td>
    <td class="foot-os"><a href="..">perl v5.34.0</a></td>
  </tr>
</table>
</body>
</html>
