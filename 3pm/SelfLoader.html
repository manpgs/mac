<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>SelfLoader(3pm)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">SelfLoader(3pm)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">SelfLoader(3pm)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">SelfLoader - load functions only on demand</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
    package FOOBAR;
    use SelfLoader;

    ... (initializing code)

    __DATA__
    sub {....
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This module tells its users that functions in the FOOBAR package
    are to be autoloaded from after the
    <span class="Li">&quot;__DATA__&quot;</span> token. See also
    &quot;Autoloading&quot; in perlsub.</p>
<section class="Ss">
<h2 class="Ss" id="The__"><a class="permalink" href="#The__">The __DATA__
  token</a></h2>
<p class="Pp">The <span class="Li">&quot;__DATA__&quot;</span> token tells the
    perl compiler that the perl code for compilation is finished. Everything
    after the <span class="Li">&quot;__DATA__&quot;</span> token is available
    for reading via the filehandle FOOBAR::DATA, where FOOBAR is the name of the
    current package when the <span class="Li">&quot;__DATA__&quot;</span> token
    is reached. This works just the same as
    <span class="Li">&quot;__END__&quot;</span> does in package 'main', but for
    other modules data after <span class="Li">&quot;__END__&quot;</span> is not
    automatically retrievable, whereas data after
    <span class="Li">&quot;__DATA__&quot;</span> is. The
    <span class="Li">&quot;__DATA__&quot;</span> token is not recognized in
    versions of perl prior to 5.001m.</p>
<p class="Pp">Note that it is possible to have
    <span class="Li">&quot;__DATA__&quot;</span> tokens in the same package in
    multiple files, and that the last
    <span class="Li">&quot;__DATA__&quot;</span> token in a given package that
    is encountered by the compiler is the one accessible by the filehandle. This
    also applies to <span class="Li">&quot;__END__&quot;</span> and main, i.e.
    if the 'main' program has an <span class="Li">&quot;__END__&quot;</span>,
    but a module 'require'd (_not_ 'use'd) by that program has a 'package main;'
    declaration followed by an '<span class="Li">&quot;__DATA__&quot;</span>',
    then the <span class="Li">&quot;DATA&quot;</span> filehandle is set to
    access the data after the <span class="Li">&quot;__DATA__&quot;</span> in
    the module, _not_ the data after the
    <span class="Li">&quot;__END__&quot;</span> token in the 'main' program,
    since the compiler encounters the 'require'd file later.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="SelfLoader_autoloading"><a class="permalink" href="#SelfLoader_autoloading">SelfLoader
  autoloading</a></h2>
<p class="Pp">The <b>SelfLoader</b> works by the user placing the
    <span class="Li">&quot;__DATA__&quot;</span> token <i>after</i> perl code
    which needs to be compiled and run at 'require' time, but <i>before</i>
    subroutine declarations that can be loaded in later - usually because they
    may never be called.</p>
<p class="Pp">The <b>SelfLoader</b> will read from the FOOBAR::DATA filehandle
    to load in the data after <span class="Li">&quot;__DATA__&quot;</span>, and
    load in any subroutine when it is called. The costs are the one-time parsing
    of the data after <span class="Li">&quot;__DATA__&quot;</span>, and a load
    delay for the _first_ call of any autoloaded function. The benefits
    (hopefully) are a speeded up compilation phase, with no need to load
    functions which are never used.</p>
<p class="Pp">The <b>SelfLoader</b> will stop reading from
    <span class="Li">&quot;__DATA__&quot;</span> if it encounters the
    <span class="Li">&quot;__END__&quot;</span> token - just as you would
    expect. If the <span class="Li">&quot;__END__&quot;</span> token is present,
    and is followed by the token DATA, then the <b>SelfLoader</b> leaves the
    FOOBAR::DATA filehandle open on the line after that token.</p>
<p class="Pp">The <b>SelfLoader</b> exports the
    <span class="Li">&quot;AUTOLOAD&quot;</span> subroutine to the package using
    the <b>SelfLoader</b>, and this loads the called subroutine when it is first
    called.</p>
<p class="Pp">There is no advantage to putting subroutines which will _always_
    be called after the <span class="Li">&quot;__DATA__&quot;</span> token.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Autoloading_and_package_lexicals"><a class="permalink" href="#Autoloading_and_package_lexicals">Autoloading
  and package lexicals</a></h2>
<p class="Pp">A 'my <span class="Li">$pack_lexical</span>' statement makes the
    variable <span class="Li">$pack_lexical</span> local _only_ to the file up
    to the <span class="Li">&quot;__DATA__&quot;</span> token. Subroutines
    declared elsewhere _cannot_ see these types of variables, just as if you
    declared subroutines in the package but in another file, they cannot see
    these variables.</p>
<p class="Pp">So specifically, autoloaded functions cannot see package lexicals
    (this applies to both the <b>SelfLoader</b> and the Autoloader). The
    <span class="Li">&quot;vars&quot;</span> pragma provides an alternative to
    defining package-level globals that will be visible to autoloaded routines.
    See the documentation on <b>vars</b> in the pragma section of perlmod.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="SelfLoader_and_AutoLoader"><a class="permalink" href="#SelfLoader_and_AutoLoader">SelfLoader
  and AutoLoader</a></h2>
<p class="Pp">The <b>SelfLoader</b> can replace the AutoLoader - just change
    'use AutoLoader' to 'use SelfLoader' (though note that the <b>SelfLoader</b>
    exports the AUTOLOAD function - but if you have your own AUTOLOAD and are
    using the AutoLoader too, you probably know what you're doing), and the
    <span class="Li">&quot;__END__&quot;</span> token to
    <span class="Li">&quot;__DATA__&quot;</span>. You will need perl version
    5.001m or later to use this (version 5.001 with all patches up to patch
  m).</p>
<p class="Pp">There is no need to inherit from the <b>SelfLoader</b>.</p>
<p class="Pp">The <b>SelfLoader</b> works similarly to the AutoLoader, but picks
    up the subs from after the <span class="Li">&quot;__DATA__&quot;</span>
    instead of in the 'lib/auto' directory. There is a maintenance gain in not
    needing to run AutoSplit on the module at installation, and a runtime gain
    in not needing to keep opening and closing files to load subs. There is a
    runtime loss in needing to parse the code after the
    <span class="Li">&quot;__DATA__&quot;</span>. Details of the
    <b>AutoLoader</b> and another view of these distinctions can be found in
    that module's documentation.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_"><a class="permalink" href="#_">__DATA__, __END__, and the
  FOOBAR::DATA filehandle.</a></h2>
<p class="Pp">This section is only relevant if you want to use the
    <span class="Li">&quot;FOOBAR::DATA&quot;</span> together with the
    <b>SelfLoader</b>.</p>
<p class="Pp">Data after the <span class="Li">&quot;__DATA__&quot;</span> token
    in a module is read using the FOOBAR::DATA filehandle.
    <span class="Li">&quot;__END__&quot;</span> can still be used to denote the
    end of the <span class="Li">&quot;__DATA__&quot;</span> section if followed
    by the token DATA - this is supported by the <b>SelfLoader</b>. The
    <span class="Li">&quot;FOOBAR::DATA&quot;</span> filehandle is left open if
    an <span class="Li">&quot;__END__&quot;</span> followed by a DATA is found,
    with the filehandle positioned at the start of the line after the
    <span class="Li">&quot;__END__&quot;</span> token. If no
    <span class="Li">&quot;__END__&quot;</span> token is present, or an
    <span class="Li">&quot;__END__&quot;</span> token with no DATA token on the
    same line, then the filehandle is closed.</p>
<p class="Pp">The <b>SelfLoader</b> reads from wherever the current position of
    the <span class="Li">&quot;FOOBAR::DATA&quot;</span> filehandle is, until
    the EOF or <span class="Li">&quot;__END__&quot;</span>. This means that if
    you want to use that filehandle (and ONLY if you want to), you should
  either</p>
<p class="Pp">1. Put all your subroutine declarations immediately after the
    <span class="Li">&quot;__DATA__&quot;</span> token and put your own data
    after those declarations, using the
    <span class="Li">&quot;__END__&quot;</span> token to mark the end of
    subroutine declarations. You must also ensure that the <b>SelfLoader</b>
    reads first by calling 'SelfLoader-&gt;<b>load_stubs()</b>;', or by using a
    function which is selfloaded;</p>
<p class="Pp">or</p>
<p class="Pp">2. You should read the
    <span class="Li">&quot;FOOBAR::DATA&quot;</span> filehandle first, leaving
    the handle open and positioned at the first line of subroutine
  declarations.</p>
<p class="Pp">You could conceivably do both.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Classes_and_inherited_methods."><a class="permalink" href="#Classes_and_inherited_methods.">Classes
  and inherited methods.</a></h2>
<p class="Pp">For modules which are not classes, this section is not relevant.
    This section is only relevant if you have methods which could be
  inherited.</p>
<p class="Pp">A subroutine stub (or forward declaration) looks like</p>
<p class="Pp"></p>
<pre>
  sub stub;
</pre>
<p class="Pp">i.e. it is a subroutine declaration without the body of the
    subroutine. For modules which are not classes, there is no real need for
    stubs as far as autoloading is concerned.</p>
<p class="Pp">For modules which ARE classes, and need to handle inherited
    methods, stubs are needed to ensure that the method inheritance mechanism
    works properly. You can load the stubs into the module at 'require' time, by
    adding the statement 'SelfLoader-&gt;<b>load_stubs()</b>;' to the module to
    do this.</p>
<p class="Pp">The alternative is to put the stubs in before the
    <span class="Li">&quot;__DATA__&quot;</span> token BEFORE releasing the
    module, and for this purpose the
    <span class="Li">&quot;Devel::SelfStubber&quot;</span> module is available.
    However this does require the extra step of ensuring that the stubs are in
    the module. If this is done I strongly recommend that this is done BEFORE
    releasing the module - it should NOT be done at install time in general.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="Multiple_packages_and_fully_qualified_subroutine_names"><a class="permalink" href="#Multiple_packages_and_fully_qualified_subroutine_names">Multiple
  packages and fully qualified subroutine names</a></h1>
<p class="Pp">Subroutines in multiple packages within the same file are
    supported - but you should note that this requires exporting the
    <span class="Li">&quot;SelfLoader::AUTOLOAD&quot;</span> to every package
    which requires it. This is done automatically by the <b>SelfLoader</b> when
    it first loads the subs into the cache, but you should really specify it in
    the initialization before the <span class="Li">&quot;__DATA__&quot;</span>
    by putting a 'use SelfLoader' statement in each package.</p>
<p class="Pp">Fully qualified subroutine names are also supported. For
  example,</p>
<p class="Pp"></p>
<pre>
   __DATA__
   sub foo::bar {23}
   package baz;
   sub dob {32}
</pre>
<p class="Pp">will all be loaded correctly by the <b>SelfLoader</b>, and the
    <b>SelfLoader</b> will ensure that the packages 'foo' and 'baz' correctly
    have the <b>SelfLoader</b> <span class="Li">&quot;AUTOLOAD&quot;</span>
    method when the data after <span class="Li">&quot;__DATA__&quot;</span> is
    first parsed.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp"><span class="Li">&quot;SelfLoader&quot;</span> is maintained by
    the perl5-porters. Please direct any questions to the canonical mailing
    list. Anything that is applicable to the CPAN release can be sent to its
    maintainer, though.</p>
<p class="Pp">Author and Maintainer: The Perl5-Porters
    &lt;perl5-porters@perl.org&gt;</p>
<p class="Pp">Maintainer of the CPAN release: Steffen Mueller
    &lt;smueller@cpan.org&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">This package has been part of the perl core since the first
    release of perl5. It has been released separately to CPAN so older
    installations can benefit from bug fixes.</p>
<p class="Pp">This package has the same copyright and license as the perl
  core:</p>
<p class="Pp">Copyright (C) 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,
    2001, 2002, 2003, 2004, 2005, 2006 by Larry Wall and others</p>
<p class="Pp">All rights reserved.</p>
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the terms of either:</p>
<dl class="Bl-tag">
  <dt id="a)"><a class="permalink" href="#a)">a)</a></dt>
  <dd>the GNU General Public License as published by the Free Software
      Foundation; either version 1, or (at your option) any later version,
    or</dd>
  <dt id="b)"><a class="permalink" href="#b)">b)</a></dt>
  <dd>the &quot;Artistic License&quot; which comes with this Kit.</dd>
</dl>
<p class="Pp">This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See either the GNU
    General Public License or the Artistic License for more details.</p>
<p class="Pp">You should have received a copy of the Artistic License with this
    Kit, in the file named &quot;Artistic&quot;. If not, I'll be glad to provide
    one.</p>
<p class="Pp">You should also have received a copy of the GNU General Public
    License along with this program in the file named &quot;Copying&quot;. If
    not, write to the Free Software Foundation, Inc., 51 Franklin St, Fifth
    Floor, Boston, MA 02110-1301, USA or visit their web page on the internet at
    http://www.gnu.org/copyleft/gpl.html.</p>
<p class="Pp">For those of you that choose to use the GNU General Public
    License, my interpretation of the GNU General Public License is that no Perl
    script falls under the terms of the GPL unless you explicitly put said
    script under the terms of the GPL yourself. Furthermore, any object code
    linked with perl does not automatically fall under the terms of the GPL,
    provided such object code only adds definitions of subroutines and
    variables, and does not otherwise impair the resulting interpreter from
    executing any standard Perl script. I consider linking in C subroutines in
    this manner to be the moral equivalent of defining subroutines in the Perl
    language itself. You may sell such an object file as proprietary provided
    that you provide or offer to provide the Perl source, as specified by the
    GNU General Public License. (This is merely an alternate way of specifying
    input to the program.) You may also sell a binary produced by the dumping of
    a running Perl script that belongs to you, provided that you provide or
    offer to provide the Perl source as specified by the GPL. (The fact that a
    Perl interpreter and your code are in the same binary file is, in this case,
    a form of mere aggregation.) This is my interpretation of the GPL. If you
    still have concerns or difficulties understanding my intent, feel free to
    contact me. Of course, the Artistic License spells all this out for your
    protection, so you may prefer to use that.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-10-21</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
