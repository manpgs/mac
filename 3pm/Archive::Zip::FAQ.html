<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>Archive::Zip::FAQ(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Archive::Zip::FAQ(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">Archive::Zip::FAQ(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Archive::Zip::FAQ - Answers to a few frequently asked questions
    about Archive::Zip</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">It seems that I keep answering the same questions over and over
    again. I assume that this is because my documentation is deficient, rather
    than that people don't read the documentation.</p>
<p class="Pp">So this FAQ is an attempt to cut down on the number of personal
    answers I have to give. At least I can now say &quot;You <i>did</i> read the
    FAQ, right?&quot;.</p>
<p class="Pp">The questions are not in any particular order. The answers assume
    the current version of Archive::Zip; some of the answers depend on newly
    added/fixed functionality.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Install_problems_on_RedHat_8_or_9_with_Perl_5.8.0"><a class="permalink" href="#Install_problems_on_RedHat_8_or_9_with_Perl_5.8.0">Install
  problems on RedHat 8 or 9 with Perl 5.8.0</a></h1>
<p class="Pp"><b>Q:</b> Archive::Zip won't install on my RedHat 9 system! It's
    broke!</p>
<p class="Pp"><b>A:</b> This has become something of a FAQ. Basically, RedHat
    broke some versions of Perl by setting LANG to UTF8. They apparently have a
    fixed version out as an update.</p>
<p class="Pp">You might try running CPAN or creating your Makefile after
    exporting the LANG environment variable as</p>
<p class="Pp"><span class="Li">&quot;LANG=C&quot;</span></p>
<p class="Pp">&lt;https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=87682&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Why_is_my_zip_file_so_big?"><a class="permalink" href="#Why_is_my_zip_file_so_big?">Why
  is my zip file so big?</a></h1>
<p class="Pp"><b>Q:</b> My zip file is actually bigger than what I stored in it!
    Why?</p>
<p class="Pp"><b>A:</b> Some things to make sure of:</p>
<dl class="Bl-tag">
  <dt id="Make"><a class="permalink" href="#Make">Make sure that you are
    requesting COMPRESSION_DEFLATED if you are storing strings.</a></dt>
  <dd><span class="Li">$member</span>-&gt;desiredCompressionMethod(
      COMPRESSION_DEFLATED );</dd>
  <dt id="Don't"><a class="permalink" href="#Don't">Don't make lots of little
    files if you can help it.</a></dt>
  <dd>Since zip computes the compression tables for each member, small members
      without much entropy won't compress well. Instead, if you've got lots of
      repeated strings in your data, try to combine them into one big
    member.</dd>
  <dt id="Make~2"><a class="permalink" href="#Make~2">Make sure that you are
    requesting COMPRESSION_STORED if you are storing things that are already
    compressed.</a></dt>
  <dd>If you're storing a .zip, .jpg, .mp3, or other compressed file in a zip,
      then don't compress them again. They'll get bigger.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="Sample_code?"><a class="permalink" href="#Sample_code?">Sample
  code?</a></h1>
<p class="Pp"><b>Q:</b> Can you send me code to do (whatever)?</p>
<p class="Pp"><b>A:</b> Have you looked in the
    <span class="Li">&quot;examples/&quot;</span> directory yet? It
  contains:</p>
<dl class="Bl-tag">
  <dt id="examples/calcSizes.pl"><a class="permalink" href="#examples/calcSizes.pl">examples/calcSizes.pl
    -- How to find out how big a Zip file will be before writing it</a></dt>
  <dd></dd>
  <dt id="examples/copy.pl"><a class="permalink" href="#examples/copy.pl">examples/copy.pl
    -- Copies one Zip file to another</a></dt>
  <dd></dd>
  <dt id="examples/extract.pl"><a class="permalink" href="#examples/extract.pl">examples/extract.pl
    -- extract file(s) from a Zip</a></dt>
  <dd></dd>
  <dt id="examples/mailZip.pl"><a class="permalink" href="#examples/mailZip.pl">examples/mailZip.pl
    -- make and mail a zip file</a></dt>
  <dd></dd>
  <dt id="examples/mfh.pl"><a class="permalink" href="#examples/mfh.pl">examples/mfh.pl
    -- demo for use of MockFileHandle</a></dt>
  <dd></dd>
  <dt id="examples/readScalar.pl"><a class="permalink" href="#examples/readScalar.pl">examples/readScalar.pl
    -- shows how to use IO::Scalar as the source of a Zip read</a></dt>
  <dd></dd>
  <dt id="examples/selfex.pl"><a class="permalink" href="#examples/selfex.pl">examples/selfex.pl
    -- a brief example of a self-extracting Zip</a></dt>
  <dd></dd>
  <dt id="examples/unzipAll.pl"><a class="permalink" href="#examples/unzipAll.pl">examples/unzipAll.pl
    -- uses Archive::Zip::Tree to unzip an entire Zip</a></dt>
  <dd></dd>
  <dt id="examples/updateZip.pl"><a class="permalink" href="#examples/updateZip.pl">examples/updateZip.pl
    -- shows how to read/modify/write a Zip</a></dt>
  <dd></dd>
  <dt id="examples/updateTree.pl"><a class="permalink" href="#examples/updateTree.pl">examples/updateTree.pl
    -- shows how to update a Zip in place</a></dt>
  <dd></dd>
  <dt id="examples/writeScalar.pl"><a class="permalink" href="#examples/writeScalar.pl">examples/writeScalar.pl
    -- shows how to use IO::Scalar as the destination of a Zip write</a></dt>
  <dd></dd>
  <dt id="examples/writeScalar2.pl"><a class="permalink" href="#examples/writeScalar2.pl">examples/writeScalar2.pl
    -- shows how to use IO::String as the destination of a Zip write</a></dt>
  <dd></dd>
  <dt id="examples/zip.pl"><a class="permalink" href="#examples/zip.pl">examples/zip.pl
    -- Constructs a Zip file</a></dt>
  <dd></dd>
  <dt id="examples/zipcheck.pl"><a class="permalink" href="#examples/zipcheck.pl">examples/zipcheck.pl
    -- One way to check a Zip file for validity</a></dt>
  <dd></dd>
  <dt id="examples/zipinfo.pl"><a class="permalink" href="#examples/zipinfo.pl">examples/zipinfo.pl
    -- Prints out information about a Zip archive file</a></dt>
  <dd></dd>
  <dt id="examples/zipGrep.pl"><a class="permalink" href="#examples/zipGrep.pl">examples/zipGrep.pl
    -- Searches for text in Zip files</a></dt>
  <dd></dd>
  <dt id="examples/ziptest.pl"><a class="permalink" href="#examples/ziptest.pl">examples/ziptest.pl
    -- Lists a Zip file and checks member CRCs</a></dt>
  <dd></dd>
  <dt id="examples/ziprecent.pl"><a class="permalink" href="#examples/ziprecent.pl">examples/ziprecent.pl
    -- Puts recent files into a zipfile</a></dt>
  <dd></dd>
  <dt id="examples/ziptest.pl~2"><a class="permalink" href="#examples/ziptest.pl~2">examples/ziptest.pl
    -- Another way to check a Zip file for validity</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="Can't_Read/modify/write_same_Zip_file"><a class="permalink" href="#Can't_Read/modify/write_same_Zip_file">Can't
  Read/modify/write same Zip file</a></h1>
<p class="Pp"><b>Q:</b> Why can't I open a Zip file, add a member, and write it
    back? I get an error message when I try.</p>
<p class="Pp"><b>A:</b> Because Archive::Zip doesn't (and can't, generally) read
    file contents into memory, the original Zip file is required to stay around
    until the writing of the new file is completed.</p>
<p class="Pp">The best way to do this is to write the Zip to a temporary file
    and then rename the temporary file to have the old name (possibly after
    deleting the old one).</p>
<p class="Pp">Archive::Zip v1.02 added the archive methods
    <span class="Li">&quot;overwrite()&quot;</span> and
    <span class="Li">&quot;overwriteAs()&quot;</span> to do this simply and
    carefully.</p>
<p class="Pp">See <span class="Li">&quot;examples/updateZip.pl&quot;</span> for
    an example of this technique.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="File_creation_time_not_set"><a class="permalink" href="#File_creation_time_not_set">File
  creation time not set</a></h1>
<p class="Pp"><b>Q:</b> Upon extracting files, I see that their modification
    (and access) times are set to the time in the Zip archive. However, their
    creation time is not set to the same time. Why?</p>
<p class="Pp"><b>A:</b> Mostly because Perl doesn't give cross-platform access
    to <i>creation time</i>. Indeed, many systems (like Unix) don't support such
    a concept. However, if yours does, you can easily set it. Get the
    modification time from the member using
    <span class="Li">&quot;lastModTime()&quot;</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Can't_use_Archive::Zip_on_gzip_files"><a class="permalink" href="#Can't_use_Archive::Zip_on_gzip_files">Can't
  use Archive::Zip on gzip files</a></h1>
<p class="Pp"><b>Q:</b> Can I use Archive::Zip to extract Unix gzip files?</p>
<p class="Pp"><b>A:</b> No.</p>
<p class="Pp">There is a distinction between Unix gzip files, and Zip archives
    that also can use the gzip compression.</p>
<p class="Pp">Depending on the format of the gzip file, you can use
    Compress::Raw::Zlib, or Archive::Tar to decompress it (and de-archive it in
    the case of Tar files).</p>
<p class="Pp">You can unzip PKZIP/WinZip/etc/ archives using Archive::Zip
    (that's what it's for) as long as any compressed members are compressed
    using Deflate compression.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Add_a_directory/tree_to_a_Zip"><a class="permalink" href="#Add_a_directory/tree_to_a_Zip">Add
  a directory/tree to a Zip</a></h1>
<p class="Pp"><b>Q:</b> How can I add a directory (or tree) full of files to a
    Zip?</p>
<p class="Pp"><b>A:</b> You can use the Archive::Zip::addTree*() methods:</p>
<p class="Pp"></p>
<pre>   use Archive::Zip;
   my $zip = Archive::Zip-&gt;new();
   # add all readable files and directories below . as xyz/*
   $zip-&gt;addTree( '.', 'xyz' );
   # add all readable plain files below /abc as def/*
   $zip-&gt;addTree( '/abc', 'def', sub { -f &amp;&amp; -r } );
   # add all .c files below /tmp as stuff/*
   $zip-&gt;addTreeMatching( '/tmp', 'stuff', '\.c$' );
   # add all .o files below /tmp as stuff/* if they aren't writable
   $zip-&gt;addTreeMatching( '/tmp', 'stuff', '\.o$', sub { ! -w } );
   # add all .so files below /tmp that are smaller than 200 bytes as stuff/*
   $zip-&gt;addTreeMatching( '/tmp', 'stuff', '\.o$', sub { -s &lt; 200 } );
   # and write them into a file
   $zip-&gt;writeToFileNamed('xxx.zip');
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="Extract_a_directory/tree"><a class="permalink" href="#Extract_a_directory/tree">Extract
  a directory/tree</a></h1>
<p class="Pp"><b>Q:</b> How can I extract some (or all) files from a Zip into a
    different directory?</p>
<p class="Pp"><b>A:</b> You can use the <b>Archive::Zip::extractTree()</b>
    method: ??? ||</p>
<p class="Pp"></p>
<pre>   # now extract the same files into /tmpx
   $zip-&gt;extractTree( 'stuff', '/tmpx' );
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="Update_a_directory/tree"><a class="permalink" href="#Update_a_directory/tree">Update
  a directory/tree</a></h1>
<p class="Pp"><b>Q:</b> How can I update a Zip from a directory tree, adding or
    replacing only the newer files?</p>
<p class="Pp"><b>A:</b> You can use the <b>Archive::Zip::updateTree()</b> method
    that was added in version 1.09.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Zip_times_might_be_off_by_1_second"><a class="permalink" href="#Zip_times_might_be_off_by_1_second">Zip
  times might be off by 1 second</a></h1>
<p class="Pp"><b>Q:</b> It bothers me greatly that my file times are wrong by
    one second about half the time. Why don't you do something about it?</p>
<p class="Pp"><b>A:</b> Get over it. This is a result of the Zip format storing
    times in DOS format, which has a resolution of only two seconds.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Zip_times_don't_include_time_zone_information"><a class="permalink" href="#Zip_times_don't_include_time_zone_information">Zip
  times don't include time zone information</a></h1>
<p class="Pp"><b>Q:</b> My file times don't respect time zones. What gives?</p>
<p class="Pp"><b>A:</b> If this is important to you, please submit patches to
    read the various Extra Fields that encode times with time zones. I'm just
    using the DOS Date/Time, which doesn't have a time zone.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="How_do_I_make_a_self-extracting_Zip"><a class="permalink" href="#How_do_I_make_a_self-extracting_Zip">How
  do I make a self-extracting Zip</a></h1>
<p class="Pp"><b>Q:</b> I want to make a self-extracting Zip file. Can I do
    this?</p>
<p class="Pp"><b>A:</b> Yes. You can write a self-extracting archive stub (that
    is, a version of unzip) to the output filehandle that you pass to
    <b>writeToFileHandle()</b>. See examples/selfex.pl for how to write a
    self-extracting archive.</p>
<p class="Pp">However, you should understand that this will only work on one
    kind of platform (the one for which the stub was compiled).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="How_can_I_deal_with_Zips_with_prepended_garbage_(i.e._from_Sircam)"><a class="permalink" href="#How_can_I_deal_with_Zips_with_prepended_garbage_(i.e._from_Sircam)">How
  can I deal with Zips with prepended garbage (i.e. from Sircam)</a></h1>
<p class="Pp"><b>Q:</b> How can I tell if a Zip has been damaged by adding
    garbage to the beginning or inside the file?</p>
<p class="Pp"><b>A:</b> I added code for this for the Amavis virus scanner. You
    can query archives for their 'eocdOffset' property, which should be 0:</p>
<p class="Pp"></p>
<pre>  if ($zip-&gt;eocdOffset &gt; 0)
    { warn($zip-&gt;eocdOffset . &quot; bytes of garbage at beginning or within Zip&quot;) }
</pre>
<p class="Pp">When members are extracted, this offset will be used to adjust the
    start of the member if necessary.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Can't_extract_Shrunk_files"><a class="permalink" href="#Can't_extract_Shrunk_files">Can't
  extract Shrunk files</a></h1>
<p class="Pp"><b>Q:</b> I'm trying to extract a file out of a Zip produced by
    PKZIP, and keep getting this error message:</p>
<p class="Pp"></p>
<pre>  error: Unsupported compression combination: read 6, write 0
</pre>
<p class="Pp"><b>A:</b> You can't uncompress this archive member. Archive::Zip
    only supports uncompressed members, and compressed members that are
    compressed using the compression supported by Compress::Raw::Zlib. That
    means only Deflated and Stored members.</p>
<p class="Pp">Your file is compressed using the Shrink format, which is not
    supported by Compress::Raw::Zlib.</p>
<p class="Pp">You could, perhaps, use a command-line UnZip program (like the
    Info-Zip one) to extract this.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Can't_do_decryption"><a class="permalink" href="#Can't_do_decryption">Can't
  do decryption</a></h1>
<p class="Pp"><b>Q:</b> How do I decrypt encrypted Zip members?</p>
<p class="Pp"><b>A:</b> With some other program or library. Archive::Zip doesn't
    support decryption, and probably never will (unless <i>you</i> write
  it).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="How_to_test_file_integrity?"><a class="permalink" href="#How_to_test_file_integrity?">How
  to test file integrity?</a></h1>
<p class="Pp"><b>Q:</b> How can Archive::Zip can test the validity of a Zip
    file?</p>
<p class="Pp"><b>A:</b> If you try to decompress the file, the gzip streams will
    report errors if you have garbage. Most of the time.</p>
<p class="Pp">If you try to open the file and a central directory structure
    can't be found, an error will be reported.</p>
<p class="Pp">When a file is being read, if we can't find a proper PK..
    signature in the right places we report a format error.</p>
<p class="Pp">If there is added garbage at the beginning of a Zip file (as
    inserted by some viruses), you can find out about it, but Archive::Zip will
    ignore it, and you can still use the archive. When it gets written back out
    the added stuff will be gone.</p>
<p class="Pp">There are two ready-to-use utilities in the examples directory
    that can be used to test file integrity, or that you can use as examples for
    your own code:</p>
<dl class="Bl-tag">
  <dt id="examples/zipcheck.pl~2"><a class="permalink" href="#examples/zipcheck.pl~2">examples/zipcheck.pl
    shows how to use an attempted extraction to test a file.</a></dt>
  <dd></dd>
  <dt id="examples/ziptest.pl~3"><a class="permalink" href="#examples/ziptest.pl~3">examples/ziptest.pl
    shows how to test CRCs in a file.</a></dt>
  <dd></dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="Duplicate_files_in_Zip?"><a class="permalink" href="#Duplicate_files_in_Zip?">Duplicate
  files in Zip?</a></h1>
<p class="Pp"><b>Q:</b> Archive::Zip let me put the same file in my Zip twice!
    Why don't you prevent this?</p>
<p class="Pp"><b>A:</b> As far as I can tell, this is not disallowed by the Zip
    spec. If you think it's a bad idea, check for it yourself:</p>
<p class="Pp"></p>
<pre>  $zip-&gt;addFile($someFile, $someName) unless $zip-&gt;memberNamed($someName);
</pre>
<p class="Pp">I can even imagine cases where this might be useful (for instance,
    multiple versions of files).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="File_ownership/permissions/ACLS/etc"><a class="permalink" href="#File_ownership/permissions/ACLS/etc">File
  ownership/permissions/ACLS/etc</a></h1>
<p class="Pp"><b>Q:</b> Why doesn't Archive::Zip deal with file ownership, ACLs,
    etc.?</p>
<p class="Pp"><b>A:</b> There is no standard way to represent these in the Zip
    file format. If you want to send me code to properly handle the various
    extra fields that have been used to represent these through the years, I'll
    look at it.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="I_can't_compile_but_ActiveState_only_has_an_old_version_of_Archive::Zip"><a class="permalink" href="#I_can't_compile_but_ActiveState_only_has_an_old_version_of_Archive::Zip">I
  can't compile but ActiveState only has an old version of Archive::Zip</a></h1>
<p class="Pp"><b>Q:</b> I've only installed modules using ActiveState's PPM
    program and repository. But they have a much older version of Archive::Zip
    than is in CPAN. Will you send me a newer PPM?</p>
<p class="Pp"><b>A:</b> Probably not, unless I get lots of extra time. But
    there's no reason you can't install the version from CPAN. Archive::Zip is
    pure Perl, so all you need is NMAKE, which you can get for free from
    Microsoft (see the FAQ in the ActiveState documentation for details on how
    to install CPAN modules).</p>
</section>
<section class="Sh">
<h1 class="Sh" id="My_JPEGs_(or_MP3's)_don't_compress_when_I_put_them_into_Zips!"><a class="permalink" href="#My_JPEGs_(or_MP3's)_don't_compress_when_I_put_them_into_Zips!">My
  JPEGs (or MP3's) don't compress when I put them into Zips!</a></h1>
<p class="Pp"><b>Q:</b> How come my JPEGs and MP3's don't compress much when I
    put them into Zips?</p>
<p class="Pp"><b>A:</b> Because they're already compressed.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Under_Windows,_things_lock_up/get_damaged"><a class="permalink" href="#Under_Windows,_things_lock_up/get_damaged">Under
  Windows, things lock up/get damaged</a></h1>
<p class="Pp"><b>Q:</b> I'm using Windows. When I try to use Archive::Zip, my
    machine locks up/makes funny sounds/displays a BSOD/corrupts data. How can I
    fix this?</p>
<p class="Pp"><b>A:</b> First, try the newest version of Compress::Raw::Zlib. I
    know of Windows-related problems prior to v1.14 of that library.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Zip_contents_in_a_scalar"><a class="permalink" href="#Zip_contents_in_a_scalar">Zip
  contents in a scalar</a></h1>
<p class="Pp"><b>Q:</b> I want to read a Zip file from (or write one to) a
    scalar variable instead of a file. How can I do this?</p>
<p class="Pp"><b>A:</b> Use <span class="Li">&quot;IO::String&quot;</span> and
    the <span class="Li">&quot;readFromFileHandle()&quot;</span> and
    <span class="Li">&quot;writeToFileHandle()&quot;</span> methods. See
    <span class="Li">&quot;examples/readScalar.pl&quot;</span> and
    <span class="Li">&quot;examples/writeScalar.pl&quot;</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="Reading_from_streams"><a class="permalink" href="#Reading_from_streams">Reading
  from streams</a></h1>
<p class="Pp"><b>Q:</b> How do I read from a stream (like for the Info-Zip
    <span class="Li">&quot;funzip&quot;</span> program)?</p>
<p class="Pp"><b>A:</b> This is not currently supported, though writing to a
    stream is.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-03-12</td>
    <td class="foot-os">perl v5.34.0</td>
  </tr>
</table>
</body>
</html>
