<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>DBIx::Class::Storage::DBI(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">DBIx::Class::Storage::DBI(3)</td>
    <td class="head-vol">User Contributed Perl Documentation</td>
    <td class="head-rtitle">DBIx::Class::Storage::DBI(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">DBIx::Class::Storage::DBI - DBI storage handler</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>  my $schema = MySchema-&gt;connect('dbi:SQLite:my.db');
  $schema-&gt;storage-&gt;debug(1);
  my @stuff = $schema-&gt;storage-&gt;dbh_do(
    sub {
      my ($storage, $dbh, @args) = @_;
      $dbh-&gt;do(&quot;DROP TABLE authors&quot;);
    },
    @column_list
  );
  $schema-&gt;resultset('Book')-&gt;search({
     written_on =&gt; $schema-&gt;storage-&gt;datetime_parser-&gt;format_datetime(DateTime-&gt;now)
  });
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This class represents the connection to an RDBMS via DBI. See
    DBIx::Class::Storage for general information. This pod only documents
    DBI-specific methods and behaviors.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="METHODS"><a class="permalink" href="#METHODS">METHODS</a></h1>
<section class="Ss">
<h2 class="Ss" id="connect_info"><a class="permalink" href="#connect_info">connect_info</a></h2>
<p class="Pp">This method is normally called by &quot;connection&quot; in
    DBIx::Class::Schema, which encapsulates its argument list in an arrayref
    before passing them here.</p>
<p class="Pp">The argument list may contain:</p>
<ul class="Bl-bullet">
  <li>The same 4-element argument set one would normally pass to
      &quot;connect&quot; in DBI, optionally followed by extra attributes
      recognized by DBIx::Class:
    <p class="Pp"></p>
    <pre>  $connect_info_args = [ $dsn, $user, $password, \%dbi_attributes?, \%extra_attributes? ];
    </pre>
  </li>
  <li>A single code reference which returns a connected DBI database handle
      optionally followed by extra attributes recognized by DBIx::Class:
    <p class="Pp"></p>
    <pre>  $connect_info_args = [ sub { DBI-&gt;connect (...) }, \%extra_attributes? ];
    </pre>
  </li>
  <li>A single hashref with all the attributes and the dsn/user/password mixed
      together:
    <p class="Pp"></p>
    <pre>  $connect_info_args = [{
    dsn =&gt; $dsn,
    user =&gt; $user,
    password =&gt; $pass,
    %dbi_attributes,
    %extra_attributes,
  }];
  $connect_info_args = [{
    dbh_maker =&gt; sub { DBI-&gt;connect (...) },
    %dbi_attributes,
    %extra_attributes,
  }];
    </pre>
    <p class="Pp">This is particularly useful for Catalyst based applications,
        allowing the following config (Config::General style):</p>
    <p class="Pp"></p>
    <pre>  &lt;Model::DB&gt;
    schema_class   App::DB
    &lt;connect_info&gt;
      dsn          dbi:mysql:database=test
      user         testuser
      password     TestPass
      AutoCommit   1
    &lt;/connect_info&gt;
  &lt;/Model::DB&gt;
    </pre>
    <p class="Pp">The
        <span class="Li">&quot;dsn&quot;</span>/<span class="Li">&quot;user&quot;</span>/<span class="Li">&quot;password&quot;</span>
        combination can be substituted by the
        <span class="Li">&quot;dbh_maker&quot;</span> key whose value is a
        coderef that returns a connected DBI database handle</p>
  </li>
</ul>
<p class="Pp">Please note that the DBI docs recommend that you always explicitly
    set <span class="Li">&quot;AutoCommit&quot;</span> to either <i>0</i> or
    <i>1</i>. DBIx::Class further recommends that it be set to <i>1</i>, and
    that you perform transactions via our &quot;txn_do&quot; in
    DBIx::Class::Schema method. DBIx::Class will set it to <i>1</i> if you do
    not do explicitly set it to zero. This is the default for most DBDs. See
    &quot;DBIx::Class and AutoCommit&quot; for details.</p>
<p class="Pp"><i>DBIx::Class specific connection attributes</i></p>
<p class="Pp">In addition to the standard DBI connection attributes, DBIx::Class
    recognizes the following connection options. These options can be mixed in
    with your other DBI connection attributes, or placed in a separate hashref
    (<span class="Li">&quot;\%extra_attributes&quot;</span>) as shown above.</p>
<p class="Pp">Every time <span class="Li">&quot;connect_info&quot;</span> is
    invoked, any previous settings for these options will be cleared before
    setting the new ones, regardless of whether any options are specified in the
    new <span class="Li">&quot;connect_info&quot;</span>.</p>
<dl class="Bl-tag">
  <dt id="on_connect_do"><a class="permalink" href="#on_connect_do">on_connect_do</a></dt>
  <dd>Specifies things to do immediately after connecting or re-connecting to
      the database. Its value may contain:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="a"><a class="permalink" href="#a">a scalar</a></dt>
  <dd>This contains one SQL statement to execute.</dd>
  <dt id="an"><a class="permalink" href="#an">an array reference</a></dt>
  <dd>This contains SQL statements to execute in order. Each element contains a
      string or a code reference that returns a string.</dd>
  <dt id="a~2"><a class="permalink" href="#a~2">a code reference</a></dt>
  <dd>This contains some code to execute. Unlike code references within an array
      reference, its return value is ignored.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt id="on_disconnect_do"><a class="permalink" href="#on_disconnect_do">on_disconnect_do</a></dt>
  <dd>Takes arguments in the same form as &quot;on_connect_do&quot; and executes
      them immediately before disconnecting from the database.
    <p class="Pp">Note, this only runs if you explicitly call
        &quot;disconnect&quot; on the storage object.</p>
  </dd>
  <dt id="on_connect_call"><a class="permalink" href="#on_connect_call">on_connect_call</a></dt>
  <dd>A more generalized form of &quot;on_connect_do&quot; that calls the
      specified <span class="Li">&quot;connect_call_METHOD&quot;</span> methods
      in your storage driver.
    <p class="Pp"></p>
    <pre>  on_connect_do =&gt; 'select 1'
    </pre>
    <p class="Pp">is equivalent to:</p>
    <p class="Pp"></p>
    <pre>  on_connect_call =&gt; [ [ do_sql =&gt; 'select 1' ] ]
    </pre>
    <p class="Pp">Its values may contain:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="a~3"><a class="permalink" href="#a~3">a scalar</a></dt>
  <dd>Will call the <span class="Li">&quot;connect_call_METHOD&quot;</span>
      method.</dd>
  <dt id="a~4"><a class="permalink" href="#a~4">a code reference</a></dt>
  <dd>Will execute <span class="Li">&quot;$code-&gt;($storage)&quot;</span></dd>
  <dt id="an~2"><a class="permalink" href="#an~2">an array reference</a></dt>
  <dd>Each value can be a method name or code reference.</dd>
  <dt id="an~3"><a class="permalink" href="#an~3">an array of arrays</a></dt>
  <dd>For each array, the first item is taken to be the
      <span class="Li">&quot;connect_call_&quot;</span> method name or code
      reference, and the rest are parameters to it.</dd>
</dl>
</div>
<div class="Bd-indent">
<p class="Pp">Some predefined storage methods you may use:</p>
<dl class="Bl-tag">
  <dt id="do_sql"><a class="permalink" href="#do_sql">do_sql</a></dt>
  <dd>Executes a SQL string or a code reference that returns a SQL string. This
      is what &quot;on_connect_do&quot; and &quot;on_disconnect_do&quot; use.
    <p class="Pp">It can take:</p>
  </dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="a~5"><a class="permalink" href="#a~5">a scalar</a></dt>
  <dd>Will execute the scalar as SQL.</dd>
  <dt id="an~4"><a class="permalink" href="#an~4">an arrayref</a></dt>
  <dd>Taken to be arguments to &quot;do&quot; in DBI, the SQL string optionally
      followed by the attributes hashref and bind values.</dd>
  <dt id="a~6"><a class="permalink" href="#a~6">a code reference</a></dt>
  <dd>Will execute <span class="Li">&quot;$code-&gt;($storage)&quot;</span> and
      execute the return array refs as above.</dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt id="datetime_setup"><a class="permalink" href="#datetime_setup">datetime_setup</a></dt>
  <dd>Execute any statements necessary to initialize the database session to
      return and accept datetime/timestamp values used with
      DBIx::Class::InflateColumn::DateTime.
    <p class="Pp">Only necessary for some databases, see your specific storage
        driver for implementation details.</p>
  </dd>
</dl>
</div>
<div class="Bd-indent"></div>
<dl class="Bl-tag">
  <dt id="on_disconnect_call"><a class="permalink" href="#on_disconnect_call">on_disconnect_call</a></dt>
  <dd>Takes arguments in the same form as &quot;on_connect_call&quot; and
      executes them immediately before disconnecting from the database.
    <p class="Pp">Calls the
        <span class="Li">&quot;disconnect_call_METHOD&quot;</span> methods as
        opposed to the <span class="Li">&quot;connect_call_METHOD&quot;</span>
        methods called by &quot;on_connect_call&quot;.</p>
    <p class="Pp">Note, this only runs if you explicitly call
        &quot;disconnect&quot; on the storage object.</p>
  </dd>
  <dt id="disable_sth_caching"><a class="permalink" href="#disable_sth_caching">disable_sth_caching</a></dt>
  <dd>If set to a true value, this option will disable the caching of statement
      handles via &quot;prepare_cached&quot; in DBI.</dd>
  <dt id="limit_dialect"><a class="permalink" href="#limit_dialect">limit_dialect</a></dt>
  <dd>Sets a specific SQL::Abstract::Limit-style limit dialect, overriding the
      default &quot;sql_limit_dialect&quot; setting of the storage (if any). For
      a list of available limit dialects see
      DBIx::Class::SQLMaker::LimitDialects.</dd>
  <dt id="quote_names"><a class="permalink" href="#quote_names">quote_names</a></dt>
  <dd>When true automatically sets &quot;quote_char&quot; and
      &quot;name_sep&quot; to the characters appropriate for your particular
      RDBMS. This option is preferred over specifying &quot;quote_char&quot;
      directly.</dd>
  <dt id="quote_char"><a class="permalink" href="#quote_char">quote_char</a></dt>
  <dd>Specifies what characters to use to quote table and column names.
    <p class="Pp"><span class="Li">&quot;quote_char&quot;</span> expects either
        a single character, in which case is it is placed on either side of the
        table/column name, or an arrayref of length 2 in which case the
        table/column name is placed between the elements.</p>
    <p class="Pp">For example under MySQL you should use
        <span class="Li">&quot;quote_char =&gt; '`'&quot;</span>, and for SQL
        Server you should use <span class="Li">&quot;quote_char =&gt; [qw/[
        ]/]&quot;</span>.</p>
  </dd>
  <dt id="name_sep"><a class="permalink" href="#name_sep">name_sep</a></dt>
  <dd>This parameter is only useful in conjunction with
      <span class="Li">&quot;quote_char&quot;</span>, and is used to specify the
      character that separates elements (schemas, tables, columns) from each
      other. If unspecified it defaults to the most commonly used
      <span class="Li">&quot;.&quot;</span>.</dd>
  <dt id="unsafe"><a class="permalink" href="#unsafe">unsafe</a></dt>
  <dd>This Storage driver normally installs its own
      <span class="Li">&quot;HandleError&quot;</span>, sets
      <span class="Li">&quot;RaiseError&quot;</span> and
      <span class="Li">&quot;ShowErrorStatement&quot;</span> on, and sets
      <span class="Li">&quot;PrintError&quot;</span> off on all database
      handles, including those supplied by a coderef. It does this so that it
      can have consistent and useful error behavior.
    <p class="Pp">If you set this option to a true value, Storage will not do
        its usual modifications to the database handle's attributes, and instead
        relies on the settings in your connect_info DBI options (or the values
        you set in your connection coderef, in the case that you are connecting
        via coderef).</p>
    <p class="Pp">Note that your custom settings can cause Storage to
        malfunction, especially if you set a
        <span class="Li">&quot;HandleError&quot;</span> handler that suppresses
        exceptions and/or disable
        <span class="Li">&quot;RaiseError&quot;</span>.</p>
  </dd>
  <dt id="auto_savepoint"><a class="permalink" href="#auto_savepoint">auto_savepoint</a></dt>
  <dd>If this option is true, DBIx::Class will use savepoints when nesting
      transactions, making it possible to recover from failure in the inner
      transaction without having to abort all outer transactions.</dd>
  <dt id="cursor_class"><a class="permalink" href="#cursor_class">cursor_class</a></dt>
  <dd>Use this argument to supply a cursor class other than the default
      DBIx::Class::Storage::DBI::Cursor.</dd>
</dl>
<p class="Pp">Some real-life examples of arguments to &quot;connect_info&quot;
    and &quot;connect&quot; in DBIx::Class::Schema</p>
<p class="Pp"></p>
<pre>  # Simple SQLite connection
  -&gt;connect_info([ 'dbi:SQLite:./foo.db' ]);
  # Connect via subref
  -&gt;connect_info([ sub { DBI-&gt;connect(...) } ]);
  # Connect via subref in hashref
  -&gt;connect_info([{
    dbh_maker =&gt; sub { DBI-&gt;connect(...) },
    on_connect_do =&gt; 'alter session ...',
  }]);
  # A bit more complicated
  -&gt;connect_info(
    [
      'dbi:Pg:dbname=foo',
      'postgres',
      'my_pg_password',
      { AutoCommit =&gt; 1 },
      { quote_char =&gt; q{&quot;} },
    ]
  );
  # Equivalent to the previous example
  -&gt;connect_info(
    [
      'dbi:Pg:dbname=foo',
      'postgres',
      'my_pg_password',
      { AutoCommit =&gt; 1, quote_char =&gt; q{&quot;}, name_sep =&gt; q{.} },
    ]
  );
  # Same, but with hashref as argument
  # See parse_connect_info for explanation
  -&gt;connect_info(
    [{
      dsn         =&gt; 'dbi:Pg:dbname=foo',
      user        =&gt; 'postgres',
      password    =&gt; 'my_pg_password',
      AutoCommit  =&gt; 1,
      quote_char  =&gt; q{&quot;},
      name_sep    =&gt; q{.},
    }]
  );
  # Subref + DBIx::Class-specific connection options
  -&gt;connect_info(
    [
      sub { DBI-&gt;connect(...) },
      {
          quote_char =&gt; q{`},
          name_sep =&gt; q{@},
          on_connect_do =&gt; ['SET search_path TO myschema,otherschema,public'],
          disable_sth_caching =&gt; 1,
      },
    ]
  );
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="on_connect_do~2"><a class="permalink" href="#on_connect_do~2">on_connect_do</a></h2>
<p class="Pp">This method is deprecated in favour of setting via
    &quot;connect_info&quot;.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="on_disconnect_do~2"><a class="permalink" href="#on_disconnect_do~2">on_disconnect_do</a></h2>
<p class="Pp">This method is deprecated in favour of setting via
    &quot;connect_info&quot;.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="dbh_do"><a class="permalink" href="#dbh_do">dbh_do</a></h2>
<p class="Pp">Arguments: ($subref | <span class="Li">$method_name</span>),
    <span class="Li">@extra_coderef_args</span>?</p>
<p class="Pp">Execute the given <span class="Li">$subref</span> or
    <span class="Li">$method_name</span> using the new exception-based
    connection management.</p>
<p class="Pp">The first two arguments will be the storage object that
    <span class="Li">&quot;dbh_do&quot;</span> was called on and a database
    handle to use. Any additional arguments will be passed verbatim to the
    called subref as arguments 2 and onwards.</p>
<p class="Pp">Using this (instead of <span class="Li">$self</span>-&gt;_dbh or
    <span class="Li">$self</span>-&gt;dbh) ensures correct exception handling
    and reconnection (or failover in future subclasses).</p>
<p class="Pp">Your subref should have no side-effects outside of the database,
    as there is the potential for your subref to be partially double-executed if
    the database connection was stale/dysfunctional.</p>
<p class="Pp">Example:</p>
<p class="Pp"></p>
<pre>  my @stuff = $schema-&gt;storage-&gt;dbh_do(
    sub {
      my ($storage, $dbh, @cols) = @_;
      my $cols = join(q{, }, @cols);
      $dbh-&gt;selectrow_array(&quot;SELECT $cols FROM foo&quot;);
    },
    @column_list
  );
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="disconnect"><a class="permalink" href="#disconnect">disconnect</a></h2>
<p class="Pp">Our <span class="Li">&quot;disconnect&quot;</span> method also
    performs a rollback first if the database is not in
    <span class="Li">&quot;AutoCommit&quot;</span> mode.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="with_deferred_fk_checks"><a class="permalink" href="#with_deferred_fk_checks">with_deferred_fk_checks</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:"><a class="permalink" href="#Arguments:">Arguments:
    $coderef</a></dt>
  <dd></dd>
  <dt id="Return"><a class="permalink" href="#Return">Return Value: The return
    value of $coderef</a></dt>
  <dd></dd>
</dl>
<p class="Pp">Storage specific method to run the code ref with FK checks
    deferred or in MySQL's case disabled entirely.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="connected"><a class="permalink" href="#connected">connected</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:~2"><a class="permalink" href="#Arguments:~2">Arguments:
    none</a></dt>
  <dd></dd>
  <dt id="Return~2"><a class="permalink" href="#Return~2">Return Value:
    1|0</a></dt>
  <dd></dd>
</dl>
<p class="Pp">Verifies that the current database handle is active and ready to
    execute an SQL statement (e.g. the connection did not get stale, server is
    still answering, etc.) This method is used internally by
  &quot;dbh&quot;.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="dbh"><a class="permalink" href="#dbh">dbh</a></h2>
<p class="Pp">Returns a <span class="Li">$dbh</span> - a data base handle of
    class DBI. The returned handle is guaranteed to be healthy by implicitly
    calling &quot;connected&quot;, and if necessary performing a reconnection
    before returning. Keep in mind that this is very <b>expensive</b> on some
    database engines. Consider using &quot;dbh_do&quot; instead.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="connect_call_datetime_setup"><a class="permalink" href="#connect_call_datetime_setup">connect_call_datetime_setup</a></h2>
<p class="Pp">A no-op stub method, provided so that one can always safely supply
    the connection option</p>
<p class="Pp"></p>
<pre> on_connect_call =&gt; 'datetime_setup'
</pre>
<p class="Pp">This way one does not need to know in advance whether the
    underlying storage requires any sort of hand-holding when dealing with
    calendar data.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="select"><a class="permalink" href="#select">select</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:~3"><a class="permalink" href="#Arguments:~3">Arguments:
    $ident, $select, $condition, $attrs</a></dt>
  <dd></dd>
</dl>
<p class="Pp">Handle a SQL select statement.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="sql_limit_dialect"><a class="permalink" href="#sql_limit_dialect">sql_limit_dialect</a></h2>
<p class="Pp">This is an accessor for the default SQL limit dialect used by a
    particular storage driver. Can be overridden by supplying an explicit
    &quot;limit_dialect&quot; to &quot;connect&quot; in DBIx::Class::Schema. For
    a list of available limit dialects see
  DBIx::Class::SQLMaker::LimitDialects.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="last_insert_id"><a class="permalink" href="#last_insert_id">last_insert_id</a></h2>
<p class="Pp">Return the row id of the last insert.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="_native_data_type"><a class="permalink" href="#_native_data_type">_native_data_type</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:~4"><a class="permalink" href="#Arguments:~4">Arguments:
    $type_name</a></dt>
  <dd></dd>
</dl>
<p class="Pp">This API is <b>EXPERIMENTAL</b>, will almost definitely change in
    the future, and currently only used by ::AutoCast and ::Sybase::ASE.</p>
<p class="Pp">The default implementation returns
    <span class="Li">&quot;undef&quot;</span>, implement in your Storage driver
    if you need this functionality.</p>
<p class="Pp">Should map types from other databases to the native RDBMS type,
    for example <span class="Li">&quot;VARCHAR2&quot;</span> to
    <span class="Li">&quot;VARCHAR&quot;</span>.</p>
<p class="Pp">Types with modifiers should map to the underlying data type. For
    example, <span class="Li">&quot;INTEGER AUTO_INCREMENT&quot;</span> should
    become <span class="Li">&quot;INTEGER&quot;</span>.</p>
<p class="Pp">Composite types should map to the container type, for example
    <span class="Li">&quot;ENUM(foo,bar,baz)&quot;</span> becomes
    <span class="Li">&quot;ENUM&quot;</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="sqlt_type"><a class="permalink" href="#sqlt_type">sqlt_type</a></h2>
<p class="Pp">Returns the database driver name.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="bind_attribute_by_data_type"><a class="permalink" href="#bind_attribute_by_data_type">bind_attribute_by_data_type</a></h2>
<p class="Pp">Given a datatype from column info, returns a database specific
    bind attribute for
    <span class="Li">&quot;$dbh-&gt;bind_param($val,$attribute)&quot;</span> or
    nothing if we will let the database planner just handle it.</p>
<p class="Pp">This method is always called after the driver has been determined
    and a DBI connection has been established. Therefore you can refer to
    <span class="Li">&quot;DBI::$constant&quot;</span> and/or
    <span class="Li">&quot;DBD::$driver::$constant&quot;</span> directly,
    without worrying about loading the correct modules.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="is_datatype_numeric"><a class="permalink" href="#is_datatype_numeric">is_datatype_numeric</a></h2>
<p class="Pp">Given a datatype from column_info, returns a boolean value
    indicating if the current RDBMS considers it a numeric value. This controls
    how &quot;set_column&quot; in DBIx::Class::Row decides whether to mark the
    column as dirty - when the datatype is deemed numeric a
    <span class="Li">&quot;!=&quot;</span> comparison will be performed instead
    of the usual <span class="Li">&quot;eq&quot;</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="create_ddl_dir"><a class="permalink" href="#create_ddl_dir">create_ddl_dir</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:~5"><a class="permalink" href="#Arguments:~5">Arguments:
    $schema, \@databases, $version, $directory, $preversion,
    \%sqlt_args</a></dt>
  <dd></dd>
</dl>
<p class="Pp">Creates a SQL file based on the Schema, for each of the specified
    database engines in <span class="Li">&quot;\@databases&quot;</span> in the
    given directory. (note: specify SQL::Translator names, not DBI driver
    names).</p>
<p class="Pp">Given a previous version number, this will also create a file
    containing the ALTER TABLE statements to transform the previous schema into
    the current one. Note that these statements may contain
    <span class="Li">&quot;DROP TABLE&quot;</span> or
    <span class="Li">&quot;DROP COLUMN&quot;</span> statements that can
    potentially destroy data.</p>
<p class="Pp">The file names are created using the
    <span class="Li">&quot;ddl_filename&quot;</span> method below, please
    override this method in your schema if you would like a different file name
    format. For the ALTER file, the same format is used, replacing
    <span class="Li">$version</span> in the name with
    &quot;$preversion-$version&quot;.</p>
<p class="Pp">See &quot;METHODS&quot; in SQL::Translator for a list of values
    for <span class="Li">&quot;\%sqlt_args&quot;</span>. The most common value
    for this would be <span class="Li">&quot;{ add_drop_table =&gt; 1
    }&quot;</span> to have the SQL produced include a
    <span class="Li">&quot;DROP TABLE&quot;</span> statement for each table
    created. For quoting purposes supply
    <span class="Li">&quot;quote_identifiers&quot;</span>.</p>
<p class="Pp">If no arguments are passed, then the following default values are
    assumed:</p>
<dl class="Bl-tag">
  <dt id="databases"><a class="permalink" href="#databases">databases -
    ['MySQL', 'SQLite', 'PostgreSQL']</a></dt>
  <dd></dd>
  <dt id="version"><a class="permalink" href="#version">version -
    $schema-&gt;schema_version</a></dt>
  <dd></dd>
  <dt id="directory"><a class="permalink" href="#directory">directory -
    './'</a></dt>
  <dd></dd>
  <dt id="preversion"><a class="permalink" href="#preversion">preversion -
    &lt;none&gt;</a></dt>
  <dd></dd>
</dl>
<p class="Pp">By default, <span class="Li">&quot;\%sqlt_args&quot;</span> will
    have</p>
<p class="Pp"></p>
<pre> { add_drop_table =&gt; 1, ignore_constraint_names =&gt; 1, ignore_index_names =&gt; 1 }
</pre>
<p class="Pp">merged with the hash passed in. To disable any of those features,
    pass in a hashref like the following</p>
<p class="Pp"></p>
<pre> { ignore_constraint_names =&gt; 0, # ... other options }
</pre>
<p class="Pp">WARNING: You are strongly advised to check all SQL files created,
    before applying them.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="deployment_statements"><a class="permalink" href="#deployment_statements">deployment_statements</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:~6"><a class="permalink" href="#Arguments:~6">Arguments:
    $schema, $type, $version, $directory, $sqlt_args</a></dt>
  <dd></dd>
</dl>
<p class="Pp">Returns the statements used by &quot;deploy&quot; in
    DBIx::Class::Storage and &quot;deploy&quot; in DBIx::Class::Schema.</p>
<p class="Pp">The SQL::Translator (not DBI) database driver name can be
    explicitly provided in <span class="Li">$type</span>, otherwise the result
    of &quot;sqlt_type&quot; is used as default.</p>
<p class="Pp"><span class="Li">$directory</span> is used to return statements
    from files in a previously created &quot;create_ddl_dir&quot; directory and
    is optional. The filenames are constructed from &quot;ddl_filename&quot; in
    DBIx::Class::Schema, the schema name and the
    <span class="Li">$version</span>.</p>
<p class="Pp">If no <span class="Li">$directory</span> is specified then the
    statements are constructed on the fly using SQL::Translator and
    <span class="Li">$version</span> is ignored.</p>
<p class="Pp">See &quot;METHODS&quot; in SQL::Translator for a list of values
    for <span class="Li">$sqlt_args</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="datetime_parser"><a class="permalink" href="#datetime_parser">datetime_parser</a></h2>
<p class="Pp">Returns the datetime parser class</p>
</section>
<section class="Ss">
<h2 class="Ss" id="datetime_parser_type"><a class="permalink" href="#datetime_parser_type">datetime_parser_type</a></h2>
<p class="Pp">Defines the datetime parser class - currently defaults to
    DateTime::Format::MySQL</p>
</section>
<section class="Ss">
<h2 class="Ss" id="build_datetime_parser"><a class="permalink" href="#build_datetime_parser">build_datetime_parser</a></h2>
<p class="Pp">See &quot;datetime_parser&quot;</p>
</section>
<section class="Ss">
<h2 class="Ss" id="is_replicating"><a class="permalink" href="#is_replicating">is_replicating</a></h2>
<p class="Pp">A boolean that reports if a particular DBIx::Class::Storage::DBI
    is set to replicate from a master database. Default is undef, which is the
    result returned by databases that don't support replication.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="lag_behind_master"><a class="permalink" href="#lag_behind_master">lag_behind_master</a></h2>
<p class="Pp">Returns a number that represents a certain amount of lag behind a
    master db when a given storage is replicating. The number is database
    dependent, but starts at zero and increases with the amount of lag. Default
    in undef</p>
</section>
<section class="Ss">
<h2 class="Ss" id="relname_to_table_alias"><a class="permalink" href="#relname_to_table_alias">relname_to_table_alias</a></h2>
<dl class="Bl-tag">
  <dt id="Arguments:~7"><a class="permalink" href="#Arguments:~7">Arguments:
    $relname, $join_count</a></dt>
  <dd></dd>
  <dt id="Return~3"><a class="permalink" href="#Return~3">Return Value:
    $alias</a></dt>
  <dd></dd>
</dl>
<p class="Pp">DBIx::Class uses DBIx::Class::Relationship names as table aliases
    in queries.</p>
<p class="Pp">This hook is to allow specific DBIx::Class::Storage drivers to
    change the way these aliases are named.</p>
<p class="Pp">The default behavior is
    <span class="Li">&quot;&quot;$relname_$join_count&quot; if $join_count &gt;
    1&quot;</span>, otherwise <span class="Li">&quot;$relname&quot;</span>.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="USAGE_NOTES"><a class="permalink" href="#USAGE_NOTES">USAGE
  NOTES</a></h1>
<section class="Ss">
<h2 class="Ss" id="DBIx::Class_and_AutoCommit"><a class="permalink" href="#DBIx::Class_and_AutoCommit">DBIx::Class
  and AutoCommit</a></h2>
<p class="Pp">DBIx::Class can do some wonderful magic with handling exceptions,
    disconnections, and transactions when you use
    <span class="Li">&quot;AutoCommit =&gt; 1&quot;</span> (the default)
    combined with txn_do for transaction support.</p>
<p class="Pp">If you set <span class="Li">&quot;AutoCommit =&gt; 0&quot;</span>
    in your connect info, then you are always in an assumed transaction between
    commits, and you're telling us you'd like to manage that manually. A lot of
    the magic protections offered by this module will go away. We can't protect
    you from exceptions due to database disconnects because we don't know
    anything about how to restart your transactions. You're on your own for
    handling all sorts of exceptional cases if you choose the
    <span class="Li">&quot;AutoCommit =&gt; 0&quot;</span> path, just as you
    would be with raw DBI.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="FURTHER_QUESTIONS?"><a class="permalink" href="#FURTHER_QUESTIONS?">FURTHER
  QUESTIONS?</a></h1>
<p class="Pp">Check the list of additional DBIC resources.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">This module is free software copyright by the DBIx::Class (DBIC)
    authors. You can redistribute it and/or modify it under the same terms as
    the DBIx::Class library.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2018-01-29</td>
    <td class="foot-os">perl v5.34.0</td>
  </tr>
</table>
</body>
</html>
