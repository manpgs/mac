<!DOCTYPE html>
<html lang="en">
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>Specio::Coercion(3)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">Specio::Coercion(3)</td>
    <td class="head-vol"><a href=".">User Contributed Perl Documentation</a></td>
    <td class="head-rtitle">Specio::Coercion(3)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">Specio::Coercion - A class representing a coercion from one type
    to another</p>
</section>
<section class="Sh">
<h1 class="Sh" id="VERSION"><a class="permalink" href="#VERSION">VERSION</a></h1>
<p class="Pp">version 0.46</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>    my $coercion = $type-&gt;coercion_from_type('Int');
    my $new_value = $coercion-&gt;coerce_value(42);
    if ( $coercion-&gt;can_be_inlined() ) {
        my $code = $coercion-&gt;inline_coercion('$_[0]');
    }
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">This class represents a coercion from one type to another.
    Internally, a coercion is a piece of code that takes a value of one type
    returns a new value of a new type. For example, a coercion from c&lt;Num&gt;
    to <span class="Li">&quot;Int&quot;</span> might round a number to its
    nearest integer and return that integer.</p>
<p class="Pp">Coercions can be implemented either as a simple subroutine
    reference or as an inline generator subroutine. Using an inline generator is
    faster but more complicated.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="API"><a class="permalink" href="#API">API</a></h1>
<p class="Pp">This class provides the following methods.</p>
<section class="Ss">
<h2 class="Ss" id="Specio::Coercion"><a class="permalink" href="#Specio::Coercion">Specio::Coercion-&gt;new(
  ... )</a></h2>
<p class="Pp">This method creates a new coercion object. It accepts the
    following named parameters:</p>
<ul class="Bl-bullet">
  <li>from =&gt; <span class="Li">$type</span>
    <p class="Pp">The type this coercion is from. The type must be an object
        which does the Specio::Constraint::Role::Interface interface.</p>
    <p class="Pp">This parameter is required.</p>
  </li>
  <li>to =&gt; <span class="Li">$type</span>
    <p class="Pp">The type this coercion is to. The type must be an object which
        does the Specio::Constraint::Role::Interface interface.</p>
    <p class="Pp">This parameter is required.</p>
  </li>
  <li>coercion =&gt; sub { ... }
    <p class="Pp">A subroutine reference implementing the coercion. It will be
        called as a method on the object and passed a single argument, the value
        to coerce.</p>
    <p class="Pp">It should return the new value.</p>
    <p class="Pp">This parameter is mutually exclusive with
        <span class="Li">&quot;inline_generator&quot;</span>.</p>
    <p class="Pp">Either this parameter or the
        <span class="Li">&quot;inline_generator&quot;</span> parameter is
        required.</p>
    <p class="Pp">You can also pass this option with the key
        <span class="Li">&quot;using&quot;</span> in the parameter list.</p>
  </li>
  <li>inline_generator =&gt; sub { ... }
    <p class="Pp">This should be a subroutine reference which returns a string
        containing a single term. This code should <i>not</i> end in a
        semicolon. This code should implement the coercion.</p>
    <p class="Pp">The generator will be called as a method on the coercion with
        a single argument. That argument is the name of the variable being
        coerced, something like <span class="Li">'$_[0]'</span> or
        <span class="Li">'$var'</span>.</p>
    <p class="Pp">This parameter is mutually exclusive with
        <span class="Li">&quot;coercion&quot;</span>.</p>
    <p class="Pp">Either this parameter or the
        <span class="Li">&quot;coercion&quot;</span> parameter is required.</p>
    <p class="Pp">You can also pass this option with the key
        <span class="Li">&quot;inline&quot;</span> in the parameter list.</p>
  </li>
  <li>inline_environment =&gt; {}
    <p class="Pp">This should be a hash reference of variable names (with
        sigils) and values for that variable. The values should be
        <i>references</i> to the values of the variables.</p>
    <p class="Pp">This environment will be used when compiling the coercion as
        part of a subroutine. The named variables will be captured as closures
        in the generated subroutine, using Eval::Closure.</p>
    <p class="Pp">It should be very rare to need to set this in the constructor.
        It's more likely that a special coercion subclass would need to provide
        values that it generates internally.</p>
    <p class="Pp">This parameter defaults to an empty hash reference.</p>
  </li>
  <li>declared_at =&gt; <span class="Li">$declared_at</span>
    <p class="Pp">This parameter must be a Specio::DeclaredAt object.</p>
    <p class="Pp">This parameter is required.</p>
  </li>
</ul>
</section>
<section class="Ss">
<h2 class="Ss">$coercion-&gt;<b>from()</b>, $coercion-&gt;<b>to()</b>,
  $coercion-&gt;<b>declared_at()</b></h2>
<p class="Pp">These methods are all read-only attribute accessors for the
    corresponding attribute.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion"><a class="permalink" href="#$coercion">$coercion-&gt;description</a></h2>
<p class="Pp">This returns a string describing the coercion. This includes the
    names of the to and from type and where the coercion was declared, so you
    end up with something like <span class="Li">'coercion from Foo to Bar
    declared in package My::Lib</span> <span class="Li">(lib/My/Lib.pm) at line
    42'</span>.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion~2"><a class="permalink" href="#$coercion~2">$coercion-&gt;coerce($value)</a></h2>
<p class="Pp">Given a value of the right &quot;from&quot; type, returns a new
    value of the &quot;to&quot; type.</p>
<p class="Pp">This method does not actually check that the types of given or
    return values.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion~3"><a class="permalink" href="#$coercion~3">$coercion-&gt;inline_coercion($var)</a></h2>
<p class="Pp">Given a variable name like <span class="Li">'$_[0]'</span> this
    returns a string with code for the coercion.</p>
<p class="Pp">Note that this method will die if the coercion does not have an
    inline generator.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion~4"><a class="permalink" href="#$coercion~4">$coercion-&gt;<b>can_be_inlined()</b></a></h2>
<p class="Pp">This returns true if the coercion has an inline generator
    <i>and</i> the constraint it is from can be inlined. This exists primarily
    for the benefit of the
    <span class="Li">&quot;inline_coercion_and_check()&quot;</span> method for
    type constraint object.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion~5"><a class="permalink" href="#$coercion~5">$coercion-&gt;<b>inline_environment()</b></a></h2>
<p class="Pp">This returns a hash defining the variables that need to be closed
    over when inlining the coercion. The keys are full variable names like
    <span class="Li">'$foo'</span> or <span class="Li">'@bar'</span>. The values
    are <i>references</i> to a variable of the matching type.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion~6"><a class="permalink" href="#$coercion~6">$coercion-&gt;<b>clone()</b></a></h2>
<p class="Pp">Returns a clone of this object.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="$coercion~7"><a class="permalink" href="#$coercion~7">$coercion-&gt;clone_with_new_to($new_to_type)</a></h2>
<p class="Pp">This returns a clone of the coercion, replacing the &quot;to&quot;
    type with a new one. This is intended for use when the to type itself is
    being cloned as part of importing that type. We need to make sure the newly
    cloned coercion has the newly cloned type as well.</p>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="ROLES"><a class="permalink" href="#ROLES">ROLES</a></h1>
<p class="Pp">This class does the Specio::Role::Inlinable role.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SUPPORT"><a class="permalink" href="#SUPPORT">SUPPORT</a></h1>
<p class="Pp">Bugs may be submitted at
    &lt;https://github.com/houseabsolute/Specio/issues&gt;.</p>
<p class="Pp">I am also usually active on IRC as 'autarch' on
    <span class="Li">&quot;irc://irc.perl.org&quot;</span>.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SOURCE"><a class="permalink" href="#SOURCE">SOURCE</a></h1>
<p class="Pp">The source code repository for Specio can be found at
    &lt;https://github.com/houseabsolute/Specio&gt;.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">Dave Rolsky &lt;autarch@urth.org&gt;</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT_AND_LICENSE"><a class="permalink" href="#COPYRIGHT_AND_LICENSE">COPYRIGHT
  AND LICENSE</a></h1>
<p class="Pp">This software is Copyright (c) 2012 - 2020 by Dave Rolsky.</p>
<p class="Pp">This is free software, licensed under:</p>
<p class="Pp"></p>
<pre>  The Artistic License 2.0 (GPL Compatible)
</pre>
<p class="Pp">The full text of the license can be found in the <i>LICENSE</i>
    file included with this distribution.</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2020-03-14</td>
    <td class="foot-os"><a href="..">perl v5.34.0</a></td>
  </tr>
</table>
</body>
</html>
