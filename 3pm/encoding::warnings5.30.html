<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
  
   Standard preamble:
   ========================================================================
   Vertical space (when we can't use .PP)
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>encoding::warnings(3pm)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">encoding::warnings(3pm)</td>
    <td class="head-vol">Perl Programmers Reference Guide</td>
    <td class="head-rtitle">encoding::warnings(3pm)</td>
  </tr>
</table>
<div class="manual-text">
<br/>
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">encoding::warnings - Warn on implicit encoding conversions</p>
</section>
<section class="Sh">
<h1 class="Sh" id="VERSION"><a class="permalink" href="#VERSION">VERSION</a></h1>
<p class="Pp">This document describes version 0.13 of encoding::warnings,
    released June 20, 2016.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="NOTICE"><a class="permalink" href="#NOTICE">NOTICE</a></h1>
<p class="Pp">As of Perl 5.26.0, this module has no effect. The internal Perl
    feature that was used to implement this module has been removed. In recent
    years, much work has been done on the Perl core to eliminate discrepancies
    in the treatment of upgraded versus downgraded strings. In addition, the
    encoding pragma, which caused many of the problems, is no longer supported.
    Thus, the warnings this module produced are no longer necessary.</p>
<p class="Pp">Hence, if you load this module on Perl 5.26.0, you will get one
    warning that the module is no longer supported; and the module will do
    nothing thereafter.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<pre>
    use encoding::warnings; # or 'FATAL' to raise fatal exceptions

    utf8::encode($a = chr(20000));  # a byte-string (raw bytes)
    $b = chr(20000);                # a unicode-string (wide characters)

    # &quot;Bytes implicitly upgraded into wide characters as iso-8859-1&quot;
    $c = $a . $b;
</pre>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<section class="Ss">
<h2 class="Ss" id="Overview_of_the_problem"><a class="permalink" href="#Overview_of_the_problem">Overview
  of the problem</a></h2>
<p class="Pp">By default, there is a fundamental asymmetry in Perl's unicode
    model: implicit upgrading from byte-strings to unicode-strings assumes that
    they were encoded in <i>ISO 8859-1 (Latin-1)</i>, but unicode-strings are
    downgraded with UTF-8 encoding. This happens because the first 256
    codepoints in Unicode happens to agree with Latin-1.</p>
<p class="Pp">However, this silent upgrading can easily cause problems, if you
    happen to mix unicode strings with non-Latin1 data -- i.e. byte-strings
    encoded in UTF-8 or other encodings. The error will not manifest until the
    combined string is written to output, at which time it would be impossible
    to see where did the silent upgrading occur.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Detecting_the_problem"><a class="permalink" href="#Detecting_the_problem">Detecting
  the problem</a></h2>
<p class="Pp">This module simplifies the process of diagnosing such problems.
    Just put this line on top of your main program:</p>
<p class="Pp"></p>
<pre>
    use encoding::warnings;
</pre>
<p class="Pp">Afterwards, implicit upgrading of high-bit bytes will raise a
    warning. Ex.: <span class="Li">&quot;Bytes implicitly upgraded into wide
    characters as iso-8859-1 at</span> <span class="Li">- line
  7&quot;</span>.</p>
<p class="Pp">However, strings composed purely of ASCII code points
    (<span class="Li">0x00</span>..<span class="Li">0x7F</span>) will <i>not</i>
    trigger this warning.</p>
<p class="Pp">You can also make the warnings fatal by importing this module
  as:</p>
<p class="Pp"></p>
<pre>
    use encoding::warnings 'FATAL';
</pre>
</section>
<section class="Ss">
<h2 class="Ss" id="Solving_the_problem"><a class="permalink" href="#Solving_the_problem">Solving
  the problem</a></h2>
<p class="Pp">Most of the time, this warning occurs when a byte-string is
    concatenated with a unicode-string. There are a number of ways to solve
  it:</p>
<ul class="Bl-bullet">
  <li>Upgrade both sides to unicode-strings
    <p class="Pp">If your program does not need compatibility for Perl 5.6 and
        earlier, the recommended approach is to apply appropriate IO
        disciplines, so all data in your program become unicode-strings. See
        encoding, open and &quot;binmode&quot; in perlfunc for how.</p>
  </li>
  <li>Downgrade both sides to byte-strings
    <p class="Pp">The other way works too, especially if you are sure that all
        your data are under the same encoding, or if compatibility with older
        versions of Perl is desired.</p>
    <p class="Pp">You may downgrade strings with
        <span class="Li">&quot;Encode::encode&quot;</span> and
        <span class="Li">&quot;utf8::encode&quot;</span>. See Encode and utf8
        for details.</p>
  </li>
  <li>Specify the encoding for implicit byte-string upgrading
    <p class="Pp">If you are confident that all byte-strings will be in a
        specific encoding like UTF-8, <i>and</i> need not support older versions
        of Perl, use the <span class="Li">&quot;encoding&quot;</span>
      pragma:</p>
    <p class="Pp"></p>
    <pre>
    use encoding 'utf8';
    </pre>
    <p class="Pp">Similarly, this will silence warnings from this module, and
        preserve the default behaviour:</p>
    <p class="Pp"></p>
    <pre>
    use encoding 'iso-8859-1';
    </pre>
    <p class="Pp">However, note that <span class="Li">&quot;use
        encoding&quot;</span> actually had three distinct effects:</p>
  </li>
</ul>
<div class="Bd-indent">
<ul class="Bl-bullet">
  <li>PerlIO layers for <b>STDIN</b> and <b>STDOUT</b>
    <p class="Pp">This is similar to what open pragma does.</p>
  </li>
  <li>Literal conversions
    <p class="Pp">This turns <i>all</i> literal string in your program into
        unicode-strings (equivalent to a <span class="Li">&quot;use
        utf8&quot;</span>), by decoding them using the specified encoding.</p>
  </li>
  <li>Implicit upgrading for byte-strings
    <p class="Pp">This will silence warnings from this module, as shown
      above.</p>
  </li>
</ul>
</div>
<div class="Bd-indent">
<p class="Pp">Because literal conversions also work on empty strings, it may
    surprise some people:</p>
<p class="Pp"></p>
<pre>
    use encoding 'big5';

    my $byte_string = pack(&quot;C*&quot;, 0xA4, 0x40);
    print length $a;    # 2 here.
    $a .= &quot;&quot;;           # concatenating with a unicode string...
    print length $a;    # 1 here!
</pre>
<p class="Pp">In other words, do not <span class="Li">&quot;use
    encoding&quot;</span> unless you are certain that the program will not deal
    with any raw, 8-bit binary data at all.</p>
<p class="Pp">However, the <span class="Li">&quot;Filter =&gt; 1&quot;</span>
    flavor of <span class="Li">&quot;use encoding&quot;</span> will <i>not</i>
    affect implicit upgrading for byte-strings, and is thus incapable of
    silencing warnings from this module. See encoding for more details.</p>
</div>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="CAVEATS"><a class="permalink" href="#CAVEATS">CAVEATS</a></h1>
<p class="Pp">For Perl 5.9.4 or later, this module's effect is lexical.</p>
<p class="Pp">For Perl versions prior to 5.9.4, this module affects the whole
    script, instead of inside its lexical block.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp">perlunicode, perluniintro</p>
<p class="Pp">open, utf8, encoding, Encode</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHORS"><a class="permalink" href="#AUTHORS">AUTHORS</a></h1>
<p class="Pp">Audrey Tang</p>
</section>
<section class="Sh">
<h1 class="Sh" id="COPYRIGHT"><a class="permalink" href="#COPYRIGHT">COPYRIGHT</a></h1>
<p class="Pp">Copyright 2004, 2005, 2006, 2007 by Audrey Tang
    &lt;cpan@audreyt.org&gt;.</p>
<p class="Pp">This program is free software; you can redistribute it and/or
    modify it under the same terms as Perl itself.</p>
<p class="Pp">See &lt;http://www.perl.com/perl/misc/Artistic.html&gt;</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2019-10-21</td>
    <td class="foot-os">perl v5.30.3</td>
  </tr>
</table>
</body>
</html>
