<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>rsyncd.conf(5)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">rsyncd.conf(5)</td>
    <td class="head-vol"></td>
    <td class="head-rtitle">rsyncd.conf(5)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp">rsyncd.conf - configuration file for rsync in daemon mode</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<p class="Pp">rsyncd.conf</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The rsyncd.conf file is the runtime configuration file for rsync
    when run as an rsync daemon.</p>
<p class="Pp">The rsyncd.conf file controls authentication, access, logging and
    available modules.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILE_FORMAT"><a class="permalink" href="#FILE_FORMAT">FILE
  FORMAT</a></h1>
<p class="Pp">The file consists of modules and parameters. A module begins with
    the name of the module in square brackets and continues until the next
    module begins. Modules contain parameters of the form 'name = value'.</p>
<p class="Pp">The file is line-based -- that is, each newline-terminated line
    represents either a comment, a module name or a parameter.</p>
<p class="Pp">Only the first equals sign in a parameter is significant.
    Whitespace before or after the first equals sign is discarded. Leading,
    trailing and internal whitespace in module and parameter names is
    irrelevant. Leading and trailing whitespace in a parameter value is
    discarded. Internal whitespace within a parameter value is retained
    verbatim.</p>
<p class="Pp">Any line beginning with a hash (#) is ignored, as are lines
    containing only whitespace.</p>
<p class="Pp">Any line ending in a \ is &quot;continued&quot; on the next line
    in the customary UNIX fashion.</p>
<p class="Pp">The values following the equals sign in parameters are all either
    a string (no quotes needed) or a boolean, which may be given as yes/no, 0/1
    or true/false. Case is not significant in boolean values, but is preserved
    in string values.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="LAUNCHING_THE_RSYNC_DAEMON"><a class="permalink" href="#LAUNCHING_THE_RSYNC_DAEMON">LAUNCHING
  THE RSYNC DAEMON</a></h1>
<p class="Pp">The rsync daemon is launched by specifying the <b>--daemon</b>
    option to rsync.</p>
<p class="Pp">The daemon must run with root privileges if you wish to use
    chroot, to bind to a port numbered under 1024 (as is the default 873), or to
    set file ownership. Otherwise, it must just have permission to read and
    write the appropriate data, log, and lock files.</p>
<p class="Pp">You can launch it either via inetd, as a stand-alone daemon, or
    from an rsync client via a remote shell. If run as a stand-alone daemon then
    just run the command &quot;<b>rsync --daemon</b>&quot; from a suitable
    startup script.</p>
<p class="Pp">When run via inetd you should add a line like this to
    /etc/services:</p>
<p class="Pp"></p>
<pre>
  rsync           873/tcp</pre>
<p class="Pp"></p>
<p class="Pp">and a single line something like this to /etc/inetd.conf:</p>
<p class="Pp"></p>
<pre>
  rsync   stream  tcp     nowait  root   /usr/bin/rsync rsyncd --daemon</pre>
<p class="Pp"></p>
<p class="Pp">Replace &quot;/usr/bin/rsync&quot; with the path to where you have
    rsync installed on your system. You will then need to send inetd a HUP
    signal to tell it to reread its config file.</p>
<p class="Pp">Note that you should <b>not</b> send the rsync daemon a HUP signal
    to force it to reread the <span class="Li">rsyncd.conf</span> file. The file
    is re-read on each client connection.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="GLOBAL_OPTIONS"><a class="permalink" href="#GLOBAL_OPTIONS">GLOBAL
  OPTIONS</a></h1>
<p class="Pp">The first parameters in the file (before a [module] header) are
    the global parameters.</p>
<p class="Pp">You may also include any module parameters in the global part of
    the config file in which case the supplied value will override the default
    for that parameter.</p>
<dl class="Bl-tag">
  <dt id="motd"><a class="permalink" href="#motd"><b>motd file</b></a></dt>
  <dd>The &quot;motd file&quot; option allows you to specify a &quot;message of
      the day&quot; to display to clients on each connect. This usually contains
      site information and any legal notices. The default is no motd file.</dd>
  <dt id="pid"><a class="permalink" href="#pid"><b>pid file</b></a></dt>
  <dd>The &quot;pid file&quot; option tells the rsync daemon to write its
      process ID to that file.</dd>
  <dt id="port"><a class="permalink" href="#port"><b>port</b></a></dt>
  <dd>You can override the default port the daemon will listen on by specifying
      this value (defaults to 873). This is ignored if the daemon is being run
      by inetd, and is superseded by the <b>--port</b> command-line option.</dd>
  <dt id="address"><a class="permalink" href="#address"><b>address</b></a></dt>
  <dd>You can override the default IP address the daemon will listen on by
      specifying this value. This is ignored if the daemon is being run by
      inetd, and is superseded by the <b>--address</b> command-line option.</dd>
  <dt id="socket"><a class="permalink" href="#socket"><b>socket
    options</b></a></dt>
  <dd>This option can provide endless fun for people who like to tune their
      systems to the utmost degree. You can set all sorts of socket options
      which may make transfers faster (or slower!). Read the man page for the
      <span class="Li">setsockopt()</span> system call for details on some of
      the options you may be able to set. By default no special socket options
      are set. These settings are superseded by the <b>--sockopts</b>
      command-line option.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="MODULE_OPTIONS"><a class="permalink" href="#MODULE_OPTIONS">MODULE
  OPTIONS</a></h1>
<p class="Pp">After the global options you should define a number of modules,
    each module exports a directory tree as a symbolic name. Modules are
    exported by specifying a module name in square brackets [module] followed by
    the options for that module.</p>
<dl class="Bl-tag">
  <dt id="comment"><a class="permalink" href="#comment"><b>comment</b></a></dt>
  <dd>The &quot;comment&quot; option specifies a description string that is
      displayed next to the module name when clients obtain a list of available
      modules. The default is no comment.</dd>
  <dt id="path"><a class="permalink" href="#path"><b>path</b></a></dt>
  <dd>The &quot;path&quot; option specifies the directory in the daemon's
      filesystem to make available in this module. You must specify this option
      for each module in <span class="Li">rsyncd.conf</span>.</dd>
  <dt id="use"><a class="permalink" href="#use"><b>use chroot</b></a></dt>
  <dd>If &quot;use chroot&quot; is true, the rsync daemon will chroot to the
      &quot;path&quot; before starting the file transfer with the client. This
      has the advantage of extra protection against possible implementation
      security holes, but it has the disadvantages of requiring super-user
      privileges, of not being able to follow symbolic links that are either
      absolute or outside of the new root path, and of complicating the
      preservation of users and groups by name (see below). When &quot;use
      chroot&quot; is false, rsync will: (1) munge symlinks by default for
      security reasons (see &quot;munge symlinks&quot; for a way to turn this
      off, but only if you trust your users), (2) substitute leading slashes in
      absolute paths with the module's path (so that options such as
      <b>--backup-dir</b>, <b>--compare-dest</b>, etc. interpret an absolute
      path as rooted in the module's &quot;path&quot; dir), and (3) trim
      &quot;..&quot; path elements from args if rsync believes they would escape
      the chroot. The default for &quot;use chroot&quot; is true, and is the
      safer choice (especially if the module is not read-only).</dd>
  <dt></dt>
  <dd>When this option is enabled, rsync will not attempt to map users and
      groups by name (by default), but instead copy IDs as though
      <b>--numeric-ids</b> had been specified. In order to enable name-mapping,
      rsync needs to be able to use the standard library functions for looking
      up names and IDs (i.e. <span class="Li">getpwuid()</span> ,
      <span class="Li">getgrgid()</span> , <span class="Li">getpwname()</span> ,
      and <span class="Li">getgrnam()</span> ). This means the rsync process in
      the chroot hierarchy will need to have access to the resources used by
      these library functions (traditionally /etc/passwd and /etc/group, but
      perhaps additional dynamic libraries as well).</dd>
  <dt></dt>
  <dd>If you copy the necessary resources into the module's chroot area, you
      should protect them through your OS's normal user/group or ACL settings
      (to prevent the rsync module's user from being able to change them), and
      then hide them from the user's view via &quot;exclude&quot; (see how in
      the discussion of that option). At that point it will be safe to enable
      the mapping of users and groups by name using the &quot;numeric ids&quot;
      daemon option (see below).</dd>
  <dt></dt>
  <dd>Note also that you are free to setup custom user/group information in the
      chroot area that is different from your normal system. For example, you
      could abbreviate the list of users and groups.</dd>
  <dt id="numeric"><a class="permalink" href="#numeric"><b>numeric
    ids</b></a></dt>
  <dd>Enabling the &quot;numeric ids&quot; option disables the mapping of users
      and groups by name for the current daemon module. This prevents the daemon
      from trying to load any user/group-related files or libraries. Enabling
      this option makes the transfer behave as if the client had passed the
      <b>--numeric-ids</b> command-line option. By default, this parameter is
      enabled for chroot modules and disabled for non-chroot modules.</dd>
  <dt></dt>
  <dd>A chroot-enabled module should not have this option enabled unless you've
      taken steps to ensure that the module has the necessary resources it needs
      to translate names, and that it is not possible for a user to change those
      resources.</dd>
  <dt id="munge"><a class="permalink" href="#munge"><b>munge
    symlinks</b></a></dt>
  <dd>The &quot;munge symlinks&quot; option tells rsync to modify all incoming
      symlinks in a way that makes them unusable but recoverable (see below).
      This should help protect your files from user trickery when your daemon
      module is writable. The default is disabled when &quot;use chroot&quot; is
      on and enabled when &quot;use chroot&quot; is off.</dd>
  <dt></dt>
  <dd>If you disable this option on a daemon that is not read-only, there are
      tricks that a user can play with uploaded symlinks to access
      daemon-excluded items (if your module has any), and, if &quot;use
      chroot&quot; is off, rsync can even be tricked into showing or changing
      data that is outside the module's path (as access-permissions allow).</dd>
  <dt></dt>
  <dd>The way rsync disables the use of symlinks is to prefix each one with the
      string &quot;/rsyncd-munged/&quot;. This prevents the links from being
      used as long as that directory does not exist. When this option is
      enabled, rsync will refuse to run if that path is a directory or a symlink
      to a directory. When using the &quot;munge symlinks&quot; option in a
      chroot area, you should add this path to the exclude setting for the
      module so that the user can't try to create it.</dd>
  <dt></dt>
  <dd>Note: rsync makes no attempt to verify that any pre-existing symlinks in
      the hierarchy are as safe as you want them to be. If you setup an rsync
      daemon on a new area or locally add symlinks, you can manually protect
      your symlinks from being abused by prefixing &quot;/rsyncd-munged/&quot;
      to the start of every symlink's value. There is a perl script in the
      support directory of the source code named &quot;munge-symlinks&quot; that
      can be used to add or remove this prefix from your symlinks.</dd>
  <dt></dt>
  <dd>When this option is disabled on a writable module and &quot;use
      chroot&quot; is off, incoming symlinks will be modified to drop a leading
      slash and to remove &quot;..&quot; path elements that rsync believes will
      allow a symlink to escape the module's hierarchy. There are tricky ways to
      work around this, though, so you had better trust your users if you choose
      this combination of options.</dd>
  <dt id="max"><a class="permalink" href="#max"><b>max connections</b></a></dt>
  <dd>The &quot;max connections&quot; option allows you to specify the maximum
      number of simultaneous connections you will allow. Any clients connecting
      when the maximum has been reached will receive a message telling them to
      try later. The default is 0 which means no limit. See also the &quot;lock
      file&quot; option.</dd>
  <dt id="log"><a class="permalink" href="#log"><b>log file</b></a></dt>
  <dd>When the &quot;log file&quot; option is set to a non-empty string, the
      rsync daemon will log messages to the indicated file rather than using
      syslog. This is particularly useful on systems (such as AIX) where
      <span class="Li">syslog()</span> doesn't work for chrooted programs. The
      file is opened before <span class="Li">chroot()</span> is called, allowing
      it to be placed outside the transfer. If this value is set on a per-module
      basis instead of globally, the global log will still contain any
      authorization failures or config-file error messages.</dd>
  <dt></dt>
  <dd>If the daemon fails to open to specified file, it will fall back to using
      syslog and output an error about the failure. (Note that the failure to
      open the specified log file used to be a fatal error.)</dd>
  <dt id="syslog"><a class="permalink" href="#syslog"><b>syslog
    facility</b></a></dt>
  <dd>The &quot;syslog facility&quot; option allows you to specify the syslog
      facility name to use when logging messages from the rsync daemon. You may
      use any standard syslog facility name which is defined on your system.
      Common names are auth, authpriv, cron, daemon, ftp, kern, lpr, mail, news,
      security, syslog, user, uucp, local0, local1, local2, local3, local4,
      local5, local6 and local7. The default is daemon. This setting has no
      effect if the &quot;log file&quot; setting is a non-empty string (either
      set in the per-modules settings, or inherited from the global
    settings).</dd>
  <dt id="max~2"><a class="permalink" href="#max~2"><b>max
    verbosity</b></a></dt>
  <dd>The &quot;max verbosity&quot; option allows you to control the maximum
      amount of verbose information that you'll allow the daemon to generate
      (since the information goes into the log file). The default is 1, which
      allows the client to request one level of verbosity.</dd>
  <dt id="lock"><a class="permalink" href="#lock"><b>lock file</b></a></dt>
  <dd>The &quot;lock file&quot; option specifies the file to use to support the
      &quot;max connections&quot; option. The rsync daemon uses record locking
      on this file to ensure that the max connections limit is not exceeded for
      the modules sharing the lock file. The default is
      <span class="Li">/var/run/rsyncd.lock</span>.</dd>
  <dt id="read"><a class="permalink" href="#read"><b>read only</b></a></dt>
  <dd>The &quot;read only&quot; option determines whether clients will be able
      to upload files or not. If &quot;read only&quot; is true then any
      attempted uploads will fail. If &quot;read only&quot; is false then
      uploads will be possible if file permissions on the daemon side allow
      them. The default is for all modules to be read only.</dd>
  <dt id="write"><a class="permalink" href="#write"><b>write only</b></a></dt>
  <dd>The &quot;write only&quot; option determines whether clients will be able
      to download files or not. If &quot;write only&quot; is true then any
      attempted downloads will fail. If &quot;write only&quot; is false then
      downloads will be possible if file permissions on the daemon side allow
      them. The default is for this option to be disabled.</dd>
  <dt id="list"><a class="permalink" href="#list"><b>list</b></a></dt>
  <dd>The &quot;list&quot; option determines if this module should be listed
      when the client asks for a listing of available modules. By setting this
      to false you can create hidden modules. The default is for modules to be
      listable.</dd>
  <dt id="uid"><a class="permalink" href="#uid"><b>uid</b></a></dt>
  <dd>The &quot;uid&quot; option specifies the user name or user ID that file
      transfers to and from that module should take place as when the daemon was
      run as root. In combination with the &quot;gid&quot; option this
      determines what file permissions are available. The default is uid -2,
      which is normally the user &quot;nobody&quot;.</dd>
  <dt id="gid"><a class="permalink" href="#gid"><b>gid</b></a></dt>
  <dd>The &quot;gid&quot; option specifies the group name or group ID that file
      transfers to and from that module should take place as when the daemon was
      run as root. This complements the &quot;uid&quot; option. The default is
      gid -2, which is normally the group &quot;nobody&quot;.</dd>
  <dt id="filter"><a class="permalink" href="#filter"><b>filter</b></a></dt>
  <dd>The &quot;filter&quot; option allows you to specify a space-separated list
      of filter rules that the daemon will not allow to be read or written. This
      is only superficially equivalent to the client specifying these patterns
      with the <b>--filter</b> option. Only one &quot;filter&quot; option may be
      specified, but it may contain as many rules as you like, including
      merge-file rules. Note that per-directory merge-file rules do not provide
      as much protection as global rules, but they can be used to make
      <b>--delete</b> work better when a client downloads the daemon's files (if
      the per-dir merge files are included in the transfer).</dd>
  <dt id="exclude"><a class="permalink" href="#exclude"><b>exclude</b></a></dt>
  <dd>The &quot;exclude&quot; option allows you to specify a space-separated
      list of patterns that the daemon will not allow to be read or written.
      This is only superficially equivalent to the client specifying these
      patterns with the <b>--exclude</b> option. Only one &quot;exclude&quot;
      option may be specified, but you can use &quot;-&quot; and &quot;+&quot;
      before patterns to specify exclude/include.</dd>
  <dt></dt>
  <dd>Because this exclude list is not passed to the client it only applies on
      the daemon: that is, it excludes files received by a client when receiving
      from a daemon and files deleted on a daemon when sending to a daemon, but
      it doesn't exclude files from being deleted on a client when receiving
      from a daemon.</dd>
  <dt></dt>
  <dd>When you want to exclude a directory and all its contents, it is safest to
      use a rule that does both, such as &quot;/some/dir/***&quot; (the three
      stars tells rsync to exclude the directory itself and everything inside
      it). This is better than just excluding the directory alone with
      &quot;/some/dir/&quot;, as it helps to guard against attempts to trick
      rsync into accessing files deeper in the hierarchy.</dd>
  <dt id="exclude~2"><a class="permalink" href="#exclude~2"><b>exclude
    from</b></a></dt>
  <dd>The &quot;exclude from&quot; option specifies a filename on the daemon
      that contains exclude patterns, one per line. This is only superficially
      equivalent to the client specifying the <b>--exclude-from</b> option with
      an equivalent file. See the &quot;exclude&quot; option above.</dd>
  <dt id="include"><a class="permalink" href="#include"><b>include</b></a></dt>
  <dd>The &quot;include&quot; option allows you to specify a space-separated
      list of patterns which rsync should not exclude. This is only
      superficially equivalent to the client specifying these patterns with the
      <b>--include</b> option because it applies only on the daemon. This is
      useful as it allows you to build up quite complex exclude/include rules.
      Only one &quot;include&quot; option may be specified, but you can use
      &quot;+&quot; and &quot;-&quot; before patterns to switch include/exclude.
      See the &quot;exclude&quot; option above.</dd>
  <dt id="include~2"><a class="permalink" href="#include~2"><b>include
    from</b></a></dt>
  <dd>The &quot;include from&quot; option specifies a filename on the daemon
      that contains include patterns, one per line. This is only superficially
      equivalent to the client specifying the <b>--include-from</b> option with
      a equivalent file. See the &quot;exclude&quot; option above.</dd>
  <dt id="incoming"><a class="permalink" href="#incoming"><b>incoming
    chmod</b></a></dt>
  <dd>This option allows you to specify a set of comma-separated chmod strings
      that will affect the permissions of all incoming files (files that are
      being received by the daemon). These changes happen after all other
      permission calculations, and this will even override destination-default
      and/or existing permissions when the client does not specify
      <b>--perms</b>. See the description of the <b>--chmod</b> rsync option and
      the <b>chmod</b>(1) manpage for information on the format of this
    string.</dd>
  <dt id="outgoing"><a class="permalink" href="#outgoing"><b>outgoing
    chmod</b></a></dt>
  <dd>This option allows you to specify a set of comma-separated chmod strings
      that will affect the permissions of all outgoing files (files that are
      being sent out from the daemon). These changes happen first, making the
      sent permissions appear to be different than those stored in the
      filesystem itself. For instance, you could disable group write permissions
      on the server while having it appear to be on to the clients. See the
      description of the <b>--chmod</b> rsync option and the <b>chmod</b>(1)
      manpage for information on the format of this string.</dd>
  <dt id="auth"><a class="permalink" href="#auth"><b>auth users</b></a></dt>
  <dd>The &quot;auth users&quot; option specifies a comma and space-separated
      list of usernames that will be allowed to connect to this module. The
      usernames do not need to exist on the local system. The usernames may also
      contain shell wildcard characters. If &quot;auth users&quot; is set then
      the client will be challenged to supply a username and password to connect
      to the module. A challenge response authentication protocol is used for
      this exchange. The plain text usernames and passwords are stored in the
      file specified by the &quot;secrets file&quot; option. The default is for
      all users to be able to connect without a password (this is called
      &quot;anonymous rsync&quot;).</dd>
  <dt></dt>
  <dd>See also the &quot;CONNECTING TO AN RSYNC DAEMON OVER A REMOTE SHELL
      PROGRAM&quot; section in <b>rsync</b>(1) for information on how handle an
      rsyncd.conf-level username that differs from the remote-shell-level
      username when using a remote shell to connect to an rsync daemon.</dd>
  <dt id="secrets"><a class="permalink" href="#secrets"><b>secrets
    file</b></a></dt>
  <dd>The &quot;secrets file&quot; option specifies the name of a file that
      contains the username:password pairs used for authenticating this module.
      This file is only consulted if the &quot;auth users&quot; option is
      specified. The file is line based and contains username:password pairs
      separated by a single colon. Any line starting with a hash (#) is
      considered a comment and is skipped. The passwords can contain any
      characters but be warned that many operating systems limit the length of
      passwords that can be typed at the client end, so you may find that
      passwords longer than 8 characters don't work.</dd>
  <dt></dt>
  <dd>There is no default for the &quot;secrets file&quot; option, you must
      choose a name (such as <span class="Li">/etc/rsyncd.secrets</span>). The
      file must normally not be readable by &quot;other&quot;; see &quot;strict
      modes&quot;.</dd>
  <dt id="strict"><a class="permalink" href="#strict"><b>strict
    modes</b></a></dt>
  <dd>The &quot;strict modes&quot; option determines whether or not the
      permissions on the secrets file will be checked. If &quot;strict
      modes&quot; is true, then the secrets file must not be readable by any
      user ID other than the one that the rsync daemon is running under. If
      &quot;strict modes&quot; is false, the check is not performed. The default
      is true. This option was added to accommodate rsync running on the Windows
      operating system.</dd>
  <dt id="hosts"><a class="permalink" href="#hosts"><b>hosts allow</b></a></dt>
  <dd>The &quot;hosts allow&quot; option allows you to specify a list of
      patterns that are matched against a connecting clients hostname and IP
      address. If none of the patterns match then the connection is
    rejected.</dd>
  <dt></dt>
  <dd>Each pattern can be in one of five forms:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="o"><a class="permalink" href="#o">o</a></dt>
  <dd>a dotted decimal IPv4 address of the form a.b.c.d, or an IPv6 address of
      the form a:b:c::d:e:f. In this case the incoming machine's IP address must
      match exactly.</dd>
  <dt id="o~2"><a class="permalink" href="#o~2">o</a></dt>
  <dd>an address/mask in the form ipaddr/n where ipaddr is the IP address and n
      is the number of one bits in the netmask. All IP addresses which match the
      masked IP address will be allowed in.</dd>
  <dt id="o~3"><a class="permalink" href="#o~3">o</a></dt>
  <dd>an address/mask in the form ipaddr/maskaddr where ipaddr is the IP address
      and maskaddr is the netmask in dotted decimal notation for IPv4, or
      similar for IPv6, e.g. ffff:ffff:ffff:ffff:: instead of /64. All IP
      addresses which match the masked IP address will be allowed in.</dd>
  <dt id="o~4"><a class="permalink" href="#o~4">o</a></dt>
  <dd>a hostname. The hostname as determined by a reverse lookup will be matched
      (case insensitive) against the pattern. Only an exact match is allowed
    in.</dd>
  <dt id="o~5"><a class="permalink" href="#o~5">o</a></dt>
  <dd>a hostname pattern using wildcards. These are matched using the same rules
      as normal unix filename matching. If the pattern matches then the client
      is allowed in.</dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt></dt>
  <dd>Note IPv6 link-local addresses can have a scope in the address
      specification:</dd>
</dl>
<div class="Bd-indent"><span class="Li"> fe80::1%link1</span>
<br/>
<span class="Li"> fe80::%link1/64</span>
<br/>
<span class="Li"> fe80::%link1/ffff:ffff:ffff:ffff::</span>
<br/>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt></dt>
  <dd>You can also combine &quot;hosts allow&quot; with a separate &quot;hosts
      deny&quot; option. If both options are specified then the &quot;hosts
      allow&quot; option s checked first and a match results in the client being
      able to connect. The &quot;hosts deny&quot; option is then checked and a
      match means that the host is rejected. If the host does not match either
      the &quot;hosts allow&quot; or the &quot;hosts deny&quot; patterns then it
      is allowed to connect.</dd>
  <dt></dt>
  <dd>The default is no &quot;hosts allow&quot; option, which means all hosts
      can connect.</dd>
  <dt id="hosts~2"><a class="permalink" href="#hosts~2"><b>hosts
    deny</b></a></dt>
  <dd>The &quot;hosts deny&quot; option allows you to specify a list of patterns
      that are matched against a connecting clients hostname and IP address. If
      the pattern matches then the connection is rejected. See the &quot;hosts
      allow&quot; option for more information.</dd>
  <dt></dt>
  <dd>The default is no &quot;hosts deny&quot; option, which means all hosts can
      connect.</dd>
  <dt id="ignore"><a class="permalink" href="#ignore"><b>ignore
    errors</b></a></dt>
  <dd>The &quot;ignore errors&quot; option tells rsyncd to ignore I/O errors on
      the daemon when deciding whether to run the delete phase of the transfer.
      Normally rsync skips the <b>--delete</b> step if any I/O errors have
      occurred in order to prevent disastrous deletion due to a temporary
      resource shortage or other I/O error. In some cases this test is counter
      productive so you can use this option to turn off this behavior.</dd>
  <dt id="ignore~2"><a class="permalink" href="#ignore~2"><b>ignore
    nonreadable</b></a></dt>
  <dd>This tells the rsync daemon to completely ignore files that are not
      readable by the user. This is useful for public archives that may have
      some non-readable files among the directories, and the sysadmin doesn't
      want those files to be seen at all.</dd>
  <dt id="transfer"><a class="permalink" href="#transfer"><b>transfer
    logging</b></a></dt>
  <dd>The &quot;transfer logging&quot; option enables per-file logging of
      downloads and uploads in a format somewhat similar to that used by ftp
      daemons. The daemon always logs the transfer at the end, so if a transfer
      is aborted, no mention will be made in the log file.</dd>
  <dt></dt>
  <dd>If you want to customize the log lines, see the &quot;log format&quot;
      option.</dd>
  <dt id="log~2"><a class="permalink" href="#log~2"><b>log format</b></a></dt>
  <dd>The &quot;log format&quot; option allows you to specify the format used
      for logging file transfers when transfer logging is enabled. The format is
      a text string containing embedded single-character escape sequences
      prefixed with a percent (%) character. An optional numeric field width may
      also be specified between the percent and the escape letter (e.g.
      &quot;%-50n %8l %07p&quot;).</dd>
  <dt></dt>
  <dd>The default log format is &quot;%o %h [%a] %m (%u) %f %l&quot;, and a
      &quot;%t [%p] &quot; is always prefixed when using the &quot;log
      file&quot; option. (A perl script that will summarize this default log
      format is included in the rsync source code distribution in the
      &quot;support&quot; subdirectory: rsyncstats.)</dd>
  <dt></dt>
  <dd>The single-character escapes that are understood are as follows:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="o~6"><a class="permalink" href="#o~6">o</a></dt>
  <dd>%a the remote IP address</dd>
  <dt id="o~7"><a class="permalink" href="#o~7">o</a></dt>
  <dd>%b the number of bytes actually transferred</dd>
  <dt id="o~8"><a class="permalink" href="#o~8">o</a></dt>
  <dd>%B the permission bits of the file (e.g. rwxrwxrwt)</dd>
  <dt id="o~9"><a class="permalink" href="#o~9">o</a></dt>
  <dd>%c the checksum bytes received for this file (only when sending)</dd>
  <dt id="o~10"><a class="permalink" href="#o~10">o</a></dt>
  <dd>%f the filename (long form on sender; no trailing &quot;/&quot;)</dd>
  <dt id="o~11"><a class="permalink" href="#o~11">o</a></dt>
  <dd>%G the gid of the file (decimal) or &quot;DEFAULT&quot;</dd>
  <dt id="o~12"><a class="permalink" href="#o~12">o</a></dt>
  <dd>%h the remote host name</dd>
  <dt id="o~13"><a class="permalink" href="#o~13">o</a></dt>
  <dd>%i an itemized list of what is being updated</dd>
  <dt id="o~14"><a class="permalink" href="#o~14">o</a></dt>
  <dd>%l the length of the file in bytes</dd>
  <dt id="o~15"><a class="permalink" href="#o~15">o</a></dt>
  <dd>%L the string &quot; -&gt; SYMLINK&quot;, &quot; =&gt; HARDLINK&quot;, or
      &quot;&quot; (where <b>SYMLINK</b> or <b>HARDLINK</b> is a filename)</dd>
  <dt id="o~16"><a class="permalink" href="#o~16">o</a></dt>
  <dd>%m the module name</dd>
  <dt id="o~17"><a class="permalink" href="#o~17">o</a></dt>
  <dd>%M the last-modified time of the file</dd>
  <dt id="o~18"><a class="permalink" href="#o~18">o</a></dt>
  <dd>%n the filename (short form; trailing &quot;/&quot; on dir)</dd>
  <dt id="o~19"><a class="permalink" href="#o~19">o</a></dt>
  <dd>%o the operation, which is &quot;send&quot;, &quot;recv&quot;, or
      &quot;del.&quot; (the latter includes the trailing period)</dd>
  <dt id="o~20"><a class="permalink" href="#o~20">o</a></dt>
  <dd>%p the process ID of this rsync session</dd>
  <dt id="o~21"><a class="permalink" href="#o~21">o</a></dt>
  <dd>%P the module path</dd>
  <dt id="o~22"><a class="permalink" href="#o~22">o</a></dt>
  <dd>%t the current date time</dd>
  <dt id="o~23"><a class="permalink" href="#o~23">o</a></dt>
  <dd>%u the authenticated username or an empty string</dd>
  <dt id="o~24"><a class="permalink" href="#o~24">o</a></dt>
  <dd>%U the uid of the file (decimal)</dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt></dt>
  <dd>For a list of what the characters mean that are output by &quot;%i&quot;,
      see the <b>--itemize-changes</b> option in the rsync manpage.</dd>
  <dt></dt>
  <dd>Note that some of the logged output changes when talking with older rsync
      versions. For instance, deleted files were only output as verbose messages
      prior to rsync 2.6.4.</dd>
  <dt id="timeout"><a class="permalink" href="#timeout"><b>timeout</b></a></dt>
  <dd>The &quot;timeout&quot; option allows you to override the clients choice
      for I/O timeout for this module. Using this option you can ensure that
      rsync won't wait on a dead client forever. The timeout is specified in
      seconds. A value of zero means no timeout and is the default. A good
      choice for anonymous rsync daemons may be 600 (giving a 10 minute
      timeout).</dd>
  <dt id="refuse"><a class="permalink" href="#refuse"><b>refuse
    options</b></a></dt>
  <dd>The &quot;refuse options&quot; option allows you to specify a
      space-separated list of rsync command line options that will be refused by
      your rsync daemon. You may specify the full option name, its one-letter
      abbreviation, or a wild-card string that matches multiple options. For
      example, this would refuse <b>--checksum</b> (<b>-c</b>) and all the
      various delete options:</dd>
</dl>
<div class="Bd-indent"><span class="Li"> refuse options = c delete</span></div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt></dt>
  <dd>The reason the above refuses all delete options is that the options imply
      <b>--delete</b>, and implied options are refused just like explicit
      options. As an additional safety feature, the refusal of
      &quot;delete&quot; also refuses <b>remove-sent-files</b> when the daemon
      is the sender; if you want the latter without the former, instead refuse
      &quot;delete-*&quot; -- that refuses all the delete modes without
      affecting <b>--remove-sent-files</b>.</dd>
  <dt></dt>
  <dd>When an option is refused, the daemon prints an error message and exits.
      To prevent all compression when serving files, you can use &quot;dont
      compress = *&quot; (see below) instead of &quot;refuse options =
      compress&quot; to avoid returning an error to a client that requests
      compression.</dd>
  <dt id="dont"><a class="permalink" href="#dont"><b>dont compress</b></a></dt>
  <dd>The &quot;dont compress&quot; option allows you to select filenames based
      on wildcard patterns that should not be compressed when pulling files from
      the daemon (no analogous option exists to govern the pushing of files to a
      daemon). Compression is expensive in terms of CPU usage, so it is usually
      good to not try to compress files that won't compress well, such as
      already compressed files.</dd>
  <dt></dt>
  <dd>The &quot;dont compress&quot; option takes a space-separated list of
      case-insensitive wildcard patterns. Any source filename matching one of
      the patterns will not be compressed during transfer.</dd>
  <dt></dt>
  <dd>The default setting is <span class="Li">*.gz *.tgz *.zip *.z *.rpm *.deb
      *.iso *.bz2 *.tbz</span></dd>
  <dt id="pre-xfer"><a class="permalink" href="#pre-xfer"><b>pre-xfer exec</b>,
    <b>post-xfer exec</b></a></dt>
  <dd>You may specify a command to be run before and/or after the transfer. If
      the <b>pre-xfer exec</b> command fails, the transfer is aborted before it
      begins.</dd>
  <dt></dt>
  <dd>The following environment variables will be set, though some are specific
      to the pre-xfer or the post-xfer environment:</dd>
</dl>
<div class="Bd-indent">
<dl class="Bl-tag">
  <dt id="o~25"><a class="permalink" href="#o~25">o</a></dt>
  <dd><b>RSYNC_MODULE_NAME</b>: The name of the module being accessed.</dd>
  <dt id="o~26"><a class="permalink" href="#o~26">o</a></dt>
  <dd><b>RSYNC_MODULE_PATH</b>: The path configured for the module.</dd>
  <dt id="o~27"><a class="permalink" href="#o~27">o</a></dt>
  <dd><b>RSYNC_HOST_ADDR</b>: The accessing host's IP address.</dd>
  <dt id="o~28"><a class="permalink" href="#o~28">o</a></dt>
  <dd><b>RSYNC_HOST_NAME</b>: The accessing host's name.</dd>
  <dt id="o~29"><a class="permalink" href="#o~29">o</a></dt>
  <dd><b>RSYNC_USER_NAME</b>: The accessing user's name (empty if no user).</dd>
  <dt id="o~30"><a class="permalink" href="#o~30">o</a></dt>
  <dd><b>RSYNC_PID</b>: A unique number for this transfer.</dd>
  <dt id="o~31"><a class="permalink" href="#o~31">o</a></dt>
  <dd><b>RSYNC_REQUEST</b>: (pre-xfer only) The module/path info specified by
      the user (note that the user can specify multiple source files, so the
      request can be something like &quot;mod/path1 mod/path2&quot;, etc.).</dd>
  <dt id="o~32"><a class="permalink" href="#o~32">o</a></dt>
  <dd><b>RSYNC_ARG#</b>: (pre-xfer only) The pre-request arguments are set in
      these numbered values. RSYNC_ARG0 is always &quot;rsyncd&quot;, and the
      last value contains a single period.</dd>
  <dt id="o~33"><a class="permalink" href="#o~33">o</a></dt>
  <dd><b>RSYNC_EXIT_STATUS</b>: (post-xfer only) the server side's exit value.
      This will be 0 for a successful run, a positive value for an error that
      the server generated, or a -1 if rsync failed to exit properly. Note that
      an error that occurs on the client side does not currently get sent to the
      server side, so this is not the final exit status for the whole
    transfer.</dd>
  <dt id="o~34"><a class="permalink" href="#o~34">o</a></dt>
  <dd><b>RSYNC_RAW_STATUS</b>: (post-xfer only) the raw exit value from
      <span class="Li">waitpid()</span> .</dd>
</dl>
</div>
<p class="Pp"></p>
<dl class="Bl-tag">
  <dt></dt>
  <dd>Even though the commands can be associated with a particular module, they
      are run using the permissions of the user that started the daemon (not the
      module's uid/gid setting) without any chroot restrictions.</dd>
</dl>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHENTICATION_STRENGTH"><a class="permalink" href="#AUTHENTICATION_STRENGTH">AUTHENTICATION
  STRENGTH</a></h1>
<p class="Pp">The authentication protocol used in rsync is a 128 bit MD4 based
    challenge response system. This is fairly weak protection, though (with at
    least one brute-force hash-finding algorithm publicly available), so if you
    want really top-quality security, then I recommend that you run rsync over
    ssh. (Yes, a future version of rsync will switch over to a stronger hashing
    method.)</p>
<p class="Pp">Also note that the rsync daemon protocol does not currently
    provide any encryption of the data that is transferred over the connection.
    Only authentication is provided. Use ssh as the transport if you want
    encryption.</p>
<p class="Pp">Future versions of rsync may support SSL for better authentication
    and encryption, but that is still being investigated.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h1>
<p class="Pp">A simple rsyncd.conf file that allow anonymous rsync to a ftp area
    at <span class="Li">/home/ftp</span> would be:</p>
<p class="Pp"></p>
<pre>
[ftp]
        path = /home/ftp
        comment = ftp export area
</pre>
<p class="Pp"></p>
<p class="Pp">A more sophisticated example would be:</p>
<p class="Pp"></p>
<pre>
uid = nobody
gid = nobody
use chroot = no
max connections = 4
syslog facility = local5
pid file = /var/run/rsyncd.pid
[ftp]
        path = /var/ftp/pub
        comment = whole ftp area (approx 6.1 GB)
[sambaftp]
        path = /var/ftp/pub/samba
        comment = Samba ftp area (approx 300 MB)
[rsyncftp]
        path = /var/ftp/pub/rsync
        comment = rsync ftp area (approx 6 MB)
[sambawww]
        path = /public_html/samba
        comment = Samba WWW pages (approx 240 MB)
[cvs]
        path = /data/cvs
        comment = CVS repository (requires authentication)
        auth users = tridge, susan
        secrets file = /etc/rsyncd.secrets
</pre>
<p class="Pp"></p>
<p class="Pp">The /etc/rsyncd.secrets file would look something like this:</p>
<p class="Pp"></p>
<div class="Bd-indent"><span class="Li">tridge:mypass</span>
<br/>
<span class="Li">susan:herpass</span>
<br/>
</div>
<p class="Pp"></p>
</section>
<section class="Sh">
<h1 class="Sh" id="FILES"><a class="permalink" href="#FILES">FILES</a></h1>
<p class="Pp">/etc/rsyncd.conf or rsyncd.conf</p>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><b>rsync</b>(1)</p>
</section>
<section class="Sh">
<h1 class="Sh" id="DIAGNOSTICS"><a class="permalink" href="#DIAGNOSTICS">DIAGNOSTICS</a></h1>
</section>
<section class="Sh">
<h1 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h1>
<p class="Pp">Please report bugs! The rsync bug tracking system is online at
    http://rsync.samba.org/</p>
</section>
<section class="Sh">
<h1 class="Sh" id="VERSION"><a class="permalink" href="#VERSION">VERSION</a></h1>
<p class="Pp">This man page is current for version 2.6.9 of rsync.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="CREDITS"><a class="permalink" href="#CREDITS">CREDITS</a></h1>
<p class="Pp">rsync is distributed under the GNU public license. See the file
    COPYING for details.</p>
<p class="Pp">The primary ftp site for rsync is
  ftp://rsync.samba.org/pub/rsync.</p>
<p class="Pp">A WEB site is available at http://rsync.samba.org/</p>
<p class="Pp">We would be delighted to hear from you if you like this
  program.</p>
<p class="Pp">This program uses the zlib compression library written by
    Jean-loup Gailly and Mark Adler.</p>
</section>
<section class="Sh">
<h1 class="Sh" id="THANKS"><a class="permalink" href="#THANKS">THANKS</a></h1>
<p class="Pp">Thanks to Warren Stanley for his original idea and patch for the
    rsync daemon. Thanks to Karsten Thygesen for his many suggestions and
    documentation!</p>
</section>
<section class="Sh">
<h1 class="Sh" id="AUTHOR"><a class="permalink" href="#AUTHOR">AUTHOR</a></h1>
<p class="Pp">rsync was written by Andrew Tridgell and Paul Mackerras. Many
    people have later contributed to it.</p>
<p class="Pp">Mailing lists for support and development are available at
    http://lists.samba.org</p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">6 Nov 2006</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
