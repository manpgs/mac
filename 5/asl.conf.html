<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
  Copyright (c) 2004-2013 Apple Inc. All rights reserved.
  
  @APPLE_LICENSE_HEADER_START@
  
  This file contains Original Code and/or Modifications of Original Code
  as defined in and that are subject to the Apple Public Source License
  Version 2.0 (the 'License'). You may not use this file except in
  compliance with the License. Please obtain a copy of the License at
  http://www.opensource.apple.com/apsl/ and read it before using this
  file.
  
  The Original Code and all software distributed under the License are
  distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
  EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
  INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
  Please see the License for the specific language governing rights and
  limitations under the License.
  
  @APPLE_LICENSE_HEADER_END@
   -->
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="../style.css" type="text/css" media="all"/>
  <title>ASL.CONF(5)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">ASL.CONF(5)</td>
    <td class="head-vol">File Formats Manual</td>
    <td class="head-rtitle">ASL.CONF(5)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">asl.conf</code> &#x2014;
    <span class="Nd">configuration file for
    <a class="Xr" href="../8/syslogd">syslogd(8)</a> and
    <a class="Xr" href="../8/aslmanager">aslmanager(8)</a></span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<p class="Pp">The <a class="Xr" href="../8/syslogd">syslogd(8)</a> server reads
    the /etc/asl.conf file at startup, and re-reads the file when it receives a
    HUP signal. The <a class="Xr" href="../8/aslmanager">aslmanager(8)</a>
    daemon reads the file when it starts. See the ASLMANAGER PARAMETER SETTINGS
    section for details on aslmanager-specific parameters.</p>
<p class="Pp">If the /etc/asl directory exists, then
    <code class="Nm">syslogd</code> and <code class="Nm">aslmanager</code> will
    read each file it contains. These files must have the same format as
    <code class="Nm">asl.conf</code>. Each file configures an independent
    module, identified by the file name. Modules may be enabled or disabled
    independently. Each module may specify its own set of rules for acting on
    received messages. See the ASL MODULES section for details.</p>
<p class="Pp">The files contain several types of lines, described below. Each
    type is identified by the first non-whitespace character in the line.</p>
<p class="Pp"></p>
<dl class="Bl-tag Bl-compact">
  <dt>=</dt>
  <dd>Parameter settings</dd>
  <dt>?</dt>
  <dd>Query-action rules</dd>
  <dt>&gt;</dt>
  <dd>Output file or directory configuration options</dd>
  <dt>#</dt>
  <dd>Comments</dd>
</dl>
<p class="Pp">Parameter setting lines in the configuration file are generally of
    the form:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= parameter_name value
  ...</code></div>
<p class="Pp">Most parameter settings require a single value, although some may
    take several values. See the PARAMETER SETTINGS section for details.</p>
<p class="Pp">Query-action rules in the file generally have the form:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">? query action ...</code></div>
<p class="Pp">This directs <code class="Nm">syslogd</code> to perform the
    specified action when a received message matches the given query. Actions
    may be followed by optional arguments. See the QUERY-ACTION RULES section
    for details.</p>
<p class="Pp">Most query-action rules specify output files or ASL-format data
    stores where matching messages should be saved. The optional parameters for
    those rules can specify a number of options for these outputs. As a
    convenience, these configuration options may be specified on a separate
    line. Output configuration settings in the file begin with a greater-than
    sign &#x201C;&gt;&#x201D; followed by a file or ASL directory name and the
    configuration options for that file or directory. These lines generally have
    the form:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">&gt; filename option ...</code></div>
<p class="Pp">See the OUTPUT CONFIGURATION SETTINGS section for details.</p>
<p class="Pp">Comment lines are ignored.</p>
<section class="Ss">
<h2 class="Ss" id="PARAMETER_SETTINGS"><a class="permalink" href="#PARAMETER_SETTINGS">PARAMETER
  SETTINGS</a></h2>
<p class="Pp">The following parameter-settings are recognized by
    <code class="Nm">syslogd</code>.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>debug</dt>
  <dd>Enables or disables internal debugging output. This is probably of little
      interest to most users. The debug parameter requires a value of
      &#x201C;1&#x201D; to enable debug output, or a value of &#x201C;0&#x201D;
      to disable it. Debugging messages are written to /var/log/syslogd.log.
    <p class="Pp"></p>
  </dd>
  <dt>mark_time</dt>
  <dd>Sets the time interval for the mark facility. The default is 0 seconds,
      which indicates that mark messages are not generated.
    <p class="Pp"></p>
  </dd>
  <dt>dup_delay</dt>
  <dd>Sets the maximum time before writing a &#x201C;last message repeated
      &lt;N&gt; times&#x201D; message in a log file when duplicate messages have
      been detected. The default is 30 seconds.
    <p class="Pp"></p>
  </dd>
  <dt>utmp_ttl</dt>
  <dd>Sets the time-to-live for messages used by the utmp, wtmp, and lastlog
      subsystems. The default is 31622400 seconds (approximately 1 year).
    <p class="Pp"></p>
  </dd>
  <dt>mps_limit</dt>
  <dd>Sets the kernel message per second quota. The default is value is 500. A
      value of 0 disables the quota mechanism. Note that this setting only
      limits the number of kernel messages that will be saved by
      <code class="Nm">syslogd</code>. User processes are limited to 36000
      messages per hour. The limit for a user process is not enforced if a
      remote-control ASL filter is in place for the process. See the
      <a class="Xr" href="../1/syslog">syslog(1)</a> manual for enabling a
      remote-control filter using the <code class="Fl">-c</code> option with the
      <code class="Nm">syslog</code> command.
    <p class="Pp"></p>
  </dd>
  <dt>max_file_size</dt>
  <dd>Sets the maximum file size for individual files in the ASL database. The
      default is 25600000 bytes.</dd>
</dl>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="QUERY-ACTION_RULES"><a class="permalink" href="#QUERY-ACTION_RULES">QUERY-ACTION
  RULES</a></h2>
<p class="Pp">Query-action rules are used to cause
    <code class="Nm">syslogd</code> to perform specific actions when received
    messages match a specified query pattern. For example, to save certain
    messages in a file. The rules are processed in the order in which they
    appear in the file. This matters because some actions can affect further
    processing. For example, an &#x201C;ignore&#x201D; action causes
    <code class="Nm">syslogd</code> to stop processing the rules in a file for
    messages that match a given query pattern.</p>
<p class="Pp">Query-action rules contain three components: a query, an action,
    and optional parameters specific to that action. For example, the following
    rule matches log messages sent by the &#x201C;example&#x201D; process which
    have log priority levels in the range emergency to error. If a received
    message matches, <code class="Nm">syslogd</code> posts a BSD notification
    for the key &#x201C;com.example.log_message&#x201D;.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">? [= Sender example] [&lt;= Level
  error] notify com.example.log_message</code></div>
</section>
<section class="Ss">
<h2 class="Ss" id="Query_Format"><a class="permalink" href="#Query_Format">Query
  Format</a></h2>
<p class="Pp">Queries comprise one or more message matching components, each of
    which has the form:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">[OP KEY VAL]</code></div>
<p class="Pp">OP is a comparison operator. It can have the following values:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>T</dt>
  <dd>true (always matches)</dd>
  <dt>=</dt>
  <dd>equal</dd>
  <dt>!</dt>
  <dd>not equal</dd>
  <dt>&gt;</dt>
  <dd>greater than</dd>
  <dt>&gt;=</dt>
  <dd>greater than or equal to</dd>
  <dt>&lt;</dt>
  <dd>less than</dd>
  <dt>&lt;=</dt>
  <dd>less than or equal to</dd>
</dl>
</div>
<p class="Pp">It can also be preceded by one or more modifiers:</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>C</dt>
  <dd>casefold</dd>
  <dt>N</dt>
  <dd>numeric comparison</dd>
  <dt>S</dt>
  <dd>substring</dd>
  <dt>A</dt>
  <dd>prefix</dd>
  <dt>Z</dt>
  <dd>suffix</dd>
</dl>
</div>
<p class="Pp">KEY and VAL are message keys and values. For example</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">[= Sender example]</code></div>
<p class="Pp">matches any message with value &#x201C;example&#x201D; for the
    &#x201C;Sender&#x201D; key. The query</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">[CA= Color gr]</code></div>
<p class="Pp">matches any message with a value beginning with the letters GR,
    Gr, gr, or gR ( &#x201C;C&#x201D; meaning casefold, &#x201C;A&#x201D;
    meaning prefix) for the &#x201C;Color&#x201D; key. The example query
  above,</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">[= Sender example] [N&lt; Level
  3]</code></div>
<p class="Pp">matches any message from &#x201C;example&#x201D; with a level
    numerically less than 3 (string values are converted to integers, and the
    comparison is done on the integer values). Note that the string values may
    be used equivalently for the Level key, so the example above may also be
    written as:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">[= Sender example] [&lt; Level
  Error]</code></div>
<p class="Pp">String values for levels may be any of the set
    &#x201C;emergency&#x201D;, &#x201C;alert&#x201D;, &#x201C;critical&#x201D;,
    &#x201C;error&#x201D;, &#x201C;warning&#x201D;, &#x201C;notice&#x201D;,
    &#x201C;info&#x201D;, or &#x201C;debug&#x201D;. These strings may be upper,
    lower, or mixed case.</p>
<p class="Pp">The &#x201C;T&#x201D; operator is useful to test for the presence
    of a particular key.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">[T Flavor]</code></div>
<p class="Pp">Will match any message that has a &#x201C;Flavor&#x201D; key,
    regardless of its value.</p>
<p class="Pp">Note that space characters and closing square bracket characters
    (']') are specially processed. The first space character following the
    beginning of a key delimits the key. The first closing square bracket
    following the beginning of a value delimits the value. So '[= foo
    bar&#x00A0;]' will match messages which have a key 'foo' with the value 'bar
    ', including a trailing space character.</p>
<p class="Pp">As a special case, the query</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">*</code></div>
<p class="Pp">matches all messages.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Actions"><a class="permalink" href="#Actions">Actions</a></h2>
<p class="Pp">The following actions are available.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>store</dt>
  <dd>Causes <code class="Nm">syslogd</code> to save matching messages in the
      ASL database. Note that if /etc/asl.conf contains no &#x201C;store&#x201D;
      action rules, then <code class="Nm">syslogd</code> will save all messages
      it receives in the ASL database.
    <p class="Pp"></p>
  </dd>
  <dt>file</dt>
  <dd>Causes matching messages to be stored in a log file. The file's path name
      must follow as the first parameter. If the path already exists, it must be
      a plain file. If the file does not exist, it will be created when the
      first message is written. If the pathname specified is not an absolute
      path, <code class="Nm">syslogd</code> will treat the given path as
      relative to /var/log (for /etc/asl.conf), or for other output modules
      relative to /var/log/module/NAME where NAME is the module name.
    <p class="Pp">By default, the file's owner will be root, and the file will
        be readable by the admin group. Various options may follow the file name
        to specify ownership and access controls, printed log message format,
        and controls for file rotation, compression, time-to-live, and other
        aspects of output file life-cycle management. See the OUTPUT
        CONFIGURATION SETTINGS section for more details.</p>
    <p class="Pp"></p>
  </dd>
  <dt>directory</dt>
  <dd>Causes matching messages to be stored in an ASL-format log message data
      store. A directory path name must follow as the first parameter. If the
      path exists, it must be a directory.
    <p class="Pp">Messages saved to an ASL directory are saved in files that are
        named &#x201C;yyyy.mm.dd.asl&#x201D;, where &#x201C;yyyy&#x201D;,
        &#x201C;mm&#x201D;, and &#x201C;dd&#x201D; are the year, month (01 to
        12) and day of the month (01 to 31) associated with matching messages.
        This has the effect of saving messages in a separate file for each
      day.</p>
    <p class="Pp">By default, files in the directory will be owned by root, and
        readable by the admin group. Various options may follow the directory
        name to control ownership, access controls, and the management of the
        store and its contents. See the OUTPUT CONFIGURATION SETTINGS section
        for a list of options that may be set for store directories.</p>
    <p class="Pp"></p>
  </dd>
  <dt id="notify_post">notify</dt>
  <dd>Causes <code class="Nm">syslogd</code> to post a notification with
      <a class="permalink" href="#notify_post"><code class="Fn">notify_post</code></a>().
      The notification key must appear as a single parameter following the
      &#x201C;notify&#x201D; action.
    <p class="Pp"></p>
  </dd>
  <dt>skip</dt>
  <dd>Causes a matching message to be ignored in all subsequent matching rules
      in the file. Its scope is local to a single module configuration file.
    <p class="Pp"></p>
  </dd>
  <dt>claim</dt>
  <dd>Messages that match the query associated with a &#x201C;claim&#x201D;
      action are not processed by the main ASL configuration file /etc/asl.conf.
      While claimed messages are not processed by /etc/asl.conf, they are not
      completely private. Other modules may also claim messages, and in some
      cases two or more modules may have claim actions that match the same
      messages. This action only blocks processing by /etc/asl.conf.
    <p class="Pp">The &#x201C;claim&#x201D; action may be followed by the
        keyword &#x201C;only&#x201D;. In this case, only those messages that
        match the &#x201C;claim only&#x201D; query will be processed by
        subsequent rules in the module.</p>
    <p class="Pp"></p>
  </dd>
  <dt>access</dt>
  <dd>Sets read access controls for messages that match the associated query
      pattern. <code class="Nm">syslogd</code> will restrict read access to
      matching messages to a specific user and group. The user ID number and
      group ID number must follow the &#x201C;access&#x201D; keyword as
      parameters.
    <p class="Pp"></p>
  </dd>
  <dt>broadcast</dt>
  <dd>Causes syslogd to write the text of matching messages to all terminal
      windows. If optional text follows the &#x201C;broadcast&#x201D; keyword,
      then that text is written rather that the matching message text. Note that
      this action is restricted to the main ASL configuration file
      /etc/asl.conf.
    <p class="Pp"></p>
  </dd>
  <dt>ignore</dt>
  <dd>Causes a matching message to be ignored in all subsequent matching rules
      in the file. This action is equivalent to the &#x201C;skip&#x201D; action
      in all module configuration files except the main ASL configuration file
      /etc/asl.conf. When used in the main configuration file, the scope of the
      action is global, and matching messages will be ignored by all ASL
      modules.</dd>
</dl>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="OUTPUT_CONFIGURATION_SETTINGS"><a class="permalink" href="#OUTPUT_CONFIGURATION_SETTINGS">OUTPUT
  CONFIGURATION SETTINGS</a></h2>
<p class="Pp">Various options may follow the path name in a &#x201C;file&#x201D;
    or &#x201C;directory&#x201D; query-action rule. For example, the following
    rule specifies that all messages from the &#x201C;example&#x201D; facility
    will be saved in the file &#x201C;example.log&#x201D;, and that messages are
    printed in a &#x201C;raw&#x201D; format that shows all the keys and values
    in the message:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">? [= Facility example] file
  example.log format=raw</code></div>
<p class="Pp">Multiple options may be specified separated by whitespace
    characters. For example:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">? [= Facility example] file
  example.log format=raw rotate=local compress ttl=3 mode=0640 uid=0 gid=5
  gid=20</code></div>
<p class="Pp">As a convenience, a file or directory name and any associated
    options can be specified on a separate output configuration line following a
    &#x201C;&gt;&#x201D; character:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">&gt; example.log format=raw
  rotate=local compress ttl=3 mode=0640 uid=0 gid=5 gid=20</code></div>
<p class="Pp">Options for a file or directory are taken from the first
    query-action rule or output configuration line for the given path. A good
    usage pattern for multiple rules that specify the same output file or
    directory is:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">&gt; example.log options
  ...</code></div>
<div class="Bd Bd-indent"><code class="Li">? query1 file
  example.log</code></div>
<div class="Bd Bd-indent"><code class="Li">? query2 file
  example.log</code></div>
<div class="Bd Bd-indent"><code class="Li">? query3 file
  example.log</code></div>
<p class="Pp">Most of the options listed below may be used with either file or
    directory outputs. Exceptions are noted.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>format=FMT</dt>
  <dd>Controls the format of log messages saved in a file. Note that this option
      is specific to file outputs. It is ignored for ASL directories.
    <p class="Pp">The format is specified by the value given for FMT. Several
        pre-defined formats are available:</p>
    <dl class="Bl-tag">
      <dt>bsd</dt>
      <dd>Format used by the <code class="Nm">syslogd</code> daemon for system
          log files, e.g. /var/log/system.log.</dd>
      <dt>std</dt>
      <dd>Standard (default) format. Similar to &#x201C;bsd&#x201D;, but
          includes the message priority level.</dd>
      <dt>raw</dt>
      <dd>Prints the complete message structure. Each key/value pair is enclosed
          in square brackets. Embedded closing brackets and white space are
          escaped. Time stamps are printed as seconds since the epoch.</dd>
      <dt>xml</dt>
      <dd>The list of messages is printed as an XML property list. Each message
          is represented as a dictionary in a array. Dictionary keys represent
          message keys. Dictionary values are strings.</dd>
      <dt>asl</dt>
      <dd>The output file is written as an ASL-format data store file. Files in
          this format may be read and searched using the
          <code class="Nm">syslog</code> command line utility with the use of
          the <code class="Fl">-f</code> <var class="Ar">path</var> option.</dd>
    </dl>
    <p class="Pp">Custom format strings may also be specified. Since custom
        formats often contain white-space characters, the entire string may be
        enclosed in single or double quote characters, or each white-space
        character may be preceded by a backslash escape character. Escaped
        characters are not interpreted. Custom format strings are described in
        detail in the READING MESSAGES section of the
        <a class="Xr" href="../1/syslog">syslog(1)</a> manual.</p>
    <p class="Pp"></p>
  </dd>
  <dt>mode=MMM</dt>
  <dd>Sets the mode of the file or files within an ASL directory. The value MMM
      may be specified as a decimal value, a hexadecimal value (if preceded by
      ``0x''), or octal value (if preceded by ``0'').
    <p class="Pp"></p>
  </dd>
  <dt>uid=UUU</dt>
  <dd>Specifies the file's owner. If more than one &#x201C;uid=UUU&#x201D;
      option is given, the first will be used to set ownership, and subsequent
      user IDs will be given read access to in the files POSIX.1e ACLs. Note
      that UIDs should be defined in the local Open Directory database, since
      <code class="Nm">syslogd</code> starts and may create the log file before
      network directory services are available. Unknown UIDs and GIDs will be
      ignored when setting access controls.
    <p class="Pp"></p>
  </dd>
  <dt>gid=GGG</dt>
  <dd>Specifies the file's group. If more than one &#x201C;gid=GGG&#x201D;
      option is given, the first will be used to set the file's group, and
      subsequent group IDs will be given read access to in the files POSIX.1e
      ACLs. As with UID=UUU options, groups should be defined in the local Open
      Directory database.
    <p class="Pp"></p>
  </dd>
  <dt>coalesce=VAL</dt>
  <dd>By default, files printed using the &#x201C;bsd&#x201D; and
      &#x201C;std&#x201D; formats will coalesce duplicates. If two or more
      messages are logged within 30 seconds, and which differ only in time, then
      the second and subsequent messages will not be printed. When a different
      message is logged, or 30 seconds have elapsed since the initial message
      was logged, a line with the text
    <div class="Bd Bd-indent"><code class="Li">--- last message repeated N times
      ---</code></div>
    will be added to the file. The default is &#x201C;coalesce=1&#x201D;. The
      default may be overridden by specifying &#x201C;coalesce=0&#x201D;. The
      values &#x201C;off&#x201D; and &#x201C;false&#x201D; may be used in place
      of &#x201C;0&#x201D;.</dd>
</dl>
</div>
<p class="Pp">The following options all deal with file rotation and life-cycle
    management. The FILE ROTATION section describes this in detail.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>rotate=NAME_STYLE</dt>
  <dd>Enables log file rotation and specifies the file naming scheme for rotated
      files. This option does not apply to ASL directories. NAME_STYLE may
      either be a simple time-stamp style: &#x201C;sec&#x201D;,
      &#x201C;utc&#x201D;, &#x201C;utc-basic&#x201D;, &#x201C;local&#x201D;,
      &#x201C;local-basic&#x201D;, or &#x201C;seq&#x201D;; or the value may
      contain the file's base name, a file name extension, and one of the
      time-stame styles. For example &#x201C;example.seq.log&#x201D; or
      &#x201C;example.log.utc-basic.&#x201D; A detailed description of name
      styles may be found in the FILE ROTATION section below.
    <p class="Pp">If the option &#x201C;rotate&#x201D; appears without a value,
        the naming style defaults to &#x201C;sec&#x201D;.</p>
    <p class="Pp"></p>
  </dd>
  <dt>ttl=DAYS</dt>
  <dd>Specifies the number of days that older versions of rotated files should
      be allowed to remain in the filesystem. Rotated files older than this
      limit are deleted.
    <p class="Pp"></p>
  </dd>
  <dt>dest=PATH</dt>
  <dd>By default, rotated files are left in the same directory as the original
      file. However, in some cases it may be useful to move the rotated versions
      to a different directory for archival or other reasons. If this option is
      specified, <code class="Nm">aslmanager</code> will move files to the
      directory given by PATH.
    <p class="Pp"></p>
  </dd>
  <dt>soft</dt>
  <dd>Makes <code class="Nm">syslogd</code> ignore write errors when saving
      messages. Normally, <code class="Nm">syslogd</code> will stop saving to a
      file or ASL directory after 5 consecutive write errors.
    <p class="Pp"></p>
  </dd>
  <dt>compress</dt>
  <dd>Enables gzip file compression for rotated log files. When compressed, the
      extension &#x201C;.gz&#x201D; is appended to the file name. When the
      output is an ASL directory, data files are compressed after midnight local
      time. This means that messages written in the current day will be readable
      using <code class="Nm">syslog</code> <code class="Fl">-d</code> or using
      the <a class="Xr" href="../3/asl">asl(3)</a> API. Messages in compressed
      data files will not be available until the files are un-compressed.
    <p class="Pp"></p>
  </dd>
  <dt>file_max=SIZE</dt>
  <dd>Limits the size of an active log file. SIZE may be an integer number of
      bytes, or the value may be followed by a single character
      &#x201C;k&#x201D;, &#x201C;m&#x201D;, or &#x201C;g&#x201D; (upper or lower
      case), to indicate a size limit in multiples of 1024 (kibibyte), 1048576
      (mebibyte), or 1073741824 (gibibyte). If a file exceeds this limit, it is
      immediately checkpointed by <code class="Nm">syslogd</code> and a new file
      is opened. Note that &#x201C;file_max&#x201D; specifies a size limit
      before file compression is performed if the &#x201C;compress&#x201D;
      option is also present.
    <p class="Pp"></p>
  </dd>
  <dt>all_max=SIZE</dt>
  <dd>Specifies a size limit for the total of all rotated versions of a file.
      <code class="Nm">aslmanager</code> will delete rotated files, oldest
      first, to reduce the total below the limit. SIZE may be specified in the
      same format as the file_max option.
    <p class="Pp"></p>
  </dd>
  <dt>basestamp</dt>
  <dd>Causes <code class="Nm">syslogd</code> to add a timestamp to the file name
      when it is created. For example,
    <p class="Pp"></p>
    <div class="Bd Bd-indent"><code class="Li"></code></div>
    &gt; example.log rotate=utc-basic basestamp
    <p class="Pp">will result in syslogd writing to, e.g.
        &#x201C;example.log.20120625T070000Z&#x201D; rather than to
        &#x201C;example.log&#x201D;. Note that this option does nothing with
        sequenced (``seq'') files.</p>
    <p class="Pp"></p>
  </dd>
  <dt>symlink</dt>
  <dd>This option may only be used together with the basestamp option. It causes
      <code class="Nm">syslogd</code> to create a symlink with the unstamped
      file name to the currently active log file. For example,
    <p class="Pp"></p>
    <div class="Bd Bd-indent"><code class="Li"></code></div>
    &gt; example.log rotate=sec basestamp symlink
    <p class="Pp">will result in syslogd writing to, e.g.
        &#x201C;example.log.T1340607600&#x201D;, and creating a sybolic link
        from &#x201C;example.log&#x201D; to the active file.</p>
  </dd>
</dl>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="FILE_ROTATION"><a class="permalink" href="#FILE_ROTATION">FILE
  ROTATION</a></h2>
<p class="Pp"><code class="Nm">syslogd</code> and
    <code class="Nm">aslmanager</code> work together to provide the features of
    file rotation. This section describes the file rotation options that may be
    used in /etc/asl.conf or an ASL Output Module configuration file, together
    with a description of how the system works to support those features.</p>
<p class="Pp">File rotation or file rolling is enabled by the
    &#x201C;rotate&#x201D; output configuration option. It is typically
    specificed with a value which specifies the naming sytle for rotated files.
    Name styles may simply be a timestamp format, which is appended to the
    filename.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>sec</dt>
  <dd>Rotated file names are of the form
      &#x201C;example.log.T1340607600&#x201D;. The file names include the
      creation time of the file in seconds since the epoch.
    <p class="Pp"></p>
  </dd>
  <dt>utc</dt>
  <dd>Rotated file names are in ISO 8601 extended format, for example
      &#x201C;example.log.2012-06-24T07:00:00Z&#x201D;. The file names includes
      its creation time as a UTC date and time.
    <p class="Pp"></p>
  </dd>
  <dt>utc-basic</dt>
  <dd>Rotated file names are in ISO 8601 basic format, for example
      &#x201C;example.log.20120624T070000Z&#x201D;. The file names includes its
      creation time as a UTC date and time.
    <p class="Pp"></p>
  </dd>
  <dt>local</dt>
  <dd>Rotated file names are in ISO 8601 extended format, for example
      &#x201C;example.log.2012-06-24T07:00:00-7&#x201D;. The file names includes
      its creation time as date and time in the local time zone. The local
      timezone offset is included as a trailing part of the name. The value
      &#x201C;lcl&#x201D; is an alias for &#x201C;local&#x201D;.
    <p class="Pp"></p>
  </dd>
  <dt>local-basic</dt>
  <dd>Rotated file names are in ISO 8601 basic format, for example
      &#x201C;example.log.20120624T070000-07&#x201D;. The file names includes
      its creation time as date and time in the local time zone. The local
      timezone offset is included as a trailing part of the name. The value
      &#x201C;lcl-basic&#x201D; is an alias for &#x201C;local-basic&#x201D;.
    <p class="Pp"></p>
  </dd>
  <dt>seq</dt>
  <dd>Rotated file names are of the form &#x201C;example.log.N&#x201D; where N
      is an integer sequence number. Files are re-numbered on each rotation so
      that the &#x201C;0&#x201D; file is the most recent.</dd>
</dl>
</div>
<p class="Pp">Note that using the local timezone for timestamped files may cause
    odd behavior on highly mobile systems. <code class="Nm">aslmanager</code>
    will delete files after a specified time-to-live (see below). The age of the
    file is determined by the file name. If files are created in different
    timezones but saved with a non-absolute timestamp, the age calculation may
    result in some files being considered older or newer than they are in
    reality.</p>
<p class="Pp">Also note that sequenced files (using the &#x201C;seq&#x201D;
    style) will initially be checkpointed using a file name containing a
    timestamp in seconds. <code class="Nm">aslmanager</code> will re-sequence
    the files when it scans for checkpoint files.</p>
<p class="Pp">Alternatively, the name style may be have two or three components.
    The first component is the &#x201C;base&#x201D; name of the file, with no
    filename extension. The base name may be followed by a timestamp format and
    optionally by a filename extension, or the base name may be followed by an
    extension (the extension is optional) and a timestamp format. These
    components must be separated by a dot character.</p>
<p class="Pp">For example, this output configuration line specifies that the
    output file &#x201C;example.log&#x201D; should be rotated to create the
    files &#x201C;example.0.log&#x201D;, &#x201C;example.1.log&#x201D;, and so
    on.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">&gt; example.log
  rotate=example.seq.log</code></div>
<p class="Pp">If a file is marked for rotation, <code class="Nm">syslogd</code>
    will close the file at the start of a new day or when the file exceeds its
    &#x201C;file_max&#x201D; size limit. At that point,
    <code class="Nm">syslogd</code> renames the file with the file's creation
    time included in its name (unless the basestamp option is present, in which
    case the file's creation time is already included in the filename) and
    starts a new file to continue logging. This operation is called
    checkpointing the file.</p>
<p class="Pp">For example, <code class="Nm">syslogd</code> might close
    &#x201C;example.log&#x201D; and rename it
    &#x201C;example.log.T1340521200&#x201D;, 1340521200 being the time that the
    file was created. It would then start a new &#x201C;example.log&#x201D; file
    and use it until midnight, when the cycle would be repeated.</p>
<p class="Pp">Files are normally checkpointed at midnight. If the system is
    sleeping or powered off, then files are checkpointed when the the first
    message of a new day (local time) is received. Files are also checkpointed
    if they exceed a size limit specified by a file_max option, and they may be
    checkpointed manually through options provided by the
    <a class="Xr" href="../1/syslog">syslog(1)</a> and
    <a class="Xr" href="../8/aslmanager">aslmanager(8)</a> utilities. The
    checkpointed file name always contains the file's creation time. If the
    options for the file include &#x201C;rotate=utc&#x201D; then the timestamp
    will be a UTC date and time string. &#x201C;rotate=local&#x201D; causes the
    timestamp to be the date and time in the current local timezone. Otherwise,
    the timestamp will be in seconds since the epoch.</p>
<p class="Pp"><code class="Nm">syslogd</code> only performs the checkpointing
    operation. It closes old files, moves them out of the way, and starts
    writing new files. Most of the work of file rotation is done by the
    <a class="Xr" href="../8/aslmanager">aslmanager(8)</a> utility. That
    includes moving files to a destination directory, compressing files,
    re-naming files according to one of the naming style options, deleting old
    files after they exceed their time-to-live, and checking file space
  usage.</p>
<p class="Pp"><code class="Nm">aslmanager</code> normally runs once during
    system start-up, and once a day just after midnight. It may also be
    triggered occasionally by <code class="Nm">syslogd</code>, and it may be run
    manually.</p>
<p class="Pp"><code class="Nm">aslmanager</code> scans for any checkpointed
    files created by <code class="Nm">syslogd</code> and will rename the files
    (if required) to match the naming style specified by the
    &#x201C;rotate=NAME_STYLE&#x201D; option. If &#x201C;rotate=seq&#x201D; is
    specified for a file, checkpointed files created by
    <code class="Nm">syslogd</code> contain a timestamp in seconds. These files
    are renamed so that the file names contain a sequence number. The most
    recent version has the number &#x201C;0&#x201D;, and older versions have
    higher numbers. For example:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">example.log.0</code></div>
<div class="Bd Bd-indent"><code class="Li">example.log.1</code></div>
<div class="Bd Bd-indent"><code class="Li">example.log.2</code></div>
<div class="Bd Bd-indent"><code class="Li">...</code></div>
<p class="Pp">As well as renaming files, <code class="Nm">aslmanager</code> may
    perform other actions. If the file has been given a
    &#x201C;dest=PATH&#x201D; option, the rotated versions of the file will be
    moved to the specified directory. Files will be gzip compressed using the
    <a class="Xr" href="../3/zlib">zlib(3)</a> library if the
    &#x201C;compress&#x201D; option has been given. If the total size of all the
    rotated versions of the file exceeds a value given in an
    &#x201C;all_max&#x201D; option, older versions of the rotated file will be
    deleted to keep the total below the specified limit.</p>
<p class="Pp">Although checkpoint and file rotation operations are normally done
    automatically, <code class="Nm">aslmanager</code> supports an option that
    will trigger <code class="Nm">syslogd</code> to checkpoint files before
    <code class="Nm">aslmanager</code> starts its scan.
    <code class="Nm">syslog</code> also supports an option to force files to be
    checkpointed without running <code class="Nm">aslmanager</code>. See the
    <a class="Xr" href="../8/aslmanager">aslmanager(8)</a> and
    <a class="Xr" href="../1/syslog">syslog(1)</a> manuals for details.</p>
<p class="Pp">Programmatically, an <a class="Xr" href="../3/asl">asl(3)</a>
    message may be sent to syslogd to force it to checkpoint either a single
    file, or to checkpoint all files for a particular ASL module. To checkpoint
    all files:</p>
<p class="Pp">
  <br/>
   const char *module_name;</p>
<p class="Pp">
  <br/>
   //TODO: set module_name
  <br/>
   asl_object_t ctl = asl_new(ASL_TYPE_MSG);
  <br/>
   asl_set(ctl, ASL_KEY_OPTION, &quot;control&quot;);
  <br/>
   asl_log(NULL, ctl, ASL_LEVEL_NOTICE, &quot;@ %s checkpoint&quot;,
    module_name);
  <br/>
   asl_release(ctl);</p>
<p class="Pp">To checkpoint just one file:</p>
<p class="Pp">
  <br/>
   const char *module_name;
  <br/>
   const char *file_name;</p>
<p class="Pp">
  <br/>
   //TODO: set module_name
  <br/>
   //TODO: set file_name
  <br/>
   asl_object_t ctl = asl_new(ASL_TYPE_MSG);
  <br/>
   asl_set(ctl, ASL_KEY_OPTION, &quot;control&quot;);
  <br/>
   asl_log(NULL, ctl, ASL_LEVEL_NOTICE, &quot;@ %s checkpoint %s&quot;,
    module_name, file_name);
  <br/>
   asl_release(ctl);</p>
</section>
<section class="Ss">
<h2 class="Ss" id="ASL_OUTPUT_MODULES"><a class="permalink" href="#ASL_OUTPUT_MODULES">ASL
  OUTPUT MODULES</a></h2>
<p class="Pp">An ASL output module is created by a configuration file in the
    directory /etc/asl. The file name is used as the module's name. The format
    of the file is generally the same as <code class="Nm">asl.conf</code> with a
    few exceptions. Modules may not have parameter setting lines for the system
    parameters listed in the PARAMETER SETTINGS or ASLMANAGER PARAMETER SETTINGS
    sections, nor may they include &#x201C;broadcast&#x201D; query-action
  rules.</p>
<p class="Pp">Module configuration files are read by
    <code class="Nm">syslogd</code> when it starts, and whenever it gets a HUP
    signal. Messages received by <code class="Nm">syslogd</code> are first
    processed according the the rules found in /etc/asl.conf (also known as the
    &#x201C;com.apple.asl&#x201D; module), then the message is processed by the
    rules from each module found in /etc/asl.</p>
<p class="Pp">An exception to this is that messages that match the query in a
    &#x201C;claim&#x201D; action rule in any module are not processed by the
    rules in /etc/asl.conf.</p>
<p class="Pp">ASL output modules are enabled by default, but a module may
    include a parameter setting:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= enable 0</code></div>
<p class="Pp">The module is still loaded by <code class="Nm">syslogd</code>, but
    the module will not save messages to files or directories, and will not post
    BSD notifications.</p>
<p class="Pp">Several mechanisms allow modules to be enabled or disabled
    dynamically. One mechanism allows the setting of the &#x201C;enable&#x201D;
    parameter to be based on the existence of a path in the filesystem, or on
    the value associated with a dictionary key in a property list file. On iOS
    only, the value of a key in an installed configuration profile may be
    tested.</p>
<p class="Pp">To enable a module based on the existence of a file, the module
    may use:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= enable [File /a/b/c]</code></div>
<p class="Pp">where &#x201C;/a/b/c&#x201D; may be any filesystem path.</p>
<p class="Pp">To enable a module based on the value of a dictionary key in a
    property list file,</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= enable [Plist /path/config.plist]
  [= SomeKey SomeValue]</code></div>
<p class="Pp">Any of the test operations described above in the QUERY-ACTION
    RULES section may also be used in testing key / value pairs. Multiple
    operations are also allowed, for example:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= enable [Plist /path/config.plist]
  [N&gt;= DebugLevel 7] [S= Othervalue xyz]</code></div>
<p class="Pp">If the property list file does not exist, the test will evaluate
    to zero. The file may be in binary or xml format. It may only contain a
    single dictionary object at its top level. Only keys and values at the top
    level of the dictionary may be tested. Values must be strings, integer
    values, doubles, UUIDs, dates, or booleans. Boolean &lt;true/&gt; and
    &lt;false/&gt; values are converted to 1 and 0 respectively. Values are
    converted into strings, and string comparisons are used unless unless an
    &#x201C;N&#x201D; modifier is specified with the test operator.</p>
<p class="Pp">On iOS, a module may test key / value pairs in a configuration
    profile using the same key / value tests that may be used for property list
    files.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= enable [Profile name] [= Verbose
  1]</code></div>
<p class="Pp">The profile name is the value of its DefaultsDomainName key. The
    test will evaluate to zero if the profile is not installed.</p>
<p class="Pp">A module may be also enabled or disabled using
    <code class="Nm">syslog</code> or by sending <code class="Nm">syslogd</code>
    a special <a class="Xr" href="../3/asl">asl(3)</a> control message. Only the
    user &#x201C;root&#x201D; may enable or disable modules.</p>
<p class="Pp">A module may be enabled or disabled by sending an
    <a class="Xr" href="../3/asl">asl(3)</a> message as shown in this
  example:</p>
<p class="Pp">
  <br/>
   int enable;
  <br/>
   const char *module_name;</p>
<p class="Pp">
  <br/>
   //TODO: set module_name
  <br/>
   //TODO: set enable to 0 or 1
  <br/>
   asl_object_t ctl = asl_new(ASL_TYPE_MSG);
  <br/>
   asl_set(ctl, ASL_KEY_OPTION, &quot;control&quot;);
  <br/>
   asl_log(NULL, ctl, ASL_LEVEL_NOTICE, &quot;@ %s enable %d&quot;, module_name,
    enable);
  <br/>
   asl_release(ctl);</p>
<p class="Pp">A control message may also be sent using
    <code class="Nm">syslog</code> as the following example shows to disable a
    module named &#x201C;com.apple.example&#x201D;:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">sudo syslog -module com.apple.example
  enable 0</code></div>
<p class="Pp">A module may also enable or disable itself. Although a module that
    is not enabled will not write or post notifications, it still will scan
    messages. The module may contain conditional parameter-setting rules
  like:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">= [= Color Green] enable
  1</code></div>
<div class="Bd Bd-indent"><code class="Li">= [= Color Red] enable 0</code></div>
<p class="Pp">This is similar to a query-action rule. If a message received by
    syslogd matches the specified query, in this case having a Color key with
    the value Green or Red, then the enable parameter is set as specified. So in
    this example, the module would be enabled and disabled whenever syslogd
    received a message containing the appropriate value for the
    &#x201C;Color&#x201D; key.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="ASLMANAGER_PARAMETER_SETTINGS"><a class="permalink" href="#ASLMANAGER_PARAMETER_SETTINGS">ASLMANAGER
  PARAMETER SETTINGS</a></h2>
<p class="Pp">The following parameter-settings are recognized by
    <code class="Nm">aslmanager</code>.</p>
<p class="Pp"></p>
<div class="Bd-indent">
<dl class="Bl-tag Bl-compact">
  <dt>aslmanager_debug</dt>
  <dd>Enables or disables internal debugging output. This is probably of little
      interest to most users. The debug parameter requires a value of
      &#x201C;1&#x201D; to enable debug output, or a value of &#x201C;0&#x201D;
      to disable it. Debug messages are saved in an auxiliary file attached to
      an ASL log message. The file may be inspected by opening the file
      attachement from the Console utility.
    <p class="Pp"></p>
  </dd>
  <dt>store_ttl</dt>
  <dd>Sets the time-to-live in days for messages in the ASL database. The
      default is 7 days.
    <p class="Pp"></p>
  </dd>
  <dt>max_store_size</dt>
  <dd>Sets the maximum size for for the ASL database. The default is 150000000
      bytes.
    <p class="Pp"></p>
  </dd>
  <dt>archive</dt>
  <dd>Enables or disables archiving of the ASL database. The archive parameter
      requires a value of &#x201C;1&#x201D; to enable archiving, or a value of
      &#x201C;0&#x201D; to disable it. An optional archive directory path may
      follow the &#x201C;0&#x201D; or &#x201C;1&#x201D;. If enabled, files
      removed from the ASL database are moved to the archive directory. The
      default archive directory path is /var/log/asl.archive.
    <p class="Pp"></p>
  </dd>
  <dt>store_path</dt>
  <dd>The ASL database path used by <code class="Nm">aslmanager</code>. The
      default is /var/log/asl. Note that this parameter is ignored by
      <code class="Nm">syslogd</code>.
    <p class="Pp"></p>
  </dd>
  <dt>archive_mode</dt>
  <dd>Files copied to the ASL database archive will be given the specified
      access mode. The default is 0400, so archive files will only be readable
      by root.</dd>
</dl>
</div>
</section>
</section>
<section class="Sh">
<h1 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h1>
<p class="Pp"><a class="Xr" href="../1/syslog">syslog(1)</a>,
    <a class="Xr" href="../3/asl">asl(3)</a>,
    <a class="Xr" href="../3/notify">notify(3)</a>,
    <a class="Xr" href="../8/aslmanager">aslmanager(8)</a>,
    <a class="Xr" href="../8/syslogd">syslogd(8)</a></p>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">September 19, 2008</td>
    <td class="foot-os">macOS</td>
  </tr>
</table>
</body>
</html>
